<html>
<head>
<title>Storing Go Structs in Redis using ReJSON</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨ReJSONåœ¨Redisä¸­å­˜å‚¨Goç»“æ„</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/storing-go-structs-in-redis-using-rejson-dab7f8fc0053?source=collection_archive---------1-----------------------#2018-05-17">https://itnext.io/storing-go-structs-in-redis-using-rejson-dab7f8fc0053?source=collection_archive---------1-----------------------#2018-05-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/3d6f0ec554f7988d7ec05befa5ca5c71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*w3hPEpsPFtHs36dJMUdl7w.jpeg"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">å›¾ç‰‡æä¾›:<a class="ae jy" href="https://redislabs.com/blog/redis-go-designed-improve-performance/" rel="noopener ugc nofollow" target="_blank">https://redis labs . com/blog/redis-go-designed-improve-performance/</a></figcaption></figure><p id="517e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ä½ ä»¬å¾ˆå¤šäººå¯èƒ½å¯¹<a class="ae jy" href="https://redis.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kb ir"> Redis </strong> </a>å¾ˆç†Ÿæ‚‰ã€‚å¯¹äºå¤–è¡Œæ¥è¯´ï¼Œrediså³ä½¿ä¸æ˜¯æœ€æµè¡Œçš„ï¼Œä¹Ÿæ˜¯æœ€å¹¿æ³›é‡‡ç”¨çš„æ•°æ®åº“/ç¼“å­˜ä¹‹ä¸€ã€‚</p><p id="8644" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">å®˜æ–¹æ–‡æ¡£å°†<a class="ae jy" href="https://redis.io/" rel="noopener ugc nofollow" target="_blank"> redis </a>æè¿°ä¸ºï¼Œ</p><blockquote class="kx ky kz"><p id="3f12" class="jz ka la kb b kc kd ke kf kg kh ki kj lb kl km kn lc kp kq kr ld kt ku kv kw ij bi translated">Redisæ˜¯ä¸€ä¸ªå¼€æºçš„(BSDè®¸å¯çš„)ã€å†…å­˜ä¸­çš„æ•°æ®ç»“æ„å­˜å‚¨ï¼Œç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä»£ç†ã€‚å®ƒæ”¯æŒæ•°æ®ç»“æ„ï¼Œå¦‚å­—ç¬¦ä¸²ã€å“ˆå¸Œã€åˆ—è¡¨ã€é›†åˆã€å¸¦æœ‰èŒƒå›´æŸ¥è¯¢çš„æ’åºé›†åˆã€ä½å›¾ã€è¶…çº§æ—¥å¿—å’Œå¸¦æœ‰radiusæŸ¥è¯¢çš„åœ°ç†ç©ºé—´ç´¢å¼•ã€‚Rediså…·æœ‰å†…ç½®çš„å¤åˆ¶ã€Luaè„šæœ¬ã€LRUé©±é€ã€äº‹åŠ¡å’Œä¸åŒçº§åˆ«çš„ç£ç›˜æŒä¹…æ€§ï¼Œå¹¶é€šè¿‡Redis Sentinelå’ŒRedis Clusterçš„è‡ªåŠ¨åˆ†åŒºæä¾›é«˜å¯ç”¨æ€§ã€‚</p></blockquote><p id="2971" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">redisä¸å…¶ä»–(ä¼ ç»Ÿ)æ•°æ®åº“çš„ä¸åŒä¹‹å¤„åœ¨äºå®ƒæ˜¯ä¸€ä¸ª<a class="ae jy" href="https://en.wikipedia.org/wiki/Key-value_database" rel="noopener ugc nofollow" target="_blank">é”®å€¼</a>å­˜å‚¨(é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒä½äºå†…å­˜ä¸­)ã€‚è¿™æ„å‘³ç€åœ¨è¿™æ ·çš„æ•°æ®åº“ä¸­ï¼Œæ‰€æœ‰çš„å€¼éƒ½å­˜å‚¨åœ¨ä¸€ä¸ªé”®ä¸­(æ¯”å¦‚å­—å…¸)ã€‚</p><p id="5afa" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç„¶è€Œï¼Œæˆ‘è·‘é¢˜äº†ï¼Œè¿™ä¸ªå¸–å­ä¸æ˜¯å…³äºredisçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»§ç»­å§ï¼</p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><h1 id="c890" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">ä½¿ç”¨Goä¸Redisäº¤äº’</h1><p id="df38" class="pw-post-body-paragraph jz ka iq kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ij bi translated">ä½œä¸ºä¸€åä½¿ç”¨redisçš„Goå¼€å‘äººå‘˜ï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦åœ¨redisä¸­ç¼“å­˜æˆ‘ä»¬çš„å¯¹è±¡ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨Redisä¸­çš„<code class="fe mo mp mq mr b">HMSET</code>æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p><p id="74b5" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ä¸€ä¸ªç®€å•çš„goç»“æ„åº”è¯¥æ˜¯è¿™æ ·çš„ï¼Œ</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="2442" class="na lm iq mr b gy nb nc l nd ne">type SimpleObject struct {<br/>    FieldA string<br/>    FieldB int<br/>}</span><span id="13a1" class="na lm iq mr b gy nf nc l nd ne">simpleObject := SimpleObject{â€œJohn Doeâ€,24}</span></pre><p id="7c77" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">å¾ˆæ˜æ˜¾ï¼Œè¦åœ¨redisä¸­å­˜å‚¨å¯¹è±¡ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒè½¬æ¢æˆä¸€ä¸ªé”®å€¼å¯¹ã€‚æˆ‘ä»¬é€šè¿‡ä½¿ç”¨Go Structå­—æ®µåä½œä¸ºé”®å’Œæ ¹æ®å®ƒå­˜å‚¨çš„ç»“æ„å€¼æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p><p id="1831" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ä¸€ä¸ª<strong class="kb ir">æ•£åˆ—</strong>å°†æ˜¯ä¸€ä¸ªå®Œç¾çš„å€™é€‰ï¼Œå®ƒå°†å±äºä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å­—æ®µç»‘å®šå›å¯¹è±¡æœ¬èº«ã€‚ä»<code class="fe mo mp mq mr b">redis-cli</code>å¼€å§‹ï¼Œæˆ‘ä»¬å°†æ‰§è¡Œä»¥ä¸‹æ“ä½œ:</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="6c45" class="na lm iq mr b gy nb nc l nd ne">127.0.0.1:6379&gt; HMSET simple_object fieldA â€œJohn Doeâ€ fieldB 24<br/>OK</span></pre><p id="b403" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ä½¿ç”¨<code class="fe mo mp mq mr b">HGETALL</code>å‘½ä»¤è·å–çš„ç»“æœå°†æ˜¯ï¼Œ</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="87cf" class="na lm iq mr b gy nb nc l nd ne">127.0.0.1:6379&gt; HGETALL simple_object<br/>fieldA<br/>John Doe<br/>fieldB<br/>24</span></pre><p id="5268" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬çŸ¥é“äº†å¯¹è±¡æ˜¯å¦‚ä½•è¢«å°é€åˆ°æ•°æ®åº“ä¸­çš„ã€‚è®©æˆ‘ä»¬ä»¥ç¼–ç¨‹çš„æ–¹å¼ç»§ç»­åšè¿™ä»¶äº‹å§ï¼</p><p id="ab47" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è™½ç„¶redisæœ‰ç›¸å½“å¤šçš„goå®¢æˆ·ï¼Œä½†æˆ‘è€ƒè™‘ä¸Redigoåˆä½œã€‚å®ƒåœ¨githubä¸Šæœ‰ä¸€ä¸ªå¾ˆæ£’çš„ç¤¾åŒºï¼Œå¹¶ä¸”æ˜¯redisæœ€å—æ¬¢è¿çš„go-clientä¹‹ä¸€ï¼Œæ‹¥æœ‰è¶…è¿‡100å4Kæ˜æ˜Ÿã€‚</p><h2 id="9f2c" class="na lm iq bd ln ng nh dn lr ni nj dp lv kk nk nl lz ko nm nn md ks no np mh nq bi translated">RedigoåŠ©æ‰‹â€” AddFlatå’ŒScanStruct</h2><p id="2142" class="pw-post-body-paragraph jz ka iq kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ij bi translated">Redigoé…å¤‡äº†ä¸€ç»„å¾ˆæ£’çš„åŠ©æ‰‹å‡½æ•°ï¼Œå…¶ä¸­ä¸€ä¸ªæˆ‘ä»¬å°†ä½¿ç”¨<code class="fe mo mp mq mr b">AddFlat</code>ï¼Œåœ¨å°†å®ƒæ·»åŠ åˆ°redisä¹‹å‰ï¼Œå±•å¹³æˆ‘ä»¬çš„ç»“æ„ã€‚</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="37e3" class="na lm iq mr b gy nb nc l nd ne">// Get the connection object<br/>conn, err := redis.Dial(â€œtcpâ€, â€œlocalhost:6379â€)<br/>if err != nil {<br/>    return<br/>}</span><span id="55f8" class="na lm iq mr b gy nf nc l nd ne">// Invoke the command using the Do command<br/>_, err = conn.Do(â€œHMSETâ€, redis.Args{â€œsimple_objectâ€}.AddFlat(simpleObject)â€¦)<br/>if err != nil {<br/>    return<br/>}</span></pre><p id="f29e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç°åœ¨å¦‚æœä½ æƒ³æŠŠè¿™ä¸ªå¯¹è±¡è¯»å›ä½ çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code class="fe mo mp mq mr b">HGETALL</code>å‘½ä»¤æ¥å®Œæˆï¼Œ</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="e7bc" class="na lm iq mr b gy nb nc l nd ne">value, err := redis.Values(conn.Do(â€œHGETALLâ€, key))<br/>if err != nil {<br/>    return<br/>}</span><span id="f319" class="na lm iq mr b gy nf nc l nd ne">object := SimpleStruct{}<br/>err = redis.ScanStruct(value, &amp;object)<br/>if err != nil {<br/>    return<br/>}</span></pre></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><blockquote class="nr"><p id="8ebc" class="ns nt iq bd nu nv nw nx ny nz oa kw dk translated">å¤Ÿç®€å•äº†å§ï¼Ÿè®©æˆ‘ä»¬çœ‹çœ‹æ›´å¤æ‚çš„ä¸œè¥¿â€¦</p></blockquote><h2 id="64a7" class="na lm iq bd ln ng ob dn lr ni oc dp lv kk od nl lz ko oe nn md ks of np mh nq bi translated">Goç»“æ„ä¸­çš„åµŒå…¥å¯¹è±¡</h2><p id="48b7" class="pw-post-body-paragraph jz ka iq kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ij bi translated">ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæ›´å¤æ‚çš„ç»“æ„ï¼Œ</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="c9ef" class="na lm iq mr b gy nb nc l nd ne">type Student struct {<br/>    Info *StudentDetails `json:â€info,omitemptyâ€`<br/>    Rank int `json:â€rank,omitemptyâ€`<br/>}</span><span id="bcf4" class="na lm iq mr b gy nf nc l nd ne">type StudentDetails struct {<br/>    FirstName string<br/>    LastName string<br/>    Major string<br/>}</span><span id="421f" class="na lm iq mr b gy nf nc l nd ne">studentJD := Student{<br/>    Info: &amp;StudentDetails{<br/>        FirstName: â€œJohnâ€,<br/>        LastName: â€œDoeâ€,<br/>        Major: â€œCSEâ€,<br/>    },<br/>    Rank: 1,<br/>}</span></pre><p id="babc" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æˆ‘ä»¬ç°åœ¨æ‹¥æœ‰çš„æ˜¯ä¸€ä¸ª<strong class="kb ir">åµŒå…¥çš„</strong>ç»“æ„ï¼Œå¸¦æœ‰<code class="fe mo mp mq mr b">StudentDetails</code>ï¼Œä½œä¸º<code class="fe mo mp mq mr b">Student</code>å¯¹è±¡çš„æˆå‘˜ã€‚</p><p id="8ebe" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è®©æˆ‘ä»¬å†æ¬¡å°è¯•ä½¿ç”¨<code class="fe mo mp mq mr b">HMSET</code>ï¼Œ</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="cac1" class="na lm iq mr b gy nb nc l nd ne">// Invoke the command using the Do command<br/>_, err = conn.Do(â€œHMSETâ€, redis.Args{â€œJohnDoeâ€}.AddFlat(studentJD)â€¦)<br/>if err != nil {<br/>    return<br/>}</span></pre><p id="058c" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">å¦‚æœæˆ‘ä»¬ç°åœ¨æŸ¥çœ‹redisï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°infoå¯¹è±¡è¢«å­˜å‚¨ä¸ºâ€“</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="f34d" class="na lm iq mr b gy nb nc l nd ne">127.0.0.1:6379&gt; HGETALL JohnDoe<br/>Info<br/>&amp;{John Doe CSE}<br/>Rank<br/>1</span></pre><p id="840e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨ã€‚å½“æˆ‘ä»¬è¯•å›¾å°†ä¿¡æ¯æ£€ç´¢å›å¯¹è±¡ä¸­æ—¶ï¼Œ<strong class="kb ir"> ScanStruct </strong>å¤±è´¥ï¼Œå¹¶å‡ºç°<strong class="kb ir">é”™è¯¯</strong>ï¼Œ</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="1e43" class="na lm iq mr b gy nb nc l nd ne"><strong class="mr ir">redigo.ScanStruct: cannot assign field Info: cannot convert from Redis bulk string to *main.StudentDetails</strong></span></pre><blockquote class="nr"><p id="d12d" class="ns nt iq bd nu nv og oh oi oj ok kw dk translated">å²è¯—å¤±è´¥ï¼</p></blockquote><p id="985a" class="pw-post-body-paragraph jz ka iq kb b kc ol ke kf kg om ki kj kk on km kn ko oo kq kr ks op ku kv kw ij bi translated">å‘ç”Ÿè¿™ç§æƒ…å†µæ˜¯å› ä¸ºåœ¨redisä¸­ï¼Œæ‰€æœ‰ä¸œè¥¿éƒ½è¢«å­˜å‚¨ä¸ºä¸€ä¸ª<strong class="kb ir">å­—ç¬¦ä¸²</strong> <em class="la">ã€å¯¹äºè¾ƒå¤§çš„å¯¹è±¡æ˜¯æ‰¹é‡å­—ç¬¦ä¸²ã€‘ã€‚</em></p><h2 id="2953" class="na lm iq bd ln ng nh dn lr ni nj dp lv kk nk nl lz ko nm nn md ks no np mh nq bi translated">ç°åœ¨æ€ä¹ˆåŠï¼Ÿ</h2><p id="e7de" class="pw-post-body-paragraph jz ka iq kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ij bi translated">å¿«é€Ÿæœç´¢ä¼šå¸¦ä½ æ‰¾åˆ°å‡ ä¸ªè§£å†³æ–¹æ¡ˆã€‚å…¶ä¸­ä¸€ä¸ªè§£å†³æ–¹æ¡ˆå»ºè®®ä½¿ç”¨å°é€æ‹†æ”¶å™¨(<code class="fe mo mp mq mr b">JSON</code> marshal)ï¼Œå…¶ä»–çš„å»ºè®®ä½¿ç”¨<code class="fe mo mp mq mr b">MessagePack</code>ã€‚</p><p id="4875" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æˆ‘å°†åœ¨ä¸‹é¢å±•ç¤ºåŸºäº<code class="fe mo mp mq mr b">JSON</code>çš„è§£å†³æ–¹æ¡ˆã€‚</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="1e98" class="na lm iq mr b gy nb nc l nd ne">b, err := json.Marshal(&amp;studentJD)<br/>if err != nil {<br/>    return<br/>}</span><span id="7281" class="na lm iq mr b gy nf nc l nd ne">_, err = conn.Do(â€œSETâ€, â€œJohnDoeâ€, string(b))<br/>if err != nil {<br/>    return<br/>}</span></pre><p id="878d" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¦æ£€ç´¢å®ƒï¼Œåªéœ€ä½¿ç”¨<code class="fe mo mp mq mr b">GET</code>å‘½ä»¤è¯»å›<code class="fe mo mp mq mr b">JSON</code>å­—ç¬¦ä¸²</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="dbe8" class="na lm iq mr b gy nb nc l nd ne">objStr, err = redis.String(conn.Do(â€œGETâ€, â€œJohnDoeâ€))<br/>if err != nil {<br/>    return<br/>}</span><span id="d304" class="na lm iq mr b gy nf nc l nd ne">b := []byte(objStr)</span><span id="26a3" class="na lm iq mr b gy nf nc l nd ne">student := &amp;Student{}</span><span id="f4b2" class="na lm iq mr b gy nf nc l nd ne">err = json.Unmarshal(b, student)<br/>if err != nil {<br/>    return<br/>}</span></pre><p id="dc14" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">å¦‚æœæˆ‘ä»¬æƒ³è¦åšçš„æ˜¯<strong class="kb ir"> <em class="la">å®Œæ•´åœ°ç¼“å­˜å¯¹è±¡</em> </strong>ï¼Œè¿™å°±å¤ªæ£’äº†ã€‚</p><p id="b799" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">å¦‚æœæˆ‘ä»¬åªæƒ³æ·»åŠ ã€ä¿®æ”¹æˆ–è¯»å–å…¶ä¸­ä¸€ä¸ªå­—æ®µï¼Œä¾‹å¦‚ï¼Œå¦‚æœJohn Doe<strong class="kb ir"><em class="la"/></strong>å°†å…¶ä¸“ä¸šä»<strong class="kb ir"><em class="la">ã€CSE</em></strong><em class="la">æ›´æ”¹ä¸º<strong class="kb ir"> <em class="la"> EE </em> </strong>è¯¥æ€ä¹ˆåŠï¼Ÿï¼Ÿ</em></p><p id="4755" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æˆ‘ä»¬å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹çš„å”¯ä¸€æ–¹æ³•æ˜¯è¯»å–JSONå­—ç¬¦ä¸²ï¼Œå°†å®ƒè§£å°åˆ°å¯¹è±¡ä¸­ï¼Œä¿®æ”¹å¯¹è±¡å¹¶å°†å…¶é‡æ–°å†™å…¥redisã€‚çœ‹èµ·æ¥å·¥ä½œé‡å¾ˆå¤§ï¼</p><blockquote class="kx ky kz"><p id="84f4" class="jz ka la kb b kc kd ke kf kg kh ki kj lb kl km kn lc kp kq kr ld kt ku kv kw ij bi translated"><em class="iq">å¦‚æœä½ æƒ³çŸ¥é“ï¼Œé€šè¿‡ä½¿ç”¨</em> <code class="fe mo mp mq mr b"><em class="iq">HGET</em></code> <em class="iq"> / </em> <code class="fe mo mp mq mr b"><em class="iq">HSET</em></code> <em class="iq">å‘½ä»¤ï¼Œç”¨</em> <code class="fe mo mp mq mr b"><em class="iq">Hash</em></code> <em class="iq">åšè¿™ä»¶äº‹å¾ˆç®€å•ã€‚è¦æ˜¯é‚£æ ·å°±å¥½äº†â€”â€”</em><strong class="kb ir"><em class="iq"/></strong><em class="iq">ï¼</em></p></blockquote><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/1e790d0b7cf4f642a7cc3a0241d44c7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*ed0x40y1Y30I4NB_ahm6WQ.jpeg"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">å› ä¸ºï¼Œæ²¡æœ‰æ¨¡å› ï¼Œä»»ä½•ç½‘ç»œå¸–å­éƒ½ä¸å¯èƒ½å­˜åœ¨â€¦</figcaption></figure><h2 id="21ca" class="na lm iq bd ln ng nh dn lr ni nj dp lv kk nk nl lz ko nm nn md ks no np mh nq bi translated">ç‘æ£®</h2><p id="c264" class="pw-post-body-paragraph jz ka iq kb b kc mj ke kf kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw ij bi translated">RedisLabsçš„ä¼˜ç§€å›¢é˜Ÿä¸ºæˆ‘ä»¬å¸¦æ¥äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œè®©æˆ‘ä»¬å¯ä»¥åƒå¯¹å¾…ä¼ ç»Ÿå¯¹è±¡ä¸€æ ·å¯¹å¾…æˆ‘ä»¬çš„å¯¹è±¡ã€‚</p><p id="cd25" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è®©æˆ‘ä»¬ç›´æ¥è¿›å…¥ä¸»é¢˜ã€‚æˆ‘ç›´æ¥ä»rejsonæ–‡æ¡£ä¸­æŒ‘é€‰äº†è¿™ä¸ªä¾‹å­ï¼Œ</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="1258" class="na lm iq mr b gy nb nc l nd ne">127.0.0.1:6379&gt; JSON.SET amoreinterestingexample . â€˜[ true, { â€œanswerâ€: 42 }, null ]â€™<br/>OK<br/>127.0.0.1:6379&gt; JSON.GET amoreinterestingexample<br/>â€œ[true,{\â€answer\â€:42},null]â€<br/>127.0.0.1:6379&gt; JSON.GET amoreinterestingexample [1].answer<br/>â€œ42â€<br/>127.0.0.1:6379&gt; JSON.DEL amoreinterestingexample [-1]<br/>1<br/>127.0.0.1:6379&gt; JSON.GET amoreinterestingexample<br/>â€œ[true,{\â€answer\â€:42}]â€</span></pre><p id="91dd" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ä¸ºäº†ä»¥ç¼–ç¨‹æ–¹å¼åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬è‚¯å®šå¯ä»¥ä½¿ç”¨åŸå§‹å½¢å¼çš„<code class="fe mo mp mq mr b">Redigo</code>ã€‚[è¿™æ„å‘³ç€æ”¯æŒRedisæ”¯æŒçš„ä»»ä½•å‘½ä»¤ï¼Œä½¿ç”¨<code class="fe mo mp mq mr b">conn.Do(â€¦)</code>æ–¹æ³•]ã€‚</p><p id="562b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç„¶è€Œï¼Œæˆ‘èŠ±äº†ä¸€äº›æ—¶é—´å°†æ‰€æœ‰çš„<code class="fe mo mp mq mr b">ReJSON</code>å‘½ä»¤è½¬æ¢æˆä¸€ä¸ªGoä¾¿åˆ©åŒ…ï¼Œåä¸º<a class="ae jy" href="https://github.com/nitishm/go-rejson" rel="noopener ugc nofollow" target="_blank"> go-rejson </a>ã€‚</p><p id="6383" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">å›åˆ°æˆ‘ä»¬çš„<code class="fe mo mp mq mr b">Student</code>å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ­¥éª¤é€šè¿‡ç¼–ç¨‹å°†å…¶æ·»åŠ åˆ°Redisä¸­ã€‚</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="e437" class="na lm iq mr b gy nb nc l nd ne">import "github.com/nitishm/go-rejson"</span><span id="6c0a" class="na lm iq mr b gy nf nc l nd ne">_, err = rejson.JSONSet(conn, â€œJohnDoeJSON, â€œ.â€, studentJD, false, false)<br/>if err != nil {<br/>    return<br/>}</span></pre><p id="5ae7" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><code class="fe mo mp mq mr b">redis-cli</code>ä¸­çš„å¿«é€Ÿæ£€æŸ¥ç»™äº†æˆ‘ä»¬ï¼Œ</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="e1a1" class="na lm iq mr b gy nb nc l nd ne">127.0.0.1:6379&gt; JSON.GET JohnDoeJSON<br/>{â€œinfoâ€:{â€œFirstNameâ€:â€Johnâ€,â€LastNameâ€:â€Doeâ€,â€Majorâ€:â€CSEâ€},â€rankâ€:1}</span></pre><p id="0a9b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">å¦‚æœæˆ‘å¸Œæœ›åªä»redisæ¡ç›®ä¸­è¯»å–ä¿¡æ¯å­—æ®µï¼Œæˆ‘å°†æ‰§è¡Œå¦‚ä¸‹çš„<code class="fe mo mp mq mr b">JSON.SET</code>,</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="f7fa" class="na lm iq mr b gy nb nc l nd ne">127.0.0.1:6379&gt; JSON.GET JohnDoeJSON .info<br/>{â€œFirstNameâ€:â€Johnâ€,â€LastNameâ€:â€Doeâ€,â€Majorâ€:â€CSEâ€}</span></pre><p id="c8fc" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç±»ä¼¼åœ°ï¼Œå¯¹äº<strong class="kb ir">ç­‰çº§</strong>å­—æ®µï¼Œæˆ‘å¯ä»¥å¼•ç”¨<code class="fe mo mp mq mr b">.rank</code>ï¼Œ</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="1a43" class="na lm iq mr b gy nb nc l nd ne">127.0.0.1:6379&gt; JSON.GET JohnDoeJSON .rank<br/>1</span></pre><p id="2ccb" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ä¸ºäº†ä»¥ç¼–ç¨‹æ–¹å¼æ£€ç´¢å­¦ç”Ÿå¯¹è±¡ï¼Œæˆ‘ä»¬å°†é€šè¿‡<code class="fe mo mp mq mr b">JSONGet()</code>æ–¹æ³•ä½¿ç”¨<code class="fe mo mp mq mr b">JSON.GET</code>å‘½ä»¤ï¼Œ</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="3074" class="na lm iq mr b gy nb nc l nd ne">v, err := rejson.JSONGet(conn, â€œJohnDoeJSON, â€œâ€)<br/>if err != nil {<br/>    return<br/>}</span><span id="cc3d" class="na lm iq mr b gy nf nc l nd ne">outStudent := &amp;Student{}<br/>err = json.Unmarshal(outJSON.([]byte), outStudent)<br/>if err != nil {<br/>    return<br/>}</span></pre><p id="0b8a" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ä¸ºäº†è®¾ç½®<strong class="kb ir">ç­‰çº§</strong>å­—æ®µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="fe mo mp mq mr b">JSONSet()</code>æ–¹æ³•å¯¹<code class="fe mo mp mq mr b">.rank</code>å­—æ®µä½¿ç”¨<code class="fe mo mp mq mr b">JSON.SET</code>å‘½ä»¤ï¼Œ</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="8f52" class="na lm iq mr b gy nb nc l nd ne">_, err = rejson.JSONSet(conn, â€œJohnDoeJSON, â€œ.info.Majorâ€, â€œEEâ€, false, false)<br/>if err != nil {<br/>    return<br/>}</span></pre><p id="7db4" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æ£€æŸ¥<code class="fe mo mp mq mr b">redis-cli</code>ä¸­çš„æ¡ç›®ï¼Œæˆ‘ä»¬å¾—åˆ°:</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="c3fb" class="na lm iq mr b gy nb nc l nd ne">127.0.0.1:6379&gt; JSON.GET JohnDoeJSON{â€œinfoâ€:{â€œFirstNameâ€:â€Johnâ€,â€LastNameâ€:â€Doeâ€,â€Majorâ€:â€EEâ€},â€rankâ€:1}</span></pre></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><h1 id="6849" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">è¿è¡Œæ­¤ç¤ºä¾‹</h1><h2 id="0ee8" class="na lm iq bd ln ng nh dn lr ni nj dp lv kk nk nl lz ko nm nn md ks no np mh nq bi translated">ä½¿ç”¨Dockerç”¨rejsonæ¨¡å—å¯åŠ¨redis</h2><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="5d11" class="na lm iq mr b gy nb nc l nd ne">docker run -p 6379:6379 --name redis-rejson redislabs/rejson:latest</span></pre><h2 id="bb05" class="na lm iq bd ln ng nh dn lr ni nj dp lv kk nk nl lz ko nm nn md ks no np mh nq bi translated">ä»githubå…‹éš†è¿™ä¸ªä¾‹å­</h2><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="bbdc" class="na lm iq mr b gy nb nc l nd ne"># git clone <a class="ae jy" href="https://github.com/nitishm/rejson-struct.git" rel="noopener ugc nofollow" target="_blank">https://github.com/nitishm/rejson-struct.git</a><br/># cd rejson-struct<br/># go run main.go</span></pre></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><p id="1eeb" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><em class="la">è¦äº†è§£æ›´å¤šå…³äº</em><strong class="kb ir"><em class="la">Go-ReJSON</em></strong><em class="la">åŒ…çš„ä¿¡æ¯ï¼Œè¯·è®¿é—®</em><a class="ae jy" href="https://github.com/nitishm/go-rejson" rel="noopener ugc nofollow" target="_blank"><strong class="kb ir"><em class="la">ã€https://github.com/nitishm/go-rejsonã€‘</em></strong></a><em class="la">ã€‚</em></p><p id="ec7a" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><em class="la">é˜…è¯»æ›´å¤šå…³äº</em> <strong class="kb ir"> <em class="la">é›·å‰æ£®</em> </strong> <em class="la">åœ¨ä»–ä»¬çš„å®˜æ–¹æ–‡æ¡£é¡µé¢ï¼Œ</em><a class="ae jy" href="http://rejson.io/." rel="noopener ugc nofollow" target="_blank"><strong class="kb ir"><em class="la">http://rejson.io/</em></strong><em class="la">ã€‚</em>T55ã€‘</a></p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><p id="e6b1" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« å¹¶è§‰å¾—å®ƒå¾ˆæœ‰ç”¨ï¼Œåˆ«å¿˜äº†ç»™å®ƒä¸€ä¸ªğŸ‘ï¼ï¼</p><p id="ba9b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">å¦‚æœèƒ½å¾—åˆ°ä¸€äº›åé¦ˆï¼Œæˆ‘å°†ä¸èƒœæ„Ÿæ¿€ï¼è¯·åŠ¡å¿…ç•™ä¸‹æ‚¨çš„è¯„è®ºã€‚</p><p id="756a" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ä¹Ÿå¯ä»¥çœ‹çœ‹æˆ‘ä¹‹å‰(ç¬¬ä¸€ç¯‡)çš„å¸–å­â€”â€”â€œ<em class="la">åœ¨Golangæ„å»ºå¾®æœåŠ¡æ¡†æ¶â€åœ¨</em><a class="ae jy" href="https://medium.com/@nitishmalhotra/building-a-microservice-framework-in-golang-dd3c9530dff9" rel="noopener">https://medium . com/@ nitishmalhotra/Building-a-microservice-framework-in-Golang-dd3c 9530 dff 9</a></p></div></div>    
</body>
</html>