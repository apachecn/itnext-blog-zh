<html>
<head>
<title>How to backup your object storage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•å¤‡ä»½æ‚¨çš„å¯¹è±¡å­˜å‚¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/how-to-backup-your-object-storage-29bfb9fe7584?source=collection_archive---------4-----------------------#2020-01-25">https://itnext.io/how-to-backup-your-object-storage-29bfb9fe7584?source=collection_archive---------4-----------------------#2020-01-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/9766cc95c1d918ed3a48b4911e203313.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*Q8FbelbyczVdsPMmBJygUQ.png"/></div></figure><p id="65de" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">ç”¨è¿™ä¸ªç®€å•çš„è„šæœ¬å¤‡ä»½ä½ çš„ç©ºé—´ã€‚</p><h1 id="7d4b" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">TLï¼›é€Ÿåº¦ä¸‰è§’å½¢å®šä½æ³•(dead reckoning)</h1><p id="53a0" class="pw-post-body-paragraph jx jy it jz b ka lt kc kd ke lu kg kh ki lv kk kl km lw ko kp kq lx ks kt ku im bi translated">é•¿è¯çŸ­è¯´:<a class="ae ly" href="https://github.com/GeoPablo/s3-backup" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œæ˜¯è„šæœ¬(jsä»£ç )</a>è¿™é‡Œæ˜¯<a class="ae ly" href="https://m.do.co/c/f0f252058644" rel="noopener ugc nofollow" target="_blank"> <strong class="jz iu"> 100$ </strong>ä½œä¸ºå¼•èé“¾æ¥åˆ°æ•°å­—æµ·æ´‹æµ‹è¯•ä¸€ä¸‹ã€‚</a>ä¸‹è½½å®ƒï¼Œè¿è¡Œå®ƒï¼Œäº«å—å®ƒã€‚ğŸ˜€</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="d475" class="kv kw it bd kx ky mg la lb lc mh le lf lg mi li lj lk mj lm ln lo mk lq lr ls bi translated">åœ¨å¹•å</h1><p id="3e78" class="pw-post-body-paragraph jx jy it jz b ka lt kc kd ke lu kg kh ki lv kk kl km lw ko kp kq lx ks kt ku im bi translated">å¦‚ä½•ç¼–å†™nodejsè„šæœ¬æ¥å¤‡ä»½æ‚¨çš„å¯¹è±¡å­˜å‚¨ã€‚</p><h2 id="5d65" class="ml kw it bd kx mm mn dn lb mo mp dp lf ki mq mr lj km ms mt ln kq mu mv lr mw bi translated">é¡¹ç›®è®¾ç½®</h2><ol class=""><li id="4d26" class="mx my it jz b ka lt ke lu ki mz km na kq nb ku nc nd ne nf bi translated">åˆ›å»º<strong class="jz iu"> package.json </strong>æ–‡ä»¶</li><li id="aa97" class="mx my it jz b ka ng ke nh ki ni km nj kq nk ku nc nd ne nf bi translated">å®‰è£…ä¾èµ–é¡¹</li><li id="ed19" class="mx my it jz b ka ng ke nh ki ni km nj kq nk ku nc nd ne nf bi translated">åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶<strong class="jz iu"> index.js </strong>å’Œ<strong class="jz iu">ã€‚env </strong> <em class="nl">(ç¯å¢ƒå˜é‡å¯é€‰)</em></li></ol><p id="a588" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi">â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€”</p><ol class=""><li id="f2a7" class="mx my it jz b ka kb ke kf ki nm km nn kq no ku nc nd ne nf bi translated">åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸­è¿è¡Œè¯¥å‘½ä»¤ä»¥ç”Ÿæˆ<strong class="jz iu"> package.json </strong>æ–‡ä»¶:</li></ol><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="be87" class="ml kw it nu b gy ny nz l oa ob">npm init -y</span></pre><blockquote class="oc od oe"><p id="382b" class="jx jy nl jz b ka kb kc kd ke kf kg kh of kj kk kl og kn ko kp oh kr ks kt ku im bi translated"><strong class="jz iu"> <em class="it"> -y </em> </strong> <em class="it">å°†åˆ›å»ºæ–‡ä»¶è€Œä¸è¯¢é—®ä»»ä½•é—®é¢˜</em></p></blockquote><p id="c040" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">2.æˆ‘ä»¬éœ€è¦å®‰è£…è¿™ä¸ªä¾èµ–é¡¹:<strong class="jz iu"> <em class="nl"> aws-sdkï¼Œcolorsï¼Œinquirerï¼Œå•è¡Œæ—¥å¿—</em> </strong></p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="8304" class="ml kw it nu b gy ny nz l oa ob">npm i aws-sdk colors inquirer single-line-log</span></pre><p id="1e55" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">3.åˆ›å»ºæ–‡ä»¶å¹¶æ”¾å…¥<strong class="jz iu">ä¸­ã€‚env </strong>æ·»åŠ æ‚¨çš„å‡­æ®</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="9f84" class="ml kw it nu b gy ny nz l oa ob">SPACE_ENDPOINT=<br/>SPACE_ACCESS_KEY=<br/>SPACE_SECRET_KEY=<br/>BUCKET_TO_BACKUP=</span></pre><figure class="np nq nr ns gt ju gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/ad72444bde14cbf1e83e89815dc0993a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*15t1CNXojv5DGL3qFHXFHw.png"/></div><figcaption class="oj ok gj gh gi ol om bd b be z dk translated">é¡¹ç›®ç»“æ„å’Œã€‚ç¯å¢ƒå†…å®¹</figcaption></figure><h2 id="89f6" class="ml kw it bd kx mm mn dn lb mo mp dp lf ki mq mr lj km ms mt ln kq mu mv lr mw bi translated">ä»£ç ğŸ“ƒ</h2><ol class=""><li id="95a5" class="mx my it jz b ka lt ke lu ki mz km na kq nb ku nc nd ne nf bi translated">æ·»åŠ ä¾èµ–é¡¹</li></ol><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="95ff" class="ml kw it nu b gy ny nz l oa ob">const path = require(â€œpathâ€);<br/>const fs = require(â€œfsâ€);<br/>const AWS = require(â€œaws-sdkâ€);<br/>const colors = require(â€œcolorsâ€);<br/>const inquirer = require(â€œinquirerâ€);<br/>const log = require(â€œsingle-line-logâ€).stdout;<br/>require(â€œdotenvâ€).config();</span></pre><blockquote class="oc od oe"><p id="a415" class="jx jy nl jz b ka kb kc kd ke kf kg kh of kj kk kl og kn ko kp oh kr ks kt ku im bi translated"><strong class="jz iu">è¦æ±‚(â€œdotenvâ€)ã€‚config()ï¼›</strong>ä¼šå¾—åˆ°æˆ‘ä»¬åœ¨é‡Œé¢å†™çš„ç¯å¢ƒå˜é‡ã€‚ç¯å¢ƒæ–‡ä»¶</p></blockquote><p id="ba68" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">2.å£°æ˜è¯¥è„šæœ¬æ‰€éœ€çš„æ‰€æœ‰å˜é‡</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="94b4" class="ml kw it nu b gy ny nz l oa ob">let TOTAL_BYTES_TO_DOWNLOAD = 0;<br/>let BYTES_DOWNLOADED = 0;</span><span id="dab6" class="ml kw it nu b gy on nz l oa ob">const endpoint = process.env.SPACE_ENDPOINT.trim();<br/>const accessKeyId = process.env.SPACE_ACCESS_KEY.trim();<br/>const secretAccessKey = process.env.SPACE_SECRET_KEY.trim();<br/>const BUCKET_TO_BACKUP = process.env.BUCKET_TO_BACKUP.trim();</span><span id="880c" class="ml kw it nu b gy on nz l oa ob">if (!(endpoint.length &amp;&amp;accessKeyId.length &amp;&amp; secretAccessKey.length &amp;&amp; BUCKET_TO_BACKUP.length)) {<br/>  console.log(â€œPaste your credentials inside .env file.â€.red);<br/>  console.log(â€œ================= Program Started =================â€.bgMagenta);<br/>  return;<br/>}</span><span id="80ec" class="ml kw it nu b gy on nz l oa ob">const OUTPUT_DIR = `backup-${BUCKET_TO_BACKUP}-${Date.now()}`;<br/>const s3 = new AWS.S3({<br/>  endpoint,<br/>  accessKeyId,<br/>  secretAccessKey<br/>});</span></pre><blockquote class="oc od oe"><p id="df84" class="jx jy nl jz b ka kb kc kd ke kf kg kh of kj kk kl og kn ko kp oh kr ks kt ku im bi translated"><strong class="jz iu"> TOTAL_BYTES_TO_DOWNLOADï¼ŒBYTES_DOWNLOADED </strong> â€”å°†ç”¨äºè·Ÿè¸ªä¸‹è½½è¿›åº¦</p></blockquote><p id="bde6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªifè¯­å¥æ¥åœæ­¢ç¨‹åºif<strong class="jz iu">ã€‚env </strong>æ–‡ä»¶ä¸ºç©ºï¼Œå¹¶ä¸”å‡­è¯ä¸å­˜åœ¨ã€‚</p><blockquote class="oc od oe"><p id="2014" class="jx jy nl jz b ka kb kc kd ke kf kg kh of kj kk kl og kn ko kp oh kr ks kt ku im bi translated"><strong class="jz iu"> OUTPUT_DIR </strong> â€”ä¸‹è½½æ–‡ä»¶çš„æ–‡ä»¶å¤¹å(å­˜å‚¨æ¡¶å+æ—¶é—´æˆ³)</p></blockquote><p id="17eb" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">æœ€ååˆ›å»ºä¸€ä¸ª<strong class="jz iu">æ–°çš„S3 </strong>å®ä¾‹ã€‚</p><blockquote class="oo"><p id="b3bb" class="op oq it bd or os ot ou ov ow ox ku dk translated">å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæˆ‘ç”¨å¤§å†™å­—æ¯æ¥å†™å…¨å±€å˜é‡åç§°ï¼Œä»¥ä¾¿æ›´å¥½åœ°åŒºåˆ†å®ƒä»¬ã€‚</p></blockquote><p id="7fc3" class="pw-post-body-paragraph jx jy it jz b ka oz kc kd ke pa kg kh ki pb kk kl km pc ko kp kq pd ks kt ku im bi translated">3.åˆ›å»ºä¸¤ä¸ªåŠ©æ‰‹å‡½æ•°:ä¸€ä¸ªå°†å­—èŠ‚è½¬æ¢ä¸ºMBæˆ–GBï¼Œå¦ä¸€ä¸ªæ‰“å°è¿›åº¦(å•è¡Œæ—¥å¿—)</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="6015" class="ml kw it nu b gy ny nz l oa ob">function bytesToSize(bytes) {<br/>  const sizes = [â€œBytesâ€, â€œKBâ€, â€œMBâ€, â€œGBâ€, â€œTBâ€];<br/>  if (bytes == 0) return â€œ0 Byteâ€;<br/>  var i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));<br/>  return Math.round(bytes / Math.pow(1024, i), 2) + â€œ â€œ + sizes[i];<br/>}</span><span id="0a52" class="ml kw it nu b gy on nz l oa ob">function printTotalProgress(current, total) {<br/>  const percentage = (current * 100) / total;<br/>  log(`${bytesToSize(current)} / ${bytesToSize(total)}  (${Math.floor(percentage)}%)`);<br/>}</span></pre><blockquote class="oc od oe"><p id="81e6" class="jx jy nl jz b ka kb kc kd ke kf kg kh of kj kk kl og kn ko kp oh kr ks kt ku im bi translated"><strong class="jz iu"> log() </strong> â€”è¯¥å‡½æ•°æ¥è‡ª<strong class="jz iu"> const log = require("å•è¡Œæ—¥å¿—")ã€‚stdout</strong>è¿™å°†åœ¨å•è¡Œä¸Šæ‰“å°ä¸€æ¡æ¶ˆæ¯ï¼›</p></blockquote><p id="4a2a" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">4.å†™ä¸€ä¸ªä¸‹è½½æ–‡ä»¶çš„å‡½æ•°</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="7469" class="ml kw it nu b gy ny nz l oa ob">async function downloadFile(outputDir, fileKey) {<br/>  const params = {<br/>    Bucket: BUCKET_TO_BACKUP,<br/>    Key: fileKey<br/>  };<br/>  const outputPath = path.join(__dirname, outputDir, fileKey);<br/>  const fileStream = fs.createWriteStream(outputPath);</span><span id="a469" class="ml kw it nu b gy on nz l oa ob">  s3.getObject(params)<br/>    .createReadStream()<br/>    .on(â€œerrorâ€, function(err) {<br/>      console.log(err);<br/>      })<br/>    .on(â€œdataâ€, function(chunk) {<br/>      BYTES_DOWNLOADED += chunk.length;<br/>      printTotalProgress(BYTES_DOWNLOADED, TOTAL_BYTES_TO_DOWNLOAD);<br/>    })<br/>    .pipe(fileStream);<br/>}</span></pre><p id="9b9b" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">è¯¥å‡½æ•°å°†æ ¹æ®æ–‡ä»¶å¯†é’¥(æ–‡ä»¶å)ä»å¯¹è±¡å­˜å‚¨å™¨ä¸‹è½½ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶å°†å…¶å†™å…¥<strong class="jz iu"> outputDir + fileKey </strong>(è¿™æ„å‘³ç€è¯¥æ–‡ä»¶å°†ä¿æŒå…¶åŸå§‹åç§°å’Œæ‰©å±•åï¼Œå¹¶å°†è¢«æ”¾åœ¨åŒä¸€æ–‡ä»¶å¤¹ä¸­)</p><blockquote class="oc od oe"><p id="0687" class="jx jy nl jz b ka kb kc kd ke kf kg kh of kj kk kl og kn ko kp oh kr ks kt ku im bi translated"><strong class="jz iu">ã€‚on('data') </strong> â€”ä»å¯¹è±¡å­˜å‚¨å™¨ä¸­è¯»å–æ–‡ä»¶æ—¶ï¼Œè¯¥äº‹ä»¶å°†å¼€å§‹</p><p id="bb80" class="jx jy nl jz b ka kb kc kd ke kf kg kh of kj kk kl og kn ko kp oh kr ks kt ku im bi translated"><strong class="jz iu"> chunk </strong> â€” chunk.lengthå°†ç»™å‡ºå­—èŠ‚å¤§å°</p></blockquote><blockquote class="oo"><p id="c331" class="op oq it bd or os pe pf pg ph pi ku dk translated">file keyâ€”â€”ä¸ä»…è¡¨ç¤ºæ–‡ä»¶åï¼Œè¿˜è¡¨ç¤ºæ‚¨çš„bucketä¸­è¯¥å›¾åƒçš„å®Œæ•´è·¯å¾„ï¼›ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„å›¾åƒåç§°â€œmy-img.pngâ€æ”¾åœ¨åä¸ºâ€œfolder1â€çš„æ–‡ä»¶å¤¹ä¸­ï¼Œåˆ™å¯†é’¥å°†ä¸º:foder1/my-img.png </p></blockquote><p id="23e7" class="pw-post-body-paragraph jx jy it jz b ka oz kc kd ke pa kg kh ki pb kk kl km pc ko kp kq pd ks kt ku im bi translated">4.ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨æ‚¨çš„<strong class="jz iu"> outputDir </strong>ä¸­åˆ›å»ºä¸æ‚¨çš„bucketç›¸åŒçš„æ–‡ä»¶å¤¹ç»“æ„</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="18d5" class="ml kw it nu b gy ny nz l oa ob">async function createFolderStructure(outputDir, Prefix = â€œâ€) {<br/>  const params = {<br/>  Bucket: BUCKET_TO_BACKUP,<br/>  Delimiter: â€œ/â€,<br/>  Prefix<br/>  };</span><span id="e974" class="ml kw it nu b gy on nz l oa ob">  const { CommonPrefixes } = await s3.listObjects(params).promise();<br/>  if (CommonPrefixes.length) {<br/>    for (let i = 0; i &lt; CommonPrefixes.length; i++) {<br/>      const { Prefix } = CommonPrefixes[i];<br/>      const dirPath = path.join(__dirname, outputDir, Prefix);<br/>      fs.mkdirSync(dirPath);<br/>      await createFolderStructure(outputDir, Prefix);<br/>    }<br/>  }<br/>}</span></pre><blockquote class="oc od oe"><p id="0c9e" class="jx jy nl jz b ka kb kc kd ke kf kg kh of kj kk kl og kn ko kp oh kr ks kt ku im bi translated"><strong class="jz iu">CommonPerfixes</strong>â€”â€”ä½ å¯ä»¥è¯´è¿™å°†æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­åŒ…å«ä½ çš„æ¡¶ä¸­çš„æ–‡ä»¶å¤¹</p></blockquote><p id="0b8e" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">å¦‚æœæ‚¨çš„bucketä¸­æœ‰ä»»ä½•æ–‡ä»¶å¤¹ï¼Œè¿™ä¸ªé€’å½’å‡½æ•°å°†åœ¨æ‚¨çš„ç›®å½•ä¸­åˆ›å»ºç›¸åŒçš„æ–‡ä»¶å¤¹ç»“æ„ã€‚</p><p id="ce33" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">è¿™æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºå¦‚æœä½ è®°å¾—æˆ‘ä»¬è¯´è¿‡ç”¨äºä¸‹è½½æ–‡ä»¶çš„<strong class="jz iu"> fileKey </strong>ä¸ä»…åŒ…å«æ–‡ä»¶åï¼Œè¿˜åŒ…å«æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼ŒåŒ…æ‹¬æ–‡ä»¶å¤¹ã€‚</p><p id="d1f2" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">5.ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œéå†bucketä¸­çš„æ‰€æœ‰æ–‡ä»¶å¤¹ï¼Œå¹¶åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶çš„å…³é”®å­—ã€‚</p><p id="656a" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">è¯¥å‡½æ•°å°†è¿”å›å¦‚ä¸‹æ‰€ç¤ºçš„å¯¹è±¡æ•°ç»„:</p><figure class="np nq nr ns gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="pk pl di pm bf pn"><div class="gh gi pj"><img src="../Images/bcb2d0145e8e884f9fe6f04207afb219.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BE0CxfwaMLuBreypi8RVcw.png"/></div></div></figure><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="5508" class="ml kw it nu b gy ny nz l oa ob">async function getAListWithAllFiles() {<br/>  const output = [];<br/>  async function clojure(Prefix = â€œâ€) {<br/>    const params = {<br/>      Bucket: BUCKET_TO_BACKUP,<br/>      Delimiter: â€œ/â€,<br/>      Prefix<br/>    };<br/>    const { Contents, CommonPrefixes } = await<br/>    s3.listObjects(params).promise();<br/>    if (Contents.length) {<br/>      Contents.forEach(content =&gt; {<br/>        const { Size, Key } = content;<br/>        output.push({<br/>          size: Size,<br/>          key: Key<br/>        });<br/>      });<br/>    }<br/>    if (CommonPrefixes.length) {<br/>      for (let i = 0; i &lt; CommonPrefixes.length; i++) {<br/>        const { Prefix } = CommonPrefixes[i];<br/>        await clojure(Prefix);<br/>      }<br/>    }<br/>  }<br/>  await clojure();<br/>  return output;<br/>}</span></pre><blockquote class="oc od oe"><p id="189e" class="jx jy nl jz b ka kb kc kd ke kf kg kh of kj kk kl og kn ko kp oh kr ks kt ku im bi translated">å†…å®¹â€”â€”è¿™æ˜¯ä½ çš„æ–‡ä»¶</p></blockquote><p id="d968" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">5.æœ€åè°ƒç”¨æ‰€æœ‰è¿™äº›å‡½æ•°æ¥å˜é­”æœ¯</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="6eba" class="ml kw it nu b gy ny nz l oa ob">(async function() {<br/>  console.log(â€œâ€.white);<br/>  console.log(â€œ================= Program Started   =================â€.bgMagenta);</span><span id="57bd" class="ml kw it nu b gy on nz l oa ob">  const makeQuestion = (totalFilesLength, totalSize) =&gt; {<br/>    return [<br/>      {<br/>        type: â€œconfirmâ€,<br/>        default: false,<br/>        name: â€œstartProgramâ€,<br/>        message: `Are you sure you want to download        ${totalFilesLength} files (${bytesToSize(totalSize)})?`,<br/>        filter: function(val) {<br/>          return val.toLowerCase().trim();<br/>        }<br/>      }<br/>    ];<br/>  };</span><span id="2f03" class="ml kw it nu b gy on nz l oa ob">  const allFiles = await getAListWithAllFiles();<br/>  const totalSizeOfFilesToDownload = allFiles.map(file =&gt;    file.size).reduce((prev, curr) =&gt; prev + curr, 0);</span><span id="68ac" class="ml kw it nu b gy on nz l oa ob">  TOTAL_BYTES_TO_DOWNLOAD = totalSizeOfFilesToDownload;</span><span id="58e3" class="ml kw it nu b gy on nz l oa ob">  const { startProgram } = await inquirer.prompt(<br/>    makeQuestion(allFiles.length, totalSizeOfFilesToDownload)<br/>  );</span><span id="9783" class="ml kw it nu b gy on nz l oa ob">  if (!startProgram) {<br/>    console.log(â€œ================= Program Stopped=================â€.bgRed);<br/>    return;<br/>  }</span><span id="b350" class="ml kw it nu b gy on nz l oa ob">  fs.mkdirSync(OUTPUT_DIR);<br/>  await createFolderStructure(OUTPUT_DIR);</span><span id="88d3" class="ml kw it nu b gy on nz l oa ob">  allFiles.forEach(file =&gt; {<br/>    downloadFile(OUTPUT_DIR, file.key);<br/>  });<br/>})();</span></pre><blockquote class="oc od oe"><p id="91a4" class="jx jy nl jz b ka kb kc kd ke kf kg kh of kj kk kl og kn ko kp oh kr ks kt ku im bi translated">makeQuestion() â€”è¯¥å‡½æ•°å°†åˆ›å»ºä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<strong class="jz iu">æŸ¥è¯¢è€…</strong>æ¨¡å—æç¤ºè¯¥é—®é¢˜</p></blockquote><p id="a78e" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">è¿™ä¸ª<strong class="jz iu">life</strong>å°†é¦–å…ˆä»æˆ‘ä»¬çš„å¯¹è±¡å­˜å‚¨ä¸­åˆ›å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰æ–‡ä»¶çš„åˆ—è¡¨ï¼Œå¹¶ä»¥å­—èŠ‚ä¸ºå•ä½è®¡ç®—æ€»å¤§å°ã€‚</p><p id="dc9a" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">ä½¿ç”¨<strong class="jz iu">è¯¢é—®å™¨</strong>æˆ‘ä»¬å°†è¯¢é—®ç”¨æˆ·æ˜¯å¦çœŸçš„æƒ³è¦ä¸‹è½½æ‰€æœ‰æ–‡ä»¶ï¼Œæˆ‘ä»¬å°†æ˜¾ç¤ºæ–‡ä»¶çš„æ€»æ•°å’Œå®ƒä»¬æ‰€éœ€çš„ç£ç›˜å¤§å°</p><figure class="np nq nr ns gt ju gh gi paragraph-image"><div class="gh gi po"><img src="../Images/d30910135f4d51077eacb55203094939.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*TSCnYoWnI-TQQROI8RRLYg.png"/></div></figure><p id="5669" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">å¦‚æœç”¨æˆ·æŒ‰ä¸‹<strong class="jz iu"> y </strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†åˆ›å»ºè¾“å‡ºç›®å½•(æ”¾ç½®ä¸‹è½½æ–‡ä»¶çš„æ–‡ä»¶å¤¹)ï¼Œä¹‹åæˆ‘ä»¬å°†åœ¨å…¶ä¸­åˆ›å»ºä¸æˆ‘ä»¬åœ¨bucketä¸­ç›¸åŒçš„æ–‡ä»¶å¤¹ç»“æ„ï¼Œæœ€åæˆ‘ä»¬å°†ä¸‹è½½æ¯ä¸ªæ–‡ä»¶ã€‚</p><h1 id="278b" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated"><strong class="ak">ç»“è®º</strong></h1><p id="61d4" class="pw-post-body-paragraph jx jy it jz b ka lt kc kd ke lu kg kh ki lv kk kl km lw ko kp kq lx ks kt ku im bi translated">å®Œæ•´çš„ä»£ç å¯ä»¥åœ¨github ä¸Šæ‰¾åˆ°ã€‚åœ¨é‚£é‡Œä½ ä¼šçœ‹åˆ°è¿™æ®µä»£ç å’Œå¦ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒå…è®¸ä½ è·Ÿè¸ªä¸‹è½½çš„æ–‡ä»¶ï¼Œè¿™æ ·æ¯æ¬¡ä½ åšä¸€ä¸ªæ–°çš„å¤‡ä»½æ—¶ï¼Œä½ å¯ä»¥åªä¸‹è½½æ–°æ·»åŠ çš„æ–‡ä»¶ã€‚</p><p id="78f6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">å¦‚æœä½ æƒ³æµ‹è¯•è¿™ä¸ªä»£ç æˆ–ä»»ä½•å…¶ä»–äº‘åŠŸèƒ½ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª<a class="ae ly" href="https://m.do.co/c/f0f252058644" rel="noopener ugc nofollow" target="_blank">åˆ°æ•°å­—æµ·æ´‹</a>çš„é“¾æ¥ï¼Œ100ç¾å…ƒå¯ä»¥ç©ã€‚</p></div></div>    
</body>
</html>