<html>
<head>
<title>Firebase Cloud Functions: Verify Users Tokens</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Firebaseäº‘åŠŸèƒ½:éªŒè¯ç”¨æˆ·ä»¤ç‰Œ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/firebase-cloud-functions-verify-users-tokens-d4e60e314d1a?source=collection_archive---------3-----------------------#2020-09-04">https://itnext.io/firebase-cloud-functions-verify-users-tokens-d4e60e314d1a?source=collection_archive---------3-----------------------#2020-09-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a818" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">ä»…å‘ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·æˆäºˆå¯¹Firebaseäº‘åŠŸèƒ½çš„è®¿é—®æƒé™ã€‚</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/002b2380921e71ff43a0f13fa9f45924.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BSLn4cG8OsG63z4pbJqrXA.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">å¥ˆæ°å°”Â·å¡”è¿ªäºšæ©å¤šåœ¨<a class="ae ky" href="https://unsplash.com/s/photos/you-shall-not-pass?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><p id="d09e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘æ˜¨å¤©é€šè¿‡å£°æ˜ä¸€ä¸ªæ–°çš„<a class="ae ky" href="https://firebase.google.com/docs/functions/" rel="noopener ugc nofollow" target="_blank"> Firebaseäº‘å‡½æ•°</a>å¼€å§‹äº†å¯¹<a class="ae ky" href="https://deckdeckgo.com" rel="noopener ugc nofollow" target="_blank"> DeckDeckGo </a>çš„æ ¸å¿ƒå‡½æ•°ä¹‹ä¸€çš„é‡æ„ï¼Œå®ƒå¯ä»¥é€šè¿‡<a class="ae ky" href="https://firebase.google.com/docs/functions/http-events" rel="noopener ugc nofollow" target="_blank"> HTTPè¯·æ±‚</a>æ¥è§¦å‘ã€‚</p><p id="4ff1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å› ä¸ºæˆ‘æƒ³ä¿æŠ¤å®ƒçš„è®¿é—®ï¼Œä¸ºäº†é¿å…å·å·æ‘¸æ‘¸çš„è¯·æ±‚ï¼Œæˆ‘æŒ‰ç…§æˆ‘ä¹‹å‰çš„ä¸€ç¯‡åšæ–‡<a class="ae ky" href="https://medium.com/better-programming/protect-your-http-firebase-cloud-functions-adf23c45765e" rel="noopener">åœ¨ä¸€ä¸ªäººçš„å¸®åŠ©ä¸‹ä¿æŠ¤å®ƒã€‚</a></p><p id="6005" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¸€æ—¦æˆ‘æµ‹è¯•äº†è¿™ä¸ªç‰¹æ€§çš„ç¬¬ä¸€æ­¥ï¼Œæˆ‘å®é™…ä¸Šæ³¨æ„åˆ°å®ƒä¸æ˜¯æˆ‘ç”¨ä¾‹çš„æ­£ç¡®è§£å†³æ–¹æ¡ˆã€‚æˆ‘ä¸å¾—ä¸ä½¿ç”¨ç”¨æˆ·ä»¤ç‰Œæˆäºˆè®¿é—®æƒé™ã€‚</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4dd5" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">éªŒè¯ç”¨æˆ·åœ¨äº‘å‡½æ•°ä¸­çš„ä»¤ç‰Œ</h1><p id="ea7e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">å¯¹äºé‚£äº›çŸ¥é“è§£å†³æ–¹æ¡ˆçš„äººæ¥è¯´ï¼Œè¿™å¯èƒ½å¬èµ·æ¥å¾ˆå‚»ï¼Œä½†å®é™…ä¸Šæˆ‘èŠ±äº†ç›¸å½“å¤šçš„æ—¶é—´æ¥æ‰¾åˆ°å¦‚ä½•åœ¨Firebase Cloudå‡½æ•°ä¸­éªŒè¯ç”¨æˆ·çš„ä»¤ç‰Œã€‚</p><p id="301d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘åœ¨å°è¯•å®ç°è¯¥è§£å†³æ–¹æ¡ˆæ—¶èµ°é”™äº†è·¯ï¼Œå› ä¸ºæˆ‘åˆ†åˆ«åœ¨åç«¯å®ç°å®ƒï¼Œå¦‚<a class="ae ky" href="https://developers.google.com/identity/sign-in/web/backend-auth" rel="noopener ugc nofollow" target="_blank">ä½¿ç”¨åº“<a class="ae ky" href="https://github.com/googleapis/google-auth-library-nodejs" rel="noopener ugc nofollow" target="_blank"> google-auth-library </a>å‘åç«¯æœåŠ¡å™¨</a>éªŒè¯æ‰€ç¤ºã€‚æˆ‘èŠ±æ—¶é—´å®æ–½è¯¥è§£å†³æ–¹æ¡ˆï¼Œå¹¶å¯»æ‰¾åœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°æˆ‘çš„é¡¹ç›®æ‰€éœ€çš„OAuth <code class="fe mz na nb nc b">CLIENT_ID</code>ä¿¡æ¯ï¼Œæœ€ç»ˆåœ¨æˆ‘å°è¯•è¯¥è¿‡ç¨‹æ—¶é¢ä¸´ä»¥ä¸‹é”™è¯¯:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="62b3" class="nh md it nc b gy ni nj l nk nl">No pem found for envelope: {"alg":"RS256","kid":"...","typ":"JWT"}</span></pre><p id="7204" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æœ€åï¼Œç»è¿‡å¤šæ¬¡å°è¯•ï¼Œæˆ‘æ¥å—äº†å¤±è´¥ï¼Œå¹¶åœ¨è°·æ­Œä¸Šå¯»æ‰¾è§£å†³æ–¹æ¡ˆã€‚å¹¸è¿çš„æ˜¯ï¼Œå¯¹æˆ‘æ¥è¯´ï¼Œåœ¨ä¸€ä¸ª<a class="ae ky" href="https://stackoverflow.com/questions/61937587/how-to-get-valid-token-from-react-firebase-f%c3%bcr-nodesjs-server-verification/61937783#comment112690479_61937783" rel="noopener ugc nofollow" target="_blank"> Stackoverflowé—®é¢˜</a>çš„ç»“å°¾ï¼Œç”±äº<a class="ae ky" href="https://stackoverflow.com/users/8535518/will" rel="noopener ugc nofollow" target="_blank"> Will </a>çš„å›ç­”ï¼Œæˆ‘å‘ç°æœ‰ä¸€ç§æ›´å®¹æ˜“éªŒè¯ä»¤ç‰Œçš„æ–¹æ³•ã€‚</p><p id="327d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">äº‹å®ä¸Šï¼Œå¦‚æœæˆ‘çŸ¥é“<a class="ae ky" href="https://firebase.google.com/docs/auth/admin/verify-id-tokens" rel="noopener ugc nofollow" target="_blank">ç®¡ç†æ–‡æ¡£</a>ï¼Œæˆ‘ä¼šå‘ç°Firebaseæ˜¯è§£å†³è¿™ä¸€éœ€æ±‚çš„å†…ç½®æ–¹æ³•ã€‚</p><blockquote class="nm nn no"><p id="80d1" class="kz la np lb b lc ld ju le lf lg jx lh nq lj lk ll nr ln lo lp ns lr ls lt lu im bi translated">Firebase Admin SDKæœ‰ä¸€ä¸ªç”¨äºéªŒè¯å’Œè§£ç IDä»¤ç‰Œçš„å†…ç½®æ–¹æ³•ã€‚å¦‚æœæä¾›çš„IDæ ‡è®°å…·æœ‰æ­£ç¡®çš„æ ¼å¼ã€æœªè¿‡æœŸå¹¶ä¸”ç»è¿‡æ­£ç¡®ç­¾åï¼Œåˆ™è¯¥æ–¹æ³•è¿”å›è§£ç åçš„IDæ ‡è®°ã€‚æ‚¨å¯ä»¥ä»è§£ç çš„ä»¤ç‰Œä¸­è·å–ç”¨æˆ·æˆ–è®¾å¤‡çš„uidã€‚</p></blockquote><p id="00fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¸€æ—¦æˆ‘å‘ç°äº†è¿™å—å®çŸ³ï¼Œä¸€æ—¦æˆ‘çš„å¤§è„‘ç»ˆäºçµå…‰ä¸€ç°ï¼Œæˆ‘å°±èƒ½å¤Ÿå®ç°ä¸€ä¸ªå°çš„å®ç”¨åŠŸèƒ½:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="c87b" class="nh md it nc b gy ni nj l nk nl">import * as admin from 'firebase-admin';<br/>import * as functions from 'firebase-functions';<br/><br/>export async function verifyToken(<br/>                request: functions.Request): Promise&lt;boolean&gt; {<br/>  try {<br/>    const token: string | undefined = await getToken(request);<br/><br/>    if (!token) {<br/>      return false;<br/>    }<br/><br/>    const payload: admin.auth.DecodedIdToken = <br/>                   await admin.auth().verifyIdToken(token);</span><span id="7ab0" class="nh md it nc b gy nt nj l nk nl">    return payload !== null;<br/>  } catch (err) {<br/>    return false;<br/>  }<br/>}</span><span id="7323" class="nh md it nc b gy nt nj l nk nl">async function getToken(request: functions.Request): <br/>                       Promise&lt;string | undefined&gt; {<br/>  if (!request.headers.authorization) {<br/>    return undefined;<br/>  }<br/><br/>  const token: string = <br/>        request.headers.authorization.replace(/^Bearer\s/, '');<br/><br/>  return token;<br/>}</span></pre><p id="21e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ³¨æ„ï¼Œæˆ‘æµ‹è¯•äº†<code class="fe mz na nb nc b">payload</code>æ˜¯å¦ä¸æ˜¯<code class="fe mz na nb nc b">null</code>æ¥è®¤ä¸ºä»¤ç‰Œæ˜¯æœ‰æ•ˆçš„ï¼Œä½†æ˜¯æˆ‘è®¤ä¸ºå®ƒå¯èƒ½æ˜¯ä¸éœ€è¦çš„ã€‚æ–¹æ³•<code class="fe mz na nb nc b">verifyIdToken</code>åœ¨æ— æ•ˆæ—¶æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p><p id="da30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ­¤å¤–ï¼Œæ‚¨è¿˜å¯ä»¥æ³¨æ„åˆ°ï¼Œæˆ‘å°†ç”¨æˆ·ä»¤ç‰Œä½œä¸ºHTTPè¯·æ±‚çš„<code class="fe mz na nb nc b">headers</code>è¿›è¡Œä¼ é€’ï¼Œå¹¶ä»¥å…³é”®å­—<code class="fe mz na nb nc b">Bearer</code>ä¸ºå‰ç¼€ã€‚</p><p id="2c50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¾‹å¦‚ï¼Œç»™å®šä¸€ä¸ªä»¤ç‰ŒID <code class="fe mz na nb nc b">975dd9f6</code>ï¼ŒHTTP POSTè¯·æ±‚å°†å¦‚ä¸‹æ‰€ç¤º:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="61b6" class="nh md it nc b gy ni nj l nk nl">#!/bin/sh<br/>curl -i<br/>     -H "Accept: application/json"<br/>     -H "Authorization: Bearer 975dd9f6"<br/>     -X POST https://us-central1-yolo.cloudfunctions.net/helloWorld</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5aae" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">ä»…æˆæƒéåŒ¿åç”¨æˆ·</h1><p id="af1e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">ä»»ä½•äººéƒ½å¯ä»¥è¯•ç”¨<a class="ae ky" href="https://deckdeckgo.com" rel="noopener ugc nofollow" target="_blank"> DeckDeckGo </a>ï¼Œå¦‚æœä½ åªæ˜¯æƒ³è¯•ä¸€è¯•ï¼Œæ²¡æœ‰å¼ºåˆ¶ç™»å½•æˆ–é¢„å…ˆç™»å½•ã€‚è¿™å¯¹æˆ‘ä»¬æ¥è¯´çœŸçš„å¾ˆé‡è¦ï¼Œæˆ‘ä»¬ä¸æ˜¯åœ¨è¿½é€æ•°æ®æˆ–ç”¨æˆ·æ•°é‡ï¼Œæˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªç”¨äºæ¼”ç¤ºçš„ç¼–è¾‘å™¨ï¼Œä¾›ç”¨æˆ·ä½¿ç”¨æˆ–ä¸ä½¿ç”¨ğŸ˜‰ã€‚</p><p id="cc5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœç”¨æˆ·æƒ³è¦å…¬å¼€åˆ†äº«ä»–ä»¬çš„æ¼”ç¤ºæ–‡ç¨¿ï¼Œå› ä¸ºæˆ‘ä»¬ä¸æƒ³å…¬å¼€å‘å¸ƒå¤ªå¤šâ€œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•â€æˆ–â€œYoloâ€å¡ç‰‡ï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼Œåˆ†åˆ«é¿å…æ²¡æœ‰æ„ä¹‰çš„å…¬å¼€å†…å®¹ï¼Œæˆ‘ä»¬ä¼šå°†æˆ‘ä»¬çš„â€œå‘å¸ƒæµç¨‹â€(æˆ‘ä»¬å°†æ¼”ç¤ºæ–‡ç¨¿ä½œä¸ºæ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åºåœ¨çº¿è½¬æ¢å’Œéƒ¨ç½²çš„æµç¨‹)é™åˆ¶ä¸ºç­¾åç”¨æˆ·ã€‚</p><p id="e730" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¯¹äºè¿™äº›è¿›ç¨‹ï¼Œæˆ‘ä»¬ä½¿ç”¨Firebaseæä¾›çš„èƒ½åŠ›æ¥ä½¿ç”¨åŒ¿åç”¨æˆ·ã€‚</p><p id="d4a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¿™å°±æ˜¯ä¸ºä»€ä¹ˆï¼Œé™¤äº†éªŒè¯ä»¤ç‰Œï¼Œæˆ‘è¿˜æ·»åŠ æ£€æŸ¥è¿™ä¸€ä¿¡æ¯ã€‚å¹¸è¿çš„æ˜¯ï¼Œè¿™ä¹Ÿå¯ä»¥å¾ˆå®¹æ˜“åœ°è§£å†³ï¼Œå› ä¸ºç”±<code class="fe mz na nb nc b">verifyToken</code>å‡½æ•°æä¾›çš„<code class="fe mz na nb nc b">payload</code>ç¡®å®åŒ…å«è¿™æ ·çš„ä¿¡æ¯ã€‚</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="e3ce" class="nh md it nc b gy ni nj l nk nl">const payload: admin.auth.DecodedIdToken = <br/>                   await admin.auth().verifyIdToken(token);</span><span id="4067" class="nh md it nc b gy nt nj l nk nl">return payload !== null &amp;&amp;<br/>       payload.firebase.sign_in_provider !== 'anonymous';</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="714f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">å¸¦æ‰¿è½½çš„å‘¼å«åŠŸèƒ½</h1><p id="d61e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">å¦‚æœä½ æ„Ÿå…´è¶£çš„è¯ï¼Œä¸‹é¢æ˜¯æˆ‘å¦‚ä½•åœ¨TypeScriptå’Œä½¿ç”¨Firebase Authçš„åº”ç”¨ç¨‹åºä¸­ä¸ºå‡½æ•°è°ƒç”¨æä¾›ä¸Šé¢çš„<code class="fe mz na nb nc b">bearer</code>ã€‚</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="b952" class="nh md it nc b gy ni nj l nk nl">import * as firebase from 'firebase/app';<br/>import 'firebase/auth';</span><span id="320f" class="nh md it nc b gy nt nj l nk nl">helloWorld(): Promise&lt;void&gt; {<br/>  return new Promise&lt;void&gt;(async (resolve, reject) =&gt; {<br/>    try {<br/>      const token: string = <br/>            await firebase.auth().currentUser.getIdToken();</span><span id="3a97" class="nh md it nc b gy nt nj l nk nl">      const functionsUrl: string = <br/>           'https://us-central1-yolo.cloudfunctions.net';</span><span id="c0f1" class="nh md it nc b gy nt nj l nk nl">      const rawResponse: Response = <br/>            await fetch(`${functionsUrl}/helloWorld`, {<br/>        method: 'POST',<br/>        headers: {<br/>          Accept: 'application/json',<br/>          'Content-Type': 'application/json',<br/>          Authorization: `Bearer ${token}`,<br/>        },<br/>        body: JSON.stringify({<br/>          something: 'a value'<br/>        }),<br/>      });<br/><br/>      if (!rawResponse || !rawResponse.ok) {<br/>        reject('Post failed etc.');<br/>        return;<br/>      }<br/><br/>      resolve();<br/>    } catch (err) {<br/>      reject(err);<br/>    }<br/>  });<br/>}</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d0d7" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">é¡¶ç«¯çš„æ¨±æ¡ƒ:CORS</h1><p id="8d34" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">å› ä¸ºæˆ‘å®ç°äº†ç¬¬ä¸€ä¸ªå¤„ç†HTTPè¯·æ±‚çš„å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘å¿…é¡»å¤„ç†CORSã€‚å¿«é€Ÿçš„è°·æ­Œæœç´¢å’Œç”±<a class="ae ky" href="https://github.com/CoderTonyB" rel="noopener ugc nofollow" target="_blank"> CoderTonyB </a>æä¾›çš„<a class="ae ky" href="https://gist.github.com/mediavrog/49c4f809dffea4e00738a7f5e3bbfa59#gistcomment-2585600" rel="noopener ugc nofollow" target="_blank">è¦ç‚¹</a>æä¾›äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚</p><p id="0a77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/expressjs/cors" rel="noopener ugc nofollow" target="_blank"> expressjs/cors </a>åº”å®‰è£…åœ¨åŠŸèƒ½é¡¹ç›®ä¸­ã€‚</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="0525" class="nh md it nc b gy ni nj l nk nl">npm i cors --save &amp;&amp; npm i @types/cors --save-dev</span></pre><p id="9333" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æœ€åï¼Œåœ¨æœ‰æ•ˆå®ç°ä¹‹å‰ï¼Œåº”è¯¥ä½¿ç”¨ä¸€ä¸ªå¤„ç†ç¨‹åºæ¥å¤„ç†CORSè¯·æ±‚ã€‚</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="c760" class="nh md it nc b gy ni nj l nk nl">import * as functions from 'firebase-functions';</span><span id="06da" class="nh md it nc b gy nt nj l nk nl">import * as cors from 'cors';</span><span id="6199" class="nh md it nc b gy nt nj l nk nl">export const helloWorld<strong class="nc iu"><em class="np"> </em></strong>= functions.https.onRequest(myHelloWorld);</span><span id="6533" class="nh md it nc b gy nt nj l nk nl">async function helloWorld(request: functions.Request,<br/>                          response: functions.Response&lt;any&gt;) {<br/>  const corsHandler = cors({origin: true});<br/><br/>  corsHandler(request, response, async () =&gt; {<br/>      response.send('Yolo');<br/>  });<br/>}</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0f58" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">æ‹¿èµ°</h1><p id="acf0" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">ä¸ç”¨è¯´ï¼Œé”™è¯¯åœ°å¼€å§‹ä¸€ä¸ªæ–°ç‰¹æ€§çš„å¼€å‘å¹¶å¾ˆå¿«å¤±å»æ—¶é—´æ˜¯å¾ˆå®¹æ˜“çš„ã€‚æˆ‘å¾ˆæƒ³è¯´æ·±å‘¼å¸æˆ–è€…ä¼‘æ¯ä¸€ä¸‹æ˜¯å…³é”®ï¼Œä½†æ˜¯å¶å°”ä¼šå‘ç”Ÿä¸€äº›äº‹æƒ…ğŸ˜‰ã€‚ç„¶è€Œï¼Œå¦‚æœä½ æœ‰å¾ˆæ£’çš„æŠ€å·§å’Œè¯€çªæ¥é¿å…è¿™ç§æƒ…å†µï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘å¾ˆæƒ³å¬å¬è¿™äº›ï¼</p><p id="d512" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¦‚æœä½ å¯¹ç»“æœæ„Ÿåˆ°å¥½å¥‡ï¼Œè¯·å…³æ³¨æˆ‘ä»¬çš„Twitterï¼Œå› ä¸ºæˆ‘ä»¬å¯èƒ½ä¼šåœ¨ä¸‹å‘¨ä¸ºå¼€å‘è€…å‘å¸ƒä¸€ä¸ªè¶…çº§é…·çš„åŠŸèƒ½ğŸš€ã€‚</p><p id="3b8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">åˆ°æ— é™å’Œæ›´è¿œçš„åœ°æ–¹ï¼</p><p id="49c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¤§å«</p></div></div>    
</body>
</html>