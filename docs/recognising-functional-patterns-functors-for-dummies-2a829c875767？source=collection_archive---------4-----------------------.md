# è¯†åˆ«åŠŸèƒ½æ¨¡å¼:å‡½å­

> åŸæ–‡ï¼š<https://itnext.io/recognising-functional-patterns-functors-for-dummies-2a829c875767?source=collection_archive---------4----------------------->

å‡½å­æ˜¯å®ç° map()å‡½æ•°çš„ç»“æ„ã€‚å®ƒè¢«ç”¨ä½œç”¨æˆ·æƒ³è¦è½¬æ¢çš„ç‰¹å®šæ•°æ®/ç»“æ„çš„ä¸Šä¸‹æ–‡åŒ…è£…å™¨ã€‚

æˆ‘ä»¬ä¼ é€’ç»™å‡½å­çš„ç»“æ„å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼Œä½†æ˜¯åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†æ¼”ç¤ºä¸€ä¸ªè·å–æ•°æ®åˆ—è¡¨çš„å‡½å­ã€‚(å‡½å­æ— å¤„ä¸åœ¨ï¼Œè¿™é‡Œå¯ä»¥æ‰¾åˆ°å‡ ç§å‡½å­ç±»å‹[)ã€‚](https://blog.ploeh.dk/2018/03/22/functors/)

æˆ‘ä»¬å¯ä»¥å°†ä»¿å‡½æ•°çœ‹ä½œæ˜¯ä¸€ç§ç»“æ„ï¼Œæˆ‘ä»¬éœ€è¦è¿™ç§ç»“æ„æ¥å°†ä¸€ä¸ªé¡¹ç›®ä»ä¸€ç»„å€¼ A ä¼ é€’åˆ°å¦ä¸€ç»„å€¼â€”â€”æ¯”å¦‚è¯´ B(æˆ‘ä»¬é€šè¿‡ä½¿ç”¨ map()å‡½æ•°æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œè¯¥å‡½æ•°è¿­ä»£ç»™å®šçš„æ•°æ®å¹¶å°†å…¶è½¬æ¢ä¸ºå…¶ä»–æ•°æ®)ã€‚

å› ä¸ºä»¿å‡½æ•°è¿”å›ä¸Šä¸‹æ–‡(åœ¨æˆ‘çš„é¢å‘ç±»çš„è§£å†³æ–¹æ¡ˆä¸­å®ƒè‡ªå·±çš„ä¸€ä¸ªæ–°å®ä¾‹..)æˆ‘ä»¬å¯ä»¥æ°¸è¿œä¿æŒæ˜ å°„(æˆ–è€…ç›´åˆ°æˆ‘ä»¬å¾—åˆ°æƒ³è¦çš„æ•°æ®ç±»å‹)

```
someArray
  .map(f1)
  .map(f2)
  .map(f3)
```

## è¯†åˆ«æ¨¡å¼çš„ç”¨ä¾‹:

æˆ‘å°†è½¯ä»¶ [**è®¾è®¡æ¨¡å¼**](https://en.wikipedia.org/wiki/Software_design_pattern) è§†ä¸ºä¸€å¥—å·¥å…·ï¼Œæ ¹æ®éœ€è¦å®Œæˆçš„å¿…è¦å·¥ä½œè¿›è¡Œç»„åˆã€‚

å½“ç¼–å†™è½¯ä»¶æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥**å°†**ä»£ç ä¸­çš„æŸäº›éƒ¨åˆ†è¯†åˆ«ä¸ºè®¾è®¡æ¨¡å¼å€™é€‰ï¼Œè¿™å¯ä»¥ä½¿ä»£ç æ›´åŠ ç‹¬ç«‹/åˆ†ç¦»ã€å¯é‡ç”¨å’Œè®²æ•…äº‹ã€‚

åœ¨é¢å‘å¯¹è±¡çš„æ¦‚å¿µä¸­ï¼Œè¿™äº›æ˜¯**â€œGOF è®¾è®¡æ¨¡å¼â€**ï¼Œå®ƒä»¬è¢«åˆ†ä¸º**åˆ›é€ å‹ã€ç»“æ„å‹**å’Œ**è¡Œä¸ºå‹**(å¹¶ä¸”è¦åŠ¡å®ï¼åœ¨åŸºäº lang as JS çš„åŸå‹ä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦å…¨éƒ¨ç”šè‡³å¤§éƒ¨åˆ†ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰åŠŸèƒ½æ¨¡å¼ã€‚

å¦‚æœæˆ‘ä»¬æƒ³åˆ°ä¸€ä¸ªå¯¹**ä»¿å‡½æ•°**çš„ OOP å¼•ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³åˆ°**è®¿é—®è€…**æ¨¡å¼ï¼Œè¿™æ˜¯ä¸€ç§å°†ç®—æ³•ä¸å…¶æ“ä½œçš„å¯¹è±¡ç»“æ„åˆ†ç¦»çš„æ–¹å¼(æˆ‘å–œæ¬¢è¿™ä¸ª[å¼•ç”¨](https://github.com/thma/LtuPatternFactory#visitor--foldable))ã€‚

åœ¨ visitor å®ç°ä¸­ï¼Œæˆ‘ä»¬æä¾›äº†åœ¨ç»™å®šç»“æ„ä¸Šæ“ä½œçš„ visit()æ–¹æ³•â€”â€”å¦‚æœè¯¥ç»“æ„æ¥å—å®ƒ(å®ç°äº†ä¸€ä¸ªè°ƒç”¨ visitor.visit()çš„å‡½æ•°),ä½†è®¿é—®åŒ…è£…ä¸ä¼šè¿”å›æ–°çš„ç»“æ„ï¼Œå®ƒå°†ä¿®æ”¹ç°æœ‰çš„ç»“æ„(ä¸ä»¿å‡½æ•°ä¸åŒ)ã€‚

å½“æˆ‘ä»¬ä»¥è¿­ä»£çš„æ–¹å¼ä½¿ç”¨ visitor æ—¶(è¿™é€šå¸¸æ˜¯ç”¨ä¾‹ï¼Œå½“åœ¨æ ‘ä¸Šè¿è¡Œæ—¶æ˜¯é€’å½’çš„ï¼Œä¾‹å¦‚â€œæ ‡è®°â€èŠ‚ç‚¹),å®ƒä¼šæé†’å‡½å­çš„ map å‡½æ•°ã€‚

```
**for** (**const** **orange** **of** oranges) {
        orange.accept(visitor);
    }
```

æˆ‘ä¹Ÿæƒ³åˆ°äº†ç”¨æˆ·èµ‹äºˆåœ°å›¾çš„å˜æ¢å‡½æ•°å½¢å¼çš„**ç­–ç•¥**æ¨¡å¼ï¼Œä½†æˆ‘ä¸æƒ³è¯¯å¯¼ä»»ä½•äººï¼Œé‚£åªæ˜¯ä¸€ç§çœ‹æ³•ã€‚

## å…³äºå‡½æ•°å¼ç¼–ç¨‹çš„ä¸€å¥è¯:

IMO å‡½æ•°å¼ç¼–ç¨‹æ˜¯å…³äº-

*   ç¼–å†™æ€»æ˜¯è¾“å‡ºç»“æœçš„çº¯å‡½æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç¼–å†™å£°æ˜æ€§çš„(å¯ç»„åˆçš„)ä»£ç ã€‚
*   ä½¿ç”¨[é«˜é˜¶å‡½æ•°](https://en.wikipedia.org/wiki/Higher-order_function) s(æŠ½è±¡)ã€‚
*   ä¿æŒå‡½æ•°æ²¡æœ‰å‰¯ä½œç”¨(å¹¶ä¸”åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä¿æŒä¸å˜)ã€‚
*   ç¼–å†™è‡ªå·±çš„ç»„åˆ/ç®¡é“æŠ½è±¡å®ç”¨ç¨‹åºç­‰..
*   ä»£æ•°æ•°æ®ç±»å‹å¸®åŠ©æˆ‘ä»¬æ¶µç›–æ‰€æœ‰å¯èƒ½çš„æƒ…å†µ(å¯¹äºå’Œä¸ç§¯)ã€‚
*   è¡¨è¾¾æˆ‘ä»¬äº‹ä¸šçš„ç±»å‹/ç±»å‹ç³»ç»Ÿï¼é€šè¿‡å®šä¹‰å‡½æ•°çš„ç±»å‹ã€‚

ä½†æ˜¯è¿˜æœ‰æ›´å¤šçš„åŸºäºèŒƒç•´è®ºå’ŒæŠ½è±¡ä»£æ•°çš„æ¦‚å¿µã€‚

[**å‡½å­**](https://bartoszmilewski.com/2015/11/17/its-all-about-morphisms/) å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å°½é‡ç®€åŒ–å®ƒï¼Œç›´åˆ°å®ç°ä¸€ä¸ªåˆ—è¡¨å‡½å­ã€‚

å‡½å­çš„ç±»å‹å®šä¹‰åº”è¯¥æ˜¯é€šç”¨çš„ï¼Œè€Œä¸æ˜¯åƒæˆ‘çš„ä¾‹å­ä¸­é‚£æ ·ç»‘å®šåˆ°æŸä¸ªç±»å‹ã€‚

## å‡½å­å®šä¹‰

æ ¹æ® Luis Atencio çš„ä¹¦[â€œJavaScript ä¸­çš„å‡½æ•°å¼ç¼–ç¨‹â€”å¦‚ä½•æ”¹è¿›æ‚¨çš„ JavaScript ç¨‹åºâ€](https://www.amazon.com/Functional-Programming-JavaScript-Javascript-Techniques/dp/B07KFPZLQ6/ref=tmm_aud_title_sr?_encoding=UTF8&qid=&sr=)

> â€œæœ¬è´¨ä¸Šï¼Œå‡½å­åªä¸è¿‡æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œæ‚¨å¯ä»¥æ˜ å°„å‡½æ•°ï¼Œç›®çš„æ˜¯å°†å€¼æå‡åˆ°åŒ…è£…å™¨ä¸­ï¼Œä¿®æ”¹å®ƒä»¬ï¼Œç„¶å
> å°†å®ƒä»¬æ”¾å›åŒ…è£…å™¨ä¸­ã€‚è¿™æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå®šä¹‰äº† fmap åº”è¯¥å¦‚ä½•å·¥ä½œçš„è¯­ä¹‰ã€‚ä¸‹é¢æ˜¯ fmap çš„ä¸€èˆ¬å®šä¹‰:
> fmap :: (A - > B) - >åŒ…è£…å™¨(A) - >åŒ…è£…å™¨(B)â€

ä¸‹é¢çš„æ’å›¾ä¹Ÿå–è‡ªè¿™æœ¬ä¹¦:

![](img/077eb2d9e230fcc059173545c15db232.png)

**æ•°ç»„**æ•°æ®ç»“æ„åŒ…å« map()ï¼Œ(å’Œå…¶ä»–ç”¨äºè½¬æ¢çš„é«˜é˜¶å‡½æ•°)ï¼Œä½¿ç”¨ map å‡½æ•°æˆ‘ä»¬ä¿®æ”¹ç»™å®šçš„æ•°æ®å¹¶è¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„å¼•ç”¨å’Œä¿®æ”¹åçš„æ•°æ®(å¦ä¸€ä¸ªåŒ…è£…å™¨)ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšä¸‹å»ï¼

```
**class** MyFunctorContext<T> {

    **items**: T[];

    **constructor** (items: T[]) {
        **this**.**items** = items
    }

    map(transformFn: <T, V> (arg: T) => V ): MyFunctorContext<T> {
        **const** newItems = [];

        **for** (**const** item **of this**.**items**) {
            newItems.push(transformFn(item));
        }

        **return new** MyFunctorContext(newItems);
    }
}
```

å¦‚ä½•ä½¿ç”¨:

```
**const *bananas***: **any** = [
    {**isYellow**: **true**},
    {**isYellow**: **false**},
    {**isYellow**: **true**},
    {**isYellow**: **false**}
    ];

**const *myTypedFunctor*** = **new** MyFunctorContext(***bananas***);

**const *bestBananas*** = ***myTypedFunctor*** .map((banana: **any**) => {
    **if** (banana.**isYellow**) {
        banana.**tasty** = **true**;
        **return** banana;
    }
    banana.**tasty** = **false**;
    **return** banana;
});
```

æ‰€ä»¥ç†è®ºä¸Šè¿™å¾ˆæ£’ï¼Œä½†æ˜¯æˆ‘å®é™…ä¸Šä»æ¥æ²¡æœ‰å‘ç°ä½¿ç”¨å®ƒçš„éœ€è¦ï¼Œæ•°ç»„<t>è®©æˆ‘å¾—åˆ°äº†æ©æŠ¤..</t>

åœ¨ Haskell BTW ä¸­ï¼Œmap()è¡¨ç¤ºä¸º:

```
(a -> b) -> [a] -> [b]
```

ç¬¬ä¸€ä¸ªå‚æ•°:(a -> b)è¡¨ç¤ºä¸€ä¸ªé‡‡ç”¨ç±»å‹â€œa â€(å¯ä»¥æ˜¯ä»»ä½•ç±»å‹)å¹¶è¿”å›ç±»å‹â€œbâ€çš„å‡½æ•°

ç¬¬äºŒä¸ªå‚æ•°æ˜¯â€œaâ€ç±»å‹çš„åˆ—è¡¨

è¿”å›å€¼æ˜¯â€œbâ€ç±»å‹çš„åˆ—è¡¨

å¦ä¸€ä¸ªä½¿ç”¨ä»¿å‡½æ•°çš„ä¾‹å­å¯ä»¥åœ¨ **D3** ä¸­æ‰¾åˆ°ï¼Œæˆ‘ç”¨è¿™ä¸ªåº“åšäº†å¾ˆå¤šå·¥ä½œï¼Œæˆ‘ä¼¼ä¹è®¤è¯†åˆ°äº†â€œ**é€‰æ‹©**API å½¢å¼çš„ä»¿å‡½æ•°æ¨¡å¼ï¼ŒæŸ¥çœ‹[è¿™ç¯‡æ–‡ç« ](http://www.dreadedsoftware.com/blog/2016/1/16/d3js-is-a-functor-over-the-dom)ã€‚(é€‰æ‹©æ€»æ˜¯è¿”å›é€‰æ‹©çš„æ–°å¼•ç”¨)

ä»¥ä¸‹æ˜¯å¯è¿è¡Œçš„ç¤ºä¾‹:

å¦‚æœä½ è§‰å¾—é‚£ä¸ªå¸–å­æœ‰æ„æ€ï¼Œæˆ‘æ¨èä½ çœ‹çœ‹æˆ‘ä¸‹é¢çš„å¸–å­:

[](/a-short-time-learning-haskell-can-shortly-improve-your-typescript-skills-523505900ac0) [## çŸ­æ—¶é—´å­¦ä¹  Haskell å¯ä»¥å¾ˆå¿«æé«˜æ‚¨çš„æ‰“å­—æŠ€èƒ½ï¼

### é”®å…¥ä»»æ„å‡½æ•°ï¼ä»¿åˆ¶è¯å¤ªç‰›é€¼äº†ï¼ğŸ˜ ğŸ‘å“ˆæ–¯å…‹å°”ä¸ºäº†æ›´å¤§çš„åˆ©ç›Šã€‚

itnext.i](/a-short-time-learning-haskell-can-shortly-improve-your-typescript-skills-523505900ac0) [](/exploring-the-mixin-pattern-by-code-1dbe5e3124eb) [## æ¢ç´¢ Mixin æ¨¡å¼â†’æŒ‰ä»£ç 

### è®©æˆ‘ä»¬æ··åˆä¸€äº›ç±»å‹è„šæœ¬ç±»

itnext.io](/exploring-the-mixin-pattern-by-code-1dbe5e3124eb) [](/d3-selections-in-depth-40b8b36ef738) [## D3 æ·±åº¦é€‰æ‹©

### è¾“å…¥â†’é€‰æ‹©

itnext.io](/d3-selections-in-depth-40b8b36ef738) 

ä¹Ÿæ¬¢è¿ä½ æ·±å…¥æˆ‘çš„[æ¸¸ä¹åœºå›è´­](https://github.com/LironHazan/advanced-patterns-in-typescript/blob/master/functional/algebric-data-types.ts)æ¥æŒæ¡ä¸€äº›æ›´å¤šçš„åŠŸèƒ½æ¦‚å¿µã€‚

å¹²æ¯ï¼Œå‹’è£ã€‚