<html>
<head>
<title>Getting started with FastAPI and MySQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">FastAPIå’ŒMySQLå…¥é—¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/getting-started-with-fastapi-and-mysql-96e720cc761a?source=collection_archive---------2-----------------------#2021-01-30">https://itnext.io/getting-started-with-fastapi-and-mysql-96e720cc761a?source=collection_archive---------2-----------------------#2021-01-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b67fc1c5cdc4b7124ef6349d17c15c05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JMvf08SjYMNAAcHRAjYm0g.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">å°¼å¤æ‹‰æ–¯Â·éœä¼Šæ³½åœ¨<a class="ae kc" href="https://unsplash.com/s/photos/fast?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><p id="fb91" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¿™ç¯‡æ–‡ç« æ˜¯FastAPIç³»åˆ—çš„ä¸€éƒ¨åˆ†ã€‚</p><p id="d1c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åœ¨ç¬¬ä¸€ç¯‡<a class="ae kc" href="http://blog.adnansiddiqi.me/create-your-first-rest-api-in-fastapi/" rel="noopener ugc nofollow" target="_blank">å¸–å­</a>ä¸­ï¼Œæˆ‘å‘æ‚¨ä»‹ç»äº†FastAPIä»¥åŠå¦‚ä½•åœ¨å…¶ä¸­åˆ›å»ºé«˜æ€§èƒ½çš„åŸºäºPythonçš„åº”ç”¨ç¨‹åºã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶ä¸MySQLæ•°æ®åº“äº¤äº’çš„Rest APIsã€‚æˆ‘ä»¬è¿˜å°†æ¢è®¨å¦‚ä½•åœ¨å¤šä¸ªæ–‡ä»¶ä¸­ç»„ç»‡è·¯ç”±å™¨å’Œæ¨¡å‹ï¼Œä½¿å®ƒä»¬æ›´æ˜“äºç»´æŠ¤å’Œé˜…è¯»ã€‚</p><p id="2b64" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">FastAPIå¹¶ä¸è¦æ±‚æ‚¨ä½¿ç”¨ç‰¹å®šçš„æ•°æ®åº“æ¡†æ¶ã€‚æ‚¨å¯ä»¥ä½¿ç”¨SQLAlchemyæˆ–ä»»ä½•å…¶ä»–æ‚¨æƒ³è¦çš„ã€‚æˆ‘æ›´å–œæ¬¢ç”¨<a class="ae kc" href="http://blog.adnansiddiqi.me/develop-database-driven-applications-in-python-with-peewee/" rel="noopener ugc nofollow" target="_blank"> peewee </a>ï¼Œå› ä¸ºå®ƒæ›´æœ‰è¡¨ç°åŠ›ï¼Œä¹Ÿæ›´å®¹æ˜“ä½¿ç”¨ã€‚</p><h1 id="9163" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">å®‰è£…Peeweeå’ŒMySQLé©±åŠ¨ç¨‹åº</h1><p id="779d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">åœ¨å¼€å§‹åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨MySQLä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»å‡†å¤‡å¥½æ‰€æœ‰çš„ä¸œè¥¿ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†é¦–å…ˆå®‰è£…<code class="fe me mf mg mh b">peewee</code> ORMã€‚</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/2cee96dc6bfdcc7d0f0e915c09094238.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*O-YXmveTUnCcgSeI.png"/></div></div></figure><p id="fc44" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘å°†åˆ›å»ºä¸€ä¸ªåä¸º<code class="fe me mf mg mh b">database.py</code>çš„å•ç‹¬æ–‡ä»¶ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ã€‚</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="554f" class="mr lc iq mh b gy ms mt l mu mv">from peewee import *</span><span id="89e6" class="mr lc iq mh b gy mw mt l mu mv">user = 'root'<br/>password = 'root'<br/>db_name = 'fastapi_contact'</span><span id="7ff6" class="mr lc iq mh b gy mw mt l mu mv">conn = MySQLDatabase(<br/>    db_name, user=user,<br/>    password=password,<br/>    host='localhost'<br/>)</span><span id="e3bf" class="mr lc iq mh b gy mw mt l mu mv">class BaseModel(Model):<br/>    class Meta:<br/>        database = conn</span></pre><p id="c42e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘å¯¼å…¥äº†æ¡†æ¶å¹¶åˆ›å»ºäº†ä¸€ä¸ª<code class="fe me mf mg mh b">MySQLDatabase</code>å¯¹è±¡ã€‚æˆ‘æ­£åœ¨ä¼ é€’æ‰€æœ‰å¿…éœ€çš„å‡­è¯ï¼Œä»¥ç¡®ä¿è¿æ¥æˆåŠŸã€‚</p><p id="88e9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä½†æ˜¯ç­‰ç­‰â€¦åœ¨æˆ‘ä»¬è¿è¡ŒæœåŠ¡å™¨ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®‰è£…MySQLé©±åŠ¨ç¨‹åºã€‚æˆ‘å°†ä½¿ç”¨PyMySQLæ¥è¿æ¥MySQLæ•°æ®åº“ï¼Œå¦åˆ™æ‚¨å°†ä¼šçœ‹åˆ°ä»¥ä¸‹é”™è¯¯:</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="5333" class="mr lc iq mh b gy ms mt l mu mv">self._state.set_connection(self._connect())<br/>  File "/Users/AdnanAhmad/.local/share/virtualenvs/ContactAPI-Ycq5CXn7/lib/python3.9/site-packages/peewee.py", line 3964, in _connect<br/>    raise ImproperlyConfigured('MySQL driver not installed!')<br/>peewee.ImproperlyConfigured: MySQL driver not installed!</span><span id="9db4" class="mr lc iq mh b gy mw mt l mu mv">&lt;a href="<a class="ae kc" href="http://blog.adnansiddiqi.me/wp-content/uploads/2021/01/fastapi_install_pymysql.png" rel="noopener ugc nofollow" target="_blank">http://blog.adnansiddiqi.me/wp-content/uploads/2021/01/fastapi_install_pymysql.png</a>"&gt;&lt;img class="aligncenter size-large wp-image-2374" src="<a class="ae kc" href="http://blog.adnansiddiqi.me/wp-content/uploads/2021/01/fastapi_install_pymysql-1024x734.png" rel="noopener ugc nofollow" target="_blank">http://blog.adnansiddiqi.me/wp-content/uploads/2021/01/fastapi_install_pymysql-1024x734.png</a>" alt="" width="960" height="688" /&gt;&lt;/a&gt;</span></pre><p id="f81f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åˆ°ç›®å‰ä¸ºæ­¢ä¸€åˆ‡é¡ºåˆ©ã€‚ç°åœ¨æˆ‘å°†æ›´æ”¹<code class="fe me mf mg mh b">main.py</code>æ¥å¯¼å…¥<code class="fe me mf mg mh b">database.py</code>æ–‡ä»¶å†…å®¹ã€‚</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="d1ce" class="mr lc iq mh b gy ms mt l mu mv">app = FastAPI(title='Contact.ly', description='APIs for contact Apis', version='0.1')</span><span id="acf3" class="mr lc iq mh b gy mw mt l mu mv"><a class="ae kc" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.on_event("startup")<br/>async def startup():<br/>    print("Connecting...")</span><span id="225a" class="mr lc iq mh b gy mw mt l mu mv"><a class="ae kc" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.get("/")<br/>async def root():<br/>    return {"message": "Contact Applications!"}</span></pre><p id="46b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å‘ç”Ÿäº†å‡ ä»¶äº‹ï¼Œä½†è®©æˆ‘å…ˆè®¨è®ºå…¶ä¸­é‡è¦çš„ä¸€ä»¶:<a class="ae kc" href="https://fastapi.tiangolo.com/advanced/events/" rel="noopener ugc nofollow" target="_blank"> FastAPIäº‹ä»¶</a>ã€‚</p><h1 id="12c8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">FastAPIäº‹ä»¶</h1><p id="f71f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">FastAPIæä¾›äº†å‡ ä¸ªå¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„äº‹ä»¶:å¯åŠ¨å’Œå…³é—­ã€‚</p><p id="70c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">å¯åŠ¨äº‹ä»¶</strong>:è¯¥äº‹ä»¶è´Ÿè´£åœ¨å¯åŠ¨åº”ç”¨ç¨‹åºæ—¶æ‰§è¡ŒæŸäº›ä»»åŠ¡ã€‚å¯åŠ¨åº”ç”¨ç¨‹åºæ„å‘³ç€å½“ä½ åˆ°è¾¾æŸä¸ªAPIç«¯ç‚¹æ—¶ï¼Œå®ƒé¦–å…ˆè¢«æ‰§è¡Œã€‚åƒè¿æ¥æ•°æ®åº“è¿™æ ·çš„ä»»åŠ¡æ˜¯åœ¨åšä»»ä½•äº‹æƒ…ä¹‹å‰å¿…é¡»æ‰§è¡Œçš„ä»»åŠ¡ä¹‹ä¸€ã€‚</p><p id="c906" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">å…³æœºäº‹ä»¶:</strong>è¯¥äº‹ä»¶åœ¨appé€€å‡ºæˆ–å…³æœºæ—¶è§¦å‘ã€‚åœ¨ç¦»å¼€åº”ç”¨ç¨‹åºä¹‹å‰ï¼Œæ‚¨å¯èƒ½å¸Œæœ›ä½¿ç”¨æ­¤äº‹ä»¶æ¥å­˜å‚¨æ‰€æœ‰ä¿¡æ¯ã€‚</p><p id="fa09" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¿™äº›äº‹ä»¶çš„ä¼˜ç‚¹æ˜¯ï¼Œæ‚¨ä¸å¿…åœ¨æ¯ä¸ªAPIç«¯ç‚¹ä¸­è°ƒç”¨ä»£ç ã€‚</p><p id="b383" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ­£å¦‚æ‚¨ç°åœ¨æ‰€ç†è§£çš„ï¼Œæˆ‘æ­£åœ¨è¿æ¥å¯åŠ¨äº‹ä»¶çš„æ•°æ®åº“ã€‚</p><p id="bce0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å¦ä¸€ä»¶äº‹ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°äº†ï¼Œæˆ‘åœ¨<code class="fe me mf mg mh b">FastAPI</code>æ„é€ å‡½æ•°ä¸­ä¼ é€’äº†ä¸€äº›å‘½åå‚æ•°ã€‚å½“æˆ‘è¿™æ ·åšæ—¶ï¼Œå®ƒä¼šäº§ç”Ÿå¦‚ä¸‹æ‰€ç¤ºçš„å†…å®¹:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/8e15ccc6916c955ac610eb2c02b263f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qCIIPSnpwZdf49mk.png"/></div></div></figure><p id="0ada" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">çœ‹èµ·æ¥å¥½å¤šäº†ï¼Œä¸æ˜¯å—ï¼Ÿ</p><p id="ad33" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç°åœ¨æˆ‘å¿…é¡»åˆ›å»ºè·¯ç”±å™¨ã€æ¨¡å‹ã€æ•°æ®åº“è¿æ¥ç­‰ã€‚è¿™äº›éƒ½åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ä¼šä½¿åº”ç”¨ç¨‹åºå˜å¾—è‡ƒè‚¿ã€‚æˆ‘ç°åœ¨å°†åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«åä¸º<code class="fe me mf mg mh b">models</code>å’Œ<code class="fe me mf mg mh b">routers</code>ã€‚æˆ‘è¿˜åœ¨æ ¹æ–‡ä»¶å¤¹ä¸­åˆ›å»ºäº†ä¸€ä¸ªæ–‡ä»¶<code class="fe me mf mg mh b">database.py</code>ï¼Œå®ƒå°†å®ä¾‹åŒ–<code class="fe me mf mg mh b">MySQLDatabase</code>ç±»å¯¹è±¡ã€‚</p><h1 id="f1c0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">ä»€ä¹ˆæ˜¯APIRouter</h1><p id="a04f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">å¦‚æœä½ æœ‰ä¸€ä¸ªå°çš„åº”ç”¨ç¨‹åºï¼ŒæŠŠä½ æ‰€æœ‰çš„è·¯çº¿æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„<code class="fe me mf mg mh b">main.py</code>æ–‡ä»¶ä¸­æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å¦‚æœä½ åœ¨ä¸€ä¸ªå¤§çš„ç³»ç»Ÿä¸Šå·¥ä½œï¼Œé‚£ä¹ˆæŠŠæ‰€æœ‰çš„è·¯çº¿æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­ä¼šä½¿å®ƒå˜å¾—ç¬¨æ‹™å’Œè‡ƒè‚¿ã€‚å¦‚æœæˆ‘ä»¬å¯ä»¥æŒ‰ç…§å®ä½“æˆ–åº”ç”¨ç¨‹åºç»„ç»‡ä¸€ç»„è·¯ç”±å™¨ï¼Œé‚£è¯¥æœ‰å¤šå¥½ï¼Ÿåƒå§œæˆˆæä¾›çš„ä¸œè¥¿ã€‚</p><p id="c428" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">FastAPIçš„<a class="ae kc" href="https://fastapi.tiangolo.com/tutorial/bigger-applications/?h=+apirouter#apirouter" rel="noopener ugc nofollow" target="_blank"> APIRouter </a>å¯ä»¥å¸®åŠ©ä½ åœ¨å¤šä¸ªæ–‡ä»¶ä¸­ç»„ç»‡ä½ çš„è·¯ç”±å’Œé€»è¾‘ã€‚</p><p id="f53e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åœ¨æ ¹æ–‡ä»¶å¤¹ä¸­ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªåä¸º<code class="fe me mf mg mh b">routers</code>çš„æ–‡ä»¶å¤¹ï¼Œæˆ‘å°†åœ¨å…¶ä¸­æ·»åŠ æˆ‘çš„è”ç³»APIç›¸å…³çš„è·¯ç”±å™¨ã€‚æˆ‘åœ¨é‡Œé¢åŠ äº†ä¸€ä¸ª<code class="fe me mf mg mh b">__init.py__</code>æŠŠå®ƒå˜æˆä¸€ä¸ªåŒ…ã€‚ä½ å¯ä»¥ä¸åšè¿™ä»¶äº‹ã€‚æˆ‘æ­£åœ¨æ·»åŠ æˆ‘çš„è·¯çº¿æ–‡ä»¶ï¼Œ<code class="fe me mf mg mh b">contact.py</code>ï¼Œå…¶å†…å®¹å¦‚ä¸‹:</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="4b19" class="mr lc iq mh b gy ms mt l mu mv">from fastapi import APIRouter</span><span id="a878" class="mr lc iq mh b gy mw mt l mu mv">router_contacts = APIRouter(<br/>    prefix="/contacts",<br/>    tags=["contacts"]<br/>)</span><span id="5f39" class="mr lc iq mh b gy mw mt l mu mv"><a class="ae kc" href="http://twitter.com/router_contacts" rel="noopener ugc nofollow" target="_blank">@router_contacts</a>.get("/",summary="List of contacts", description="Returns all contacts" )<br/>async def get_contacts():<br/>    #create(first_name='Addu', last_name='Pagal', <a class="ae kc" href="mailto:email='addu@gmail.com" rel="noopener ugc nofollow" target="_blank">email='addu@gmail.com</a>', phone='123-494', status=1)<br/>    return [{'status': 'OK'}]</span></pre><p id="7c75" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘é€šè¿‡ä¼ é€’ä¸¤ä¸ªå‚æ•°åˆ›å»ºäº†ä¸€ä¸ª<code class="fe me mf mg mh b">APIRouter</code>å¯¹è±¡:<em class="mx">å‰ç¼€</em>å’Œ<em class="mx">æ ‡ç­¾ã€‚è¿™è®©æˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸ªç«¯ç‚¹æ·»åŠ <code class="fe me mf mg mh b">/contacts/</code>ã€‚</em></p><p id="0602" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘è¿˜æ·»åŠ äº†åœ¨æ–‡æ¡£ä¸­æ¸²æŸ“çš„<code class="fe me mf mg mh b">summary</code>å’Œ<code class="fe me mf mg mh b">description</code>å‚æ•°ã€‚</p><p id="994a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">FastAPIè¿˜å…è®¸æ‚¨ä½¿ç”¨<em class="mx"> docstring </em>æ¥è®°å½•æ‚¨çš„APIç«¯ç‚¹ã€‚ä¾‹å¦‚:</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="93ac" class="mr lc iq mh b gy ms mt l mu mv"><a class="ae kc" href="http://twitter.com/router_contacts" rel="noopener ugc nofollow" target="_blank">@router_contacts</a>.get("/view/{id}", summary="Returns a single contact")<br/>async def view(id: int):<br/>    """<br/>        To view all details related to a single contact</span><span id="79a8" class="mr lc iq mh b gy mw mt l mu mv">- **id**: The integer id of the contact you want to view details.<br/>    """<br/>    return [{'status': 'OK'}]</span></pre><p id="3f0a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¿™é‡Œæˆ‘ä½¿ç”¨äº†å¸¦æœ‰markdownçš„<em class="mx"> docstring </em>ã€‚æ¸²æŸ“æ—¶ï¼Œå®ƒæ˜¾ç¤ºä¸º:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/efe268b75da3fdcc6686c3e3102b6e79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*D2AsP2C_n4ZwyCLi.png"/></div></div></figure><p id="bfa8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å¾ˆé…·ï¼Œä¸æ˜¯å—ï¼Ÿåœ¨å¦‚ä½•æ˜¾ç¤ºAPIç«¯ç‚¹æ–‡æ¡£æ–¹é¢ï¼ŒDocstring ä¸ºæ‚¨æä¾›äº†æ›´å¤šçš„çµæ´»æ€§ã€‚</p><p id="189e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mx">æ ‡ç­¾</em>æœ‰åŠ©äºå°†åº”ç”¨ç›¸å…³çš„APIç»„ç»‡åœ¨æ–‡æ¡£ä¸­çš„ä¸€ä¸ªä½ç½®ã€‚å®ƒä»¬ä¹Ÿåœ¨OpenAPIä¸­ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œå½“æˆ‘è®¿é—®<code class="fe me mf mg mh b">http://localhost:8080/openapi.json</code>æ—¶ï¼Œå®ƒä¼šæ˜¾ç¤ºä»¥ä¸‹å†…å®¹ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­çœ‹åˆ°ç»™å‡ºçš„æ ‡ç­¾ã€‚</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="71d1" class="mr lc iq mh b gy ms mt l mu mv">{"openapi":"3.0.2","info":{"title":"Contact.ly","description":"APIs for contact Apis","version":"0.1"},"paths":{"/":{"get":{"summary":"Root","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/contacts/":{"get":{"tags":["contacts"],"summary":"List of contacts","description":"Returns all contacts","operationId":"get_contacts_contacts__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/contacts/view/{id}":{"get":{"tags":["contacts"],"summary":"View","description":"Returns a single contact","operationId":"view_contacts_view__id__get","parameters":[{"required":true,"schema":{"title":"Id","type":"integer"},"name":"id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"HTTPValidationError":{"title":"HTTPValidationError","type":"object","properties":{"detail":{"title":"Detail","type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}},"ValidationError":{"title":"ValidationError","required":["loc","msg","type"],"type":"object","properties":{"loc":{"title":"Location","type":"array","items":{"type":"string"}},"msg":{"title":"Message","type":"string"},"type":{"title":"Error Type","type":"string"}}}}}}</span></pre><p id="e71b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘ä»¬å·²ç»åˆ›å»ºäº†æˆ‘ä»¬çš„è·¯çº¿æ–‡ä»¶ï¼Œä½†äº‹æƒ…è¿˜æ²¡æœ‰å®Œæˆã€‚æˆ‘ä»¬å¿…é¡»åœ¨<code class="fe me mf mg mh b">main.py</code>æ–‡ä»¶ä¸­è°ƒç”¨å®ƒä»¬ã€‚åœ¨ä¸»æ–‡ä»¶ä¸­ï¼Œæˆ‘å°†è¿›è¡Œä»¥ä¸‹æ›´æ”¹ã€‚</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="99f4" class="mr lc iq mh b gy ms mt l mu mv">from routers import contact</span><span id="dc2b" class="mr lc iq mh b gy mw mt l mu mv">app = FastAPI(title='Contact.ly', description='APIs for contact Apis', version='0.1')<br/>app.include_router(contact.router_contacts)</span></pre><p id="61c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç”±äº<code class="fe me mf mg mh b">routers</code>æ–‡ä»¶å¤¹ç°åœ¨æ˜¯ä¸€ä¸ªåŒ…ï¼Œæ‰€ä»¥æˆ‘å¯ä»¥è°ƒç”¨<code class="fe me mf mg mh b">router_contacts</code>å˜é‡å¹¶å°†å…¶ä¼ é€’ç»™<code class="fe me mf mg mh b">include_router</code>å‡½æ•°ã€‚</p><p id="e1d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å®Œæˆæ–°çš„è”ç³»åï¼Œç›¸å…³è·¯çº¿å°†å‡ºç°åœ¨æ–‡æ¡£é¡µé¢ä¸Šã€‚</p><h1 id="189a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Peeweeæ¨¡å‹</h1><p id="dc21" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">æ­£å¦‚æˆ‘æåˆ°çš„ï¼Œæˆ‘å°†ä½¿ç”¨<em class="mx"> peewee </em> ORMè€Œä¸æ˜¯SqlAlchemyï¼Œæˆ‘å°†ä¸ºæ­¤åˆ›å»ºç›¸å…³çš„æ¨¡å‹ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹<code class="fe me mf mg mh b">database.py</code>æ–‡ä»¶ä¼šæ˜¯ä»€ä¹ˆæ ·å­ã€‚è¿™ä¸ªæ–‡ä»¶å°†åŒ…å«<code class="fe me mf mg mh b">MySQLDatabase</code>ç±»çš„ç±»å¯¹è±¡ï¼Œæ‰€æœ‰éœ€è¦çš„å‚æ•°éƒ½ä¼ é€’ç»™å®ƒã€‚</p><p id="be28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä¸‹é¢çš„<code class="fe me mf mg mh b">database.py</code>å°†ä¼šæ˜¯è¿™æ ·çš„:</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="9ea7" class="mr lc iq mh b gy ms mt l mu mv">from peewee import *</span><span id="cb74" class="mr lc iq mh b gy mw mt l mu mv">user = 'root'<br/>password = 'root'<br/>db_name = 'fastapi_contact'</span><span id="72c3" class="mr lc iq mh b gy mw mt l mu mv">conn = MySQLDatabase(<br/>    db_name, user=user,<br/>    password=password,<br/>    host='localhost'<br/>)</span></pre><p id="1913" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åæ¥ï¼Œåœ¨<code class="fe me mf mg mh b">main.py</code>æ–‡ä»¶ä¸­ï¼Œæˆ‘æ‰“ç®—è¿™æ ·ç§°å‘¼å®ƒ:</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="66ee" class="mr lc iq mh b gy ms mt l mu mv">from database import *</span><span id="5e47" class="mr lc iq mh b gy mw mt l mu mv"><a class="ae kc" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.on_event("startup")<br/>async def startup():<br/>    if conn.is_closed():<br/>        conn.connect()</span><span id="28c8" class="mr lc iq mh b gy mw mt l mu mv"><a class="ae kc" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.on_event("shutdown")<br/>async def shutdown():<br/>    print("Closing...")<br/>    if not conn.is_closed():<br/>        conn.close()</span></pre><p id="88ed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å› æ­¤ï¼Œæ— è®ºä½•æ—¶è®¿é—®ä»»ä½•APIç«¯ç‚¹ï¼Œå®ƒéƒ½ä¼šåˆ›å»ºä¸€ä¸ªè¿æ¥ï¼Œç„¶ååœ¨æ‰€æœ‰æ‰§è¡Œå®Œæˆåå…³é—­å®ƒã€‚</p><p id="e2f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç°åœ¨æ¨¡å‹â€¦æˆ‘å°†åˆ›å»ºå‡ ä¸ªæ¨¡å‹:ä¸€ä¸ª<code class="fe me mf mg mh b">BaseModel</code>è´Ÿè´£å°†æ¨¡å‹ä¸MySQLæ•°æ®åº“å…³è”èµ·æ¥ï¼Œä¸€ä¸ª<code class="fe me mf mg mh b">Contact</code>è´Ÿè´£å¤„ç†<code class="fe me mf mg mh b">contacts</code>è¡¨ã€‚æˆ‘å‡è®¾å·²ç»åˆ›å»ºäº†è¯¥è¡¨ï¼Œå› æ­¤æ²¡æœ‰è¦†ç›–å®ƒã€‚è¦äº†è§£æ›´å¤šï¼Œä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹æˆ‘çš„æ–‡ç« <a class="ae kc" href="http://blog.adnansiddiqi.me/develop-database-driven-applications-in-python-with-peewee/" rel="noopener ugc nofollow" target="_blank"/>ã€‚</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="e0a2" class="mr lc iq mh b gy ms mt l mu mv">from peewee import *<br/>from database import conn</span><span id="669e" class="mr lc iq mh b gy mw mt l mu mv">class BaseModel(Model):<br/>    class Meta:<br/>        database = conn</span></pre><p id="2ba5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å’Œ<code class="fe me mf mg mh b">contact.py</code></p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="19ee" class="mr lc iq mh b gy ms mt l mu mv">from peewee import *</span><span id="3725" class="mr lc iq mh b gy mw mt l mu mv">from .Base import BaseModel</span><span id="a515" class="mr lc iq mh b gy mw mt l mu mv">class Contact(BaseModel):<br/>    first_name = CharField(max_length=30)<br/>    last_name = CharField(max_length=30)<br/>    email = CharField(max_length=40)<br/>    phone = CharField(max_length=25)<br/>    status = SmallIntegerField()<br/>    updated_at = DateTimeField()</span><span id="6916" class="mr lc iq mh b gy mw mt l mu mv">class Meta:<br/>        db_table = 'contacts'</span></pre><p id="627a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘ä»¬å°†åˆ›å»º<strong class="kf ir"> CRUD </strong>ç«¯ç‚¹æ¥ç®¡ç†æ•´ä¸ªåº”ç”¨ç¨‹åºï¼Œå³ç”¨äºåˆ›å»ºè®°å½•ã€æ›´æ–°ã€åˆ é™¤å’Œæ£€ç´¢çš„APIç«¯ç‚¹ã€‚</p><p id="aa71" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘å°†åˆ›å»ºæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªè”ç³»äººAPIç«¯ç‚¹ï¼Œå®ƒå°†åœ¨æ•°æ®åº“ä¸­æ·»åŠ ä¸€ä¸ªè”ç³»äººã€‚åœ¨<code class="fe me mf mg mh b">models/contact.py</code>ä¸­ï¼Œæˆ‘å°†åˆ›å»ºä¸€ä¸ªæ•°æ®æ’å…¥æ–¹æ³•:</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="2b3b" class="mr lc iq mh b gy ms mt l mu mv">async def create_contact(first_name: str, last_name: str, email: str, phone: str, status: int):<br/>    contact_object = Contact(<br/>        first_name=first_name,<br/>        last_name=last_name,<br/>        email=email,<br/>        phone=phone,<br/>        status=status<br/>    )<br/>    contact_object.save()<br/>    return contact_object</span></pre><p id="98f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç›¸å½“ç›´æ¥ã€‚æˆ‘åˆ›å»ºäº†ä¸€ä¸ª<code class="fe me mf mg mh b">Contact</code>å¯¹è±¡ï¼Œå¹¶åœ¨å…¶ä¸­ä¼ é€’äº†æ‰€éœ€çš„å‚æ•°ã€‚ç°åœ¨æ³¨æ„äº†ã€‚<code class="fe me mf mg mh b">create_contact</code>æ¨¡å‹æ–¹æ³•æ­£åœ¨è¿”å›ä¸€ä¸ª<code class="fe me mf mg mh b">ModelSelect</code>å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¯¹æˆ‘ä»¬æ²¡æœ‰ç”¨ï¼Œå› ä¸ºå®ƒåŒ…å«äº†ä¸€äº›ä¸peeweeç›¸å…³çš„ä¿¡æ¯ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªPydanticæ¨¡å‹æ¥å¤„ç†å®ƒã€‚è¿™å¹¶ä¸ç®€å•ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å¼€å§‹å§ï¼</p><p id="da17" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">é¦–å…ˆï¼Œæˆ‘å°†åˆ›å»ºä¸€ä¸ªå°†peeweeæ¨¡å‹æ˜ å°„åˆ°Pydanticæ¨¡å‹çš„ç±»ã€‚ä»£ç <a class="ae kc" href="https://fastapi.tiangolo.com/advanced/sql-databases-peewee/?h=+sql" rel="noopener ugc nofollow" target="_blank">å–è‡ª</a>FastAPIå®˜ç½‘:</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="cec1" class="mr lc iq mh b gy ms mt l mu mv">class PeeweeGetterDict(GetterDict):<br/>    def get(self, key: Any, default: Any = None):<br/>        res = getattr(self._obj, key, default)<br/>        if isinstance(res, peewee.ModelSelect):<br/>            return list(res)<br/>        return res</span></pre><p id="666d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åˆ›å»ºè”ç³»äººçš„Pydanticæ¨¡å‹:</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="b9f9" class="mr lc iq mh b gy ms mt l mu mv">class ContactModel(BaseModel):<br/>    id:int<br/>    first_name:str<br/>    last_name:str<br/>    email:str</span><span id="93c2" class="mr lc iq mh b gy mw mt l mu mv">class Config:<br/>        orm_mode = True<br/>        getter_dict = PeeweeGetterDict</span></pre><p id="c006" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ·»åŠ äº†æˆ‘ä»¬æƒ³è¦æ˜¾ç¤ºçš„å­—æ®µåï¼Œæˆ‘å°†<code class="fe me mf mg mh b">orm_mode</code>è®¾ç½®ä¸º<code class="fe me mf mg mh b">True</code>ï¼Œç„¶åå°†<code class="fe me mf mg mh b">getter_dict</code>å‚æ•°è®¾ç½®ä¸ºæˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„ç±»<code class="fe me mf mg mh b">PeeweeGetterDict</code>ï¼Œè¿™æ˜¯Pydanticæä¾›çš„ã€‚æ¬²äº†è§£æ›´å¤šä¿¡æ¯ï¼Œæ‚¨å¯ä»¥è®¿é—®<a class="ae kc" href="https://pydantic-docs.helpmanual.io/usage/model_config/" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>ã€‚<strong class="kf ir"> orm_mode </strong>å®é™…ä¸Šå°†ormæ¨¡å‹å¯¹è±¡æ˜ å°„åˆ°Pydanticå¯¹è±¡ï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦æ‰‹åŠ¨æ„é€ ä¸€ä¸ªè¿”å›å¯¹è±¡ã€‚</p><p id="c242" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘å°†åˆ›å»ºä¸€ä¸ªç”¨äºåˆ›å»ºæ–°è”ç³»äººçš„POSTç«¯ç‚¹ã€‚</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="f257" class="mr lc iq mh b gy ms mt l mu mv">from models.contact import create_contact</span><span id="4c1b" class="mr lc iq mh b gy mw mt l mu mv"><a class="ae kc" href="http://twitter.com/router_contacts" rel="noopener ugc nofollow" target="_blank">@router_contacts</a>.post("/", summary="Create a new contact")<br/>async def create(first_name: str, last_name: str, email: str, phone: str, status: int):<br/>    return await create_contact(first_name=first_name, last_name=last_name, email=email, phone=phone, status=status)</span></pre><p id="2fec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä½ ä¸å¿…è®©ä¸€ä¸ªå‡½æ•°æˆä¸º<code class="fe me mf mg mh b">async</code>å‡½æ•°ã€‚FastAPIä¸¤è€…éƒ½æ”¯æŒã€‚æ€»ä¹‹ï¼Œæˆ‘æ­£åœ¨åˆ›å»ºä¸€ä¸ª<code class="fe me mf mg mh b">POST</code>ç«¯ç‚¹ï¼Œå®ƒæ¥å—ä¸€ä¸ªJSONå¯¹è±¡ä½œä¸ºè¾“å…¥å¹¶åˆ›å»ºä¸€æ¡è®°å½•ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘åœ¨è¿™é‡Œåªæ˜¯è¿”å›ä¸€ä¸ªOKï¼Œä½†æ˜¯åœ¨ç°å®ä¸–ç•Œçš„åº”ç”¨ç¨‹åºä¸­ï¼Œæ‚¨å°†è´Ÿè´£æ‰€æœ‰çš„å¼‚å¸¸å’Œå…¶ä»–ä¸œè¥¿ã€‚</p><p id="2ca9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è®©æˆ‘ä»¬ç‚¹å‡»<code class="fe me mf mg mh b">/doc</code>æ¥åˆ›é€ æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªè®°å½•ã€‚å½“å®ƒè¢«åˆ›å»ºæ—¶ï¼Œå®ƒè¿”å›å¦‚ä¸‹:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/9078b9e404123371d1853e39a067d64f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9rvZRnNtQjIxp089.png"/></div></div></figure><p id="e7f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å—¯ï¼Œå®ƒç¡®å®æˆåŠŸè¿”å›äº†ï¼Œä½†æ˜¯ä½ å–œæ¬¢è¿”å›çš„JSONå“åº”å—ï¼Ÿæˆ‘ä¸çŸ¥é“ã€‚å®ƒåªæ˜¯è¿”å›ç”±peeweeå¯¹è±¡æŠ›å‡ºçš„ä»»ä½•ä¸œè¥¿ã€‚å¦‚ä½•è®©å®ƒå˜å¾—æ›´å¥½ï¼Œæ˜¯çš„ï¼Œä½ ç­”å¯¹äº†ï¼é€šè¿‡ä½¿ç”¨<code class="fe me mf mg mh b">response_model</code>å‚æ•°ã€‚APIä¾‹ç¨‹ç°åœ¨å°†å¦‚ä¸‹æ‰€ç¤º:</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="d006" class="mr lc iq mh b gy ms mt l mu mv"><a class="ae kc" href="http://twitter.com/router_contacts" rel="noopener ugc nofollow" target="_blank">@router_contacts</a>.post("/", response_model=ContactModel, summary="Create a new contact")<br/>async def create(first_name: str, last_name: str, email: str, phone: str, status: int):<br/>    return await create_contact(first_name=first_name, last_name=last_name, email=email, phone=phone, status=status)</span></pre><p id="0e10" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç°åœ¨è®©æˆ‘ä»¬å†åˆ›é€ ä¸€æ¬¡ã€‚å¤ªæ£’äº†ã€‚å¦‚æ‚¨æ‰€è§ï¼Œè¾“å‡ºçœ‹èµ·æ¥ä¸å†ä»¤äººè®¨åŒã€‚å®ƒå±•ç¤ºäº†æˆ‘ä»¬æƒ³è¦å±•ç¤ºçš„ä¸œè¥¿ã€‚</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/f785438ecf8aa52812d9d353a8e550a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_PO9igTCXYgcaA0g.png"/></div></div></figure><p id="e8de" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘çš„MYSQLå®¢æˆ·ç«¯æ˜¾ç¤ºæ–°æ’å…¥çš„æ•°æ®ã€‚</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/106044dffbd3f58761ac344013c11d2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*834VZP60HiUUDlGP.png"/></div></div></figure><p id="889f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘å°†åœ¨è¿™é‡Œåˆ›å»ºå‡ ä¸ªç«¯ç‚¹ï¼Œä¸€ä¸ªç”¨äºåˆ—è¡¨ï¼Œå¦ä¸€ä¸ªç”¨äºåˆ é™¤ã€‚æ›´æ–°æ˜¯ä½ è‡ªå·±è¦åšçš„äº‹æƒ…ğŸ˜‰</p><p id="61bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åœ¨<code class="fe me mf mg mh b">models/contact.py</code>ä¸­ï¼Œæˆ‘æ·»åŠ äº†ä¸€ä¸ªä¾‹ç¨‹æ¥åˆ—å‡ºæ‰€æœ‰è”ç³»äººï¼Œé»˜è®¤æƒ…å†µä¸‹æœ€å¤š100ä¸ªæ¡ç›®ã€‚</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="5014" class="mr lc iq mh b gy ms mt l mu mv">def list_contacts(skip: int = 0, limit: int = 100):<br/>    return list(Contact.select().offset(skip).limit(limit))</span></pre><p id="0d49" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç„¶ååœ¨<code class="fe me mf mg mh b">routers/contact.py</code>ä¸­ï¼Œæˆ‘ä¼šè¿™æ ·åš:</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="ff44" class="mr lc iq mh b gy ms mt l mu mv"><a class="ae kc" href="http://twitter.com/router_contacts" rel="noopener ugc nofollow" target="_blank">@router_contacts</a>.get("/", response_model=List[ContactModel], summary="List of contacts", description="Returns all contacts")<br/>def get_contacts():<br/>    return list_contacts()</span></pre><p id="667c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¿™ä¸ä¸ªäººæ¥è§¦æ˜¯ä¸€æ ·çš„ã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯<code class="fe me mf mg mh b">response_model</code>æ˜¯ç±»å‹<code class="fe me mf mg mh b">List</code>ï¼Œè¿™æ ·åšçš„åŸå› æ˜¯æ¨¡å‹è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æ¨¡å‹ä¹Ÿåº”è¯¥æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚åœ¨æ‰§è¡Œæ—¶ï¼Œå®ƒæ˜¾ç¤ºå¦‚ä¸‹:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/7d5dcf431369b3086fb4f88d628752d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Ti1qUyBb8bLfs44B.png"/></div></div></figure><p id="7c67" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä¸ºäº†åˆ é™¤è®°å½•ï¼Œæˆ‘å°†åœ¨æ¨¡å‹æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹:</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="f21b" class="mr lc iq mh b gy ms mt l mu mv">def delete_contact(id: int):<br/>    return Contact.delete().where(Contact.id == id).execute()</span></pre><p id="e285" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å¹¶ä¸”åœ¨<code class="fe me mf mg mh b">routers/contact.py</code></p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="f824" class="mr lc iq mh b gy ms mt l mu mv"><a class="ae kc" href="http://twitter.com/router_contacts" rel="noopener ugc nofollow" target="_blank">@router_contacts</a>.delete(<br/>    "/remove/{id}",<br/>    summary="Delete an individual contact",<br/>    response_class=Response,<br/>    responses={<br/>        200: {"description": "Contact successfully deleted"},<br/>        404: {"description": "Contact not found"},<br/>    },<br/>)<br/>def remove_contact(id: int):<br/>    del_contact = delete_contact(id)<br/>    if del_contact is None:<br/>        return Response(status_code=404)<br/>    return Response(status_code=200)</span></pre><p id="2f0f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åœ¨<code class="fe me mf mg mh b">delete</code>è£…é¥°å™¨ä¸­ï¼Œæˆ‘æ·»åŠ äº†å¦ä¸€ä¸ªå‚æ•°<code class="fe me mf mg mh b">responses</code>,å¹¶ä¸ºæ¯ä¸ªHTTPçŠ¶æ€æ¶ˆæ¯æ·»åŠ äº†åº”è¯¥åœ¨æ–‡æ¡£ä¸­æ˜¾ç¤ºçš„æ¶ˆæ¯ã€‚</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/50d5263ef44ccb9971ee0b1dcce5a10b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZbMbzqXl-6HM7poA.png"/></div></div></figure><p id="093e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">çœ‹èµ·æ¥å¥½å¤šäº†ï¼Œä¸æ˜¯å—ï¼Ÿ</p><p id="a839" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åœ¨æˆ‘ç»“æŸè¿™ç¯‡æ–‡ç« ä¹‹å‰ï¼Œæˆ‘æƒ³è°ˆè°ˆå¦ä¸€ä»¶äº‹:æ¨¡æ¿ï¼ï¼ï¼ï¼</p><h1 id="9006" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">FastAPIæ¨¡æ¿</h1><p id="79c4" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">å°±åƒFlaskä¸€æ ·ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨FastAPIä¸­ä½¿ç”¨<a class="ae kc" href="https://fastapi.tiangolo.com/advanced/templates/?h=+templ" rel="noopener ugc nofollow" target="_blank"> Jinja2æˆ–ä»»ä½•å…¶ä»–æ¨¡æ¿</a>ã€‚æ‚¨å¯èƒ½ä¸éœ€è¦è¿™ä¸ªç‰¹æ€§ï¼Œä½†æ˜¯å¦‚æœæ‚¨éœ€è¦æä¾›ç®€å•çš„HTMLï¼Œä¾‹å¦‚ä¸€ä¸ªç™»å½•è¡¨å•ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨è¿™ä¸ªç‰¹æ€§ã€‚</p><p id="c869" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘å°†é¦–å…ˆå®‰è£…<strong class="kf ir"> Jinja2 </strong>:</p><p id="4666" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">pipenv install jinja2</code></p><p id="4478" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä¸ºäº†æä¾›é™æ€æ–‡ä»¶ï¼Œæ‚¨è¿˜éœ€è¦<code class="fe me mf mg mh b">pipenv install aiofiles</code>ã€‚</p><p id="7a5a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä¸ºäº†ä¸¾ä¾‹ï¼Œæˆ‘å°†åˆ›å»ºæŸ¥çœ‹è”ç³»äººè¯¦ç»†ä¿¡æ¯çš„HTMLç‰ˆæœ¬ã€‚</p><p id="77e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘åˆ›å»ºäº†ä¸¤ä¸ªæ–‡ä»¶å¤¹:<em class="mx">é™æ€</em>å’Œ<em class="mx">æ¨¡æ¿</em>ã€‚é™æ€çš„å°†åŒ…å«æ‰€æœ‰çš„èµ„äº§ï¼Œè€ŒHTMLæ–‡ä»¶å’Œæ¨¡æ¿æ¨¡æ¿ã€‚æˆ‘åªæ˜¯åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„HTMLæ–‡ä»¶çš„æ¼”ç¤ºç›®çš„å’Œä¸€ä¸ªç®€å•çš„CSSæ–‡ä»¶ã€‚</p><p id="2f9d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åœ¨<code class="fe me mf mg mh b">main.py</code>,æˆ‘åšäº†ä»¥ä¸‹æ”¹å˜:</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="55c8" class="mr lc iq mh b gy ms mt l mu mv">from fastapi.staticfiles import StaticFiles<br/>app.mount("/static", StaticFiles(directory="static"), name="static")</span></pre><p id="a6a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¯·è®°ä½ï¼Œæ‚¨åœ¨è¿™é‡Œä½¿ç”¨çš„æ˜¯<code class="fe me mf mg mh b">mount</code>ï¼Œå› ä¸ºå®ƒä¸æ˜¯åŸºäºAPIçš„ä¸»åº”ç”¨ç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤ä¸èƒ½æˆä¸º<code class="fe me mf mg mh b">APIRouter</code>çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æœæ‚¨è¯•å›¾è¿™æ ·åšï¼Œæ‚¨ä¼šå¾—åˆ°ä¸€ä¸ªå¼‚å¸¸<code class="fe me mf mg mh b">starlette.routing.NoMatchFound</code>å¼‚å¸¸ã€‚</p><p id="e48c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åœ¨<code class="fe me mf mg mh b">routers/contact.py</code>ä¸­ï¼Œæˆ‘æ˜¯è¿™æ ·åšçš„:</p><pre class="mj mk ml mm gt mn mh mo mp aw mq bi"><span id="a73a" class="mr lc iq mh b gy ms mt l mu mv">from fastapi.responses import HTMLResponse<br/>from fastapi.templating import Jinja2Templates<br/>....</span><span id="c6a9" class="mr lc iq mh b gy mw mt l mu mv"><a class="ae kc" href="http://twitter.com/router_contacts" rel="noopener ugc nofollow" target="_blank">@router_contacts</a>.get("/view_html/{id}", response_class=HTMLResponse, summary="Returns a single contact in HTML")<br/>async def view_html(request: Request, id: int):<br/>    contact = get_contact(id=id)<br/>    if contact is None:<br/>        raise HTTPException(status_code=404, detail="Contact not found")</span><span id="c6c3" class="mr lc iq mh b gy mw mt l mu mv">return templates.TemplateResponse("view.html", {"request": request, "contact": contact})</span></pre><p id="2af3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ³¨æ„ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯<code class="fe me mf mg mh b">response_class</code>è€Œä¸æ˜¯<code class="fe me mf mg mh b">response_model</code>å‚æ•°ã€‚å½“æˆ‘è®¿é—®<code class="fe me mf mg mh b">http://localhost:8000/contacts/view_html/1</code>æ—¶ï¼Œå®ƒå‘ˆç°ä¸º:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/f85d744bdb090b73fd19018b437c40ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*T1Tg4Xc0_PdYx_ih.png"/></div></div></figure><h1 id="e340" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">ç»“è®º</h1><p id="29fd" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘è®¨è®ºäº†å¦‚ä½•åœ¨FastAPIä¸­é›†æˆåƒMySQLè¿™æ ·çš„æ•°æ®åº“å¼•æ“ã€‚æˆ‘è¿˜è®¨è®ºäº†å¦‚ä½•ä½¿ç”¨Jinja2æ¨¡æ¿åˆ›å»ºAPIçš„frontpageã€‚è¿™ç¯‡æ–‡ç« çš„ä»£ç å¯ä»¥åœ¨<a class="ae kc" href="https://github.com/kadnan/FastAPIMySQLTutorial" rel="noopener ugc nofollow" target="_blank"> Github </a>ä¸Šæ‰¾åˆ°ã€‚</p></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><p id="1899" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mx">åŸè½½äº2021å¹´1æœˆ30æ—¥</em><a class="ae kc" href="http://blog.adnansiddiqi.me/getting-started-with-fastapi-and-mysql/" rel="noopener ugc nofollow" target="_blank"><em class="mx">http://blog . adnansiddiqi . me</em></a><em class="mx">ã€‚</em></p></div></div>    
</body>
</html>