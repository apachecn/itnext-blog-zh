<html>
<head>
<title>Writing Redux in 15 lines of code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨15è¡Œä»£ç ç¼–å†™Redux</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/writing-redux-in-15-lines-of-code-6d317b521719?source=collection_archive---------5-----------------------#2018-10-11">https://itnext.io/writing-redux-in-15-lines-of-code-6d317b521719?source=collection_archive---------5-----------------------#2018-10-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="87e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2020å¹´æ›´æ–°:</strong>ä½ å¯èƒ½æœ‰å…´è¶£å­¦ä¹ å¦‚ä½•ä»å¤´å¼€å§‹æ„å»ºä¸€ä¸ªå•†åº—ï¼Œå®ƒä½¿ç”¨Redux Devtoolsï¼Œå¹¶ä½¿ç”¨ReactæŒ‚é’©åœ¨ä»»ä½•åœ°æ–¹è®¿é—®å®ƒ:</p><div class="kl km gp gr kn ko"><a href="https://medium.com/@dominictobias/using-react-hooks-for-global-redux-stores-97c092afe210" rel="noopener follow" target="_blank"><div class="kp ab fo"><div class="kq ab kr cl cj ks"><h2 class="bd ir gy z fp kt fr fs ku fu fw ip bi translated">å¯¹å…¨å±€Reduxå­˜å‚¨ä½¿ç”¨ReactæŒ‚é’©</h2><div class="kv l"><h3 class="bd b gy z fp kt fr fs ku fu fw dk translated">å½“hooksé—®ä¸–æ—¶ï¼Œæœ‰å„ç§å„æ ·çš„æ–‡ç« æš—ç¤ºReduxå¯èƒ½ä¸å†éœ€è¦ï¼Œè€Œåƒè¿™æ ·çš„åé©³â€¦</h3></div><div class="kw l"><p class="bd b dl z fp kt fr fs ku fu fw dk translated">medium.com</p></div></div><div class="kx l"><div class="ky l kz la lb kx lc ld ko"/></div></div></a></div></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><p id="a929" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»Šå¤©å†™è¿™ç¯‡æ–‡ç« çš„çµæ„Ÿæ¥è‡ªäºä¸€ä½æ–°åŠ å…¥Reactçš„åŒäº‹ï¼Œä»–æŠ±æ€¨è¯´åœ¨ä½¿ç”¨Redux(å’ŒRedux-Saga)æ—¶æœ‰å¤ªå¤šçš„æ ·æ¿æ–‡ä»¶ã€‚æ‰€ä»¥æˆ‘æŠŠè¿™äº›æ”¾åœ¨ä¸€èµ·æœ‰å‡ ä¸ªåŸå› :</p><ol class=""><li id="5c4b" class="ll lm iq jp b jq jr ju jv jy ln kc lo kg lp kk lq lr ls lt bi translated">æˆ‘ä»¬é”™è¯¯åœ°è®¤ä¸ºå†—é•¿å¯¹äºå•å‘æ•°æ®æµæ˜¯å¿…è¦çš„ã€‚</li><li id="013c" class="ll lm iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">æˆ‘ä»¬ä½¿ç”¨Reduxå¹¶ä¸äº†è§£å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</li></ol><p id="0c4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¯¹äºæˆ‘ä»¬çš„ç®€å•Reduxå•†åº—ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä¸‹åŠŸèƒ½:</p><ul class=""><li id="54c8" class="ll lm iq jp b jq jr ju jv jy ln kc lo kg lp kk lz lr ls lt bi translated">æ›´æ–°å•†åº—çŠ¶æ€çš„å‡½æ•°(å› ä¸ºæˆ‘ä»¬éœ€è¦åœ¨çŠ¶æ€æ”¹å˜æ—¶é€šçŸ¥è®¢æˆ·)â€”â€”<strong class="jp ir"><em class="ma">æ›´æ–°(storeKeyï¼ŒupdateFn) </em> </strong></li><li id="178f" class="ll lm iq jp b jq lu ju lv jy lw kc lx kg ly kk lz lr ls lt bi translated">è®¢é˜…æ›´æ–°åŠŸèƒ½â€” <strong class="jp ir"> <em class="ma">ã€è®¢é˜…(fn) </em> </strong></li><li id="a3d5" class="ll lm iq jp b jq lu ju lv jy lw kc lx kg ly kk lz lr ls lt bi translated">è·å–å†…éƒ¨çŠ¶æ€çš„å‡½æ•°(è¿™ä¸æ˜¯å¿…éœ€çš„ï¼Œä½†é¼“åŠ±ç”¨æˆ·ä¸è¦ç›´æ¥æ“ä½œçŠ¶æ€å¯¹è±¡)â€”â€”<strong class="jp ir"><em class="ma">getState()</em></strong></li></ul><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="d504" class="mk ml iq mg b gy mm mn l mo mp">class Store {<br/>  constructor(initialState) {<br/>    this.state = initialState;<br/>    this.subscriptions = [];<br/>  }<br/>  update(storeKey, updateFn) {<br/>    const nextStoreState = updateFn(this.state[storeKey]);<br/>    if (this.state[storeKey] !== nextStoreState) {<br/>      this.state[storeKey] = nextStoreState;<br/>      this.subscriptions.forEach(f =&gt; f(store));<br/>    }<br/>  }<br/>  subscribe = fn =&gt; this.subscriptions.push(fn)<br/>  getState = () =&gt; this.state<br/>}</span></pre><p id="8ee1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ma">æ³¨æ„æ²¡æœ‰æ¢è¡Œç¬¦æ¥ä¿ç•™æˆ‘å¸å¼•äººçš„æ ‡é¢˜</em></p><p id="9b38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¾ˆç®€å•ï¼Œå¯¹å§ï¼Ÿç°åœ¨ï¼Œæ¯æ¬¡å•†åº—æ›´æ–°æ—¶ï¼Œæˆ‘ä»¬éƒ½å¸Œæœ›è°ƒç”¨<em class="ma"> ReactDOM.render </em>æ¥é‡æ–°å‘ˆç°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚ç¨åæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªç±»ä¼¼äº<em class="ma"> redux-connect </em>çš„ç‰¹è®¾ç»„ä»¶æ¥åŒ…è£…æˆ‘ä»¬çš„æ ¹ç»„ä»¶ä»¥å¤„ç†æ›´æ–°ï¼Œå¹¶åœ¨åº”ç”¨ç¨‹åºä¸­çš„ä»»ä½•åœ°æ–¹ä¼ é€’å•†åº—é“å…·(ç¬¬äºŒéƒ¨åˆ†æœ‰äººçŸ¥é“å—ï¼Ÿ).</p><p id="fc7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„æ¼”ç¤ºæ¥çœ‹çœ‹è¿™ä¸€ç‚¹ã€‚</p><figure class="mb mc md me gt mq"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="7494" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°äº†ä¸‹é¢çš„æ–¹æ³•:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="ffe9" class="mk ml iq mg b gy mm mn l mo mp">increaseUserAge = () =&gt; {<br/>  this.props.store.update('user', state =&gt; ({<br/>    ...state,<br/>    age: state.age + 2,<br/>  }));<br/>}</span></pre><h1 id="5eb9" class="mt ml iq bd mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np bi translated">å¬ç€å¦ˆå¦ˆï¼Œä¸è¦è¡ŒåŠ¨ï¼</h1><p id="275b" class="pw-post-body-paragraph jn jo iq jp b jq nq js jt ju nr jw jx jy ns ka kb kc nt ke kf kg nu ki kj kk ij bi translated">ç„¶è€Œï¼Œæ•°æ®ä»ç„¶æ˜¯å•å‘æµåŠ¨çš„ã€‚æ²¡æœ‰ä»€ä¹ˆèƒ½é˜»æ­¢æˆ‘ä»¬å°†æ›´æ–°æå–åˆ°å¯é‡ç”¨ä¸”æ˜“äºæµ‹è¯•çš„åŠŸèƒ½ä¸­:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="8d1f" class="mk ml iq mg b gy mm mn l mo mp">// Somewhere else.<br/>function fetchUserDetailsAction(store) {<br/>  const { user } = store.getState();</span><span id="f6b1" class="mk ml iq mg b gy nv mn l mo mp">  if (!user.fetched) {<br/>    $get('/user/123').then(user =&gt; store.update('user', user));<br/>  }<br/>}</span><span id="a0c3" class="mk ml iq mg b gy nv mn l mo mp">// In your Component<br/>componentDidMount() {<br/>  fetchUserDetailsAction(this.props.store);<br/>}</span></pre><h1 id="9045" class="mt ml iq bd mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np bi translated">â€œä½†æˆ‘å–œæ¬¢å‡é€Ÿå™¨å’Œè¡ŒåŠ¨ğŸ¤¬"</h1><p id="99d7" class="pw-post-body-paragraph jn jo iq jp b jq nq js jt ju nr jw jx jy ns ka kb kc nt ke kf kg nu ki kj kk ij bi translated">å¦‚ä¸Šæ‰€è¿°ï¼Œå¯ä»¥æå–å¤æ‚çš„çŠ¶æ€æ›´æ–°ï¼Œè€Œæ— éœ€é‡‡å–è¡ŒåŠ¨ã€‚ä½†æ˜¯æˆ‘ä¹Ÿå–œæ¬¢å‡é€Ÿå™¨ã€‚å®ƒä»¬å°†æ¯ä¸ªå­˜å‚¨èŠ‚ç‚¹çš„æ•°æ®æ“ä½œä¿å­˜åœ¨ä¸€ä¸ªåœ°æ–¹ã€‚</p><p id="d6c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ²¡æœ‰ä»€ä¹ˆèƒ½é˜»æ­¢æˆ‘ä»¬æ‹¥æœ‰ä¸€ä¸ª<code class="fe nw nx ny mg b">reducers/user.js</code>æ–‡ä»¶:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="e022" class="mk ml iq mg b gy mm mn l mo mp">const userReducer = {<br/>  increaseUserAge: (state, ageIncrease) =&gt; ({<br/>    ...state,<br/>    age: state.age + ageIncrease,<br/>  }),<br/>  setUserEmail: (state, email) =&gt; ({<br/>    ...state,<br/>    email,<br/>  }),<br/>};</span></pre><p id="6747" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªæ¥ä»£æ›¿:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="5201" class="mk ml iq mg b gy mm mn l mo mp">increaseUserAge = () =&gt; {<br/>  this.props.store.update('user', state =&gt;<br/>    userReducer.increaseUserAge(state, 2));<br/>}</span></pre><p id="b83b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åŠ¨ä½œä¹Ÿæœ‰è¶…å‡ºé€»è¾‘å°è£…çš„ç›®çš„ï¼›<strong class="jp ir">æ—¶é—´æ—…è¡Œ</strong>ã€‚æˆ‘ä»¬å¯ä»¥è®°å½•å’Œé‡æ”¾åŠ¨ä½œï¼Œè¿™å¯¹äºè°ƒè¯•æ¥è¯´éå¸¸æ–¹ä¾¿ï¼æˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½åæˆ‘ä»¬çš„è¡Œä¸ºæ¥è¾¾åˆ°ç±»ä¼¼çš„ç›®çš„</p><p id="e997" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘æƒ³åœ¨è¿™é‡Œå±•ç¤ºä¸€äº›åŸºæœ¬åŸåˆ™ï¼Œå¹¶è¡¨æ˜å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥æ‹¥æœ‰ä¸€ä¸ªéå¸¸ç²¾ç®€çš„å•†åº—æ›´æ–°å‘¨æœŸã€‚</p><p id="d18d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬çš„ä¸‹ä¸€æ­¥å°†æ˜¯æ·»åŠ ä¸€ä¸ª<strong class="jp ir"> <em class="ma"> connect() </em> </strong>å‡½æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåŒ…è£…åœ¨ä¸€ä¸ªç‰¹è®¾ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åƒ<em class="ma"> redux-connect </em>é‚£æ ·å°†çŠ¶æ€ç‰‡æ®µä½œä¸ºé“å…·ä¼ é€’ç»™ç»„ä»¶ã€‚</p></div></div>    
</body>
</html>