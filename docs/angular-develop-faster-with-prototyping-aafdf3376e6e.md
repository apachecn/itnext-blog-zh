# è§’åº¦:ä½¿ç”¨åŸå‹å¼€å‘æ›´å¿«

> åŸæ–‡ï¼š<https://itnext.io/angular-develop-faster-with-prototyping-aafdf3376e6e?source=collection_archive---------1----------------------->

## å¿«é€Ÿå¼€å‘å’Œæµ‹è¯•åŸå‹

![](img/bc1db226d06e9efc4097d1777ee0fece.png)

# å…³äºæˆ‘ğŸ‘‹

æˆ‘ç›®å‰æ˜¯ä¸€åè½¯ä»¶å·¥ç¨‹å¸ˆï¼Œ**å’Œä¸€äº›ä¸šå†…æœ€å¥½çš„ Angular å¼€å‘äººå‘˜ä¸€èµ·åœ¨**è´¢å¯Œ 100 å¼ºå…¬å¸æ€ç§‘**å·¥ä½œã€‚æˆ‘åœ¨ä¸šä½™æ—¶é—´ç§¯æä»äº‹ä¸€äº›è¾…åŠ©é¡¹ç›®ï¼Œè¿™äº›é¡¹ç›®ç”± Angular & Firebase æä¾›åŠ¨åŠ›ã€‚**

> ğŸ”¥ [**æºä»£ç **](https://github.com/Everduin94/poc)â€”â€”æˆ–è€…ï¼Œæ¯ä¸ªè¦ç‚¹éƒ½æœ‰ä¸€ä¸ªåˆ°å…¶å¯¹åº”æ–‡ä»¶çš„é“¾æ¥

# ç›®æ ‡ğŸ—ºï¸

*   ğŸ¦ ç»´æŒä¸€å¥—é€šç”¨æ¨¡æ‹Ÿæ•°æ®
*   ğŸ§¬åœ¨ e2e (cypress)å’Œå•å…ƒ(jest)æµ‹è¯•ä¹‹é—´å…±äº«æ¨¡æ‹Ÿæ•°æ®
*   ğŸ§™â€â™‚ï¸é«˜æ•ˆåœ°ä¸ºåŸå‹å¼€å‘å’Œæµ‹è¯•åˆ›å»ºæ¨¡æ‹Ÿæ•°æ®
*   ğŸ§ªç¼–è¾‘å’Œåˆ é™¤ä¸ä¼šå½±å“å®æ—¶æ•°æ®
*   ğŸ”­æ–¹ä¾¿åœ°å­˜æ ¹ HTTP è¯·æ±‚

åŸå‹æ˜¯æŒ‡æˆ‘ä»¬åˆ©ç”¨ä¸€äº›æ ·æœ¬æˆ–æ¨¡æ‹Ÿæ•°æ®æ¥å¿«é€Ÿæµ‹è¯•ä¸€ä¸ªæƒ³æ³•ã€‚æ¯å½“æˆ‘å¼€å§‹ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œæˆ‘åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯æœ‰æ•ˆåœ°å»ºç«‹æ¶æ„åŸå‹ã€‚ â€”ä¸è¦ä¸ [JavaScript åŸå‹](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/Object_prototypes)æ··æ·†ğŸ™‚

è¿™åœ¨ä»¥ä¸‹æƒ…å†µä¸‹å¾ˆæœ‰ç”¨

*   ğŸ‡å¿«é€Ÿè¯æ˜ä¸€ä¸ªæƒ³æ³•çš„æ¦‚å¿µï¼Œè€Œä¸å½±å“å®æ—¶æ•°æ®
*   ğŸ–¥ï¸:ç›¸åº”çš„ API è¿˜æ²¡æœ‰å®‰è£…åœ¨åç«¯
*   ğŸ§ªåˆ©ç”¨çœŸå®æ•°æ®è¿›è¡Œå•å…ƒå’Œ e2e æµ‹è¯•

é¢å¤–çš„å¥½å¤„æ˜¯ï¼Œè¿™ä¸ªè®¾ç½®å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ä¸€ç»„æ¨¡æ‹Ÿæ•°æ®è¿›è¡Œæ‰€æœ‰çš„æ‰‹å·¥ã€å•å…ƒå’Œ e2e æµ‹è¯•ã€‚â€”è¿™æ„å‘³ç€**æˆ‘ä»¬ä¸å¿…ä¸º e2e æµ‹è¯•åˆ›å»º JSON fixture**ï¼Œå¹¶ä¸”**å¯ä»¥åˆ©ç”¨æ¥è‡ªæˆ‘ä»¬æ‰‹åŠ¨æµ‹è¯•**çš„ç›¸åŒæ•°æ®ã€‚

# è£…ç½®ğŸ”§

ä»¥ä¸‹ä»…åœ¨åˆ©ç”¨ **HttpClient** æ—¶æœ‰æ•ˆã€‚å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ *Angular & Firebase* å‚è§[Angular Prototyping:Firebase Emulator&Cypress](https://erxk.medium.com/angular-prototyping-firebase-emulator-with-cypress-9ff6f5b3bf8a)ã€‚

åœ¨å†…å­˜ä¸­å®‰è£…*è§’åº¦ API:*

```
**npm i angular-in-memory-web-api**
```

## å†…å­˜ API ä¸­çš„ Angular æ˜¯ä»€ä¹ˆï¼Ÿ

å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè¿è¡Œåœ¨æ‚¨çš„æœºå™¨ä¸Šçš„ä¼ªåç«¯ï¼ŒçŸ¥é“å¦‚ä½•æ¨¡ä»¿ HttpClient ä» Angular æœåŠ¡è¿”å›æ•°æ®ã€‚

æœ¬æ–‡å°†å…³æ³¨å¦‚ä½•ä½¿ç”¨å®ƒæ¥åŸå‹åŒ–æµ‹è¯•ï¼Œè€Œä¸æ˜¯æ·±å…¥åº“æœ¬èº«ã€‚

# é…ç½®âš™ï¸

åˆ›å»ºä¸€ä¸ªè§’åº¦æœåŠ¡æ¥ç®¡ç†åŸå‹æ•°æ®ã€‚

[æ¥æº](https://github.com/Everduin94/poc/blob/main/libs/rest/src/lib/in-memory-database.service.ts)

ä¸Šè¿°é…ç½®ä½¿æˆ‘ä»¬èƒ½å¤Ÿ:

*   é€šè¿‡`httpClient.get('api/tickets')`è·å–æ‰€æœ‰é—¨ç¥¨
*   é€šè¿‡`httpClient.get('api/tickets/ID')`ä¹°ç¥¨
*   é€šè¿‡`httpClient.delete('api/tickets/ID')`åˆ é™¤è½¦ç¥¨
*   é€šè¿‡`httpClient.put('api/tickets/ID', DATA)`æ›´æ–°è½¦ç¥¨

è¦è®¾ç½®æœåŠ¡ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒå¯¼å…¥åˆ°æˆ‘ä»¬çš„`app.module`ä¸­ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªæ ‡å¿—æ¥ç¡®å®šå®ƒæ˜¯æ‰“å¼€è¿˜æ˜¯å…³é—­ã€‚â€”å»ºè®®åœ¨æ‚¨çš„*ç¯å¢ƒ*æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªæ ‡å¿—ï¼Œä»¥ç¡®å®šå†…å­˜ API åº”è¯¥æ‰“å¼€è¿˜æ˜¯å…³é—­ã€‚

[æ¥æº](https://github.com/Everduin94/poc/blob/main/apps/demo/src/app/app.module.ts#L33-L38)

ä¸ºäº†ä½¿è¿™ç¯‡æ–‡ç« ç®€çŸ­æ‰¼è¦ï¼Œæˆ‘å·²ç»åˆ›å»ºäº†ä¸€ç¯‡ç®€çŸ­çš„å•ç‹¬çš„é…å¥—æ–‡ç« ï¼Œä»¥é˜²æ‚¨ä¸ç¡®å®š[**å¦‚ä½•è®¾ç½®è‡ªå®šä¹‰ç¯å¢ƒ**](https://erxk.medium.com/nx-setup-a-custom-environment-116342b7815b) ã€‚â€”è¿™å…è®¸æˆ‘ä»¬æ‹¥æœ‰ç‹¬ç«‹çš„å¼€å‘ã€ç”Ÿäº§å’ŒåŸå‹ç¯å¢ƒ

# ä½¿ç”¨

åœ¨å†…å­˜ API **æ‰“å¼€çš„æƒ…å†µä¸‹è¿è¡Œæ‚¨çš„é¡¹ç›®ã€‚(**ğŸ’¡*åŸå‹*æ˜¯æˆ‘å®šåˆ¶ç¯å¢ƒçš„åå­—ã€‚è¿™å°†æ˜¯ä½ ç»™å®ƒèµ·çš„åå­—)

```
// Nx Project
**nx run APP:serve:prototype**
// Without Nx
**ng serve configuration=prototype**
```

ä¸‹é¢çš„ä»£ç æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹çœ‹æˆ‘ä»¬çš„æ¨¡æ‹Ÿå™¨å·¥ä½œã€‚

*   ğŸ§™ **åœ¨ init ä¸Šè°ƒç”¨** `**http.get(â€˜api/ticketsâ€™)**`(è¿™å°†è°ƒç”¨å†…å­˜ API)
*   ğŸ”‹**å°†** `**tickets**` **è®¾ç½®ä¸ºæ¥è‡ªå†…å­˜ API çš„å“åº”**
*   ğŸŒˆåœ¨æ¨¡æ¿ä¸­çš„ç¥¨ä¸Šå¾ªç¯ï¼Œ**æ˜¾ç¤ºç¥¨å€¼**ã€‚

[ç»„ä»¶æº](https://github.com/Everduin94/poc/blob/main/libs/rest/src/lib/ticket/ticket.component.ts) | [æœåŠ¡æº](https://github.com/Everduin94/poc/blob/main/libs/rest/src/lib/ticket/ticket.service.ts)

æ¥ä¸‹æ¥çš„éƒ¨åˆ†å°†ç€çœ¼äºä½¿ç”¨æˆ‘ä»¬åˆšåˆšåœ¨æˆ‘ä»¬çš„å•å…ƒå’Œ e2e æµ‹è¯•ä¸­ä½¿ç”¨çš„**ã€**ç›¸åŒçš„æ•°æ®é›†ã€‚

# åœ¨ç¬‘è¯ä¸­ä½¿ç”¨(å•å…ƒæµ‹è¯•)ğŸƒ

æˆ‘ä»¬å°†é€šè¿‡å‘æˆ‘ä»¬çš„*æµ‹è¯•åºŠ*æ·»åŠ `HttpClientInMemoryWebApiModule`æ¥è®¾ç½®æˆ‘ä»¬çš„æµ‹è¯•ï¼Œç±»ä¼¼äºæˆ‘ä»¬åœ¨`app.module`ä¸­è®¾ç½®å®ƒçš„æ–¹å¼ã€‚æ³¨æ„ï¼Œ**æˆ‘ä»¬ä¸å¿…åœ¨æµ‹è¯•æ–‡ä»¶ä¸­å‘ HttpClient** æ·»åŠ  mocks æˆ–å­˜æ ¹è¯·æ±‚ã€‚

åœ¨æˆ‘ä»¬çš„*inmemorydataservice*ä¸­ï¼Œæˆ‘å®šä¹‰äº† 5 å¼ ç¥¨ã€‚æˆ‘ä»¬å°†**ä½¿ç”¨ä¸Šä¸€èŠ‚**ä¸­çš„ç›¸åŒç»„ä»¶ã€‚å›æƒ³ä¸€ä¸‹ï¼Œç»„ä»¶åœ¨ *ngOnInit ä¸­è°ƒç”¨äº†`http.get(â€˜ticketsâ€™)`ã€‚*æˆ‘ä»¬**æœŸæœ›ç»„ä»¶åœ¨ init ä¸Šè¿”å›æ‰€æœ‰ 5 å¼ ç¥¨**ã€‚

[æ¥æº](https://github.com/Everduin94/poc/blob/main/libs/rest/src/lib/ticket/ticket.component.spec.ts)

```
// NX **nx run YOUR_APP:test** // Without NX **npm run test**
```

![](img/008cddca1caeba88c4ad3cbcbb766ef6.png)

5 å¼ ç¥¨å…¨éƒ¨é€€å›

è¿™åœ¨æµ‹è¯•æ—¶æä¾›äº†ä¸€äº›å¥½å¤„ã€‚

*   ğŸ§¼è‡ªåŠ¨å¤„ç†**è®¾ç½®å’Œæ‹†é™¤**æ•°æ®
*   ğŸ§™ç›´æ¥è°ƒç”¨æˆ‘ä»¬çš„ç»„ä»¶**ï¼Œè€Œæ²¡æœ‰æ˜¾å¼åˆ›å»ºæ¨¡æ‹Ÿ**
*   ğŸ¦ ç®€å•åœ°é€šè¿‡ä½¿ç”¨å¦ä¸€ç§æœåŠ¡æ¥ä¼ é€æ•°æ®é›†

åœ¨å¤§å‹å›¢é˜Ÿä¸­å·¥ä½œæ—¶ï¼Œæˆ‘çœ‹åˆ°äº†ç»„ç»‡æ¨¡æ‹Ÿæ•°æ®çš„æ··åˆç­–ç•¥:JSON fixturesã€å¤§å‹ Javascript æ–‡ä»¶ã€spec æ–‡ä»¶ä¸­çš„å†…åµŒæ¨¡æ‹Ÿæ•°æ®â€”â€”è¿™ä¸ªå·¥ä½œæµæ¸…æ¥šåœ°è¡¨æ˜äº†æ¨¡æ‹Ÿæ•°æ®åº”è¯¥å­˜åœ¨äºä½•å¤„ï¼Œä¸ºå›¢é˜Ÿæä¾›äº†**ç»„ç»‡ä¼˜åŠ¿**ã€‚

è¿™ä¸ªä¾‹å­éå¸¸ç®€å•ï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªè¯æ˜ï¼Œ**å‡ å¹´å‰æˆ‘åœ¨ä¸€ä¸ªä¸“ä¸šé¡¹ç›®ä¸­å¹¿æ³›ä½¿ç”¨äº†è¿™ä¸ªç­–ç•¥**ï¼Œåœ¨é‚£é‡Œæˆ‘æœ‰èƒ½åŠ›åšå‡ºè¿™æ ·çš„æ¶æ„å†³ç­–ã€‚â€”åœ¨æˆ‘çœ‹æ¥ï¼Œå®ƒç”šè‡³åœ¨å¤æ‚çš„åº”ç”¨ç¨‹åºä¸­ä¹Ÿèƒ½å·¥ä½œï¼Œå› ä¸ºå†…å­˜ API æœ‰å¦‚æ­¤å¤§çš„çµæ´»æ€§ã€‚

# åœ¨æŸæ ‘ä¸­ä½¿ç”¨(E2E è¯•éªŒ*)ğŸŒ³

è¦åœ¨ä¸Šç”¨å†…å­˜ API **è¿è¡Œ Cypressï¼Œæˆ‘ä»¬éœ€è¦åœ¨è¿è¡Œ Cypress æ—¶æŒ‡å‘åŸå‹é…ç½®/ç¯å¢ƒã€‚**

å¯¹äºé Nx é¡¹ç›®ï¼Œæˆ‘ä¸€èˆ¬å…ˆè¿è¡Œ`ng serve --configuration="YOUR_ENV"`ï¼Œç„¶åå•ç‹¬è¿è¡Œ`cypress open`ã€‚

å¯¹äº Nx é¡¹ç›®ï¼Œåœ¨ä½ çš„**APP-e2e***project . JSON*ä¸­è®¾ç½®`devServerTarget`ä¸ºä½ çš„åŸå‹ç¯å¢ƒå[ã€æºã€‘](https://github.com/Everduin94/poc/blob/main/apps/demo-e2e/project.json#L6-L11)[å¦‚ä½•è®¾ç½®è‡ªå®šä¹‰ç¯å¢ƒ](https://erxk.medium.com/nx-setup-a-custom-environment-116342b7815b)

```
**"devServerTarget": "APP:serve:prototype"**
```

ç°åœ¨ Cypress åº”è¯¥ä½¿ç”¨å†…å­˜ API è¿è¡Œäº†:

```
**nx run APP-e2e:e2e --watch**
```

æˆ‘åœ¨æˆ‘æ‰€æœ‰çš„é™„å¸¦é¡¹ç›® E2E æµ‹è¯•ä¸­ä½¿ç”¨äº†è¿™ä¸ªç­–ç•¥ã€‚ä¸‹é¢çš„ä¾‹å­ä½¿ç”¨äº† 0 json fixtures å’Œ 0 cypress æˆªè·ã€‚è¿™åœ¨æˆ‘çš„é¡¹ç›®ä¸­æå¤§åœ°å¸®åŠ©äº†æˆ‘æ„å»ºæ–°æƒ³æ³•çš„åŸå‹ï¼Œæµ‹è¯•ç‰¹æ€§ï¼Œå¹¶ç»´æŠ¤æœ‰ç”¨çš„æ¨¡æ‹Ÿæ•°æ®ã€‚

![](img/816fabfa5b5414ae162805edd8a7c2c1.png)

E2E çš„ä¾‹å­

# ç»“è®º

ä½œä¸ºä¸€åå¼€å‘äººå‘˜ï¼Œä¸€ä¸ªå¥½çš„åŸå‹å·¥ä½œæµå¯¹æˆ‘æ¥è¯´æ˜¯å¿…ä¸å¯å°‘çš„ã€‚è¿™é‡Œåˆ—å‡ºçš„å†…å®¹æ²¡æœ‰ç¡¬æ€§è§„å®šã€‚ä»¥é€‚åˆæ‚¨å·¥ä½œæµç¨‹çš„æ–¹å¼ä½¿ç”¨è¿™äº›å·¥å…·ã€‚

æˆ‘ç¦»å¼€å†™æ–‡ç« æœ‰å¾ˆé•¿ä¸€æ®µæ—¶é—´äº†ï¼Œä¸€ç›´åœ¨åšå¤§é‡çš„å·¥ä½œ:Angularã€Firebaseã€Neovimã€Linux å’Œ Luaã€‚å¦‚æœä½ æœ‰ä»€ä¹ˆæƒ³å¬æˆ‘è§£é‡Šçš„ï¼Œæˆ–è€…æ˜¯åˆ—è¡¨ä¸­çš„æŸä¸ªç‰¹å®šè¯é¢˜ï¼Œè¯·åœ¨è¯„è®ºä¸­å‘Šè¯‰æˆ‘ï¼

# å‚è€ƒ

> *æ³¨æ„ï¼ŒE2E åœ¨è¿™é‡Œè¢«å¹¿æ³›ä½¿ç”¨ã€‚ä»æŠ€æœ¯ä¸Šæ¥è¯´ï¼Œæˆ‘ç§°ä¹‹ä¸ºâ€œåŠŸèƒ½æ€§â€æµ‹è¯•ï¼Œå› ä¸ºå®ƒæ²¡æœ‰è§¦åŠä¸€ä¸ªæ´»åŠ¨çš„åç«¯ã€‚

*   [ç¼©ç•¥å›¾ä¸­çš„å›¾æ ‡](https://lordicon.com/icons/wired/flat)
*   [åœ¨å†…å­˜ API æ–‡æ¡£ä¸­](https://github.com/angular/in-memory-web-api)
*   [å¦‚ä½•ç”¨ Nx è®¾ç½®è‡ªå®šä¹‰ç¯å¢ƒ](https://erxk.medium.com/nx-setup-a-custom-environment-116342b7815b)

> â˜ï¸[flotes](https://flotes.app)â€”â€”å°è¯•æ¼”ç¤ºï¼Œä¸éœ€è¦ç™»å½•ã€‚æˆ–è€…å…è´¹æŠ¥åã€‚Flotes æ˜¯æˆ‘è®°ç¬”è®°å’Œé«˜æ•ˆå­¦ä¹ çš„æ–¹å¼ï¼Œå³ä½¿åœ¨æˆ‘å¾ˆå¿™çš„æ—¶å€™ã€‚

![](img/8e468f6e74135bbbc2ecbfce7e2db2bf.png)

[Flotes](https://flotes.app)

*   [æºä»£ç ](https://github.com/Everduin94/poc)