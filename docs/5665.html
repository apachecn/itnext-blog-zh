<html>
<head>
<title>K0s Cluster Without Internet Access</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æ— äº’è”ç½‘æ¥å…¥çš„K0sé›†ç¾¤</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/k0s-cluster-without-internet-access-ac0dda08aa63?source=collection_archive---------4-----------------------#2021-04-27">https://itnext.io/k0s-cluster-without-internet-access-ac0dda08aa63?source=collection_archive---------4-----------------------#2021-04-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9223" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">è®©æˆ‘ä»¬çœ‹çœ‹k0så¦‚ä½•è®©æ°”éš™å®‰è£…å˜å¾—ç®€å•</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b8028416403fa5532add38087a66cb3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uKcGMA7kC_BCe7Blkk0fow.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae ky" href="https://unsplash.com/@riiyad?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">å¡æ¯”å°”Â·æ‹‰èµ«æ›¼Â·é‡Œäºšå¾·</a>åœ¨<a class="ae ky" href="https://unsplash.com/s/photos/network?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>æ‹æ‘„</figcaption></figure><p id="0460" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ğŸ”¥æ ¹æ®æˆ‘åœ¨LinkedInä¸Šçš„ä¸€äº›è¯„è®ºï¼Œæˆ‘å¿…é¡»å¼ºè°ƒï¼Œè¿™ç¯‡æ–‡ç« åªä»‹ç»äº†ä¸€ç§éå¸¸ç®€å•çš„æ°”éš™å®‰è£…æ–¹æ³•ã€‚å®ƒå¹¶ä¸ä¸€å®šæ˜¯å»ºç«‹å¼¹æ€§/å®‰å…¨/å¯è§‚å¯Ÿ/å¯å‡çº§ç”Ÿäº§é›†ç¾¤çš„å®Œæ•´æŒ‡å—ã€‚</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="ecbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">åœ¨å…·æœ‰é«˜åº¦å®‰å…¨æ€§çº¦æŸçš„å…¬å¸ä¸­ï¼Œå¯èƒ½éœ€è¦åœ¨æ²¡æœ‰ä»»ä½•äº’è”ç½‘æ¥å…¥çš„æœºå™¨ä¸Šå®‰è£…Kubernetesé›†ç¾¤ã€‚è¿™æ„å‘³ç€å¿…é¡»é¢„å…ˆä»å¦ä¸€å°æœºå™¨ä¸Šä¸‹è½½è®¾ç½®é›†ç¾¤æ‰€éœ€çš„æ‰€æœ‰ä¸œè¥¿ï¼Œç„¶åä»¥å®‰å…¨çš„æ–¹å¼(ä¾‹å¦‚ï¼Œä½¿ç”¨USBå¯†é’¥ï¼Œä»è€Œé€šè¿‡ç‰©ç†æ–¹å¼è®¿é—®æœºå™¨)å¤åˆ¶åˆ°æ°”éš™æœºå™¨ä¸Šã€‚</p><p id="766b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">åœ¨è¿™ç¯‡çŸ­æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£<a class="ae ky" href="https://k0sproject.io" rel="noopener ugc nofollow" target="_blank"> k0s </a>å¦‚ä½•ç®¡ç†æ°”éš™å®‰è£…ã€‚k0s 0.12(ç«æ˜Ÿ2021)å¢åŠ äº†è¿™ä¸ªåŠŸèƒ½ã€‚æˆ‘ä»¬å°†ç”¨ä½¿ç”¨<a class="ae ky" href="https://multipass.run" rel="noopener ugc nofollow" target="_blank">å¤šé</a>åˆ›å»ºçš„2ä¸ªè™šæ‹Ÿæœºæ¥è¯´æ˜æ•´ä¸ªè¿‡ç¨‹:</p><ul class=""><li id="56b2" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu mh mi mj mk bi translated">ç¬¬ä¸€ä¸ªå«åš<em class="ml">å·¥å…·</em>ï¼Œå¯ä»¥ä¸Šç½‘ã€‚å®ƒå°†ç”¨äºè·å–k0säºŒè¿›åˆ¶æ–‡ä»¶å’Œè®¾ç½®é›†ç¾¤æ‰€éœ€çš„æ‰€æœ‰æ˜ åƒ</li><li id="525c" class="mc md it lb b lc mm lf mn li mo lm mp lq mq lu mh mi mj mk bi translated">ç¬¬äºŒä¸ªåä¸º<em class="ml"> airgap </em>çš„æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿçš„airgapæœºå™¨(æˆ‘ä»¬å‡è®¾è¿™ä¸ªæ²¡æœ‰äº’è”ç½‘æ¥å…¥)</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="d0f0" class="mr ms it bd mt mu mv dn mw mx my dp mz li na nb nc lm nd ne nf lq ng nh ni nj bi translated">è·å–å›¾åƒ</h2><p id="1a7f" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å°†ä»ä¸€å°å¯ä»¥è®¿é—®äº’è”ç½‘çš„æœºå™¨ä¸Šä¸‹è½½k0säºŒè¿›åˆ¶æ–‡ä»¶å’Œæ‰€æœ‰éœ€è¦çš„å›¾åƒã€‚</p><p id="a9b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿæœº(å¯åŠ¨å¹¶è¿è¡Œä¸åˆ°ä¸€åˆ†é’Ÿ),å¹¶åœ¨å…¶ä¸­è£…å…¥ä¸€ä¸ªshell:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="4260" class="mr ms it nq b gy nu nv l nw nx">$ multipass launch -n tools</span><span id="e377" class="mr ms it nq b gy ny nv l nw nx">$ multipass shell tools</span></pre><p id="37df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç”¨ä¸‹é¢çš„å‘½ä»¤ä¸‹è½½k0säºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¿™ä¸ªå‘½ä»¤ä¹Ÿå°†k0så®‰è£…åˆ°<em class="ml"> /usr/local/bin: </em></p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="0b57" class="mr ms it nq b gy nu nv l nw nx"><strong class="nq iu">ubuntu@tools:~$ curl -sSLf https://get.k0s.sh | sudo sh</strong><br/>...<br/>k0s is now executable in /usr/local/bin</span></pre><p id="515c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è¿™é‡Œä¸éœ€è¦è¿è¡Œk0sï¼Œå› ä¸ºæˆ‘ä»¬åªä½¿ç”¨è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶æ¥è·å–è¿è¡Œé›†ç¾¤æ‰€éœ€çš„æ˜ åƒåˆ—è¡¨ã€‚è¯¥åˆ—è¡¨å¯ä½¿ç”¨å¦‚ä¸‹æ‰€ç¤ºçš„<code class="fe nz oa ob nq b">airgap</code>å­å‘½ä»¤è·å¾—:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="ba09" class="mr ms it nq b gy nu nv l nw nx"><strong class="nq iu">ubuntu@tools:~$ k0s airgap list-images</strong><br/>docker.io/calico/cni:v3.16.2<br/>docker.io/calico/kube-controllers:v3.16.2<br/>docker.io/calico/node:v3.16.2<br/>us.gcr.io/k8s-artifacts-prod/kas-network-proxy/proxy-agent:v0.0.13<br/>docker.io/coredns/coredns:1.7.0<br/>k8s.gcr.io/kube-proxy:v1.20.4<br/>gcr.io/k8s-staging-metrics-server/metrics-server:v0.3.7<br/>k8s.gcr.io/pause:3.2<br/>docker.io/cloudnativelabs/kube-router:v1.1.1<br/>quay.io/k0sproject/cni-node:0.1.0</span></pre><p id="6527" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘ä»¬ä¸ä¼šæ·±å…¥æ¯ä¸ªæ˜ åƒçš„ç»†èŠ‚ï¼Œå®ƒä»¬åŸºæœ¬ä¸Šè¢«k0sç”¨æ¥è¿è¡Œé›†ç¾¤çš„æ§åˆ¶å¹³é¢(åŠ ä¸Šä¸€äº›é¢å¤–çš„é¡¹ç›®ï¼Œå¦‚metrics-serverï¼Œä¸€ä¸ªç”¨æ¥è·å–é›†ç¾¤æŒ‡æ ‡çš„æµè¡Œå·¥å…·)ã€‚</p><p id="5d86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">0.13 <code class="fe nz oa ob nq b">kube-router</code>çš„â„¹ï¸æ˜¯k0sé»˜è®¤ä½¿ç”¨çš„CNIæ’ä»¶</p><p id="506d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œæˆ‘ä»¬å®‰è£…äº†Dockerï¼Œä»¥ä¾¿æ›´å®¹æ˜“ä¸‹è½½å›¾åƒã€‚åœ¨Linuxä¸»æœºä¸Šå®‰è£…Dockerï¼Œä¸‹é¢çš„å‘½ä»¤éå¸¸æ–¹ä¾¿:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="fe6b" class="mr ms it nq b gy nu nv l nw nx"><strong class="nq iu">ubuntu@tools:~$ </strong>curl -sSLf https://get.docker.com | sudo sh</span></pre><p id="9057" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘ä»¬å°†é»˜è®¤çš„<code class="fe nz oa ob nq b">ubuntu</code>ç”¨æˆ·æ·»åŠ åˆ°<code class="fe nz oa ob nq b">docker</code>ç»„ä¸­:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="fb1c" class="mr ms it nq b gy nu nv l nw nx"><strong class="nq iu">ubuntu@tools:~$ </strong>sudo usermod -aG docker ubuntu</span></pre><p id="2b71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">é€€å‡ºshellå¹¶å¯åŠ¨æ–°çš„shellåï¼Œæˆ‘ä»¬å¯ä»¥ä»<code class="fe nz oa ob nq b">ubuntu</code>ç”¨æˆ·é‚£é‡Œè·å–æ‰€æœ‰å›¾åƒ:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="51f5" class="mr ms it nq b gy nu nv l nw nx"><strong class="nq iu">ubuntu@tools:~$ </strong>for image in $(k0s airgap list-images); do<br/>  docker image pull $image<br/>done</span></pre><p id="d192" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰è¿™äº›å›¾åƒçš„å½’æ¡£ã€‚è¿™å¯ä»¥ä½¿ç”¨<code class="fe nz oa ob nq b">docker image save</code>å­å‘½ä»¤å®Œæˆï¼Œå…¶ç”¨æ³•è¯¦è¿°å¦‚ä¸‹:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="e842" class="mr ms it nq b gy nu nv l nw nx"><strong class="nq iu">ubuntu@tools:~$ docker image save --help</strong></span><span id="3f98" class="mr ms it nq b gy ny nv l nw nx">Usage:  docker image save [OPTIONS] IMAGE [IMAGE...]</span><span id="5df2" class="mr ms it nq b gy ny nv l nw nx">Save one or more images to a tar archive (streamed to STDOUT by default)</span><span id="361f" class="mr ms it nq b gy ny nv l nw nx">Options:<br/>  -o, --output string   Write to a file, instead of STDOUT</span></pre><p id="266a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä»¥ä¸‹å‘½ä»¤åˆ›å»ºäº†<code class="fe nz oa ob nq b">images.tar</code>å½’æ¡£æ–‡ä»¶:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="f738" class="mr ms it nq b gy nu nv l nw nx"><strong class="nq iu">ubuntu@tools:~$</strong> docker image save $(k0s airgap list-images) -o images.tar</span></pre><p id="da55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å½’æ¡£åŒ…å«æ‰€æœ‰å›¾åƒï¼Œå› æ­¤éå¸¸æ²‰é‡:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="94ba" class="mr ms it nq b gy nu nv l nw nx"><strong class="nq iu">ubuntu@k0s:~$ ls -lrt<br/></strong>total 759408<br/>-rw------- 1 ubuntu ubuntu 777626624 Apr 26 15:29 images.tar</span></pre><p id="62cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å°†æŠŠk0säºŒè¿›åˆ¶æ–‡ä»¶å’Œå½’æ¡£æ–‡ä»¶å¤åˆ¶åˆ°Air-Gapæœºå™¨ï¼Œå¹¶è¿è¡Œk0sé›†ç¾¤ã€‚</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="9559" class="mr ms it bd mt mu mv dn mw mx my dp mz li na nb nc lm nd ne nf lq ng nh ni nj bi translated">å°†å›¾åƒå¤åˆ¶åˆ°æ°”éš™æœº</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/0dca098bdaf72b5e71108aef5e8e8da7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*HKqBtMSN1UCHCdy5ko6e7A.jpeg"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">å°†æ•°æ®å¤åˆ¶åˆ°æ°”éš™æœºå¹¶ä¸æ€»æ˜¯å®¹æ˜“çš„</figcaption></figure><p id="7e31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ ¹æ®æ°”éš™ç”µæœºçš„å®‰å…¨çº§åˆ«ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å¯¹ç”µæœºè¿›è¡Œç‰©ç†è®¿é—®ï¼Œå¹¶ä»USBé—ªå­˜ç›˜å¤åˆ¶æ•°æ®ã€‚å½“ç„¶ï¼Œæœ‰æ—¶æ¥è‡ªå¦ä¸€å°æœºå™¨çš„sshè¿æ¥ä¹Ÿæ˜¯å¯èƒ½çš„ã€‚</p><p id="d28f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªæ–°çš„å¤šé€šé“è™šæ‹Ÿæœºæ¥æ¨¡æ‹Ÿä¸€ä¸ªæ°”éš™ç”µæœº:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="a6e5" class="mr ms it nq b gy nu nv l nw nx">$ multipass launch -n airgap</span></pre><p id="edce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æœ¬åœ°æ–‡ä»¶å¤¹å’ŒMultipass' transferå‘½ä»¤å°†èµ„äº§ä»<code class="fe nz oa ob nq b">tools</code>å¤åˆ¶åˆ°<code class="fe nz oa ob nq b">airgap</code>:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="1fea" class="mr ms it nq b gy nu nv l nw nx"># Create a local shared folder<br/>mkdir -p /tmp/shared/k0s</span><span id="f192" class="mr ms it nq b gy ny nv l nw nx"># Copy assets from tools to the shared folder<br/>multipass transfer tools:/usr/local/bin/k0s /tmp/shared/k0s<br/>multipass transfer tools:/home/ubuntu/images.tar /tmp/shared/k0s</span><span id="b75a" class="mr ms it nq b gy ny nv l nw nx"># Copy assets from the shared folder to airgap<br/>multipass transfer /tmp/shared/k0s/k0s airgap:/tmp<br/>multipass transfer /tmp/shared/k0/images.tar airgap:/tmp</span></pre><p id="0432" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¸€æ—¦å¯ä»¥ä»æ°”éš™æœºè®¿é—®èµ„äº§ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒä»¬æ”¾å…¥æ­£ç¡®çš„ä½ç½®:</p><ul class=""><li id="6887" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu mh mi mj mk bi translated">k0säºŒè¿›åˆ¶éœ€è¦ç§»åˆ°<em class="ml"> /usr/local/bin/ </em></li></ul><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="83d3" class="mr ms it nq b gy nu nv l nw nx">$ multipass exec airgap -- /bin/bash -c "<br/>  sudo mv /tmp/k0s /usr/local/bin/<br/>  sudo chmod +x /usr/local/bin/k0s<br/>"</span></pre><ul class=""><li id="a81b" class="mc md it lb b lc ld lf lg li me lm mf lq mg lu mh mi mj mk bi translated">å›¾åƒæ¡£æ¡ˆéœ€è¦ç§»åŠ¨åˆ°æ–°çš„<em class="ml"> /var/lib/k0s/images </em>æ–‡ä»¶å¤¹ä¸­</li></ul><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="4446" class="mr ms it nq b gy nu nv l nw nx">$ multipass exec airgap -- /bin/bash -c "<br/>  <!-- -->sudo mkdir -p /var/lib/k0s/images<br/>  sudo mv /tmp/images.tar /var/lib/k0s/images/<br/>"</span></pre><p id="6ce4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ‰€æœ‰çš„èµ„äº§åœ¨æ°”éš™æœºä¸Šéƒ½ä¸å¯ç”¨ã€‚åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¿™äº›ç»„ä»¶è¿è¡Œä¸€ä¸ªé›†ç¾¤ã€‚</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="5e70" class="mr ms it bd mt mu mv dn mw mx my dp mz li na nb nc lm nd ne nf lq ng nh ni nj bi translated">åœ¨æ°”éš™ç”µæœºä¸Šè¿è¡Œk0s</h2><p id="c308" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">é¦–å…ˆæˆ‘ä»¬åœ¨<code class="fe nz oa ob nq b">airgap</code>ä¸Šå¾—åˆ°ä¸€ä¸ªshell</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="254e" class="mr ms it nq b gy nu nv l nw nx">$ multipass shell airgap</span></pre><p id="015c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå°†<code class="fe nz oa ob nq b">default_pull_policy</code>è®¾ç½®ä¸º<code class="fe nz oa ob nq b">Never</code>ï¼Œä»¥ç¡®ä¿å¦‚æœå›¾åƒä¸å­˜åœ¨ï¼Œå°±ä¸ä¼šä»äº’è”ç½‘ä¸Šä¸‹è½½ã€‚</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="b45a" class="mr ms it nq b gy nu nv l nw nx"><strong class="nq iu">ubuntu@airgap:~$ </strong>cat &lt;&lt;EOF &gt; /tmp/k0s.yaml<br/>apiVersion: k0s.k0sproject.io/v1beta1<br/>kind: Cluster <br/>metadata:   <br/>  name: k0s <br/>spec:   <br/>  images:     <br/><strong class="nq iu">    default_pull_policy: Never<br/></strong>EOF</span></pre><p id="a465" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ç„¶åï¼Œæˆ‘ä»¬ç…§å¸¸å®‰è£…k0s(åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†é€‰æ‹©å•ä¸ªèŠ‚ç‚¹),å¹¶æä¾›é…ç½®æ–‡ä»¶:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="08e6" class="mr ms it nq b gy nu nv l nw nx"><strong class="nq iu">ubuntu@airgap:~$ sudo k0s install controller --single -c /tmp/k0s.yaml</strong><br/>INFO[2021-04-26 20:54:49] no config file given, using defaults<br/>INFO[2021-04-26 20:54:49] creating user: etcd<br/>INFO[2021-04-26 20:54:49] creating user: kube-apiserver<br/>INFO[2021-04-26 20:54:49] creating user: konnectivity-server<br/>INFO[2021-04-26 20:54:49] creating user: kube-scheduler<br/>INFO[2021-04-26 20:54:49] Installing k0s service</span></pre><p id="932d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ç„¶åï¼Œæˆ‘ä»¬å¯åŠ¨systemdè¿›ç¨‹:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="7536" class="mr ms it nq b gy nu nv l nw nx">$ sudo systemctl start k0scontroller</span></pre><p id="4f6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æœ€åï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥ç¾¤é›†æ˜¯å¦æ­£å¸¸è¿è¡Œ</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="e2b0" class="mr ms it nq b gy nu nv l nw nx">export KUBECONFIG=/var/lib/k0s/pki/admin.conf</span><span id="0452" class="mr ms it nq b gy ny nv l nw nx"><strong class="nq iu">$ sudo k0s kubectl get no<br/></strong>NAME     STATUS   ROLES    AGE     VERSION<br/>airgap   Ready    &lt;none&gt;   2m28s   v1.20.5-k0s1</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="977e" class="mr ms it bd mt mu mv dn mw mx my dp mz li na nb nc lm nd ne nf lq ng nh ni nj bi translated">å…³é”®å¤–å–</h2><p id="dbf0" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">å‡ºäºå®‰å…¨åŸå› ï¼Œæ°”éš™å®‰è£…æœ‰æ—¶æ˜¯å¿…è¦ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨æœ¬æ–‡ä¸­çœ‹åˆ°çš„ï¼Œk0sçš„æœ€æ–°ç‰ˆæœ¬é€šè¿‡æ–°çš„<code class="fe nz oa ob nq b">airgap</code>å­å‘½ä»¤ä½¿æ•´ä¸ªè¿‡ç¨‹å˜å¾—éå¸¸ç®€å•ã€‚</p></div></div>    
</body>
</html>