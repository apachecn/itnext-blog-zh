# é€‚åˆåˆå­¦è€…çš„åœ°å½¢

> åŸæ–‡ï¼š<https://itnext.io/terraform-for-beginners-dd8701c1ebdd?source=collection_archive---------0----------------------->

![](img/b0155423995db249facbaa33eac66ecb.png)

# ä»‹ç»

ä½ å¬è¯´è¿‡ Terraformï¼Œå¯¹å§ï¼Ÿä½†æ˜¯ä½ å®é™…ä¸Šä¸çŸ¥é“å®ƒæ˜¯ä»€ä¹ˆæˆ–è€…å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿå¥½äº†ï¼Œè¯»è€…æœ‹å‹ä»¬ï¼Œè¯·ä¸ºæˆ‘çš„åˆå­¦è€…æŒ‡å—ç³»å¥½å®‰å…¨å¸¦ã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å‘ä½ è§£é‡Š Terraform çš„åŸºæœ¬æ¦‚å¿µï¼Œä½ å¦‚ä½•ä½¿ç”¨å®ƒï¼Œå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå¹¶å‘Šè¯‰ä½ ä¸ºä»€ä¹ˆå®ƒåœ¨è¿‡å»å‡ å¹´ä¸­è·å¾—äº†å¦‚æ­¤å¼ºå¤§çš„è¿½éšè€…ã€‚æˆ‘æ‰“ç®—ç®€å•ä»‹ç»ä¸€ä¸‹ Terraform çš„åŸºæœ¬è¯­æ³•å’Œå®ƒæ‰€ä½¿ç”¨çš„é…ç½®è¯­è¨€ï¼Œè€Œä¸ä¼šåœ¨æ›´é«˜çº§çš„ä¸»é¢˜ä¸Šåšå¤ªæ·±å…¥çš„æ¢è®¨ã€‚æˆ‘å°†åœ¨è¿™ç¯‡åšå®¢ä¹‹åæ›´æ·±å…¥åœ°ç ”ç©¶è¿™é¡¹æŠ€æœ¯ã€‚

å½“æˆ‘å¼€å§‹å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæˆ‘ä»¥ä¸ºè¿™åªæ˜¯ä¸€ä»¶ç®€å•çš„å°äº‹ï¼Œä½†æ˜¯å½“æˆ‘å¼€å§‹å†™çš„æ—¶å€™ï¼Œæˆ‘æ„è¯†åˆ° Terraform å®é™…ä¸Šæ˜¯éå¸¸å¤æ‚çš„ï¼Œæ‰€ä»¥è¿™ç¯‡æ–‡ç« ä¹Ÿéšä¹‹å‘å±•ã€‚å› æ­¤ï¼Œå¦‚æœä½ æ²¡æœ‰å¾ˆå¤šæ—¶é—´ï¼Œåªæƒ³æ¶ˆåŒ–æ‘˜è¦ï¼Œè¯·éšæ„è·³åˆ°åº•éƒ¨ï¼Œåœ¨é‚£é‡Œä½ ä¼šæ‰¾åˆ° TLï¼›ç¾éš¾æ¢å¤ç‰ˆæœ¬ğŸ™‚

# ä»€ä¹ˆæ˜¯ Terraformï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆå¤§æƒŠå°æ€ªï¼Ÿ

å¥½çš„ï¼Œæ‰€ä»¥ä½ æ‰¾åˆ°è¿™ä¸ªåšå®¢çš„å¯èƒ½æ˜¯å› ä¸ºä½ å…¬å¸é‡Œæœ‰äººè¯´è¿‡â€œæˆ‘ä»¬åº”è¯¥ä¸ºæ­¤ä½¿ç”¨ Terraformâ€ï¼Œæˆ–è€…å› ä¸ºä½ é‡åˆ°äº†ä¸€ä¸ª git repoï¼Œä¸Šé¢å†™ç€â€œä½ å¯ä»¥ä½¿ç”¨è¿™äº› Terraform è„šæœ¬æ¥éƒ¨ç½²è¿™ä¸ªè§£å†³æ–¹æ¡ˆâ€ï¼Œè€Œä¸æƒ³ä¸¾æ‰‹è¯¢é—®ä»–ä»¬åœ¨è°ˆè®ºä»€ä¹ˆã€‚äº²çˆ±çš„è¯»è€…ï¼Œä¸è¦å®³æ€•ï¼Œ12 ä¸ªå¤šæœˆå‰ï¼Œæˆ‘ç¡®å®å¤„åœ¨ä½ çš„ä½ç½®ä¸Šï¼ŒåŠªåŠ›ä»å›°æƒ‘ä¸­æŒ£è„±å‡ºæ¥ã€‚

## ä¸€è¨€ä»¥è”½ä¹‹

åœ¨å…¶æœ€åŸºæœ¬çš„å½¢å¼ä¸­ï¼ŒTerraform æ˜¯ä¸€ç§å°†ç§°ä¸º HCL *(Hashicorp é…ç½®è¯­è¨€)*çš„é…ç½®æ–‡ä»¶è½¬æ¢ä¸ºç°å®ä¸–ç•ŒåŸºç¡€è®¾æ–½çš„åº”ç”¨ç¨‹åºï¼Œé€šå¸¸åœ¨ AWSã€Azure æˆ–è°·æ­Œäº‘å¹³å°ç­‰äº‘æä¾›å•†ä¸­ã€‚

è¿™ç§è·å–é…ç½®æ–‡ä»¶å¹¶å°†å…¶è½¬æ¢æˆå®é™…èµ„æºçš„æ¦‚å¿µè¢«ç§°ä¸º IaC *(åŸºç¡€è®¾æ–½å³ä»£ç )*ï¼Œæ˜¯è½¯ä»¶å·¥ç¨‹é¢†åŸŸçš„æ–°çƒ­ç‚¹ã€‚å®ƒç°åœ¨å˜å¾—å¦‚æ­¤çƒ­é—¨çš„åŸå› æ˜¯å› ä¸ºè¿™äº›ä»£ç å¯ä»¥åœ¨ repos ä¸­ä¸ä½ çš„åº”ç”¨ç¨‹åºä»£ç å…±å­˜ï¼Œå¯ä»¥è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¹¶ä¸”å¯ä»¥è½»æ¾é›†æˆåˆ°ä½ çš„ CI/CD ç®¡é“ä¸­ã€‚

## ä»£ç è¾“å…¥èµ„æºè¾“å‡ºâ€¦ç®€å•ï¼(ä¸å®Œå…¨æ˜¯)

å› æ­¤ï¼Œæ­£å¦‚ä½ ä»¬ä¸­çš„è®¸å¤šäººå¯èƒ½å·²ç»çœ‹åˆ°çš„é‚£æ ·ï¼ŒIaC çš„æ¦‚å¿µå¹¶ä¸æ–°é²œï¼Œåå¤šå¹´æ¥äººä»¬ä¸€ç›´è¯•å›¾è‡ªåŠ¨åŒ–ä»–ä»¬çš„äº‘éƒ¨ç½²ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿™ä¸ªå¹³å°ä¼šå˜å¾—å¦‚æ­¤å—æ¬¢è¿å‘¢ï¼Ÿ

ç®€å•æ¥è¯´ï¼›Terraform æ˜¯ä¸€ä¸ªçŠ¶æ€é©±åŠ¨çš„äº‘å¹³å°ä¾›åº”å¼•æ“ã€‚å®ƒåˆ©ç”¨æŠ½è±¡å·¥å…·(ç§°ä¸º*æä¾›è€…*å’Œ*åç«¯*)ä½¿æˆ‘ä»¬èƒ½å¤Ÿç¼–å†™ä»£ç ï¼Œè¿™äº›ä»£ç å¯ä»¥è¢«è§£é‡Šå’Œç¿»è¯‘æˆä¸€è‡´çš„ã€ç¡®å®šæ€§çš„ã€ç‰¹å®šäºäº‘æä¾›è€…çš„ CRUD api è°ƒç”¨ï¼Œä»è€Œæ¶ˆé™¤äº†æˆ‘ä»¬çš„å¤§é‡è·‘è…¿å·¥ä½œå’Œå‹åŠ›ã€‚

![](img/2883f944d15ca9f15695244e3bb1d817.png)

Terraform å¦‚ä½•å·¥ä½œçš„é«˜çº§è§†å›¾

# åŸºç¡€è®¾æ–½ä½œä¸ºä»£ç 

å¥½äº†ï¼Œä½ å·²ç»æœ‰äº†åŸºæœ¬çš„ç”µæ¢¯é—´æ¨ä»‹ï¼Œä½†è¿™å®é™…ä¸Šæ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿç®€è€Œè¨€ä¹‹ï¼ŒIaC è¯•å›¾è§£å†³ä»¥ä¸‹é—®é¢˜:

*   ä¸å†éœ€è¦å•ç‹¬çš„å›¢é˜Ÿæ¥ç®¡ç†åŸºç¡€æ¶æ„ä¾›åº”å’Œåº”ç”¨ç¨‹åºä»£ç å¼€å‘ã€‚
*   å…è®¸æˆ‘ä»¬ä½¿ç”¨ç°ä»£æºä»£ç æ§åˆ¶å·¥å…·(å¦‚ git)æ¥ä¿å­˜ã€åˆ›ä½œ/å®¡æŸ¥å¯¹æˆ‘ä»¬åŸºç¡€æ¶æ„çš„æ›´æ”¹ï¼Œå¹¶ä¸ºæˆ‘ä»¬æä¾›åŸºç¡€æ¶æ„å†å²/å‘å±•çš„è‰¯å¥½æ¦‚è¿°ã€‚
*   ä½¿æˆ‘ä»¬èƒ½å¤Ÿæ‰§è¡Œåº”ç”¨ç¨‹åºå’ŒåŸºç¡€æ¶æ„çš„æŒç»­é›†æˆå’ŒæŒç»­éƒ¨ç½²(CI/CD );è¿™æ„å‘³ç€è¿™ä¸¤ç§å…ƒç´ å¯ä»¥åŒæ—¶éƒ¨ç½²ã€‚
*   å…è®¸æˆ‘ä»¬è½»æ¾ä¿æŒå¤šä¸ªç¯å¢ƒåŒæ­¥ï¼Œè€Œæ— éœ€æ‰‹åŠ¨æ›´æ–°ã€‚
*   æ— éœ€å®šåˆ¶åŸºç¡€æ¶æ„é…ç½®è„šæœ¬å’Œ/æˆ–å†…éƒ¨æ„å»ºçš„å·¥å…·ã€‚
*   æ¶ˆé™¤äº†äººä¸ºé”™è¯¯ï¼Œå› ä¸ºè‡ªåŠ¨åŒ–ä»£ç éƒ¨ç½²æ¶ˆé™¤äº†äººä¸ºå› ç´ ã€‚

*éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒIaC å¹¶ä¸æ˜¯ä¸€ä¸ªæ–°æ¦‚å¿µï¼Œäº‹å®ä¸Šå®ƒåœ¨äº‘å¹³å°çš„æ—©æœŸå°±ä»¥ä¸åŒçš„å½¢å¼å‡ºç°äº†(AWS æœ‰ CloudFormationï¼ŒAzure æœ‰ ARM æ¨¡æ¿)*

## ç®€å•çš„ä¾‹å­

ä½œä¸ºä¸€åç³»ç»Ÿå¼€å‘äººå‘˜ï¼Œæˆ‘æ„è¯†åˆ°æˆ‘éœ€è¦é…ç½®ä¸€äº›äº‘å­˜å‚¨ã€‚æ²¡ä»€ä¹ˆç‰¹åˆ«çš„ï¼Œä½†æ˜¯æˆ‘éœ€è¦ä¸€ä¸ªè½¬å‚¨æ–‡ä»¶çš„åœ°æ–¹å’Œä¸€ä¸ªè¯»å–æ–‡ä»¶çš„åœ°æ–¹ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å½“æˆ‘ä»¬ä½¿ç”¨ Azure å’Œâ€œç‰©ç†â€äº‘åŸºç¡€è®¾æ–½æ—¶ï¼Œè¿™åœ¨æ¦‚å¿µä¸Šæ˜¯ä»€ä¹ˆæ ·å­çš„:

![](img/581b80308e3ee176722fb8f2c5b64416.png)

æ¦‚å¿µç³»ç»Ÿæ¶æ„

æ‰€ä»¥æˆ‘åœ¨è¿™é‡Œä½¿ç”¨å¾®è½¯ Azure æœ¯è¯­ï¼Œä½†å¸Œæœ›è¿™å¯¹ä¸ç†Ÿæ‚‰è¿™ä¸ªå¹³å°çš„äººæ¥è¯´ä¸ä¼šé€ æˆå¾ˆå¤§çš„æ··ä¹±ã€‚åŸºæœ¬ä¸Šæˆ‘éœ€è¦ä¸€ä¸ªèµ„æºç»„(å› ä¸ºåœ¨ Azure ä¸­ï¼Œäº‹ç‰©å­˜åœ¨äºèµ„æºç»„ä¸­)ï¼Œä¸€ä¸ªå­˜å‚¨å¸æˆ·å’Œä¸€ä¸ªå­˜å‚¨å®¹å™¨ã€‚æœ‰äº†æ‰€æœ‰è¿™äº›ä¸œè¥¿ï¼Œæˆ‘å°±å¯ä»¥å®‰å…¨åœ°å°†æˆ‘çš„æ–‡ä»¶å­˜å‚¨åœ¨äº‘ä¸­çš„æ‰€è¿°å®¹å™¨ä¸­ğŸ™‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°†è¿™ä¸ªæ¦‚å¿µæ¨¡å‹è½¬æ¢æˆ Terraform HCLï¼Œçœ‹çœ‹å®ƒæ˜¯ä»€ä¹ˆæ ·å­:

```
terraform {
  required_providers {
    azurerm = "~> 2.64"
  }
}provider "azuread" {
}resource "azurerm_resource_group" "example" {
  name     = "example-resources"
  location = "West Europe"
}

resource "azurerm_storage_account" "example" {
  name                     = "examplestoracc"
  resource_group_name      = azurerm_resource_group.example.name
  location                 = azurerm_resource_group.example.location
  account_tier             = "Standard"
  account_replication_type = "LRS"
}

resource "azurerm_storage_container" "example" {
  name                  = "content"
  storage_account_name  = azurerm_storage_account.example.name
  container_access_type = "private"
}
```

å¦‚æœç”¨æˆ‘ä»¬å¾—åˆ°çš„ HCL æ³¨é‡Šæˆ‘ä»¬çš„æ¦‚å¿µè®¾è®¡:

![](img/a5762a8d3e3782272f5e463d7e8616cd.png)

# åˆ†è§£å®ƒ

å¥½çš„ï¼Œæˆ‘çŸ¥é“æˆ‘è¯´è¿‡æˆ‘ä¸ä¼šæ·±å…¥è§£é‡Š HCL çš„è¯­æ³•ï¼Œä½†æ˜¯æˆ‘è®¤ä¸ºä¸€ç‚¹æ¦‚è¿°å¯èƒ½æœ‰åŠ©äºè§£é‡Šäº‹æƒ…ã€‚

è®©æˆ‘ä»¬ä»¥å­˜å‚¨å®¢æˆ·çš„ HCL ä¸ºä¾‹ï¼Œä¸€æ­¥ä¸€æ­¥åœ°è¿›è¡Œåˆ†è§£:

```
terraform {
  required_providers {
    azurerm = "~> 2.64"
  } backend "azurerm" {
  }
}provider "azuread" {
}resource "azurerm_resource_group" "example" {
  name     = "example-resources"
  location = "West Europe"
}resource "azurerm_storage_account" "example" {
  name                     = "examplestoracc"
  resource_group_name      = azurerm_resource_group.example.name
  location                 = azurerm_resource_group.example.location
  account_tier             = "Standard"
  account_replication_type = "LRS"
}
```

ç›´æ¥æŸ¥çœ‹è¿™ä¸ªè¯­æ³•ï¼Œæ‚¨å¯ä»¥å¾ˆå®¹æ˜“åœ°å‘ç°å®ƒä¸ JSON ç­‰è¯­è¨€çš„ä¸€äº›ç›¸ä¼¼ä¹‹å¤„ã€‚ä½†æ˜¯æ¯ä¸ªéƒ¨åˆ†(æˆ–è€…è¯´**é˜»æŒ¡**æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ

*   `**terraform**`:å…è®¸æ‚¨é…ç½® **Terraform** æœ¬èº«çš„ä¸€äº›è¡Œä¸ºï¼Œæ¯”å¦‚æ‚¨å¸Œæœ›ä½¿ç”¨å“ªä¸ª**æä¾›è€…**ä»¥åŠå®ƒéœ€è¦ä¸‹è½½çš„ç‰ˆæœ¬ã€‚è®°ä½:ä½ ä¸èƒ½ä½¿ç”¨æ¥è‡ªæä¾›è€…çš„èµ„æºï¼Œé™¤éä½ é¦–å…ˆæŒ‡ç¤º Terraform ä½ æƒ³ä½¿ç”¨é‚£äº›æä¾›è€…ï¼Œå°±åƒæˆ‘ä»¬çš„ C#ä»£ç ä¸­çš„ nuget åŒ…ä¾èµ–æˆ– JavaScript ä¸­çš„ npm åŒ…ã€‚[æ¬²äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§æ­¤å¤„çš„æ–‡æ¡£](https://www.terraform.io/docs/language/settings/index.html)
*   `**backend**`:å…è®¸æˆ‘ä»¬æŒ‡å®šå¸Œæœ› Terraform ä½¿ç”¨å“ªä¸ª**åç«¯**ã€‚åç«¯å†³å®šäº†ä¸¤ä»¶å…³é”®çš„äº‹æƒ…ï¼Œæˆ‘ä»¬çš„çŠ¶æ€å­˜å‚¨åœ¨å“ªé‡Œï¼Œæˆ‘ä»¬çš„æ“ä½œåœ¨å“ªé‡Œæ‰§è¡Œã€‚æœ¬è´¨ä¸Šï¼Œå¦‚æœæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ Azureï¼Œå¹¶ä¸”æƒ³è¦å°†æˆ‘ä»¬çš„çŠ¶æ€æŒä¹…åŒ–åˆ°äº‘ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`azurerm`åç«¯æ¥å®ç°ã€‚å¦‚æœæˆ‘ä»¬ä¸æŒ‡å®šåç«¯ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨é»˜è®¤çš„åç«¯ï¼Œè¿™é€šå¸¸è¢«ç§°ä¸º`local`ã€‚[åœ¨æ­¤æŸ¥çœ‹å®˜æ–¹æ–‡ä»¶](https://www.terraform.io/docs/language/settings/backends/index.html)
*   `**provider**` : **æä¾›å•†**æ˜¯ Terraform ç”¨æ¥ä¸ä¸åŒäº‘æä¾›å•†æ¥å£çš„æ’ä»¶ã€‚ä¸€äº›æä¾›ç¨‹åºå…è®¸æ‚¨åœ¨è¿™äº›å—ä¸­æ·»åŠ é¢å¤–çš„é…ç½®ã€‚[åœ¨æ­¤æŸ¥çœ‹å®˜æ–¹æ–‡ä»¶](https://www.terraform.io/docs/language/providers/index.html)
*   `**resource**`:HCL ä¸­çš„ä¸€ä¸ªå…³é”®å­—ï¼Œè¡¨ç¤ºè¿™æ˜¯æ‚¨æƒ³è¦æä¾›çš„**èµ„æº**ã€‚[å®˜æ–¹æ–‡ä»¶åœ¨æ­¤](https://www.terraform.io/docs/language/resources/index.html)
*   `**"azure_reosurce_group**"`:è¿™æ˜¯ä½ æƒ³è¦çš„â€œèµ„æºâ€çš„â€œç±»å‹â€ã€‚å½“å®ƒè¿è¡Œæ—¶ï¼ŒTerraform å°†å°è¯•å¹¶ç¡®å®šå“ªä¸ªâ€œæä¾›è€…â€åŒ…å«è¿™ä¸ªâ€œç±»å‹â€,å¹¶å¯¹å…¶æ‰§è¡Œæ­£ç¡®çš„ CRUD æ“ä½œã€‚(æˆ‘å°†åœ¨æœ¬æ–‡åé¢æ›´è¯¦ç»†åœ°ä»‹ç»è¿™äº› CRUD æ“ä½œ)
*   `**"example"**`:è¿™æ˜¯ Terraform è„šæœ¬ä¸­èµ„æºçš„åç§°/æ ‡è¯†ç¬¦ã€‚**è¯·ä¸è¦å°†è¿™ä¸æ‚¨å°†åœ¨ Azure é—¨æˆ·**ä¸­çœ‹åˆ°çš„èµ„æºåç§°æ··æ·†ã€‚æœ€å¥½ä»¥åŒæ ·çš„æ–¹å¼æ¥è€ƒè™‘è¿™ä¸€ç‚¹ï¼Œåœ¨ä»£ç è¯­è¨€ä¸­ï¼Œå¦‚ Go æˆ– C#ç­‰ï¼Œä½ ä¼šæœ‰å˜é‡åã€‚è¯·æ³¨æ„ï¼Œæˆ‘æ˜¯å¦‚ä½•å°†æˆ‘çš„ä¸¤ä¸ªèµ„æºç§°ä¸ºåŒä¸€ä¸ªâ€œç¤ºä¾‹â€æ ‡è¯†ç¬¦çš„ï¼Œè¿™æ˜¯å› ä¸ºå¦‚æœèµ„æºç±»å‹å’Œæ ‡è¯†ç¬¦çš„ç»„åˆæ˜¯å”¯ä¸€çš„ï¼ŒTerraform å…è®¸å¤åˆ¶ã€‚
*   `**name**`å’Œ`**location**`:è¿™äº›æ˜¯â€œèµ„æºâ€çš„å±æ€§æˆ–ç‰¹æ€§ã€‚è¿™äº›å†³å®šäº†â€œæä¾›å•†â€å°†å¦‚ä½•åœ¨äº‘ä¸­è°ƒé…èµ„æºã€‚å¦‚æœä½ ä½¿ç”¨è¿‡ Azureï¼Œæˆ‘ç›¸ä¿¡ä½ ä¼šæ„è¯†åˆ°åå­—å’Œä½ç½®æ˜¯ä½ åœ¨èµ„æºä¸Šè®¾ç½®çš„å¸¸è§äº‹ç‰©ã€‚è¿™é‡Œ`name`æŒ‡å®šäº†æ‚¨å°†åœ¨ Azure é—¨æˆ·ä¸­çœ‹åˆ°çš„èµ„æºçš„åç§°ã€‚
*   å¥½äº†ï¼Œç°åœ¨äº‹æƒ…å˜å¾—æœ‰è¶£äº†ï¼Œè¿™å°±æ˜¯ Terraform çš„çœŸæ­£åŠ›é‡å¼€å§‹æ˜¾ç°çš„åœ°æ–¹ã€‚è¿™é‡Œæˆ‘ä»¬å°†ä¸€ä¸ªèµ„æºçš„â€œè¾“å‡ºâ€ä¼ é€’ç»™å¦ä¸€ä¸ªèµ„æºã€‚è¿™é‡Œæˆ‘ä»¬è¯´çš„æ˜¯`azurerm_storage_account`çš„`resource_group_name`å±æ€§ä¾èµ–äºåä¸º`example`çš„`azure_resource_group`çš„è¾“å‡ºã€‚å¾ˆèªæ˜å§ï¼Ÿ

å¥½äº†ï¼Œå¸Œæœ›è¿™èƒ½è®©æ‚¨å¯¹å¦‚ä½•é…ç½®èµ„æºä»¥åŠå¦‚ä½•å°†ä¸€ä¸ªèµ„æºçš„è¾“å‡ºé“¾æ¥åˆ°å¦ä¸€ä¸ªèµ„æºæœ‰ä¸€ä¸ªå¾ˆå¥½çš„äº†è§£ã€‚è¿™ç§èµ„æºçš„â€œé“¾æ¥â€å®é™…ä¸Šæ˜¯ Terraform ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œå› ä¸ºå®ƒå…è®¸å¼•æ“æ„å»ºå…¶èµ„æºå›¾ã€‚é€šè¿‡æ˜ç¡®å®šä¹‰èµ„æºä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå®ƒå°†ç¡®ä¿å¼•æ“çŸ¥é“ä»¥æ­£ç¡®çš„é¡ºåºä¾›åº”å®ƒä»¬(ä¾‹å¦‚:åœ¨å®ƒå¿…é¡»è¿›å…¥çš„èµ„æºç»„ä¹‹å‰ï¼Œå®ƒä¸ä¼šå°è¯•åšå­˜å‚¨å¸æˆ·)ï¼Œå¹¶å°†å¸®åŠ© Terraform å°†èµ„æºè½¬æ¢ä¸ºå…¶çŠ¶æ€**ã€‚**

# **æ²ƒç‰¹å·ï¼Ÿï¼Ÿï¼Ÿé‚£æ˜¯ä»å“ªé‡Œæ¥çš„ï¼Ÿï¼Ÿ**

**å¥½äº†ï¼Œå¦‚æœä½ æ²¡æœ‰ä»è¿™ç¯‡åšæ–‡ä¸­å¾—åˆ°ä»€ä¹ˆï¼Œè¯·è®°ä½å®ƒçš„æ ¸å¿ƒå°±æ˜¯ä¸€ä¸ªçŠ¶æ€é©±åŠ¨çš„å·¥ä½œæµå¼•æ“ã€‚æ­£æ˜¯è¿™ç§çŠ¶æ€å¼•æ“ä½¿å¾— Terraform èƒ½å¤Ÿè¿è¡Œï¼Œä¹Ÿä½¿å¾—å®ƒå¦‚æ­¤å—å¼€å‘è€…æ¬¢è¿ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»äº†è§£ä»€ä¹ˆæ˜¯å›½å®¶ï¼Œä»¥åŠå®ƒæ˜¯å¦‚ä½•è¿ä½œçš„ã€‚**

**å¥½çš„ï¼Œè®©æˆ‘ä»¬æƒ³è±¡ä½ åœ¨ä¸€å®¶é¤é¦†é‡Œï¼Œå½“æœåŠ¡å‘˜æ¥åˆ°ä½ çš„æ¡Œå­å‰ï¼Œä½ ç‚¹äº†ä»¥ä¸‹å‡ æ ·èœ:**

*   **æ±¤**
*   **ç‰›æ’**
*   **è–¯ç‰‡ä¸€ä¾§**
*   **å†°æ·‡æ·‹**

**åœ¨ Terraform æœ¯è¯­ä¸­ï¼Œè¿™æ˜¯ä½ çš„ ***ã€æœŸæœ›çŠ¶æ€ã€‘*** ï¼Œä¸ºäº†è®©ä½ æ»¡æ„ï¼Œä½ æƒ³è¦ä½ å·²ç»è®¢è´­çš„æ‰€æœ‰ 4 ä¸ªé¡¹ç›®ã€‚æ‰€ä»¥å¨æˆ¿å¾—åˆ°å‘½ä»¤ï¼Œå¼€å§‹åšé¥­ï¼Œä½†æ˜¯ä½ å…³å¿ƒä»–ä»¬æ€ä¹ˆåšå—ï¼Ÿå¦‚æœä½ åƒæˆ‘ä¸€æ ·ï¼Œè®¤ä¸ºä»–ä»¬ä¼šæ­£ç¡®ç†è§£ä½ çš„è®¢å•ï¼ŒæŒ‰ç…§ä»–ä»¬çš„é£Ÿè°±ï¼Œæœ€ç»ˆé£Ÿç‰©ä¼šæŒ‰ç…§ä½ çš„è¦æ±‚åˆ°è¾¾ä½ çš„é¤æ¡Œï¼Œä¾›ä½ é£Ÿç”¨ã€‚**

**å¥½çš„ Terraform å®Œå…¨ä¸€æ ·ï¼Œåœ¨ Terraform æœ¯è¯­ä¸­ï¼Œå½“æˆ‘ä»¬çš„ ***ã€æœŸæœ›çŠ¶æ€ã€‘*** æ˜¾ç°ä¸ºç°å®æ—¶ï¼Œå°±å˜æˆäº†æ‰€è°“çš„ ***ã€å®é™…çŠ¶æ€ã€‘*** ã€‚**

# **Pfffft è¿™ä¸ªå›½å®¶çš„äº‹æƒ…ä¼¼ä¹å¾ˆå®¹æ˜“â€¦å¯¹ä¸å¯¹ï¼Ÿ**

**å¥½å§ï¼Œæˆ‘è®¨åŒå¬èµ·æ¥åƒä¸€å¼ å¡ä½çš„å”±ç‰‡ï¼Œä½†æ˜¯ä½ ç†è§£çŠ¶æ€çš„æ¦‚å¿µå¯¹åœ°çƒçš„é‡è¦æ€§çœŸçš„å¾ˆé‡è¦ã€‚å®Œå…¨è¯šå®åœ°è¯´ï¼›è®©ä½ çš„å¤´è„‘äº†è§£è¿™ä¸ªæ¦‚å¿µæ˜¯ç ´è§£ Terraform æŠ€æœ¯çš„å…³é”®ã€‚**

**å½“æˆ‘ä»¬å‘Šè¯‰ Terraform è¿›è¡Œéƒ¨ç½²æ—¶ï¼Œå®ƒä¼šæ‰§è¡Œä¸€ç³»åˆ—æ­¥éª¤:**

1.  **å®ƒå°†è§£ææˆ‘ä»¬çš„ HCL é…ç½®/ä»£ç æ–‡ä»¶ã€‚**
2.  **ä½¿ç”¨æˆ‘ä»¬çš„ HCL ä¸­çš„ä¿¡æ¯ï¼ŒTerraform å°†æ„å»ºä¸€ä¸ªæˆ‘ä»¬æƒ³è¦ä¾›åº”çš„æ‰€æœ‰èµ„æºçš„å›¾è¡¨ ***ã€æ‰€éœ€çŠ¶æ€ã€‘*** ï¼Œå¹¶æ‰¾å‡ºå®ƒä»¬ä¹‹é—´çš„ä»»ä½•ä¾èµ–å…³ç³»ï¼Œä»¥å°è¯•å¹¶å†³å®šå®ƒä»¬éœ€è¦åˆ›å»ºçš„é€»è¾‘é¡ºåºã€‚**
3.  **Terraform æ¥ä¸‹æ¥å°†æ£€æŸ¥å®ƒçš„çŠ¶æ€ï¼Œä»¥æ›´å¥½åœ°äº†è§£å®ƒå·²ç»éƒ¨ç½²å’Œå°šæœªéƒ¨ç½²çš„å†…å®¹(å¦‚æœè¿™æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€æ¬¡éƒ¨ç½²ï¼ŒçŠ¶æ€å°†ä¸ºç©º)ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ ***æ„ŸçŸ¥çŠ¶æ€ã€‚*** ä¹‹æ‰€ä»¥æ˜¯æ„ŸçŸ¥çŠ¶æ€ï¼Œæ˜¯å› ä¸º Terraformâ€œè®¤ä¸ºâ€å­˜åœ¨çš„ä¸œè¥¿å’Œâ€œå®é™…â€å­˜åœ¨çš„ä¸œè¥¿ä¹‹é—´å­˜åœ¨è„±èŠ‚ã€‚**
4.  **Terraform æ¥ä¸‹æ¥æ‰§è¡Œæˆ‘ä»¬çš„**æœŸæœ›çŠ¶æ€**å’Œå®ƒæ‰€çŸ¥é“çš„æˆ‘ä»¬çš„ ***æ„ŸçŸ¥çŠ¶æ€ä¹‹é—´çš„é€»è¾‘å¢é‡ã€‚*** ç„¶åå®ƒå†³å®šéœ€è¦æ‰§è¡Œå“ªäº› CRUD åŠ¨ä½œï¼Œä»¥åŠæ‰§è¡Œå®ƒä»¬çš„é¡ºåºï¼Œä»¥ä¾¿ä½¿æˆ‘ä»¬çš„ ***æ„ŸçŸ¥çŠ¶æ€*** ä¸æˆ‘ä»¬çš„ ***æœŸæœ›çŠ¶æ€*** ä¸€è‡´ã€‚**
5.  **Terraform æ¥ä¸‹æ¥æ‰§è¡Œæ‰€æœ‰å¿…è¦çš„æ“ä½œï¼Œä»¥è¾¾åˆ° ***æœŸæœ›çŠ¶æ€*** ã€‚è¯¥æ“ä½œçš„ç»“æœå°†æ˜¯èµ„æºå¯èƒ½å¼€å§‹å‡ºç°åœ¨æˆ‘ä»¬çš„ Azure è®¢é˜…ä¸­ï¼Œç„¶åè¿™è¢«ç§°ä¸º ***å®é™…çŠ¶æ€ã€‚*****
6.  **Terraform æ›´æ–°çŠ¶æ€ä»¥åæ˜ å®ƒæ‰€åšçš„äº‹æƒ…ã€‚**

**è®©æˆ‘ä»¬ç”¨å›¾å½¢æ¥æ£€æŸ¥è¿™ä¸ªæµç¨‹(ç”¨ä¸ä¸Šè¿°æ­¥éª¤ç›¸å¯¹åº”çš„æ•°å­—æ ‡æ³¨çš„å›¾):**

**![](img/842568e9cefabc5851eca49d43ac3e40.png)**

**å¦‚ä½ æ‰€è§ï¼ŒçŠ¶æ€æŒä¹…æ€§ä½¿ Terraform èƒ½å¤Ÿåœ¨é…ç½®æ‰§è¡Œä¹‹é—´åšå‡ºå†³å®šã€‚**

## **ä½†æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦åŒºåˆ†â€œæ„ŸçŸ¥çŠ¶æ€â€å’Œâ€œå®é™…çŠ¶æ€â€æˆ‘å¬åˆ°ä½ å“­äº†ï¼Ÿ**

**è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œä½ åœ¨åŠå…¬å®¤å·¥ä½œï¼Œä½ æœ‰ä¸€å¼ æ¯å¤©éƒ½è¦åçš„æ¡Œå­å’Œæ¤…å­ã€‚è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œè¿™æ˜¯ä¸€ä¸ªå…±äº«çš„åŠå…¬å®¤ï¼Œå…¶ä»–äººæ¯å¤©éƒ½æ¥æ¥å»å»ã€‚**

**ç°åœ¨å¦‚æœæˆ‘é—®ä½ â€œä½ çš„æ¤…å­åœ¨ä½ çš„æ¡Œå­ä¸Šå—ï¼Ÿâ€â€¦ä½ çš„ç­”æ¡ˆä¼šæ˜¯ä»€ä¹ˆï¼Ÿ**

**ä½ ä»¬å½“ä¸­é‚£äº›è¯´â€œæ˜¯çš„ï¼Œå½“ç„¶ï¼Œå¦‚æœé‚£æ˜¯æˆ‘çš„æ¤…å­ï¼Œæˆ‘ä¼šçŸ¥é“å®ƒåœ¨é‚£é‡Œï¼Œå› ä¸ºé‚£æ˜¯æˆ‘æ”¾å®ƒçš„åœ°æ–¹â€çš„äººä¸å¹¸åœ°è½å…¥äº†å¤§å¤šæ•°äººåœ¨ä½¿ç”¨ Terraform æ—¶éƒ½ä¼šçŠ¯çš„å¸¸è§é”™è¯¯ï¼›å¦‚æœä¸å…ˆæ£€æŸ¥ï¼Œå°±æ— æ³•çŸ¥é“ ***æ„ŸçŸ¥çŠ¶æ€*** æ˜¯å¦ä¸ ***å®é™…çŠ¶æ€*** åŒ¹é…ã€‚**

**åœ¨æ¡Œå­å’Œæ¤…å­çš„ä¾‹å­ä¸­ï¼Œæ²¡æœ‰åŠæ³•çŸ¥é“(ä¸åœ¨é‚£é‡Œçœ‹)åŠå…¬å®¤é‡Œçš„å…¶ä»–äººæ²¡æœ‰â€œç§»èµ°â€ä½ çš„æ¤…å­å¹¶ä¸”æ²¡æœ‰å½’è¿˜å®ƒã€‚åŒæ ·ï¼Œåœ¨ Terraform ä¸­ï¼Œæœ‰å¯èƒ½æœ‰äººå·²ç»â€œç§»é™¤â€äº†æ‚¨çš„èµ„æºï¼Œå› æ­¤ Terraform å¿…é¡»é¦–å…ˆæ£€æŸ¥æˆ‘ä»¬çš„èµ„æºæ˜¯å¦é¦–å…ˆå­˜åœ¨äºçŠ¶æ€ä¸­(ä¹Ÿå°±æ˜¯å…ˆå‰å·²ç»åˆ›å»º)ï¼Œç„¶åå®ƒå¿…é¡»æ£€æŸ¥ Azure ä»¥ç¡®ä¿å®é™…çŠ¶æ€ä¸å®ƒæœŸæœ›æ‰¾åˆ°çš„ç›¸åŒ¹é…ã€‚**

**è¯·æ³¨æ„:é€šå¸¸ç»™è¿™ä¸ªæ“ä½œé“¾çš„æœ¯è¯­æ˜¯:**è°ƒå’Œï¼›**åœ°å½¢ ***å°†*** æœŸæœ›çŠ¶æ€è°ƒå’Œä¸ºå®é™…çŠ¶æ€ã€‚**

# **è¿™æ˜¯ä¸€ç§ç²¾ç¥çŠ¶æ€**

**å¥½äº†ï¼Œæˆ‘ä»¬å·²ç»å‡†å¤‡å¥½äº†æ‰€æœ‰çš„èµ„æºï¼Œå·¥ä½œå®Œæˆäº†å—ï¼Ÿæ—¶é—´åœ¨æµé€ï¼Œå‡ºäºæŸç§åŸå› ï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°éƒ¨ç½²ï¼Œä½†æ˜¯è®©æˆ‘ä»¬æƒ³è±¡åœ¨è¿™æ®µæ—¶é—´é‡Œï¼Œæœ‰äººåˆ é™¤äº†æˆ‘ä»¬çš„èµ„æºç»„ğŸ˜±å½“æˆ‘ä»¬é‡æ–°è¿è¡Œæˆ‘ä»¬çš„åœ°å½¢æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ**

**æ­£å¦‚æˆ‘ä»¬å·²ç»è®¨è®ºè¿‡çš„ï¼Œå¸Œæœ› Terraform è¶³å¤Ÿèªæ˜æ¥è§£å†³è¿™ä¸ªé—®é¢˜:**

1.  **Terraform è§£ææˆ‘ä»¬çš„ HCL é…ç½®ã€‚**
2.  **å®ƒçœ‹åˆ°æˆ‘ä»¬æƒ³è¦çš„çŠ¶æ€æ˜¯æ‹¥æœ‰ä¸€ä¸ªèµ„æºç»„**
3.  **å®ƒæ£€æŸ¥æˆ‘ä»¬çš„çŠ¶æ€ï¼Œçœ‹æ˜¯å¦æœ‰çŠ¶æ€æ ‡è¯†ç¬¦ä¸º`example`çš„èµ„æºç»„æ¡ç›®(å¦‚å‰æ‰€è¿°ï¼Œæ³¨æ„èµ„æºè¢«æ ‡è¯†ä¸ºâ€œexample â€,è€Œä¸æ˜¯åç§°å±æ€§â€œexample-resources â€,å°±åƒå…¶ä»–è¯­è¨€ä¸­çš„å˜é‡ä¸€æ ·)**
4.  **Terraform çœ‹åˆ°çŠ¶æ€åŒ…å«ä¸€ä¸ªæ¡ç›®***(percieved State)***ï¼Œäºæ˜¯æ¥ä¸‹æ¥å» Azure æŸ¥è¯¢èµ„æºç»„çš„ ***å®é™…çŠ¶æ€*** ã€‚**
5.  **Azure æŠ¥å‘Šäº†ä¸€ä¸ª 404ï¼Œæˆ‘ä»¬çš„æä¾›è€…ä¼šå°†å…¶è§£é‡Šä¸ºèµ„æºç»„ä¸å­˜åœ¨ğŸ˜±**
6.  **Terraform ç°åœ¨æ‰§è¡Œ ***ã€æœŸæœ›çŠ¶æ€ã€‘*** å’Œ ***ã€å®é™…çŠ¶æ€ã€‘*** ä¹‹é—´çš„å¢é‡ï¼Œå¹¶æ„è¯†åˆ°è¦æ‰§è¡Œçš„å¿…è¦åŠ¨ä½œæ˜¯åˆ›å»ºå®ƒã€‚**
7.  **Terraform æ‰§è¡Œå¿…è¦çš„æ“ä½œæ¥åˆ›å»ºèµ„æºç»„**
8.  **Terraform ä¼šæ ¹æ®éœ€è¦æ›´æ–°å…¶çŠ¶æ€ã€‚**

**![](img/1a4937a75a2a2c592ba75457d3c95e45.png)**

**è¯·æ³¨æ„ï¼Œè¿™æ¬¡çš„å…³é”®åŒºåˆ«åœ¨äºï¼ŒçŠ¶æ€ä¸­æŸäº›ä¸œè¥¿çš„å­˜åœ¨æ”¹å˜äº† Terraform çš„è¿è¡Œæ–¹å¼ï¼Œå› ä¸ºå®ƒâ€œæ„ŸçŸ¥â€åˆ°äº†èµ„æºçš„å­˜åœ¨ï¼Œå› ä¸ºå®ƒçŸ¥é“äº‘ä¸­åº”è¯¥æœ‰èµ„æºï¼Œæ‰€ä»¥å®ƒè½¬å‘äº‘æä¾›å•†(Azure)å¹¶è¯¢é—®è¯¥èµ„æºçš„â€œå®é™…çŠ¶æ€â€ã€‚ç„¶åï¼Œå®ƒä¼šæ ¹æ®ç»“æœå†³å®šè¦åšä»€ä¹ˆã€‚**

**å¦‚æœ Terraform å‘ç°å®ƒå·²ç»æ‹¥æœ‰äº†æˆ‘ä»¬æƒ³è¦çš„èµ„æºï¼Œè¿™ä¸€ç³»åˆ—äº‹ä»¶å°†ä¼šä¸€ç›´å‘ç”Ÿã€‚ä½†è¿™å¹¶ä¸æ˜¯è¯´ç»“æœæ°¸è¿œæ˜¯åˆ›é€ ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰äººé‡å‘½åäº†èµ„æºç»„ï¼Œé‚£ä¹ˆç»“æœå°†æ˜¯ Terraform æ‰§è¡Œèµ„æºæ›´æ–°ï¼Œä½¿å®é™…çŠ¶æ€å’ŒæœŸæœ›çŠ¶æ€ä¸€è‡´ã€‚**

# **å›½å®¶å¯èƒ½æ˜¯ä¸€æŠŠåŒåˆƒå‰‘**

**å› æ­¤ï¼Œå¦‚æœå›½å®¶æ˜¯ Terraform æ“ä½œçš„å¤§è„‘ï¼Œå½“å®ƒå˜å¾—è…è´¥æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿè®©æˆ‘å‘Šè¯‰ä½ çš„æœ‹å‹ä»¬ï¼Œå¦‚æœæˆ‘æ¯æ¬¡çœ‹åˆ°äººä»¬åˆ é™¤ä»–ä»¬çš„çŠ¶æ€ï¼Œç„¶åè¯•å›¾ç”¨ Terraform åšäº›ä»€ä¹ˆï¼Œæˆ‘å°±æœ‰ 5 è‹±é•‘ï¼Œæˆ‘ç°åœ¨å·²ç»æ˜¯ä¸€ä¸ªéå¸¸å¯Œæœ‰çš„äººäº†ã€‚**

**å¥½äº†ï¼Œè®©æˆ‘ä»¬æ¥æ¢ç©¶ä¸€ä¸‹ï¼Œå‡è®¾è®¾ç½®ä¸ä¹‹å‰å®Œå…¨ç›¸åŒï¼Œæˆ‘ä»¬å·²ç»éƒ¨ç½²äº†èµ„æºç»„ï¼Œç„¶åå‡ºäºæŸç§åŸå› ï¼Œæˆ‘ä»¬åˆ é™¤äº†æ‰€æœ‰çŠ¶æ€(ç›¸ä¿¡æˆ‘ï¼Œå¾ˆå®¹æ˜“åšåˆ°)ã€‚è¿™æ¬¡ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ**

***â€œæ˜¾ç„¶ä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿâ€*æˆ‘å¬åˆ°ä½ ä»¬éƒ½åœ¨å“­æ³£â€¦ä½†ä½ ä»¬åˆä¸€æ¬¡è½å…¥äº†æˆ‘çš„é™·é˜±ğŸ˜‰**

**äº‹å®ä¸Šè¿™æ¬¡å‘ç”Ÿçš„æ˜¯:**

1.  **Terraform è§£ææˆ‘ä»¬çš„ HCL é…ç½®/ä»£ç æ–‡ä»¶ã€‚**
2.  **Terraform å°†å»ºç«‹ä¸€ä¸ªæˆ‘ä»¬æƒ³è¦çš„æ‰€æœ‰èµ„æºçš„å›¾è¡¨ã€‚**
3.  **Terraform æ£€æŸ¥çŠ¶æ€ï¼Œå‘ç°å®ƒæ˜¯ç©ºçš„ã€‚**
4.  **Terraform åœ¨æˆ‘ä»¬æœŸæœ›çš„çŠ¶æ€å’Œå®ƒçš„çŠ¶æ€ä¹‹é—´åšé€»è¾‘å¢é‡ï¼Œå¹¶å†³å®šå®ƒéœ€è¦åˆ›å»ºä¸€ä¸ªèµ„æº(è®°ä½ï¼ŒTerraform æ²¡æœ‰æŸ¥è¯¢ Azureï¼Œå› ä¸º**çŠ¶æ€æ–‡ä»¶ä¸å­˜åœ¨/ä¸ºç©º**)**
5.  **Terraform è¯•å›¾åˆ›å»ºä¸€ä¸ªåä¸ºâ€œç¤ºä¾‹-èµ„æºâ€çš„èµ„æºç»„â€¦â€¦**BANGï¼ï¼ï¼ğŸ’¥****
6.  **æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ª Terraform é”™è¯¯çš„æƒ…å†µï¼Œå› ä¸º Azure å·²ç»æœ‰äº†ä¸€ä¸ªåŒåçš„èµ„æºç»„ï¼Œæˆ‘ä»¬æ— æ³•åˆ›å»ºå¦ä¸€ä¸ªåŒåçš„èµ„æºç»„ã€‚**

## **è¿™é‡Œè¦è®°ä½çš„å…³é”®æ˜¯:**

> **Terraform ä¸çŸ¥é“æ‚¨çš„äº‘æä¾›å•†æä¾›çš„ä»»ä½•èµ„æºï¼Œé™¤éå®ƒå¤„äºçŠ¶æ€**

# **è¿™å…¨æ˜¯ä¸€æ´¾èƒ¡è¨€**

**å¥½äº†ï¼Œæˆ‘æƒ³æˆ‘å·²ç»è®²è¿‡äº†çŠ¶æ€ï¼Œä»¥åŠå®ƒçš„é‡è¦æ€§ï¼Œç°åœ¨å¤Ÿäº†ã€‚æ˜¯æ—¶å€™çœ‹çœ‹ Terraform å¦‚ä½•å†³å®šæ‰§è¡Œå“ªäº›æ“ä½œäº†ã€‚æ­£å¦‚æˆ‘ä¹‹å‰æåˆ°çš„ï¼ŒTerraform åªæ˜¯ä¸€ä¸ªçŠ¶æ€å¼•æ“ï¼Œå®ƒæ ¹æ®å½“å‰å¯¹ä¸–ç•Œ(çŠ¶æ€)å’Œç°å®ä¸–ç•Œçš„ç†è§£åšå‡ºå†³å®šã€‚è¯´åˆ°åº•ï¼ŒTerraform èƒ½åšçš„å®é™…è¡ŒåŠ¨åªæœ‰ 3 ä¸ªã€‚è¿™äº›é€šå¸¸è¢«ç§°ä¸º CRUDï¼Œæ˜¯**CR**eatã€ **U** pdate æˆ– **D** elete çš„ç¼©å†™ã€‚**

**é‚£ä¹ˆä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´æ‰§è¡Œå“ªç§æ“ä½œå‘¢ï¼Ÿ**

## ***åˆ›å»º***

*   **æˆ‘ä»¬çš„åœ°å½¢çŠ¶æ€ä¸­ä¸å­˜åœ¨æ‰€éœ€çš„èµ„æºã€‚**
*   **ä¸€ä¸ªæœŸæœ›çš„èµ„æºä»¥ Terraform çŠ¶æ€å­˜åœ¨ï¼Œä½†æœ€ç»ˆå®é™…ä¸Šå¹¶ä¸å­˜åœ¨äºæˆ‘ä»¬çš„äº‘ä¸­ã€‚**

## **æ›´æ–°**

*   **æ‰€éœ€çš„èµ„æºå­˜åœ¨äº Terraform çŠ¶æ€ï¼Œä½†åœ¨æˆ‘ä»¬çš„äº‘ä¸­é…ç½®ä¸åŒã€‚**

## **åˆ é™¤**

*   **ä¸€ä¸ªèµ„æºä»æˆ‘ä»¬æœŸæœ›çš„çŠ¶æ€ä¸­ç§»é™¤ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨äºæˆ‘ä»¬çš„åœ°å½¢çŠ¶æ€ä¸­ã€‚**

# **è¿™æ˜¯åœ°çƒç”Ÿå‘½çš„å¾ªç¯**

**å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬å·²ç»äº†è§£äº† state å’Œ CRUD(çœ‹ï¼Œæˆ‘å‘Šè¯‰è¿‡ä½ å®ƒä»¬å¾ˆé‡è¦),æˆ‘ä»¬å¯ä»¥æ›´ä»”ç»†åœ°çœ‹çœ‹æˆ‘ä»¬æ˜¯å¦‚ä½•æ‰§è¡Œ Terraform çš„ã€‚**

**å½“æˆ‘ä»¬åœ¨å‘½ä»¤è¡Œä¸Šè¿è¡Œ Terraform æ—¶ï¼Œéœ€è¦æ‰§è¡Œ 3 ä¸ªä¸åŒçš„æ­¥éª¤ã€‚è®©æˆ‘ä»¬åœ¨è¿™é‡Œæµè§ˆä¸€ä¸‹:**

## **åˆå§‹åŒ–**

> **`$ terraform init`**

**æˆ‘ä»¬éœ€è¦è¿è¡Œçš„ç¬¬ä¸€ä¸ªå‘½ä»¤æ˜¯`init`ã€‚è¯¥å‘½ä»¤ç”¨äºåˆå§‹åŒ–åŒ…å« Terraform é…ç½®æ–‡ä»¶çš„å·¥ä½œç›®å½•ï¼Œå¹¶æŒ‡ç¤º Terraform è¯¢é—® HCL æ–‡ä»¶ï¼Œç¡®å®šæ‰€éœ€çš„æä¾›ç¨‹åºï¼Œä¸‹è½½å®ƒä»¬ï¼Œå¹¶åˆå§‹åŒ–ä¸€ä¸ªçŠ¶æ€(å¦‚æœè¯¥çŠ¶æ€ä¸å­˜åœ¨)ã€‚å¤šæ¬¡è¿è¡Œ`init`æ˜¯ç»å¯¹å®‰å…¨çš„ï¼Œäº‹å®ä¸Šï¼Œå¦‚æœæ‚¨åœ¨`Terraform`å—ä¸­æ·»åŠ æ–°çš„æä¾›è€…æˆ–æ›´æ”¹ä»»ä½•è®¾ç½®ï¼Œæ‚¨å¯èƒ½éœ€è¦è¿™æ ·åšã€‚**

**å…³äº`init`å‘½ä»¤[çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œä½ å¯ä»¥æŸ¥çœ‹è¿™é‡Œçš„æ‰€æœ‰æ–‡æ¡£](https://www.terraform.io/docs/cli/commands/init.html)ã€‚**

## **è§„åˆ’**

> **`$ terraform plan`**

**æˆ‘ä»¬è¿è¡Œçš„ä¸‹ä¸€ä¸ªå‘½ä»¤æ˜¯`plan`ã€‚è¿™ä¸ªå‘½ä»¤æŒ‡ç¤º Terraform è§£ææˆ‘ä»¬çš„ HCL æ–‡ä»¶ï¼Œæ„å»ºæˆ‘ä»¬çš„èµ„æºå›¾ï¼Œæ£€æŸ¥å®ƒçš„çŠ¶æ€ï¼Œå¹¶å°è¯•æå‡ºä¸€ä¸ªè¦æ‰§è¡Œçš„æ‰§è¡Œè®¡åˆ’ã€‚æˆ‘ä»¬çš„`init`æˆåŠŸäº†ï¼Œä½†æˆ‘ä»¬çš„`plan`å¤±è´¥äº†ï¼Œè¿™æ˜¯å®Œå…¨åˆç†çš„ã€‚è¿™æ˜¯å› ä¸º`init`å¹¶ä¸çœŸæ­£å…³å¿ƒè¯•å›¾ç¡®å®šæˆ‘ä»¬çš„ä»»ä½•èµ„æºæ˜¯å¦æœ‰æ•ˆæˆ–è€…å®ƒä»¬æ˜¯å¦å­˜åœ¨ã€‚åªæœ‰å½“ Terraform å¼€å§‹è§£é‡Šæˆ‘ä»¬çš„â€œæœŸæœ›çŠ¶æ€â€æ—¶ï¼Œæˆ‘ä»¬æ‰ä¼šå¼€å§‹åœ¨æˆ‘ä»¬çš„æ–‡ä»¶ä¸­å‘ç°è¯­æ³•é”™è¯¯ã€‚**

**`plan`å‘½ä»¤çš„è¾“å‡ºå°†æ˜¯ Terraform å†³å®šæ‰§è¡Œçš„æ“ä½œçš„å¤æ‚åˆ—è¡¨ã€‚å¼ºçƒˆå»ºè®®æ‚¨æ£€æŸ¥è¿™äº›æ›´æ”¹ï¼Œä»¥ç¡®ä¿å®ƒä»¬ä¸æ‚¨é¢„æœŸçœ‹åˆ°çš„æ›´æ”¹ç›¸åŒ¹é…ï¼Œå› ä¸ºå¦‚æœæ“ä½œå¤±è¯¯ï¼Œç ´åæ€§æ“ä½œçš„æˆæœ¬ä¼šå¾ˆé«˜ã€‚è¯·å°†æ­¤è§†ä¸ºæ‰€æœ‰åœ°å½¢çš„â€œé¢„æ¼”â€ã€‚**

**åŒæ ·å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè®¡åˆ’çš„è¾“å‡ºå¯ä»¥ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå¹¶ç”¨äºä¸‹ä¸€æ­¥`apply`ï¼Œå› ä¸ºè¿™ç¡®ä¿äº†åœ¨è®¡åˆ’çš„å’Œåº”ç”¨çš„ä¹‹é—´æ²¡æœ‰æ··æ·†/å·®å¼‚ã€‚**

**å…³äº`plan`å‘½ä»¤çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°[æ–‡æ¡£ã€‚](https://www.terraform.io/docs/cli/commands/plan.html)**

## **åº”ç”¨**

> **`$ terraform apply`**

**ç®€å•åœ°è¯´ï¼Œè¿™ä¸ªæ“ä½œå‘Šè¯‰ Terraform æ‰§è¡Œæ‰€æœ‰è®¡åˆ’å¥½çš„æ“ä½œã€‚è¿™é€šå¸¸ä¼šå¯¼è‡´ Terraform é‡åšå…¶è®¡åˆ’(é™¤éä¸ºå‘½ä»¤æä¾›äº†è®¡åˆ’æ–‡ä»¶)ï¼Œç„¶åå‘æ‚¨æ˜¾ç¤ºâ€œæ‚¨ç¡®å®šå—ï¼Ÿâ€æç¤ºã€‚è¿™æ˜¯ä½ çš„ä¸å½’è·¯ã€‚å¦‚æœä½ è¯´æ˜¯ï¼Œé‚£ä¹ˆ Terraform å°†å¼€å§‹çœŸæ­£ä¸ºä½ æä¾›ä¸œè¥¿ã€‚**

**è¿™å¯èƒ½æ˜¯æ‰€æœ‰å‘½ä»¤ä¸­æœ€ç®€å•çš„ä¸€ä¸ªï¼Œä½†æ˜¯å®ƒç¡®å®æœ‰ä¸€äº›æœ‰è¶£çš„åŠŸèƒ½ï¼Œæ¯”å¦‚â€œè‡ªåŠ¨æ‰¹å‡†â€å’Œå¢åŠ æˆ–å‡å°‘æ‰§è¡Œå¹¶è¡ŒåŒ–çš„èƒ½åŠ›ã€‚**

**ä¸å…¶ä»–å‘½ä»¤ä¸€æ ·ï¼Œ[å®Œæ•´æ–‡æ¡£åœ¨æ­¤å¤„å¯ç”¨](https://www.terraform.io/docs/cli/commands/apply.html)**

# **æœ€åä¸€å¥è­¦å‘Šï¼**

**è¯·è®°ä½äº²çˆ±çš„è¯»è€…ï¼ŒTerraform ä½¿ç”¨æˆ‘ä»¬åœ¨ HCL ä¸­æŒ‡å®šçš„æ ‡è¯†ç¬¦æ¥æ ‡è¯†çŠ¶æ€ä¸­çš„èµ„æºã€‚**

**å› æ­¤ï¼Œå¦‚æœæˆ‘æ‰§è¡Œäº†ä¸‹é¢çš„ HCL:**

```
resource "azurerm_resource_group" "example" {
  name     = "example-resources"
  location = "West Europe"
}
```

**â€¦é‚£ä¹ˆè¿™æ„å‘³ç€åœ¨æˆåŠŸå®Œæˆåï¼Œåœ¨æˆ‘çš„çŠ¶æ€æ–‡ä»¶ä¸­åº”è¯¥æœ‰ä¸€ä¸ªæ ‡è¯†ç¬¦è®¾ç½®ä¸º`example`çš„`azurerm_resource_group`èµ„æºçš„æ¡ç›®**

**äººä»¬åœ¨ä½¿ç”¨ Terraform æ—¶å®¹æ˜“é™·å…¥çš„ä¸€ä¸ªå¸¸è§é™·é˜±æ˜¯ï¼Œä»–ä»¬ä¼šçœ‹åˆ°è‡ªå·±ä¸å–œæ¬¢çš„èµ„æºæ ‡è¯†ç¬¦ï¼Œæˆ–è€…æœ‰æ—¶ä¼šçœ‹åˆ°é”™åˆ«å­—ï¼Œå¹¶è®¤ä¸ºâ€œå“¦ï¼Œæˆ‘ä¼šæ¸…ç†æ‰çš„â€â€¦ä½†æ˜¯è¯·éå¸¸éå¸¸å°å¿ƒï¼**

**å¦‚æœæˆ‘å°†ä¸Šé¢çš„ä»£ç æ”¹ä¸º:**

```
resource "azurerm_resource_group" "my_resource_group" {
  name     = "example-resources"
  location = "West Europe"
}
```

**è¯·æ³¨æ„ä»`example`åˆ°`my_resource_group`çš„å˜åŒ–ï¼Œç°åœ¨æˆ‘å¤„äºä¸€ä¸ªéå¸¸å±é™©çš„å¢ƒåœ°ã€‚ä¸‹æ¬¡æˆ‘çš„ Terraform è¿è¡Œæ—¶ï¼Œå®ƒä¼šçœ‹åˆ°è¿™ä¸ªèµ„æºï¼ŒæŸ¥çœ‹å®ƒçš„çŠ¶æ€ï¼Œä½†æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æ¡ç›®(å› ä¸ºæ—§çš„æ¡ç›®è¢«å‘½åä¸º`example`)ï¼Œè¿™æ„å‘³ç€å®ƒå°†å†³å®šåˆ›å»ºä¸€ä¸ªæ–°çš„èµ„æºç»„ï¼Œå½“ç„¶è¿™æ„å‘³ç€åˆ é™¤æ—§çš„èµ„æºç»„ï¼**

**è¿™ç”šè‡³æ›´å±é™©ï¼Œå› ä¸ºèµ„æºç»„æ˜¯ Azure ä¸­çš„é¡¶çº§å¯¹è±¡ï¼Œè¿™æ„å‘³ç€å®ƒè¿˜ä¼šå¯¼è‡´å±äºè¯¥èµ„æºç»„çš„æ‰€æœ‰å†…å®¹ä¹Ÿè¢«é”€æ¯å’Œé‡æ–°åˆ›å»ºï¼ï¼ï¼ï¼è¿™å¯¹äºç”Ÿäº§ç¯å¢ƒæ¥è¯´ç»å¯¹æ˜¯ç¾éš¾æ€§çš„ã€‚**

**æ‰€ä»¥æˆ‘çš„å»ºè®®æ˜¯æœ‹å‹ä»¬:**

> **å¦‚æœæ‚¨è¦é‡å‘½åèµ„æºæ ‡è¯†ç¬¦ï¼Œè¯·ç¡®ä¿è¿™ç§æ›´æ”¹æ˜¯éå¸¸éå¸¸å¿…è¦çš„ï¼**

**æ³¨æ„:æœ‰ä¸€äº›æ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿˜æœ‰å¯¼å…¥çŠ¶æ€çš„æ–¹æ³•ç­‰ç­‰ã€‚ä½†æ˜¯è¿™è¶…å‡ºäº†åˆå­¦è€…æŒ‡å—çš„ç®€å•æœ¬è´¨ã€‚**

# ****æ€»ä¹‹(TLï¼›åšå£«)****

*   **Terraform æ˜¯ä¸€ä¸ªçŠ¶æ€é©±åŠ¨çš„å¼•æ“ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿè½»æ¾ã€ä¸€è‡´åœ°è°ƒé…äº‘åŸºç¡€æ¶æ„ã€‚**
*   **Terraform åˆ©ç”¨äº†è¢«ç§°ä¸º HCL (Hashicorp é…ç½®è¯­è¨€)çš„ä»£ç **
*   **HCL ä½¿ç”¨å…³é”®å­—`resource`æ¥å®šä¹‰æˆ‘ä»¬å¸Œæœ›åœ¨äº‘ä¸­æä¾›çš„â€œèµ„æºâ€ã€‚**
*   **HCL å…è®¸æˆ‘ä»¬å°†ä¸€ä¸ªèµ„æºçš„é…ç½®/è¾“å‡ºç”¨ä½œå¦ä¸€ä¸ªèµ„æºçš„é…ç½®/å±æ€§çš„è¾“å…¥ã€‚**
*   **Terraform ä½¿ç”¨æä¾›å•†ä¸ä¸åŒçš„äº‘æŠ€æœ¯æ¥å£ã€‚**
*   **å½“ terraform è¿è¡Œæ—¶ï¼Œå®ƒå°†è§£æ HCL æ–‡ä»¶ï¼Œå¹¶æ„å»ºæˆ‘ä»¬æƒ³è¦çš„èµ„æºå›¾â€”â€”ç§°ä¸º**æœŸæœ›çŠ¶æ€****
*   **é€šè¿‡å°†èµ„æºâ€œé“¾æ¥â€åœ¨ä¸€èµ·ï¼Œå®ƒä½¿ Terraform èƒ½å¤Ÿåœ¨å…¶å›¾å½¢ä¸­çš„å¯¹è±¡ä¹‹é—´å»ºç«‹æ˜¾å¼çš„ä¾èµ–å…³ç³»ã€‚**
*   **Terraform åœ¨ä¸€ä¸ªåä¸º**çŠ¶æ€æ–‡ä»¶çš„æ–‡ä»¶ä¸­å­˜å‚¨äº†å®ƒä»¥å‰æä¾›çš„æ‰€æœ‰èµ„æºçš„ä¿¡æ¯ã€‚****
*   **çŠ¶æ€æ–‡ä»¶çš„å†…å®¹ç§°ä¸º**æ„ŸçŸ¥çŠ¶æ€**â€”terra form ä¸Šæ¬¡ä½¿ç”¨æˆ‘ä»¬çš„ HCL æ–‡ä»¶è¿è¡Œæ—¶ç¦»å¼€ç¯å¢ƒçš„çŠ¶æ€ã€‚**
*   **Terraform ä½¿ç”¨åç«¯æ¥å†³å®šçŠ¶æ€åº”è¯¥å¦‚ä½•æŒä¹…åŒ–ã€‚**
*   **æ ¹æ®æˆ‘ä»¬ä½¿ç”¨çš„äº‘æœåŠ¡æä¾›å•†ä»¥åŠæˆ‘ä»¬å¸Œæœ› Terraform å¦‚ä½•ä¿æŒçŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨è®¸å¤šä¸åŒçš„åç«¯ã€‚**
*   **å½“ Terraform æƒ³è¦ä¾›åº”èµ„æºï¼Œå¹¶ä¸”è¯¥èµ„æºä»¥å…¶æ„ŸçŸ¥çŠ¶æ€å­˜åœ¨æ—¶ï¼Œå®ƒå°†è¯¢é—®äº‘æä¾›å•†ä»¥ç¡®å®š**å®é™…çŠ¶æ€ã€‚****
*   **å¦‚æœ**æœŸæœ›**ã€**æ„ŸçŸ¥**å’Œ**å®é™…**çŠ¶æ€ä¹‹é—´å­˜åœ¨å·®å¼‚ï¼ŒTerraform å°†ç¡®å®šæ‰€éœ€çš„çº æ­£æªæ–½ï¼Œä»¥ä½¿å®é™…ç¬¦åˆæœŸæœ›ã€‚**
*   **Terraform æœ‰ 3 ä¸ªä¸åŒçš„ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ:`init`ã€`plan`å’Œ`apply`**
*   **å¦‚æœä½ é‡å‘½åä¸€ä¸ªèµ„æºæ ‡è¯†ç¬¦ï¼ŒTerraform å°†ä¼šæŠŠå®ƒå½“ä½œä¸€ä¸ªä»æœªè§è¿‡çš„å…¨æ–°èµ„æºï¼Œå¹¶æ¸…é™¤æ‰€æœ‰ä¸æ—§æ ‡è¯†ç¬¦ç›¸å…³çš„èµ„æºã€‚**

# **æœ€åçš„æƒ³æ³•**

**æ­£å¦‚æˆ‘åœ¨è¿™ç¯‡æ–‡ç« ä¸­æ— æ•°æ¬¡æåˆ°çš„ï¼Œå¦‚æœä½ æ²¡æœ‰ä»è¿™ç¯‡æ–‡ç« ä¸­æ‹¿èµ°ä»»ä½•ä¸œè¥¿ã€‚è¯·è®°ä½:**

> **Terraform æ‰€åšçš„ä¸€åˆ‡éƒ½å›´ç»•ç€å›½å®¶ã€‚å¦‚æœä¸äº†è§£ Terraform å¦‚ä½•ç®¡ç†å’Œç»´æŠ¤çŠ¶æ€ï¼›ä½ ä¸æ˜ç™½åœ°å½¢æ˜¯å¦‚ä½•è¿ä½œçš„**

**æ‰€ä»¥å‰©ä¸‹çš„å°±æ˜¯æ„Ÿè°¢æ‚¨çš„æ—¶é—´ï¼Œæˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¯¹æœªæ¥çš„ Terraform å¼€å‘è€…æœ‰æ‰€å¸®åŠ©ã€‚**

**![](img/ac6f974aa3f60487f7246ab50436746b.png)**

# **å»¶ä¼¸é˜…è¯»:**

*   **HashiCorp çš„ terra formâ€”terra form å¹³å°çš„åˆ›å»ºè€…ä¸ºå…¶ç¼–å†™çš„å®˜æ–¹æ–‡æ¡£ã€‚**
*   **[hashi corp Blog:terra form](https://www.hashicorp.com/blog/products/terraform)â€”å¯¹äºæƒ³è¦äº†è§£å¹³å°æœ€æ–°å˜åŒ–çš„äººæ¥è¯´ï¼Œå¿…é¡»é˜…è¯»/å…³æ³¨ã€‚**
*   **[HashiCorp èµ„æºåº“](https://www.hashicorp.com/resources)â€”terra form å¹³å°ç›®å‰æä¾›çš„æ‰€æœ‰èµ„æºå’Œæä¾›å•†çš„åº“ã€‚**
*   **[ä½¿ç”¨ Terraform å’Œ Azure |å¾®è½¯æ–‡æ¡£](https://docs.microsoft.com/en-us/azure/developer/terraform/overview)â€”Azure å¼€å‘è€…å¿«é€Ÿå…¥é—¨æŒ‡å—ã€‚**
*   **[ä»‹ç» hashi corp terra form with Armon dad garâ€”YouTube](https://www.youtube.com/watch?v=h970ZBgKINg)â€”è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è§†é¢‘ï¼Œä¸ºå–œæ¬¢è§†è§‰æ¦‚è¿°çš„äººæä¾›äº†ä¸Šè¿°å¤§éƒ¨åˆ†ä¿¡æ¯ã€‚**
*   **[AWS ä¸Šçš„ Terraform å…¥é—¨| Sumeet ni nawe](https://spacelift.io/blog/terraform-tutorial)â€”â€”space lift çš„ peeps æ’°å†™çš„æŒæ¡ Terraform å’Œ AWS çš„ä¼Ÿå¤§æŒ‡å—(æ„Ÿè°¢ [Mariusz Michalowski](https://pl.linkedin.com/in/mariusz-micha%C5%82owski) è®©æˆ‘æ„è¯†åˆ°è¿™ç¯‡ä¼Ÿå¤§çš„å¸–å­)**