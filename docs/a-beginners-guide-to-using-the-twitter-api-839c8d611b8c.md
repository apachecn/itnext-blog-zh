# Twitter API åˆå­¦è€…æŒ‡å—

> åŸæ–‡ï¼š<https://itnext.io/a-beginners-guide-to-using-the-twitter-api-839c8d611b8c?source=collection_archive---------1----------------------->

![](img/cddd3f822a615fbc6a91a6fe5a90d77e.png)

æ‚¨å¯ä»¥ä½¿ç”¨ Twitter API æ¥æ›´æ–°æ‚¨çš„çŠ¶æ€ï¼Œæˆ–è€…å‘å…¶ä»–ç”¨æˆ·å‘é€æ¨æ–‡å’Œåª’ä½“ï¼Œè€Œæ— éœ€å®é™…ç™»å½• Twitterã€‚ä½ ä¹Ÿå¯ä»¥ä»ä½ æ‰€åœ¨çš„åœ°ç†ä½ç½®çš„å…¶ä»–ç”¨æˆ·é‚£é‡Œè·å–ä¸€ä¸ªå…³äºç‰¹å®šæ ‡ç­¾çš„æœ€æ–°æ¨æ–‡åˆ—è¡¨ã€‚

è¿™å¬èµ·æ¥å¯èƒ½å¾ˆå¤æ‚ï¼Œä½†æ˜¯ä½ çœŸçš„ä¸éœ€è¦æˆä¸ºä¸€åå¼€å‘äººå‘˜æ¥ç©è¿™ä¸ª APIï¼Œå¹¶äº²è‡ªå°è¯•å…¶ä¸­çš„ä¸€äº›ä¸œè¥¿ã€‚

# ğŸ¤”ä»€ä¹ˆæ˜¯ Twitter APIï¼Ÿ

API æ˜¯[åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£](https://en.wikipedia.org/wiki/Application_programming_interface)çš„ç¼©å†™ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸¤ä¸ªè½¯ä»¶åº”ç”¨ç¨‹åºç›¸äº’é€šä¿¡çš„æ–¹æ³•åˆ—è¡¨ã€‚ä¸»è¦æ–¹æ³•æœ‰:

*   **è·å–**:æ–¹æ³•ç»™**æ£€ç´¢**ä¸€äº›æ•°æ®ã€‚
*   **POST** :æ–¹æ³•**åˆ›å»º**ä¸€äº›æ•°æ®ã€‚
*   **æ”¾**:æ–¹æ³•ä¸º**æ›´æ–°**ä¸€äº›æ•°æ®ã€‚
*   **åˆ é™¤**:åˆ é™¤éƒ¨åˆ†æ•°æ®**çš„æ–¹æ³•ã€‚**

äººä»¬ç”¨æ¥å®šä¹‰ API çš„ä¸€ä¸ªæœ€æµè¡Œçš„ç±»æ¯”æ˜¯æŠŠå®ƒæƒ³è±¡æˆä¸€ä»½é¤é¦†èœå•ã€‚å®ƒæä¾›äº†å®¢æˆ·(å¦ä¸€ä¸ªè½¯ä»¶)å¯ä»¥ä»å¨æˆ¿(ä¸€ä¸ªè½¯ä»¶)è®¢è´­çš„é¡¹ç›®åˆ—è¡¨ã€‚

Twitter API å…è®¸æ‚¨åœ¨ä¸æ‰“å¼€ Twitter åº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹è®¿é—®æ•°æ®å’Œå‘é€æ•°æ®ï¼Œå¦‚æ¶ˆæ¯å’Œåª’ä½“ã€‚ç›¸åï¼Œä½ å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·æ¥å‘é€å®ƒä»¬ï¼Œå¦‚ [cURL](https://en.wikipedia.org/wiki/CURL) æˆ– [Twurl](https://github.com/twitter/twurl) ï¼Œè¿™æ˜¯ä¸€ç§æˆæƒç‰¹å®šç”¨æˆ·è®¿é—® Twitter API çš„å·¥å…·ã€‚

# ğŸ’»å¦‚ä½•æ‰“å¼€ç»ˆç«¯

åœ¨ä½ å¼€å§‹å®‰è£…ä¸œè¥¿ä¹‹å‰ï¼Œä½ åº”è¯¥ç†Ÿæ‚‰å¦‚ä½•æ‰“å¼€ç»ˆç«¯ã€‚è¿™æ˜¯æ‚¨ç”¨æ¥å‘é€ Twitter API è°ƒç”¨çš„å‘½ä»¤è¡Œç•Œé¢(CLI ):

![](img/55370022d729c39ee8ce17c8378b4b72.png)

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Macï¼Œä½ å¯ä»¥é€šè¿‡è¿›å…¥**Finder**>**Applications**>**Utilities**>**Terminal**æ‰“å¼€ç»ˆç«¯ã€‚æˆ–è€…å¯ä»¥æŒ‰ **CMD** + **ç©ºæ ¼é”®**æ‰“å¼€èšå…‰ç¯ï¼Œæœç´¢â€˜ç»ˆç«¯â€™ã€‚

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Windows 10 æœºå™¨ï¼Œé€‰æ‹©**å¯åŠ¨**å¹¶æœç´¢â€œcmdâ€æ‰“å¼€**å‘½ä»¤æç¤ºç¬¦**ã€‚å¯¹äº Windows 7 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œé€‰æ‹©**å¼€å§‹** > **æ‰€æœ‰ç¨‹åº** > **é™„ä»¶** > **å‘½ä»¤è¡Œæç¤º**ã€‚

# ğŸ¬å¼€å§‹ä¹‹å‰

å¼€å§‹ä¹‹å‰ï¼Œæ‚¨å¿…é¡»æ»¡è¶³ä»¥ä¸‹è¦æ±‚:

*   åˆ›å»ºä¸€ä¸ª Twitter å¼€å‘è€…è´¦æˆ·ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œåšè¿™ä¸ª[ã€‚](http://href="https://developer.twitter.com/en/apply/user")
*   åœ¨æ­¤æ‰“å¼€åº”ç”¨ç®¡ç†é¡µé¢[å¹¶åˆ›å»ºä¸€ä¸ªåº”ç”¨ã€‚ä½ åªéœ€è¦ç»™å®ƒä¸€ä¸ªåå­—ï¼Œè¾“å…¥ä»»ä½•ç½‘ç«™çš„ç½‘å€å’Œ 100 å­—çš„æè¿°ã€‚](https://developer.twitter.com/en/apps)
*   å®‰è£… Rubyã€‚ä½ éœ€è¦è¿™ä¸ªæ¥è¿è¡Œ Twurlã€‚å‚è§æ­¤å¤„çš„å®‰è£…é€‰é¡¹ã€‚
*   å®‰è£… Twurlã€‚ç‚¹å‡»æŸ¥çœ‹ Twitter å®‰è£…æ–‡æ¡£[ã€‚](https://developer.twitter.com/en/docs/tutorials/using-twurl.html)

ä½ å¯ä»¥é€‰æ‹©å®‰è£… JQï¼Œä¸€ä¸ªå‘½ä»¤è¡Œ JSON å¤„ç†å™¨ã€‚è¿™ä½¿å¾— API è°ƒç”¨è¿”å›çš„ JSON å“åº”æ›´å®¹æ˜“é˜…è¯»ã€‚

```
**NOTE**: Do not use JQ if you intend to use the output (e.g. a media ID) in a subsequent call. Integers longer than 53-bits break in JavaScript (mentioned in the JQ FAQ [here](https://github.com/stedolan/jq/wiki/FAQ#numbers)) so the numeric ID displayed will be incorrect. Thanks for the warning [Andy Piper](https://medium.com/u/da72a673691c?source=post_page-----839c8d611b8c--------------------------------)!
```

æ‚¨å¯ä»¥é€šè¿‡åœ¨æ¯ä¸ªè¯·æ±‚çš„æœ«å°¾é”®å…¥`| jq` æ¥ä½¿ç”¨è¿™ä¸ªå·¥å…·ã€‚å‚è§æ­¤å¤„çš„å®‰è£…é€‰é¡¹ã€‚

# ğŸ”‘è·å–æ‚¨çš„ API å’Œå¯†é’¥

è¦å‘ Twitter å‘é€ API è°ƒç”¨ï¼Œæ‚¨éœ€è¦ä¸€ç»„å¯¹æ‚¨çš„å¼€å‘äººå‘˜å¸æˆ·å”¯ä¸€çš„è®¿é—®é”®ã€‚è¦å–å›æ‚¨çš„é’¥åŒ™:

1.  ç™»å½•æ‚¨çš„ Twitter å¼€å‘è€…è´¦æˆ·ã€‚
2.  è¿›å…¥ä½ çš„[åº”ç”¨ç¨‹åºç®¡ç†ç•Œé¢](https://developer.twitter.com/en/apps)ï¼Œç‚¹å‡»ä½ çš„åº”ç”¨ç¨‹åºçš„**è¯¦ç»†ä¿¡æ¯**ã€‚
3.  ç‚¹å‡»**å¯†é’¥å’Œä»¤ç‰Œ**é€‰é¡¹å¡ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„ API å¯†é’¥ã€‚
4.  å¤åˆ¶æˆ–è®°ä¸‹æ¶ˆè´¹è€… API å’Œå¯†é’¥ã€‚
5.  é€šè¿‡åœ¨æ‚¨çš„ç»ˆç«¯ä¸Šè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æˆæƒæ‚¨çš„ Twitter åº”ç”¨ç¨‹åºå’Œå¸æˆ·(ç”¨æ‚¨å”¯ä¸€çš„å¯†é’¥æ›¿æ¢`<key>`å’Œ`<secret>`):

```
twurl authorize -consumer-key <key> -consumer-secret <secret>
```

6.Twurl è¿”å›ä¸€ä¸ª urlã€‚å°†å…¶å¤åˆ¶å¹¶ç²˜è´´åˆ°æµè§ˆå™¨ä¸­ä»¥æ¥æ”¶ PINã€‚

7.å°† PIN å¤åˆ¶å¹¶ç²˜è´´åˆ°æ‚¨çš„ç»ˆç«¯ä¸­ï¼Œç„¶åæŒ‰ Enterã€‚

ç°åœ¨ï¼Œä½ å¯ä»¥èµ°äº†ï¼æ›´å¤šä¿¡æ¯è§ Twitter å…³äº[è®¤è¯](https://developer.twitter.com/en/docs/basics/authentication/guides/securing-keys-and-tokens)çš„æ–‡æ¡£ã€‚

# ğŸŒªï¸å¦‚ä½•ä½¿ç”¨ Twurl

Twurl åŸºæœ¬ä¸Šæ˜¯ä¸“é—¨ä¸º Twitter API ä¿®æ”¹çš„ cURLã€‚å®ƒæˆäºˆæ‚¨ä¸€ä¸ªè®¿é—®ä»¤ç‰Œï¼Œå¹¶ç”¨è¯¥è®¿é—®ä»¤ç‰Œå¯¹æ‚¨å‘é€çš„æ‰€æœ‰åç»­è¯·æ±‚è¿›è¡Œç­¾åã€‚

å…³äºåŸºæœ¬ç”¨æ³•çš„æŒ‡å—ï¼Œæ‚¨å¯ä»¥åœ¨ç»ˆç«¯ä¸­è¿è¡Œ`twurl -h` help å‘½ä»¤ã€‚æœ€æœ‰ç”¨çš„é€‰é¡¹æ˜¯:

```
**-d, --data [data]  **              
Sends the specified data in a POST request to the HTTP server.**-A, --header [header] **           
Adds the specified header to the request to the HTTP server.**-H, --host [host] **               
Specify host to make requests to (default: api.twitter.com)**-X, --request-method [method]  **  
Request method (default: GET)**-f, --file [path_to_file] **       
Specify the path to the file to upload**-F, --file-field [field_name]  **  
Specify the POST parameter name for the file upload data (default: media)
```

å…³äºå®ƒå¦‚ä½•å·¥ä½œçš„åŸºæœ¬æ•™ç¨‹è¿è¡Œ:`twurl -T`æˆ–`twurl --tutorial`ã€‚

# ğŸ“®æ›´æ–°æ‚¨çš„ Twitter çŠ¶æ€

æ‚¨å¯ä»¥ä½¿ç”¨`statuses/update` POST ç«¯ç‚¹æ›´æ–°æ‚¨çš„ Twitter çŠ¶æ€ã€‚æ­£å¦‚[æ–‡æ¡£](https://developer.twitter.com/en/docs/tweets/post-and-engage/api-reference/post-statuses-update)æ‰€è¯´ï¼Œè¿™â€œæ›´æ–°äº†è®¤è¯ç”¨æˆ·çš„å½“å‰çŠ¶æ€â€(ä¹Ÿç§°ä¸ºå‘é€ Tweet)ã€‚

ä¸ºäº†å°†æˆ‘çš„ Twitter çŠ¶æ€æ›´æ–°ä¸ºâ€œæµ‹è¯• Twitter APIâ€¦â€æˆ‘å‘é€äº†ä»¥ä¸‹è¯·æ±‚:

```
twurl -d 'status=Testing out the Twitter API...' /1.1/statuses/update.json | jq
```

æˆ‘ç”¨ Twurl å‘çš„æ¨æ–‡æ˜¯è¿™æ ·çš„:

# ğŸ“€å°†åª’ä½“ä¸Šä¼ åˆ° Twitter

æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ Twurl å°†ä»¥ä¸‹åª’ä½“ä¸Šä¼ åˆ° Twitter:

*   æœ€å¤§ 5MB çš„å›¾åƒã€‚
*   æœ€å¤§ 15MB çš„ GIF æ–‡ä»¶ã€‚
*   æœ€å¤§ 15MB çš„è§†é¢‘ã€‚

è¦ä»æ‚¨çš„è®¡ç®—æœºä¸Šä¼ æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`media/upload`ç«¯ç‚¹:

```
twurl -X POST -H upload.twitter.com "/1.1/media/upload.json" -f <file_location> -F <file_type>
```

ä¾‹å¦‚ï¼Œè¦ä»æˆ‘çš„æ¡Œé¢ä¸Šä¼  GIFï¼Œæˆ‘è¿è¡Œä»¥ä¸‹å‘½ä»¤:

```
twurl -X POST -H upload.twitter.com "/1.1/media/upload.json" -f ~/Desktop/itworked.gif -F media
```

å“åº”åŒ…å«æ‚¨å‘å¸ƒåˆ° Twitter æ‰€éœ€çš„åª’ä½“ ID:

```
{
  "media_id": 1097859492425973760,
  "media_id_string": "1097859492425973760",
  "size": 469653,
  "expires_after_secs": 86400,
  "image": {
  "image_type": "image/gif",
  "w": 500,
  "h": 271
  }
}
```

ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»æ›´å¤šå…³äºä¸Šä¼ åª’ä½“åˆ° Twitter [çš„ä¿¡æ¯ã€‚](https://developer.twitter.com/en/docs/media/upload-media/overview)

# ğŸ“Ÿå›å¤æ¨æ–‡

æ‚¨å¯ä»¥å†æ¬¡ä½¿ç”¨`statuses/update`å‘å¸ƒç«¯ç‚¹ä¸Šä¼ å¸–å­æ¥å›å¤ä¹‹å‰çš„æ¨æ–‡ã€‚

ä¸ºäº†ç”¨åŒ…å«æˆ‘ä¸Šä¼ çš„ GIF çš„å›å¤æ›´æ–°æˆ‘ä¹‹å‰çš„æ¨æ–‡ï¼Œæˆ‘å‘é€äº†ä»¥ä¸‹è¯·æ±‚:

```
twurl -X POST -H api.twitter.com "/1.1/statuses/update.json?status=@scottydocs It worked&in_reply_to_status_id=1097511310961639427&media_ids=1097859492425973760" | jq
```

æ¨ç‰¹ä¸Šçš„å›åº”å¦‚ä¸‹:

# ğŸš€æ£€ç´¢å¸¦æœ‰ç‰¹å®šæ ‡ç­¾çš„æ¨æ–‡

æ‚¨å¯ä»¥ä½¿ç”¨`search/tweets` GET ç«¯ç‚¹æ£€ç´¢å¸¦æœ‰ç‰¹å®šæ ‡ç­¾çš„æ‰€æœ‰ Tweetsã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™åªæ£€ç´¢è¿‡å»ä¸ƒå¤©å†…å‘é€çš„æ¨æ–‡ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³è¦æ£€ç´¢æ‰€æœ‰ä½¿ç”¨#starwars æ ‡ç­¾çš„ Tweetsï¼Œæ‚¨å¯ä»¥è¿è¡Œ:

```
twurl "/1.1/search/tweets.json?q=#starwars"
```

æˆ–è€…ï¼Œè¦æ£€ç´¢å¸¦æœ‰#starwars æ ‡ç­¾çš„æœ€å—æ¬¢è¿çš„æ¨æ–‡ï¼Œæ‚¨å¯ä»¥è¿è¡Œ:

```
twurl "/1.1/search/tweets.json?q=#starwars&result_type=popular"
```

# ğŸ“ˆå¯»æ‰¾ä½ å½“åœ°çš„è¶‹åŠ¿

è¦äº†è§£æ‚¨æ‰€åœ¨ä½ç½®çš„è¶‹åŠ¿ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`trends/place`è·å–ç«¯ç‚¹ã€‚æ‚¨éœ€è¦æä¾›çš„å”¯ä¸€å¿…å¡«å­—æ®µæ˜¯ Yahooï¼ä½ çš„ä½ç½®åœ¨åœ°çƒä¸Šçš„ä»€ä¹ˆåœ°æ–¹ã€‚æˆ‘ç”¨è¿™ä¸ªç½‘ç«™æ‰¾åˆ°äº†æˆ‘çš„ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘æƒ³äº†è§£ä¼¦æ•¦ Twitter ä¸Šçš„æœ€æ–°åŠ¨æ€(WOEID 44418):

```
twurl "/1.1/trends/place.json?id=44418" | jq
```

å“åº”å¦‚ä¸‹æ‰€ç¤º:

# ğŸ¤–ä½ è¿˜èƒ½åšä»€ä¹ˆï¼Ÿ

è¿™äº›åªæ˜¯æ‚¨å¯ä»¥ä½¿ç”¨ Twitter API å’Œ Twurl è°ƒç”¨çš„ä¸€äº›åŸºæœ¬å‡½æ•°ã€‚å¦‚æœä½ æƒ³æ›´è¿›ä¸€æ­¥ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™äº›ç«¯ç‚¹å’Œå…¶ä»–ç«¯ç‚¹æ¥åˆ›å»º Twitter æœºå™¨äººã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¯èƒ½æœ‰ç”¨çš„èµ„æº:

*   [æ¨ç‰¹æœºå™¨äººæ•™ç¨‹](https://digitalinspiration.com/docs/twitter-bots)ã€‚
*   å¦‚ä½•åˆ¶ä½œä¸€ä¸ª Twitter æœºå™¨äºº:åˆå­¦è€…å®Œå…¨æŒ‡å—ã€‚
*   [å¦‚ä½•åœ¨ä¸€å°æ—¶å†…åˆ¶ä½œä¸€ä¸ªæ¨ç‰¹æœºå™¨äºº](https://medium.com/science-friday-footnotes/how-to-make-a-twitter-bot-in-under-an-hour-259597558acf)ã€‚

æ‚¨å¯ä»¥æ„å»ºçš„æœºå™¨äººçš„ä¸€äº›æ½œåœ¨ç”¨ä¾‹åŒ…æ‹¬:

*   è½¬å‘å’Œåˆ†äº«å¸¦æœ‰ç‰¹å®šæ ‡ç­¾çš„å†…å®¹ã€‚
*   æ˜¾ç¤ºå…³äºæŸä¸ªä¸»é¢˜æˆ–æ ‡ç­¾çš„å®æ—¶æ›´æ–°ã€‚
*   æé†’æ‚¨è‡ªå·±æˆ–æ‚¨çš„å…³æ³¨è€…ç‰¹å®šçš„äº‹ä»¶ã€‚

å¸Œæœ›æœ¬æŒ‡å—ä¸­çš„ä¸€äº›å†…å®¹å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ã€‚ç¥ä½ å¥½è¿ï¼Œç”¨ Twitter API å‘é€ä½ çš„ç¬¬ä¸€æ¡æ¨æ–‡ï¼Œæˆ–è€…ç”šè‡³å¯èƒ½åˆ›å»ºæ›´é…·çš„ä¸œè¥¿ï¼