<html>
<head>
<title>How-to: Kubernetes Application Deployment with DNS management</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">How-to:ä½¿ç”¨DNSç®¡ç†éƒ¨ç½²Kubernetesåº”ç”¨ç¨‹åº</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/how-to-kubernetes-application-deployment-with-dns-management-ddf63b559b67?source=collection_archive---------5-----------------------#2019-09-27">https://itnext.io/how-to-kubernetes-application-deployment-with-dns-management-ddf63b559b67?source=collection_archive---------5-----------------------#2019-09-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7d55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å½“æ¶‰åŠåˆ°GitOpsçš„å·¥ä½œæ—¶ï¼Œåœ¨é…ç½®æ—¶è¦æ³¨æ„è®¸å¤šè­¦å‘Šå’Œå„ç§éšœç¢ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯DNSçš„éº»çƒ¦ã€‚æˆ‘å·²ç»æ‹–äº†å¾ˆä¹…æ‰å¾—åˆ°è¿™ä¸ªhttps://github.com/kubernetes-incubator/external-dns<a class="ae kl" href="https://github.com/kubernetes-incubator/external-dns" rel="noopener ugc nofollow" target="_blank">å¤–éƒ¨DNS</a>çš„è¿è¡Œæ¼”ç¤ºï¼Œå”‰ï¼Œç°åœ¨å®ƒç»ˆäºæ¥äº†ã€‚</p><p id="7f7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å®ƒæ˜¯å¦‚æ­¤çš„ç›´æˆªäº†å½“ã€‚</p><p id="a901" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¤–éƒ¨DNSæ‰¿æ‹…æ‰€æœ‰çš„ç®¡ç†å·¥ä½œï¼Œå°†<strong class="jp ir"> FQDN </strong>æ˜ å°„åˆ°æœåŠ¡å’Œå…¥å£ã€‚å°½ç®¡KubernetesæœåŠ¡çš„DNSç®¡ç†å°†éœ€è¦ä¸€ä¸ªå…¬å…±IPåœ°å€ï¼Œæä¾›ä¸€ä¸ª<code class="fe km kn ko kp b">loadBalancer</code>ç±»å‹ã€‚è¿™ç®€åŒ–äº†DNSç®¡ç†â€”éšç€æ‚¨çš„K8æœåŠ¡çš„éƒ¨ç½²å’Œåˆ é™¤ï¼Œè‡ªåŠ¨æ·»åŠ å’Œåˆ é™¤è®°å½•ã€‚æ‚¨å¯èƒ½ä¸å¸Œæœ›å°†K8æœåŠ¡ä¸â€œexternal IPâ€DNSæ˜ å°„ä¸€èµ·ä½¿ç”¨ï¼Œå› ä¸ºè¿™å°†å¯¼è‡´æ­¤ç±»æœåŠ¡çš„IPä¾›åº”æˆæœ¬ã€‚å› æ­¤ï¼Œæˆ‘å»ºè®®é‡ç”¨å…¥å£ï¼Œä¸»æœºè·¯å¾„è·¯ç”±ï¼Œå› ä¸ºä½ ä¼šå‘ç°æ›´åˆé€‚ã€‚</p><p id="0c3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¯¹äºå¤§å¤šæ•°åŸºç¡€æ¶æ„ç¯å¢ƒè®¾è®¡æ¥è¯´ï¼Œè¿™åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯<code class="fe km kn ko kp b">development</code>ç¯å¢ƒï¼Œä¹Ÿè®¸<code class="fe km kn ko kp b">Staging</code>ç¯å¢ƒå¯ä»¥ä»ç‰ˆæœ¬æ§åˆ¶å’Œè‡ªåŠ¨åŒ–çš„åŸºç¡€æ¶æ„å³ä»£ç ä¾›åº”æµç¨‹ä¸­å—ç›Šã€‚</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi kq"><img src="../Images/bebd142930fe47920d623a1459b94fbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4F_itrFj8AS6joG1starYA.png"/></div></div></figure><p id="bf99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è®©æˆ‘ä»¬æ¥è¯„ä¼°æˆ‘ä»¬æ­£åœ¨è§£å†³çš„é—®é¢˜â€” <strong class="jp ir">è§£å†³æˆ‘ä»¬çš„åº”ç”¨</strong>çš„åŠ¨æ€DNSæ˜ å°„é…ç½®éœ€æ±‚ã€‚è¿™å¯èƒ½æ˜¯å¼€å‘å›¢é˜Ÿåœ¨éƒ¨ç½²å’Œæµ‹è¯•æ–°çš„åº”ç”¨ç¨‹åºç‰¹æ€§æ—¶æ‰€éœ€è¦çš„ã€‚è¿™åœ¨<em class="lc"> #GitOps </em>ç¯å¢ƒä¸­å‘³é“æ›´å¥½â€”â€”åœ¨è¿™é‡Œï¼Œæ‚¨çš„Git Repoæ˜¯æ‰€æœ‰è‡ªåŠ¨ä¾›åº”çš„<code class="fe km kn ko kp b">"source of truth"</code>ã€‚è¿™ä¸<strong class="jp ir">Weaveworks Flux</strong>(<a class="ae kl" href="https://github.com/fluxcd/flux" rel="noopener ugc nofollow" target="_blank">https://github.com/fluxcd/flux</a>)ç›¸ç»“åˆï¼Œå¯ä»¥è‡ªåŠ¨åº”ç”¨ä½ çš„Kubernetes YAMLè´§å•ï¼Œä¸ºå‘å¸ƒè¿‡ç¨‹æä¾›äº†å¾ˆå¤§ç¨‹åº¦çš„<strong class="jp ir"> CD* </strong>ã€‚</p><p id="3b40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘å¸Œæœ›â€œè§£é‡Šå®ƒï¼Œå°±åƒå¯¹ä¸€ä¸ª10å²çš„â€œâ€â€”â€”ç”¨ä¸€ä¸ªç›¸å½“ç›´æ¥çš„æ¼”ç¤ºã€‚å‘ƒâ€¦â€¦</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi ld"><img src="../Images/cfc1c5ddd14e2135db7270228bffec6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nySFxPioCWFZRg_SmzqJSg.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">ä½ ä¼šæƒ³ï¼Œwowzersï¼Œå¯¹å§ï¼Ÿåˆ«æ‹…å¿ƒï¼Œå…¶å®ä¹Ÿæ²¡é‚£ä¹ˆç³Ÿ:)</figcaption></figure><p id="7585" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘å¸Œæœ›ä½ ä»¬è¿™äº›äº²èº«å®è·µçš„è¯»è€…èƒ½å¤Ÿå¤åˆ¶è¿™ä¸€æˆåŠŸï¼Œå‰ææ˜¯ä½ ä»¬ç¡®å®åœ¨è°·æ­Œäº‘DNSæœåŠ¡ä¸­æ˜ å°„å’Œé…ç½®äº†è‡ªå·±çš„DNSã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œå°½ä¸€åˆ‡åŠæ³•ï¼Œå¤åˆ¶ç²˜è´´ä½ å¿ƒä¸­çš„å†…å®¹ï¼Œå¹¶å–œæ¬¢åˆ†äº«è¿™äº›è™šæ‹Ÿçš„<em class="lc">å•¤é…’è£èª‰</em>ã€‚</p><h1 id="4e6e" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">æ‚¨çš„ç³»ç»Ÿè¦æ±‚</h1><p id="d19e" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">è¿™å¯èƒ½æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œä½†æ˜¯æ‚¨å°†éœ€è¦åœ¨è¿è¡Œå®ƒçš„ç³»ç»Ÿä¸Šå®‰è£…<code class="fe km kn ko kp b">git</code>ã€<code class="fe km kn ko kp b">google-cloud-sdk</code>å’Œ<code class="fe km kn ko kp b">kubectl</code></p><p id="a373" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å·²ç»å°è¯•è¿‡äº†ï¼Œç°åœ¨è®¾ç½®è¿™ä¸ªã€‚å®ƒç›¸å½“ç®€å•ï¼Œåœ¨æœåŠ¡ä¾›åº”æ–¹é¢æœ‰ä¸€äº›é¢„æœŸçš„K8å’ŒGCPå»¶è¿Ÿã€‚å½“ä½ è‡ªå·±è¿›è¡Œå¤åˆ¶ç²˜è´´æµ‹è¯•æ—¶ï¼Œè¯·è®°ä½è¿™ä¸€ç‚¹ã€‚</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi ml"><img src="../Images/ac4a0baac64e732e2a07d386761ae0a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y74B4edR4X6vtbck83AZ9g.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">å±•ç¤ºä¸€ä¸‹YAMLçš„é­”åŠ›å§ï¼</figcaption></figure><h1 id="4210" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">é£è¡Œå‰è®¡åˆ’å’Œå¥å…¨æ€§æ£€æŸ¥</h1><p id="b9d2" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">æˆ‘å¸Œæœ›ä½ æœ‰ä¸€ä¸ªç”±è°·æ­Œäº‘DNSç®¡ç†çš„DNSåç§°ï¼Œå¹¶åœ¨ä½ å¤åˆ¶çš„é¡¹ç›®ä¸­å¯ç”¨äº‘DNS APIã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å°†é¦–å…ˆè®¾ç½®DNSåŒºåŸŸç®¡ç†ï¼Œç„¶åç»§ç»­å…¨æ–°çš„é›†ç¾¤è®¾ç½®ã€‚è¯¦æƒ…è¯·å…³æ³¨è¿›åº¦ã€‚</p><ul class=""><li id="c08c" class="mm mn iq jp b jq jr ju jv jy mo kc mp kg mq kk mr ms mt mu bi translated">æˆ‘çš„æµ‹è¯•åŸŸåŒºåŸŸæ˜¯<code class="fe km kn ko kp b">jpworks.squadzero.io</code></li><li id="0791" class="mm mn iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated">ç¡®ä¿æ­£ç¡®çš„NSæœåŠ¡å™¨æ˜ å°„åˆ°<code class="fe km kn ko kp b">jpworks.squadzero.io</code>åŒºåŸŸçš„google Cloud DNSåŒºåŸŸã€‚</li></ul><h1 id="b1a1" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">è¯¥è¿‡ç¨‹</h1><p id="ae24" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">ç„¶è€Œï¼Œè¿™æ˜¯ä¸€ä¸ªå·¥ä½œæ¼”ç¤ºï¼ŒåŸºäºæˆ‘çš„GCPé¡¹ç›®åå’Œæˆ‘çš„åŸŸåŒºåŸŸã€‚æ‚¨çš„è®¾ç½®ä¼šæœ‰æ‰€ä¸åŒï¼Œå› æ­¤è¯·ç¡®ä¿æ›´æ–°å…¨å±€å˜é‡ä»¥åŠå¤–éƒ¨DNSéƒ¨ç½²å‚æ•°åˆ—è¡¨ã€‚</p><h1 id="4423" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">è®¾ç½®å…¨å±€VAR</h1><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="ffcb" class="ne lj iq kp b gy nf ng l nh ni">## This global will be used throughout the copy-paste scripts<br/>## CHANGE THIS as required<br/>PROJECT=jaroslav-pantsjoha-contino <br/>CLUSTER_NAME=jpworks-cluster</span></pre><h1 id="249d" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">DNSåŒºåŸŸ</h1><p id="4a5b" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">å¦‚æœæ‚¨è¿˜æ²¡æœ‰æ‰‹åŠ¨è®¾ç½®å®ƒï¼Œæ‚¨å¯ä»¥é€šè¿‡ç¼–ç¨‹æ–¹å¼åˆ›å»ºä¸€ä¸ªæˆ‘ä»¬å¸Œæœ›å¤–éƒ¨DNSç®¡ç†çš„åŒºåŸŸï¼Œè¿™å¯¹äºè®©å¤šä¸ªé›†ç¾¤ç¯å¢ƒç®¡ç†è‡ªå·±çš„ç‹¬ç«‹åŒºåŸŸæ¥è¯´æ˜¯ä¸€ä¸ªæ˜æ˜¾çš„å¥½å¤„ã€‚</p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="32a0" class="ne lj iq kp b gy nf ng l nh ni">cloud dns managed-zones create "jpworks-demo-squadzero-io"  \<br/>   --dns-name "jpworks.squadzero.io."  \<br/>   --description "Automatically managed zone by kubernetes.io/external-dns"</span><span id="528f" class="ne lj iq kp b gy nj ng l nh ni">Created [https://dns.googleapis.com/dns/v1/projects/jaroslav-pantsjoha-contino/managedZones/jpworks-demo-squadzero-io].</span></pre><h2 id="48ea" class="ne lj iq bd lk nk nl dn lo nm nn dp ls jy no np lw kc nq nr ma kg ns nt me nu bi translated">DNSæ³¨å†Œå•†æ›´æ–°</h2><p id="f6f9" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">ç”¨æ‚¨çš„<strong class="jp ir">æ³¨å†Œå™¨</strong>æ›´æ–°NSè®°å½•ï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼Œæ›´æ—©åœ°æ”¾å¼ƒTTLï¼Œæˆ–è€…åªæ˜¯ç­‰å¾…é€šå¸¸çš„24å°æ—¶ï¼Œç›´åˆ°è®°å½•æ›´æ–°ä¼ æ’­ã€‚</p><p id="1312" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å†æ¬¡æ£€æŸ¥ï¼ŒæŸ¥çœ‹å®ƒä»¬æ˜¯å¦è¢«æ­£ç¡®ä¼ æ’­å¹¶åæ˜ åœ¨<code class="fe km kn ko kp b">dig</code>æŸ¥è¯¢ä¸­ã€‚</p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="d2db" class="ne lj iq kp b gy nf ng l nh ni">dig NS jpworks.squadzero.io<br/>...<br/>;; ANSWER SECTION:<br/>jpworks.squadzero.io.	21600	IN	NS	ns-cloud-c1.googledomains.com.<br/>jpworks.squadzero.io.	21600	IN	NS	ns-cloud-c2.googledomains.com.<br/>jpworks.squadzero.io.	21600	IN	NS	ns-cloud-c3.googledomains.com.<br/>jpworks.squadzero.io.	21600	IN	NS	ns-cloud-c4.googledomains.com.<br/>...</span></pre><h2 id="3fa4" class="ne lj iq bd lk nk nl dn lo nm nn dp ls jy no np lw kc nq nr ma kg ns nt me nu bi translated">DNS â€”é™„åŠ åŒºåŸŸå’ŒéªŒè¯</h2><p id="b932" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">é»˜è®¤è§†å›¾åº”è¯¥åŒ…å«å¤§çº¦2æ¡è®°å½•</p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="32fd" class="ne lj iq kp b gy nf ng l nh ni">jp$ gcloud dns record-sets list --zone "jpworks-demo-squadzero-io" <br/>NAME                        TYPE  TTL    DATA<br/>jpworks.squadzero.io.       NS    21600  ns-cloud-c1.googledomains.com.,ns-cloud-c2.googledomains.com.,ns-cloud-c3.googledomains.com.,ns-cloud-c4.googledomains.com.<br/>jpworks.squadzero.io.       SOA   21600  ns-cloud-c1.googledomains.com. cloud-dns-hostmaster.google.com. 1 21600 3600 259200 300</span></pre><p id="00c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Subzone Side Note </strong>:å¦‚æœæ‚¨åœ¨ä¸»zoneä¸­æœ‰ä¸€ä¸ª<strong class="jp ir">å­zone </strong>ï¼Œæ‚¨ä¹Ÿéœ€è¦å‘Šè¯‰æ ¹zoneåœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°è¿™äº›è®°å½•ã€‚</p><p id="eba0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é€šè¿‡åœ¨çˆ¶åŒºåŸŸæ·»åŠ ç›¸åº”çš„DNSè®°å½•ï¼Œå‘Šè¯‰çˆ¶åŒºåŸŸåœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°è¯¥åŒºåŸŸçš„DNSè®°å½•ã€‚å‡è®¾æ–°çš„åŒºåŸŸæ˜¯<code class="fe km kn ko kp b">demo.jpworks.squadzero.io</code>,åŸŸåæ˜¯<code class="fe km kn ko kp b">jpworks.squadzero.io</code>,å¹¶ä¸”å®ƒä¹Ÿæ‰˜ç®¡åœ¨Googleä¸Šï¼Œæˆ‘ä»¬å°†åšä»¥ä¸‹äº‹æƒ…ï¼›</p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="2169" class="ne lj iq kp b gy nf ng l nh ni">$ gcloud dns record-sets transaction start --zone "$PROJECT"<br/>$ gcloud dns record-sets transaction add ns-cloud-e{1..4}.googledomains.com. \<br/>    --name "jpworks.squadzero.io." --ttl 300 --type NS --zone $PROJECT"<br/>$ gcloud dns record-sets transaction execute --zone "$PROJECT"</span></pre><h1 id="bb76" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">æ¼”ç¤ºé›†ç¾¤è®¾ç½®</h1><p id="1119" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">åˆ›å»ºé»˜è®¤é›†ç¾¤-æ¼”ç¤ºé›†ç¾¤ã€‚è¯·æ³¨æ„æ‚¨çš„æ½œåœ¨å½“å‰ç¾¤é›†èŠ‚ç‚¹æ± é™„å¸¦çš„èŒƒå›´æƒé™â€”éœ€è¦CloudDNS RW â€”å¦‚æœæ‚¨æ²¡æœ‰ï¼Œæ‚¨å°†è¢«è¿«åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹æ± ã€‚ç¥ä½ å¥½è¿ã€‚</p><p id="1557" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½†æ˜¯ï¼Œä¸ºäº†æ¼”ç¤ºçš„ç®€å•ï¼Œæˆ‘å…è®¸æ‰€æœ‰çš„æƒé™èŒƒå›´ï¼Œä½†æ˜¯æ‚¨åº”è¯¥æ ¹æ®æ‚¨çš„éœ€è¦å°†æƒé™å‡å°‘åˆ°â€œæœ€ä½ç‰¹æƒè¦æ±‚â€ã€‚</p><p id="0ab4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe km kn ko kp b">A basic, default spec 2 node cluster with preemptible nodes</code></p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="970d" class="ne lj iq kp b gy nf ng l nh ni">gcloud beta container --project "$PROJECT" clusters create "$CLUSTER_NAME" \<br/>--zone "us-central1-a" --no-enable-basic-auth \<br/>--cluster-version "<!-- -->1.14.6-gke.2<!-- -->" --machine-type "n1-standard-2" \<br/>--image-type "COS" --disk-type "pd-ssd" --disk-size "50" \<br/>--metadata disable-legacy-endpoints=true \<br/>--scopes "https://www.googleapis.com/auth/cloud-platform" \<br/>--preemptible --num-nodes "2" \<br/>--enable-cloud-logging \<br/>--enable-stackdriver-kubernetes --enable-ip-alias \<br/>--network "projects/$PROJECT/global/networks/default" \<br/>--subnetwork "projects/$PROJECT/regions/us-central1/subnetworks/default" \<br/>--default-max-pods-per-node "110" --addons HorizontalPodAutoscaling,HttpLoadBalancing \<br/>--enable-autoupgrade \<br/>--enable-autorepair</span></pre><p id="05fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç¤ºä¾‹åˆ›å»ºçš„é›†ç¾¤</p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="67d2" class="ne lj iq kp b gy nf ng l nh ni">Creating cluster jpworks-cluster in us-central1-a... Cluster is being deployed...â ¼</span><span id="b1df" class="ne lj iq kp b gy nj ng l nh ni">kubeconfig entry generated for jpworks-cluster.<br/>NAME             LOCATION       MASTER_VERSION  MASTER_IP      MACHINE_TYPE   NODE_VERSION  NUM_NODES  STATUS<br/>jpworks-cluster  us-central1-a  1.13.7-gke.8    34.70.157.163  n1-standard-2  1.13.7-gke.8  2          RUNNING</span></pre><h2 id="8272" class="ne lj iq bd lk nk nl dn lo nm nn dp ls jy no np lw kc nq nr ma kg ns nt me nu bi translated">è¿æ¥åˆ°ç¾¤é›†</h2><p id="6ae8" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">é…ç½®æœ¬åœ°ç¯å¢ƒä»¥ä½¿ç”¨æ­£ç¡®çš„é¡¹ç›®ï¼Œå¹¶è·å–ç”¨äºç™»å½•çš„ç¾¤é›†å‡­æ®ã€‚</p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="edf1" class="ne lj iq kp b gy nf ng l nh ni">gcloud config set project $PROJECT<br/>gcloud container clusters get-credentials $CLUSTER_NAME --zone us-central1-a --project $PROJECT</span></pre><h1 id="7736" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">å‡†å¤‡éƒ¨ç½²åº”ç”¨ç¨‹åº</h1><p id="a0c0" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">å¼€å§‹:ä¸‹é¢çš„å®Œæ•´æ¼”ç¤ºYAMLåº”è¯¥æ˜¯ä½ æ‰€éœ€è¦çš„ã€‚</p><p id="3da6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå°†æ‰€æœ‰è¿™äº›YAMLæ¸…å•å¤åˆ¶ç²˜è´´åˆ°è¯¥æ–‡ä»¶å¤¹ä¸­ã€‚ç„¶åæ°å½“åœ°<code class="fe km kn ko kp b">kubectl apply -f .</code></p><p id="d795" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨ï¼Œç»„ä»¶ï¼›</p><h2 id="25c0" class="ne lj iq bd lk nk nl dn lo nm nn dp ls jy no np lw kc nq nr ma kg ns nt me nu bi translated">è¿›å…¥</h2><p id="f7be" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">é‡è¦çš„ä¸€ç‚¹â€”â€”è¿™æ˜¯å…¥å£<code class="fe km kn ko kp b">host</code>è®°å½•å°†è¢«<code class="fe km kn ko kp b">external-DNS</code>åº”ç”¨è·å–çš„åœ°æ–¹ã€‚è¿™å°†å°è¯•æ‰§è¡ŒAè®°å½•æ˜ å°„åˆ°åˆ†é…ç»™è¯¥å…¥å£(åœ¨GCPä¸Š)çš„æ‰€æä¾›çš„IPã€‚</p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="5536" class="ne lj iq kp b gy nf ng l nh ni">apiVersion: extensions/v1beta1<br/>kind: Ingress<br/>metadata:<br/>  name: nginx-ingress-default<br/>  annotations:<br/>    nginx.ingress.kubernetes.io/rewrite-target: /<br/>spec:<br/>  rules:<br/>  - host: nginx.jpworks.squadzero.io<br/>    http:<br/>      paths:<br/>      - backend:<br/>          serviceName: nginx-service<br/>          servicePort: 80</span></pre><h2 id="ddf8" class="ne lj iq bd lk nk nl dn lo nm nn dp ls jy no np lw kc nq nr ma kg ns nt me nu bi translated">Nginxæ¼”ç¤ºåº”ç”¨éƒ¨ç½²+æœåŠ¡</h2><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="cc20" class="ne lj iq kp b gy nf ng l nh ni">apiVersion: extensions/v1beta1<br/>kind: Deployment<br/>metadata:<br/>  labels:<br/>    run: nginx-app<br/>  name: nginx-app<br/>spec:<br/>  replicas: 1<br/>  selector:<br/>    matchLabels:<br/>      run: nginx-app<br/>  template:<br/>    metadata:<br/>      labels:<br/>        run: nginx-app<br/>    spec:<br/>      containers:<br/>        - name: nginx<br/>          image: nginx:1.15.7-perl<br/>          lifecycle:<br/>            postStart:<br/>              exec:<br/>                command:<br/>                  - "sh"<br/>                  - "-c"<br/>                  - &gt;<br/>                    mkdir -p /usr/share/nginx/html/ &amp;&amp; echo '&lt;h1&gt;hello world&lt;/h1&gt;&lt;p&gt;flux-kubernetes-demos/nginx&lt;/p&gt;' &gt; /usr/share/nginx/html/index.html;<br/>          ports:<br/>          - containerPort: 80</span><span id="c324" class="ne lj iq kp b gy nj ng l nh ni">---<br/>apiVersion: v1<br/>kind: Service<br/>metadata:<br/>  labels:<br/>    run: nginx-app<br/>  name: nginx-service<br/>  annotations:<br/>    cloud.google.com/load-balancer-type: "Internal"<br/>    external-dns.alpha.kubernetes.io/hostname: 'nginx-svc.jpworks.squadzero.io'<br/>spec:<br/>  type: LoadBalancer<br/>  ports:<br/>  - port: 80<br/>  selector:<br/>    run: nginx-app</span></pre><p id="5802" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœåŠ¡ç»„ä»¶å°±æ˜¯ä¸€ä¸ªä¾‹å­â€”â€”éœ€è¦<code class="fe km kn ko kp b">annotation</code>,ä½†å…è®¸æ‚¨è€ƒè™‘ç›¸åŒçš„DNSç®¡ç†ã€‚æˆ‘ç‰¹æ„ç”¨â€œ<strong class="jp ir"> type=loadbalancer </strong>â€è€Œä¸æ˜¯<code class="fe km kn ko kp b">internal</code> loadbalancerå­ç±»å‹æ¥ç»´æŠ¤æœåŠ¡ï¼Œæ‰€ä»¥æ²¡æœ‰<code class="fe km kn ko kp b">externalIP</code>å¼€é”€ã€‚</p><h2 id="9d48" class="ne lj iq bd lk nk nl dn lo nm nn dp ls jy no np lw kc nq nr ma kg ns nt me nu bi translated">å¤–éƒ¨-DNSéƒ¨ç½²+ rbac +æœåŠ¡å¸æˆ·</h2><p id="b62f" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">è¿™ä¸ªæ¼”ç¤ºçš„æœ€åä¸€ä¸ªå…³é”®éƒ¨åˆ†ã€‚</p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="910c" class="ne lj iq kp b gy nf ng l nh ni">apiVersion: extensions/v1beta1<br/>kind: Deployment<br/>metadata:<br/>  name: external-dns<br/>spec:<br/>  strategy:<br/>    type: Recreate<br/>  template:<br/>    metadata:<br/>      labels:<br/>        app: external-dns<br/>    spec:<br/>      serviceAccountName: external-dns<br/>      containers:<br/>      - name: external-dns<br/>        image: registry.opensource.zalan.do/teapot/external-dns:latest<br/>        args:<br/>        - --source=service<br/>        - --source=ingress<br/>        - --domain-filter=jpworks.squadzero.io # will make ExternalDNS see only the hosted zones matching provided domain, omit to process all available hosted zones<br/>        - --provider=google<br/>        - --google-project=jaroslav-pantsjoha-contino # Use this to specify a project different from the one external-dns is running inside<br/>        # - --policy=upsert-only # would prevent ExternalDNS from deleting any records, omit to enable full synchronization<br/>        - --registry=txt<br/>        - --txt-owner-id=my-jpworks-demo-domain</span><span id="2f53" class="ne lj iq kp b gy nj ng l nh ni">apiVersion: v1<br/>kind: ServiceAccount<br/>metadata:<br/>  name: external-dns<br/>---<br/>apiVersion: rbac.authorization.k8s.io/v1beta1<br/>kind: ClusterRole<br/>metadata:<br/>  name: external-dns<br/>rules:<br/>- apiGroups: [""]<br/>  resources: ["services"]<br/>  verbs: ["get","watch","list"]<br/>- apiGroups: [""]<br/>  resources: ["pods"]<br/>  verbs: ["get","watch","list"]<br/>- apiGroups: ["extensions"]<br/>  resources: ["ingresses"]<br/>  verbs: ["get","watch","list"]<br/>- apiGroups: [""]<br/>  resources: ["nodes"]<br/>  verbs: ["list"]<br/>---<br/>apiVersion: rbac.authorization.k8s.io/v1beta1<br/>kind: ClusterRoleBinding<br/>metadata:<br/>  name: external-dns-viewer<br/>roleRef:<br/>  apiGroup: rbac.authorization.k8s.io<br/>  kind: ClusterRole<br/>  name: external-dns<br/>subjects:<br/>- kind: ServiceAccount<br/>  name: external-dns<br/>  namespace: default<br/>---</span></pre><p id="723e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨ä¸‹é¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œå†æ¬¡å±•ç¤ºäº†<code class="fe km kn ko kp b">external-DNS</code>éƒ¨ç½²å€¼å¾—æ³¨æ„çš„ç‰¹æ€§ã€‚</p><p id="4ae1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">æ‚¨çš„å¾…åŠäº‹é¡¹</strong>:æ‚¨è‡³å°‘éœ€è¦<strong class="jp ir">æŒ‡å®š</strong>æ‚¨è‡ªå·±çš„<strong class="jp ir">åŸŸåŒºåŸŸ</strong>å’Œ<strong class="jp ir">é¡¹ç›®åç§°</strong>ã€‚</p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="d9b0" class="ne lj iq kp b gy nf ng l nh ni">args:<br/>        - --source=service # explicitly select your sources<br/>        - --source=ingress</span><span id="2d5d" class="ne lj iq kp b gy nj ng l nh ni">        - --domain-filter=jpworks.squadzero.io # will make ExternalDNS see only the hosted zones matching provided domain, omit to process all available hosted zones</span><span id="5b12" class="ne lj iq kp b gy nj ng l nh ni">        - --provider=google # can be aws,azure and many others</span><span id="c5e1" class="ne lj iq kp b gy nj ng l nh ni">        - --google-project=jaroslav-pantsjoha-contino # Use this to specify a project different from the one external-dns is running inside<br/>        - --policy=upsert-only # would prevent ExternalDNS from deleting any records, omit to enable full synchronization</span><span id="c2e0" class="ne lj iq kp b gy nj ng l nh ni">        - --registry=txt<br/>        - --txt-owner-id=my-jpworks-demo-domain</span></pre><h2 id="017d" class="ne lj iq bd lk nk nl dn lo nm nn dp ls jy no np lw kc nq nr ma kg ns nt me nu bi translated">è®©æˆ‘ä»¬å¼€å§‹å§ï¼</h2><p id="f04e" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated"><code class="fe km kn ko kp b">jp$ kubectl apply -f .</code></p><p id="2f33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ›´å¥½çš„æ˜¯ï¼Œå¦‚æœä½ é‡‡ç”¨<strong class="jp ir"> #GitOps CICDå‘å¸ƒ-éƒ¨ç½²æ–¹æ³•è®º</strong>ï¼Œä½ å¯ä»¥è®©<a class="ae kl" href="https://github.com/fluxcd/flux" rel="noopener ugc nofollow" target="_blank"> weaveworks flux </a>è¿™æ ·çš„<strong class="jp ir">è‡ªåŠ¨</strong> - <strong class="jp ir">å‘å¸ƒ</strong>ã€‚</p><p id="ca1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœä½ æƒ³äº†è§£æ›´å¤šï¼Œè¯·è”ç³»æˆ‘ä»¬ï¼</p><p id="3b4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å›åˆ°æ¼”ç¤ºï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å‰é¢æåˆ°çš„åœ¨ç¾¤é›†ä¸Šâ€œå…¨éƒ¨åº”ç”¨â€çš„ç»“æœã€‚</p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="cb00" class="ne lj iq kp b gy nf ng l nh ni">jp$ kubectl apply -f .<br/>configmap/nginx-configuration configured<br/>deployment.extensions/nginx-app configured<br/>service/nginx-service configured<br/>deployment.extensions/external-dns configured<br/>serviceaccount/external-dns configured<br/>clusterrole.rbac.authorization.k8s.io/external-dns configured<br/>clusterrolebinding.rbac.authorization.k8s.io/external-dns-viewer configured</span></pre><h1 id="041f" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">ç°åœ¨æ€ä¹ˆåŠ</h1><p id="b042" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated"><code class="fe km kn ko kp b">external-dns</code>æ¼”ç¤ºçš„å®Œå…¨æˆåŠŸå±•ç¤ºå¤§çº¦éœ€è¦3-5åˆ†é’Ÿï¼Œä¸»è¦æ˜¯å› ä¸ºGCPæ§åˆ¶é¢æ¿ä¸Šçš„å…¥å£IPè®¾ç½®éœ€è¦ä¸€äº›æ—¶é—´ã€‚æœåŠ¡å’Œå…¥å£å®Œå…¨é…ç½®åï¼Œæ‚¨å¯ä»¥åœ¨ä¸Šè§‚çœ‹æ¼”ç¤ºï¼›</p><p id="8307" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åŒæ—¶ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç›‘æ§éƒ¨ç½²è¿›åº¦:</p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="1d2f" class="ne lj iq kp b gy nf ng l nh ni">kubectl get po -w</span></pre><p id="a3bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç„¶åæ˜¯æœåŠ¡å’Œå…¥å£</p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="0448" class="ne lj iq kp b gy nf ng l nh ni">kubectl get svc,ing</span></pre><p id="8f4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚¨åº”è¯¥åœ¨æœåŠ¡å’Œå…¥å£çš„<code class="fe km kn ko kp b">External IP</code>ä¸ŠæŸ¥çœ‹IPåœ°å€ã€‚</p><p id="cb1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">ä¾‹å¦‚:</strong></p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="e8bd" class="ne lj iq kp b gy nf ng l nh ni">kubectl get svc,ing<br/>NAME                    TYPE           CLUSTER-IP   EXTERNAL-IP   PORT(S)        AGE<br/>service/kubernetes      ClusterIP      10.0.0.1     &lt;none&gt;        443/TCP        28m<br/>service/memcached       ClusterIP      None         &lt;none&gt;        11211/TCP      6m49s<br/>service/nginx-service   LoadBalancer   10.0.1.243   10.128.0.16   80:30903/TCP   26m</span><span id="a2c2" class="ne lj iq kp b gy nj ng l nh ni">NAME                                       HOSTS                        ADDRESS        PORTS   AGE<br/>ingress.extensions/nginx-ingress-default   nginx.jpworks.squadzero.io   34.96.92.237   80      26m</span></pre><p id="6862" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è®©æˆ‘ä»¬ç¡®è®¤ä¸€ä¸‹<code class="fe km kn ko kp b">external-DNS</code>æ˜¯å¦ä¹ŸæŒ‰é¢„æœŸå·¥ä½œã€‚</p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="dca1" class="ne lj iq kp b gy nf ng l nh ni">time="2019-09-27T10:06:40Z" level=info msg="Change zone: jpworks-demo-squadzero-io"</span><span id="155e" class="ne lj iq kp b gy nj ng l nh ni">time="2019-09-27T10:06:40Z" level=info msg="Add records: nginx.jpworks.squadzero.io. A [<!-- -->34.96.92.237<!-- -->] 300"</span><span id="db5e" class="ne lj iq kp b gy nj ng l nh ni">time="2019-09-27T10:06:40Z" level=info msg="Add records: nginx.jpworks.squadzero.io. TXT [\"heritage=external-dns,external-dns/owner=my-jpworks-demo-domain,external-dns/resource=ingress/default/nginx-ingress-default\"] 300"</span><span id="f257" class="ne lj iq kp b gy nj ng l nh ni">time="2019-09-27T10:07:40Z" level=info msg="Change zone: jpworks-demo-squadzero-io"</span><span id="8992" class="ne lj iq kp b gy nj ng l nh ni">time="2019-09-27T10:07:40Z" level=info msg="Add records: nginx-svc.jpworks.squadzero.io. A [<!-- -->10.128.0.16<!-- -->] 300"</span><span id="a465" class="ne lj iq kp b gy nj ng l nh ni">time="2019-09-27T10:07:40Z" level=info msg="Add records: nginx-svc.jpworks.squadzero.io. TXT [\"heritage=external-dns,external-dns/owner=my-jpworks-demo-domain,external-dns/resource=service/default/nginx-service\"] 300"</span></pre><p id="91ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è®©æˆ‘ä»¬ä¹Ÿç¡®è®¤ä¸€ä¸‹åŸŸzoneæ˜¯å¦å¾—åˆ°äº†æ‰€æœ‰ç›¸å…³çš„æ›´æ–°ï¼Œå°±åƒ<code class="fe km kn ko kp b">external-dns</code>æ‰€è¯´çš„é‚£æ ·ã€‚</p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="9e98" class="ne lj iq kp b gy nf ng l nh ni">gcloud dns record-sets list     --zone "jpworks-demo-squadzero-io"<br/></span><span id="faa7" class="ne lj iq kp b gy nj ng l nh ni">NAME                             TYPE  TTL    DATA</span><span id="e7d5" class="ne lj iq kp b gy nj ng l nh ni">jpworks.squadzero.io.            NS    21600  ns-cloud-c1.googledomains.com.,ns-cloud-c2.googledomains.com.,ns-cloud-c3.googledomains.com.,ns-cloud-c4.googledomains.com.</span><span id="7d97" class="ne lj iq kp b gy nj ng l nh ni">jpworks.squadzero.io.            SOA   21600  ns-cloud-c1.googledomains.com. cloud-dns-hostmaster.google.com. 1 21600 3600 259200 300</span><span id="6b6f" class="ne lj iq kp b gy nj ng l nh ni">nginx.jpworks.squadzero.io.      A     300    34.96.92.237</span><span id="c121" class="ne lj iq kp b gy nj ng l nh ni">nginx.jpworks.squadzero.io.      TXT   300    "heritage=external-dns,external-dns/owner=my-jpworks-demo-domain,external-dns/resource=ingress/default/nginx-ingress-default"</span><span id="82bc" class="ne lj iq kp b gy nj ng l nh ni">nginx-svc.jpworks.squadzero.io.  A     300    10.128.0.16</span><span id="2ac8" class="ne lj iq kp b gy nj ng l nh ni">nginx-svc.jpworks.squadzero.io.  TXT   300    "heritage=external-dns,external-dns/owner=my-jpworks-demo-domain,external-dns/resource=service/default/nginx-service"</span></pre><h1 id="f150" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">çœ‹èµ·æ¥ä¸é”™ï¼Œä½†æ˜¯å¯ä»¥è®¿é—®å—ï¼Ÿ</h1><p id="c093" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">ä¸å¹¸çš„æ˜¯ï¼Œæœ‰äº›å‡ºä¹æ„æ–™çš„æ˜¯ï¼Œç¬¬ä¸€æ¬¡è¿›è¡Œå…¥å£è®¾ç½®å’Œå®Œå…¨é…ç½®ç¡®å®éœ€è¦ä¸€æ®µæ—¶é—´ã€‚åœ¨åå°å¯åŠ¨äº†è®¸å¤šè¿›ç¨‹ï¼Œå¦‚IPè¯·æ±‚å’Œé¢„è®¢ï¼Œä»¥åŠåç«¯æ˜ å°„ã€IPè½¬å‘è§„åˆ™ç­‰ç­‰ã€‚å®é™…ä¸Šï¼Œè€ƒè™‘åˆ°è¿™ç§æ–¹æ³•æä¾›äº†ç”Ÿäº§çº§å¯ä¼¸ç¼©æ¶æ„ï¼Œè¿™ç§æ—¶é—´å»¶è¿ŸçœŸçš„æ²¡æœ‰é‚£ä¹ˆç³Ÿç³•ã€‚</p><p id="e758" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºäº†æ˜ç¡®å’Œå…¬å¹³åœ°å¯¹å¾…å…¥å£ä¾›åº”å»¶è¿Ÿï¼Œå¦‚æœæ‚¨ç¡®å®æƒ³å°†ä¸€ä¸ªâ€œæ™®é€šçš„â€æœåŠ¡<code class="fe km kn ko kp b">externalIP</code>æ˜ å°„åˆ°ä¸€ä¸ªè®°å½•ï¼Œè¿™å°†ç«‹å³å¯ç”¨å’Œå¯è®¿é—®ã€‚</p><p id="8dfa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç„¶åï¼Œå¤–éƒ¨æµé‡å°†ç›´æ¥å½±å“æ‚¨çš„k8æœåŠ¡ï¼Œåœ¨éƒ¨ç½²é…ç½®çš„ä»»æ„æ•°é‡çš„podä¸Šè´Ÿè½½å¹³è¡¡<code class="fe km kn ko kp b">rr</code>è¿™æ ·çš„æµé‡ã€‚å°±æ˜¯è¿™æ ·ã€‚æ²¡æœ‰é«˜çº§åŠŸèƒ½æˆ–é€»è¾‘ï¼›æ²¡æœ‰æµé‡è·¯ç”±åˆ†å‰²ã€WAFæˆ–SSLå¸è½½ã€‚</p><p id="5fbf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åªéœ€ä¸€åˆ†é’Ÿå°±å¯ä»¥æ·»åŠ ä¸€ä¸ªè®°å½•ã€‚</p><p id="5552" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸€æ—¦ingresså®Œå…¨å‡†å¤‡å°±ç»ªï¼Œè¿™ä¸ªnginxåº”ç”¨ç¨‹åºå°†å¯ä»¥å…¬å¼€è®¿é—®<code class="fe km kn ko kp b"><a class="ae kl" href="http://nginx.jpworks.squadzero.io" rel="noopener ugc nofollow" target="_blank">http://nginx.jpworks.squadzero.io</a></code></p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="80b4" class="ne lj iq kp b gy nf ng l nh ni">curl nginx.jpworks.squadzero.io</span><span id="d4a0" class="ne lj iq kp b gy nj ng l nh ni">&lt;h1&gt;hello world&lt;/h1&gt;&lt;p&gt;flux-kubernetes-demos/nginx&lt;/p&gt;</span></pre><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi nv"><img src="../Images/1cfd77ca80c1231c7f366ff1c1f8ab3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2VWlUDa3OaNSvASoRBxlxA.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">æ˜¯çš„ï¼Œå®ƒå°±åƒé­”æœ¯ä¸€æ ·ï¼Œæ‹‰é‡Œæ¬£å–œè‹¥ç‹‚ï¼å¤§å®¶æ‹‰é‡ŒÂ·æˆ´å¿«ä¹ï¼</figcaption></figure><p id="d09c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ€åï¼ŒNginxæœåŠ¡Aè®°å½•ä¹Ÿè¢«è®°å½•ï¼Œä½†é‚£åªæ˜¯<code class="fe km kn ko kp b">internal</code> DNSã€‚é€šè¿‡digéªŒè¯åŸºäºæœåŠ¡çš„DNSæ˜ å°„ä»¥è¿›è¡Œç¡®è®¤ã€‚</p><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="de31" class="ne lj iq kp b gy nf ng l nh ni">jp$ dig A <!-- -->nginx-svc.jpworks.squadzero.io<br/>...</span><span id="4def" class="ne lj iq kp b gy nj ng l nh ni">;; ANSWER SECTION:<br/>;nginx-svc.jpworks.squadzero.io.   111 IN  A   10.128.0.16</span></pre><h1 id="7f0c" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">å¸Œæœ›ä½ å–œæ¬¢è¿™ä¸ªæ¼”ç¤º</h1><p id="52ed" class="pw-post-body-paragraph jn jo iq jp b jq mg js jt ju mh jw jx jy mi ka kb kc mj ke kf kg mk ki kj kk ij bi translated">å¦‚æœä½ è§‰å¾—æœ‰ç”¨ï¼Œç»™ä¸ªèµï¼Œåˆ†äº«ä¸€ä¸‹ï¼Œç»™ç‚¹å¥½å°è±¡*</p><p id="2eda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lc">ä¸‹æ¬¡è§ï¼Œ</em></p><p id="e417" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é›…ç½—æ–¯æ‹‰å¤«Â·æ½˜ç‰¹ä¹”å“ˆ</p><h2 id="7592" class="ne lj iq bd lk nk nl dn lo nm nn dp ls jy no np lw kc nq nr ma kg ns nt me nu bi translated">å¯é€‰:æ¸…ç†</h2><pre class="kr ks kt ku gt na kp nb nc aw nd bi"><span id="200e" class="ne lj iq kp b gy nf ng l nh ni">Nuking cluster. Be careful not to nuke anything else by accident. <em class="lc">â€œDonâ€™t do anything I would doâ€</em></span><span id="d60b" class="ne lj iq kp b gy nj ng l nh ni">jp$ gcloud container clusters list<br/>NAME             LOCATION       MASTER_VERSION  MASTER_IP      MACHINE_TYPE   NODE_VERSION  NUM_NODES  STATUS<br/>jpworks-cluster  us-central1-a  1.13.7-gke.8    34.70.157.163  n1-standard-2  1.13.7-gke.8  2          RUNNING<br/></span><span id="e3d7" class="ne lj iq kp b gy nj ng l nh ni">jp$ gcloud container clusters delete jpworks-cluster --zone us-central1-a<br/></span><span id="4958" class="ne lj iq kp b gy nj ng l nh ni">The following clusters will be deleted.</span><span id="137e" class="ne lj iq kp b gy nj ng l nh ni">- [jpworks-cluster] in [us-central1-a]</span><span id="52df" class="ne lj iq kp b gy nj ng l nh ni">Do you want to continue (Y/n)?  y</span><span id="9a2a" class="ne lj iq kp b gy nj ng l nh ni">Deleting cluster jpworks-cluster...â </span></pre><p id="9a03" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Continoæ­£åœ¨å¼€å±•ä¸€ç³»åˆ—æ¿€åŠ¨äººå¿ƒçš„Kubernetesé¡¹ç›®ã€‚å¦‚æœæ‚¨æ­£åœ¨å¯»æ‰¾æœ€æ–°æœ€æ£’çš„åŸºç¡€æ¶æ„å †æ ˆï¼Œæˆ–è€…æ­£åœ¨å¯»æ‰¾æŒ‘æˆ˜ï¼Œè¯·è”ç³»æˆ‘ä»¬ï¼æˆ‘ä»¬æ­£åœ¨æ‹›è˜ï¼</p><p id="5071" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬åœ¨å„ä¸ªå±‚é¢å¯»æ‰¾èªæ˜çš„äººã€‚åœ¨Continoï¼Œæˆ‘ä»¬è‡ªè±ªåœ°ä¸ºä¸­å‹ä¼ä¸šå’Œå¤§å‹ä¼ä¸šæä¾›æœ€ä½³å®è·µäº‘è½¬å‹é¡¹ç›®ã€‚</p><p id="1a7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://www.linkedin.com/in/johas/" rel="noopener ugc nofollow" target="_blank"> JP </a></p><h1 id="f4b5" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">é¡ºä¾¿è¯´ä¸€ä¸‹ï¼ŒğŸ‘ğŸ»*é¼“æŒ*ğŸ‘ğŸ»å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·ä¸¾æ‰‹(é«˜è¾¾50å€)ã€‚å®ƒé¼“åŠ±æˆ‘ç»§ç»­å†™ä½œï¼Œå¹¶å¸®åŠ©å…¶ä»–äººæ‰¾åˆ°å®ƒ:)</h1></div></div>    
</body>
</html>