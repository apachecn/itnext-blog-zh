<html>
<head>
<title>Devise and SAML Authentication with Ruby On Rails (Line Works)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨Ruby On Railsè®¾è®¡å’ŒSAMLè®¤è¯(Line Works)</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/devise-and-saml-authentication-with-ruby-on-rails-line-works-e04b5174be1d?source=collection_archive---------1-----------------------#2018-02-10">https://itnext.io/devise-and-saml-authentication-with-ruby-on-rails-line-works-e04b5174be1d?source=collection_archive---------1-----------------------#2018-02-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7fb3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">è®¤è¯å’Œæˆæƒ(ç”Ÿäº§çº¿å·¥ç¨‹)</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a7b4da46e068773016967b841a03e69c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MD7ON6MwDHgHK3WiIGXnaQ.jpeg"/></div></div></figure><h1 id="b713" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated"><strong class="ak">ä»€ä¹ˆæ˜¯SAMLï¼Ÿ</strong></h1><p id="9186" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å®‰å…¨å£°æ˜æ ‡è®°è¯­è¨€(SAML)æ˜¯ä¸€ä¸ªåŸºäºXMLçš„æ¡†æ¶ï¼Œç”¨äºåœ¨ä¸¤ä¸ªå®ä½“(æœåŠ¡æä¾›å•†å’Œèº«ä»½æä¾›å•†)ä¹‹é—´è¿›è¡Œèº«ä»½éªŒè¯å’Œæˆæƒã€‚æœåŠ¡æä¾›å•†åŒæ„ä¿¡ä»»èº«ä»½æä¾›å•†æ¥è®¤è¯ç”¨æˆ·ã€‚ä½œä¸ºå›æŠ¥ï¼Œèº«ä»½æä¾›è€…ç”Ÿæˆä¸€ä¸ªèº«ä»½éªŒè¯å£°æ˜ï¼Œè¡¨æ˜ç”¨æˆ·å·²ç»è¿‡èº«ä»½éªŒè¯ã€‚</p><p id="5955" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">SAMLæ˜¯ä¸€ç§æ ‡å‡†çš„å•ç‚¹ç™»å½•(SSO)æ ¼å¼ã€‚è®¤è¯ä¿¡æ¯é€šè¿‡æ•°å­—ç­¾åçš„XMLæ–‡æ¡£è¿›è¡Œäº¤æ¢ã€‚è¿™æ˜¯ä¸€ä¸ªå¤æ‚çš„å•ç‚¹ç™»å½•(SSO)å®ç°ï¼Œæ”¯æŒæ— ç¼è®¤è¯ï¼Œä¸»è¦æ˜¯åœ¨ä¼ä¸šå’Œä¼ä¸šä¹‹é—´ã€‚<br/>æœ‰äº†SAMLï¼Œä½ ä¸å¿…æ‹…å¿ƒè¾“å…¥è®¤è¯å‡­è¯æˆ–è€…è®°ä½å¹¶é‡ç½®å¯†ç ã€‚</p><h1 id="dc03" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated"><strong class="ak">SAMLè®¤è¯æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</strong></h1><p id="83fc" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">SAMLèº«ä»½éªŒè¯æœ‰ä»¥ä¸‹å¥½å¤„:</p><blockquote class="mk ml mm"><p id="0d56" class="lj lk mn ll b lm mf jr lo lp mg ju lr mo mh lu lv mp mi ly lz mq mj mc md me ij bi translated"><strong class="ll ir"> <em class="iq">æ ‡å‡†åŒ–:</em> </strong> <em class="iq"> SAMLæ˜¯ä¸€ç§æ ‡å‡†æ ¼å¼ï¼Œå…è®¸ç³»ç»Ÿä¹‹é—´çš„æ— ç¼äº’æ“ä½œï¼Œç‹¬ç«‹äºå®ç°ã€‚å®ƒæ¶ˆé™¤äº†ä¸ä¾›åº”å•†å’Œå¹³å°ç‰¹å®šçš„æ¶æ„å’Œå®ç°ç›¸å…³çš„å¸¸è§é—®é¢˜ã€‚</em></p><p id="4ae0" class="lj lk mn ll b lm mf jr lo lp mg ju lr mo mh lu lv mp mi ly lz mq mj mc md me ij bi translated"><strong class="ll ir"> <em class="iq">æ”¹å–„ç”¨æˆ·ä½“éªŒ:</em> </strong> <em class="iq">ç”¨æˆ·åªéœ€ç™»å½•ä¸€æ¬¡å³å¯è®¿é—®å¤šä¸ªæœåŠ¡æä¾›å•†ï¼Œæ— éœ€é¢å¤–çš„èº«ä»½éªŒè¯ï¼Œä»è€Œåœ¨æ¯ä¸ªæœåŠ¡æä¾›å•†å¤„è·å¾—æ›´å¿«ã€æ›´å¥½çš„ä½“éªŒã€‚è¿™æ¶ˆé™¤äº†å¯†ç é—®é¢˜ï¼Œå¦‚é‡ç½®å’Œæ¢å¤ã€‚</em></p><p id="fa96" class="lj lk mn ll b lm mf jr lo lp mg ju lr mo mh lu lv mp mi ly lz mq mj mc md me ij bi translated"><strong class="ll ir"> <em class="iq">å¢åŠ å®‰å…¨æ€§:</em> </strong> <em class="iq">å®‰å…¨æ€§æ˜¯è½¯ä»¶å¼€å‘çš„ä¸€ä¸ªå…³é”®æ–¹é¢ï¼Œå¯¹äºä¼ä¸šåº”ç”¨æ¥è¯´ï¼Œæ›´æ˜¯æå…¶é‡è¦ã€‚SAMLæä¾›å•ç‚¹èº«ä»½éªŒè¯ï¼Œè¿™å‘ç”Ÿåœ¨å®‰å…¨çš„èº«ä»½æä¾›è€…å¤„ã€‚ç„¶åï¼ŒSAMLå°†èº«ä»½ä¼ é€’ç»™æœåŠ¡æä¾›å•†ã€‚è¿™ç§å½¢å¼çš„èº«ä»½éªŒè¯ç¡®ä¿å‡­è¯ä¸ä¼šç¦»å¼€é˜²ç«å¢™è¾¹ç•Œã€‚</em></p><p id="b02b" class="lj lk mn ll b lm mf jr lo lp mg ju lr mo mh lu lv mp mi ly lz mq mj mc md me ij bi translated"><strong class="ll ir"> <em class="iq">ç›®å½•çš„æ¾è€¦åˆ:</em> </strong> <em class="iq"> SAMLä¸éœ€è¦ç»´æŠ¤ç”¨æˆ·ä¿¡æ¯ï¼Œä¹Ÿä¸éœ€è¦ç›®å½•é—´çš„åŒæ­¥ã€‚</em></p><p id="d017" class="lj lk mn ll b lm mf jr lo lp mg ju lr mo mh lu lv mp mi ly lz mq mj mc md me ij bi translated"><strong class="ll ir"> <em class="iq">é™ä½æœåŠ¡æä¾›å•†çš„æˆæœ¬:</em> </strong> <em class="iq">ä½¿ç”¨SAMLï¼Œæ‚¨ä¸å¿…è·¨å¤šä¸ªæœåŠ¡ç»´æŠ¤å¸æˆ·ä¿¡æ¯ã€‚èº«ä»½æä¾›è€…æ‰¿æ‹…è¿™ä¸€è´Ÿæ‹…ã€‚</em></p></blockquote><h1 id="1acd" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated"><strong class="ak">ä¸ºä»€ä¹ˆç»„ç»‡ä½¿ç”¨SAMLï¼Ÿ</strong></h1><p id="ec7d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">éšç€å„ç§ç»„ç»‡å°†å…¶åŸºç¡€è®¾æ–½ã€æœåŠ¡å’Œæ•°æ®è¿ç§»åˆ°äº‘ä¸­ï¼ŒSAMLæä¾›äº†ä¸€ç§å®‰å…¨çš„æ–¹æ³•ï¼Œç”¨äºåœ¨ä¸æ–­æ‰©å¤§çš„å¹³å°ã€æ•°å­—æ¥è§¦ç‚¹å’Œè®¾å¤‡èŒƒå›´å†…å¯¹ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯å’Œæˆæƒã€‚SAMLé€šè¿‡ä½¿æ¶ˆè´¹è€…æ›´å®¹æ˜“è®¿é—®Webåº”ç”¨ç¨‹åºï¼Œå®ç°äº†æ›´å¥å£®çš„è¿æ¥ç³»ç»Ÿã€‚</p><p id="4894" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">SAMLé€šè¿‡å¯ç”¨åŸºäºä»¤ç‰Œçš„èº«ä»½éªŒè¯äº¤æ¢æ¶ˆé™¤äº†å¯¹å¤šä¸ªWebåº”ç”¨ç¨‹åºå¯†ç çš„éœ€æ±‚ï¼Œè¿™ç§èº«ä»½éªŒè¯äº¤æ¢å‘ç”Ÿåœ¨IdPé˜²ç«å¢™å†…éƒ¨çš„IdP(æŒæœ‰ç”¨æˆ·å‡­æ®)å’ŒSP(æœåŠ¡æä¾›å•†)ä¹‹é—´ã€‚åœ¨â€œSPå¯åŠ¨çš„â€SAMLäº‹åŠ¡ä¸­ï¼Œå½“ç”¨æˆ·è¯·æ±‚è®¿é—®æŸä¸ªåº”ç”¨ç¨‹åºæ—¶ï¼ŒSPä¼šè‡ªåŠ¨å°†ä»–ä»¬é‡å®šå‘åˆ°IdPï¼Œåœ¨IdPä¸­å¯¹ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯ï¼Œè€Œä¸ä¼šå°†ä¸ªäººä¿¡æ¯ä¼ é€’ç»™SPçš„ç³»ç»Ÿã€‚</p><p id="b186" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">SAMLé€šè¿‡å¯ç”¨å•ç‚¹ç™»å½•(SSO)åŠŸèƒ½è§£å†³äº†ä¸€ä¸ªå…³é”®æŒ‘æˆ˜:å…è®¸ç”¨æˆ·æ³¨å†Œæˆ–ç™»å½•ï¼Œå¹¶åœ¨ä¸€æ®µæ—¶é—´å†…ä½¿ç”¨ä¸€ç»„å‡­æ®è·å¾—è·¨å¤šä¸ªå±æ€§çš„æˆæƒã€‚SAMLè¿˜æ”¯æŒå•ç‚¹æ³¨é”€åŠŸèƒ½ï¼Œç¡®ä¿å½“ç”¨æˆ·ä»ä¸€ä¸ªç«™ç‚¹æ³¨é”€æ—¶ï¼Œä»–ä»¬ä¼šè‡ªåŠ¨ä»è¯¥å…¬å¸æ‹¥æœ‰çš„æ‰€æœ‰å…¶ä»–æœåŠ¡æä¾›å•†å¤„æ³¨é”€ã€‚</p><h1 id="fa7f" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">ã€SAMLè®¤è¯æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</h1><p id="757a" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">SAML SSOçš„å·¥ä½œæ–¹å¼æ˜¯å°†ç”¨æˆ·çš„èº«ä»½ä»ä¸€ä¸ªåœ°æ–¹(èº«ä»½æä¾›è€…)è½¬ç§»åˆ°å¦ä¸€ä¸ªåœ°æ–¹(æœåŠ¡æä¾›è€…)ã€‚è¿™æ˜¯é€šè¿‡äº¤æ¢æ•°å­—ç­¾åçš„XMLæ–‡æ¡£æ¥å®Œæˆçš„ã€‚</p><p id="d548" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">å‡è®¾:ä¸€ä¸ªç”¨æˆ·ç™»å½•åˆ°ä¸€ä¸ªå……å½“èº«ä»½æä¾›è€…çš„ç³»ç»Ÿã€‚ç”¨æˆ·å¸Œæœ›ç™»å½•åˆ°ä¸€ä¸ªè¿œç¨‹åº”ç”¨ç¨‹åºï¼Œå¦‚æ™ºèƒ½æµåº”ç”¨ç¨‹åº(æœåŠ¡æä¾›å•†)ã€‚ä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µ:</p><blockquote class="mk ml mm"><p id="20e6" class="lj lk mn ll b lm mf jr lo lp mg ju lr mo mh lu lv mp mi ly lz mq mj mc md me ij bi translated"><em class="iq"> -ç”¨æˆ·è®¿é—®æ™ºèƒ½æµç¨‹åº”ç”¨(</em><a class="ae mr" href="https://smartflow.vebuin.com/" rel="noopener ugc nofollow" target="_blank"><em class="iq">ã€https://smartflow.vebuin.comã€‘</em></a><em class="iq">)ã€‚</em></p><p id="e3be" class="lj lk mn ll b lm mf jr lo lp mg ju lr mo mh lu lv mp mi ly lz mq mj mc md me ij bi translated"><em class="iq"> -åº”ç”¨ç¨‹åºè¯†åˆ«ç”¨æˆ·çš„æ¥æº(é€šè¿‡åº”ç”¨ç¨‹åºå­åŸŸã€ç”¨æˆ·IPåœ°å€æˆ–ç±»ä¼¼ä¿¡æ¯)ï¼Œå¹¶å°†ç”¨æˆ·é‡å®šå‘å›èº«ä»½æä¾›å•†ï¼Œè¦æ±‚è¿›è¡Œèº«ä»½éªŒè¯ã€‚è¿™æ˜¯è®¤è¯è¯·æ±‚ã€‚</em></p><p id="6854" class="lj lk mn ll b lm mf jr lo lp mg ju lr mo mh lu lv mp mi ly lz mq mj mc md me ij bi translated"><em class="iq"> -ç”¨æˆ·ä¸èº«ä»½æä¾›è€…ä¹‹é—´å­˜åœ¨æ´»åŠ¨çš„æµè§ˆå™¨ä¼šè¯ï¼Œæˆ–è€…é€šè¿‡ç™»å½•èº«ä»½æä¾›è€…å»ºç«‹ä¸€ä¸ªä¼šè¯ã€‚</em></p><p id="0b09" class="lj lk mn ll b lm mf jr lo lp mg ju lr mo mh lu lv mp mi ly lz mq mj mc md me ij bi translated"><em class="iq"> -èº«ä»½æä¾›è€…ä»¥åŒ…å«ç”¨æˆ·ç”¨æˆ·åæˆ–ç”µå­é‚®ä»¶åœ°å€çš„XMLæ–‡æ¡£çš„å½¢å¼æ„å»ºè®¤è¯å“åº”ã€‚</em></p><p id="7746" class="lj lk mn ll b lm mf jr lo lp mg ju lr mo mh lu lv mp mi ly lz mq mj mc md me ij bi translated"><em class="iq"> -å·²ç»çŸ¥é“èº«ä»½æä¾›è€…å¹¶å…·æœ‰è¯ä¹¦æŒ‡çº¹çš„æœåŠ¡æä¾›è€…æ£€ç´¢è®¤è¯å“åº”ï¼Œå¹¶ä½¿ç”¨è¯ä¹¦æŒ‡çº¹å¯¹å…¶è¿›è¡ŒéªŒè¯ã€‚</em></p><p id="9297" class="lj lk mn ll b lm mf jr lo lp mg ju lr mo mh lu lv mp mi ly lz mq mj mc md me ij bi translated"><em class="iq"> -å»ºç«‹ç”¨æˆ·çš„èº«ä»½ï¼Œå¹¶å‘ç”¨æˆ·æä¾›åº”ç”¨ç¨‹åºè®¿é—®ã€‚</em></p></blockquote><h1 id="16f9" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated"><strong class="ak"> SAMLå•ç‚¹ç™»å½•æµç¨‹</strong></h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/ba056863142440e646e69ccc585399dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VjHzaDNcD_lfTpSq.gif"/></div></div></figure><h1 id="9891" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated"><strong class="ak"> SAML vs OAuth </strong></h1><p id="82f3" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">OAuthæ˜¯æ¯”SAMLæ›´æ–°çš„æ ‡å‡†ï¼Œç”±Googleå’ŒTwitteräº2006å¹´è”åˆå¼€å‘ã€‚å¼€å‘å®ƒçš„éƒ¨åˆ†åŸå› æ˜¯ä¸ºäº†å¼¥è¡¥SAMLåœ¨ç§»åŠ¨å¹³å°ä¸Šçš„ä¸è¶³ï¼Œå®ƒåŸºäºJSONè€Œä¸æ˜¯XMLã€‚</p><p id="98e7" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">é™¤äº†SAMLä¸å¤ªå‡ºè‰²çš„ç§»åŠ¨æ”¯æŒï¼Œä¸¤è€…æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼ŒSAMLæ ‡å‡†å®šä¹‰äº†æä¾›è€…å¦‚ä½•æä¾›è®¤è¯å’ŒæˆæƒæœåŠ¡ã€‚å¦ä¸€æ–¹é¢ï¼ŒOAuthåªå¤„ç†æˆæƒã€‚</p><h1 id="c03e" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated"><strong class="ak">ä½ éœ€è¦ä»€ä¹ˆï¼Ÿ</strong></h1><p id="8294" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">è¦åœ¨Railsåº”ç”¨ç¨‹åºä¸­å¯ç”¨SAMLåŠŸèƒ½ï¼Œæ‚¨éœ€è¦ä¸€ä¸ªèº«ä»½æä¾›è€…ã€‚ç›®å‰æˆ‘æœ‰Line workså’Œoktaã€‚è¿™æ˜¯çº¿æ¡ä½œå“çš„ä¾‹å­ã€‚å¦‚æœä½ æ²¡æœ‰Line Workså¸æˆ·ï¼Œé‚£ä¹ˆä½ ä¹Ÿå¯ä»¥åœ¨Oktaä½¿ç”¨ã€‚</p><div class="mt mu gp gr mv mw"><a href="https://www.okta.com/" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd ir gy z fp nb fr fs nc fu fw ip bi translated">Okta |æ°¸è¿œåœ¨çº¿</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">çœ‹èµ·æ¥ä½ å…³é—­äº†Javascriptï¼è¯·å¯ç”¨å®ƒä»¥æ”¹å–„æ‚¨çš„æµè§ˆä½“éªŒã€‚å¯¹â€¦çš„æ·±å…¥ç ”ç©¶</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">www.okta.com</p></div></div><div class="nf l"><div class="ng l nh ni nj nf nk kp mw"/></div></div></a></div><p id="d817" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><code class="fe nl nm nn no b">http://blog.cloud66.com/adding-sso-to-your-rails-application-with-saml/</code></p><p id="1f52" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">æˆ‘å‡è®¾ä½ ç†Ÿæ‚‰è®¾è®¡å®çŸ³ï¼Œä¹Ÿåœ¨ä½ çš„åº”ç”¨ç¨‹åºå®ç°ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰å®ç°ï¼Œé‚£ä¹ˆè¯·é€šè¿‡ä¸‹é¢çš„é“¾æ¥ã€‚</p><p id="602b" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><code class="fe nl nm nn no b">https://qiita.com/alokrawat050/items/5267e6ab0e274ad1188a</code></p><p id="0fea" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><code class="fe nl nm nn no b">https://medium.com/@alokrawat050/devise-gem-tutorial-authenticate-a-user-by-user-id-and-email-ruby-on-rails-e25ae60ca437</code></p><h1 id="cb67" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated"><strong class="ak">è®©æˆ‘ä»¬å¼€å§‹SAMLé…ç½®</strong></h1><p id="af36" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä½¿ç”¨SAMLè®¾è®¡ä½œå“ã€‚</p><p id="342e" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir"> 1ã€‚</strong>å°†è®¾è®¡ç›¸åŒçš„è®¤è¯å®çŸ³æ·»åŠ åˆ°æ‚¨çš„gemæ–‡ä»¶ä¸­</p><pre class="kg kh ki kj gt np no nq nr aw ns bi"><span id="2420" class="nt ks iq no b gy nu nv l nw nx">gem 'devise_saml_authenticatable'</span></pre><p id="e94e" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><code class="fe nl nm nn no b">refer https://github.com/apokalipto/devise_saml_authenticatable</code></p><p id="9f30" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir"> 2ã€‚</strong>æ·»åŠ :saml_authenticatableåˆ°æ‚¨çš„ç”¨æˆ·æ¨¡å‹user.rb(æ­¤å¤„æ¨¡å‹åä¸ºuser.rb):</p><pre class="kg kh ki kj gt np no nq nr aw ns bi"><span id="596a" class="nt ks iq no b gy nu nv l nw nx">class User &lt; ApplicationRecord<br/>  devise :saml_authenticatable, :database_authenticatable, :registerable,<br/>         :recoverable, :rememberable, :trackable, :validatable, :authentication_keys =&gt; [:login]<br/><br/>  attr_accessor :login<br/><br/>  def login=(login)<br/>    @login = login<br/>  end<br/><br/>  def login<br/>    @login || self.user_id || self.email<br/>  end<br/><br/>  def self.find_for_database_authentication(warden_conditions)<br/>    conditions = warden_conditions.dup<br/>    if login = conditions.delete(:login)<br/>      where(conditions.to_h).where(["user_id = :value OR email = :value", { :value =&gt; login.downcase }]).first<br/>    else<br/>      where(conditions.to_h).first<br/>    end<br/>  end<br/><br/>  def send_devise_notification(notification, *args)<br/>    devise_mailer.send(notification, self, *args).deliver_later<br/>  end<br/>end</span></pre><p id="f46d" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">è¿™é‡Œæˆ‘ç”¨çš„æ˜¯attr_accessor :loginï¼Œä¸ºä»€ä¹ˆï¼Ÿ<br/>å› ä¸ºç”¨æˆ·å¯ä»¥é€šè¿‡ç”¨æˆ·åå’Œç”µå­é‚®ä»¶ç™»å½•ã€‚ä½†æ˜¯å¦‚æœä½ ä¸éœ€è¦ï¼Œè¯·å¿½ç•¥ã€‚æ‚¨ä¸éœ€è¦åœ¨åº”ç”¨ç¨‹åºä¸­è®¾ç½®ã€‚</p><p id="440a" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir"> 3ã€‚</strong>å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°æ‚¨çš„config/initializer/device . Rbæ–‡ä»¶ä¸­:</p><pre class="kg kh ki kj gt np no nq nr aw ns bi"><span id="74c8" class="nt ks iq no b gy nu nv l nw nx">Devise.setup do |config|<br/>â€¦â€¦<br/>â€¦â€¦<br/><br/>Devise.setup do |config|  <br/>      config.saml_create_user = false<br/>      config.saml_update_user = true<br/>      config.saml_default_user_key = :email<br/>      config.saml_session_index_key = :session_index<br/>      config.saml_use_subject = true<br/>      config.idp_settings_adapter = nil<br/>      config.saml_configure do |settings|<br/>        settings.assertion_consumer_service_url     = "&lt;your url&gt;/users/saml/auth"<br/>      settings.protocol_binding = "urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST"<br/>      settings.name_identifier_format             = "urn:oasis:names:tc:SAML:2.0:nameid-format:transient"<br/>      settings.issuer                             = "&lt;your url&gt;/users/saml/metadata"<br/>      settings.authn_context                      = "urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport"<br/>      settings.idp_slo_target_url                 = ""<br/><br/>      #line configuration<br/>      settings.idp_sso_target_url                 = "&lt;your SSO auth url&gt;"<br/>      settings.idp_cert_fingerprint               = '&lt;your fingerprint of the certificate&gt;'<br/>      settings.idp_cert_fingerprint_algorithm     = 'http://www.w3.org/2000/09/xmldsig#sha256'<br/>      end<br/>    end<br/>end</span></pre><p id="5e34" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">åœ¨è¿™é‡Œï¼Œæ‚¨éœ€è¦æ›´æ”¹ä»¥ä¸‹è®¾ç½®:</p><p id="d533" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><code class="fe nl nm nn no b">&lt;your url&gt;: http://localhost:3000</code>#å¯¹äºå¼€å‘æ¥è¯´æ˜¯ä¸€ä¸ªæœ¬åœ°ä¸»æœºï¼Œä½†æ˜¯ä½ å¯ä»¥æ ¹æ®ä½ çš„å¼€å‘ç¯å¢ƒæ¥è®¾ç½®</p><p id="0c71" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><code class="fe nl nm nn no b">&lt;your SSO auth url&gt;</code>:#æ£€æŸ¥ç¬¬4.2æ­¥</p><p id="8447" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><code class="fe nl nm nn no b">&lt;your fingerprint of the certificate&gt;</code>å¦‚ä½•ç”ŸæˆæŒ‡çº¹ï¼ŒæŸ¥çœ‹ç¬¬8æ­¥ã€‚</p><p id="375f" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">åœ¨ä½ çš„<strong class="ll ir"> routes.rb </strong>æ–‡ä»¶ä¸­ï¼Œ</p><pre class="kg kh ki kj gt np no nq nr aw ns bi"><span id="9f71" class="nt ks iq no b gy nu nv l nw nx">Rails.application.routes.draw do<br/>  root 'home#index'  <br/>  devise_for :users, skip: :saml_authenticatable, controllers: {<br/>    registrations: "user/registrations",<br/>    sessions: "user/sessions",<br/>    passwords: "user/passwords"<br/>  }<br/><br/>  # opt-in saml_authenticatable<br/>  devise_scope :user do<br/>    scope "users", controller: 'saml_sessions' do<br/>      get :new, path: "saml/sign_in", as: :new_user_sso_session<br/>      post :create, path: "saml/auth", as: :user_sso_session<br/>      get :destroy, path: "sign_out", as: :destroy_user_sso_session<br/>      get :metadata, path: "saml/metadata", as: :metadata_user_sso_session<br/>      match :idp_sign_out, path: "saml/idp_sign_out", via: [:get, :post]<br/>    end<br/>  end<br/>end</span></pre><p id="cf6d" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir"> 4ã€‚</strong>ä½ åº”è¯¥åœ¨Line Worksæœ‰ä¸ªè´¦æˆ·ã€‚ç‚¹å‡»å¼€å‘è€…æ§åˆ¶å°ä¸Šçš„<br/><a class="ae mr" href="https://developers.worksmobile.com/" rel="noopener ugc nofollow" target="_blank">https://developers.worksmobile.com/</a><br/>ã€‚ä¸‹é¢æ˜¯è®¾ç½®æŒ‡å—ã€‚</p><p id="a59f" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir"> 4.1ã€‚</strong>åœ¨Line Workså¼€å‘è€…æ§åˆ¶å°æˆåŠŸç™»å½•åï¼Œè¿›å…¥Apps/SAML Appsã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/4ae6691759546bb29084d9cae93705d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*I4fWDhyeB7TarIuT.png"/></div></div></figure><p id="bfcf" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir"> 4.2ã€‚</strong>ç°åœ¨åˆ›å»ºæ‚¨çš„åº”ç”¨ç¨‹åºï¼Œç‚¹å‡»â€œæ·»åŠ â€æŒ‰é’®ï¼Œè®¾ç½®ä»¥ä¸‹å­—æ®µï¼Œç„¶åç‚¹å‡»â€œä¸‹ä¸€æ­¥â€æŒ‰é’®ã€‚</p><p id="f74c" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir">åœ¨ç”³è¯·ä¿¡æ¯éƒ¨åˆ†ï¼Œ</strong></p><pre class="kg kh ki kj gt np no nq nr aw ns bi"><span id="48c4" class="nt ks iq no b gy nu nv l nw nx">ãƒ»Application Name: <br/>ãƒ»Description:</span></pre><p id="d90c" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir">åœ¨æœåŠ¡æä¾›å•†ä¿¡æ¯éƒ¨åˆ†ï¼Œ</strong></p><pre class="kg kh ki kj gt np no nq nr aw ns bi"><span id="89ae" class="nt ks iq no b gy nu nv l nw nx">ãƒ»ACS URL: http://localhost:3000/users/saml/auth<br/>ãƒ»SP issuer(Entity Id): http://localhost:3000/users/saml/metadata</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/c272b50de31e3f790e3a6eb45821d6cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/0*Gplgz3WO0SfoRYzd.png"/></div></figure><p id="2aad" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir"> 4.3ã€‚ç°åœ¨æ¿€æ´»æ‚¨çš„åº”ç”¨ç¨‹åºã€‚ç‚¹å‡»è°ƒæ•´æŒ‰é’®ï¼Œç„¶åé€‰æ‹©æ¿€æ´»ã€‚</strong></p><ul class=""><li id="8ca1" class="oa ob iq ll b lm mf lp mg ls oc lw od ma oe me of og oh oi bi">1</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/6e834785f5604aa4dfda8a87887b95cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*l8TNvNNBzokPJ0En.png"/></div></div></figure><ul class=""><li id="3460" class="oa ob iq ll b lm mf lp mg ls oc lw od ma oe me of og oh oi bi">2</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/06eeaef328617751e0b23fac00a28480.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kHZRRgkKQqzmlkdD.png"/></div></div></figure><ul class=""><li id="5d50" class="oa ob iq ll b lm mf lp mg ls oc lw od ma oe me of og oh oi bi">3</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/6b54d0ce6b6eba6fcb09ea2518e6b9ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OLx_gT-_pcvlJEhJ.png"/></div></div></figure><p id="e72d" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir"> 5ã€‚</strong>å¦‚æœä½ åœ¨exï¼Œ<a class="ae mr" href="http://localhost/:3000(here" rel="noopener ugc nofollow" target="_blank">çš„å¼€å‘ç¯å¢ƒä¸‹è¿è¡Œä½ çš„appï¼Œhttp://localhost:3000(è¿™é‡Œ</a>æˆ‘ç”¨3000ä½œä¸ºé»˜è®¤çš„Railsç«¯å£ï¼Œæ ¹æ®ä½ çš„è®¾ç½®è¿›è¡Œè°ƒæ•´)ã€‚<br/>å¯¹äºç”Ÿäº§ï¼Œè¯·ç¡®ä¿æ‚¨ä½¿ç”¨httpsï¼Œå¹¶åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºå’ŒæœåŠ¡å™¨ä¸Šè®¾ç½®å®ƒã€‚</p><p id="434b" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir"> 6ã€‚</strong>å¤åˆ¶æ‚¨çš„SSO URL(èº«ä»½æä¾›è€…å•ç‚¹ç™»å½•URL)å¹¶å°†å…¶å€¼ä½œä¸º_<strong class="ll ir">IDP _ SSO _ target _ URL</strong>_ç²˜è´´åˆ°<strong class="ll ir">device . Rb</strong>ä¸­ã€‚</p><p id="97a2" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir"> 7ã€‚</strong>ç°åœ¨ç‚¹å‡»ä¸‹è½½è¯ä¹¦æŒ‰é’®ï¼Œä¿å­˜è¯ä¹¦æ–‡ä»¶ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/56b94088be4952151251079e10392726.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/0*BqHzodn0oF06MUk3.png"/></div></figure><p id="bacf" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir"> 8ã€‚</strong>è¿è¡Œä»¥ä¸‹å‘½ä»¤è·å–è¯ä¹¦çš„æŒ‡çº¹:</p><pre class="kg kh ki kj gt np no nq nr aw ns bi"><span id="3b41" class="nt ks iq no b gy nu nv l nw nx">openssl x509 -text -noout -in ~/Downloads/&lt;your file name&gt; -fingerprint -sha256</span></pre><p id="2ab0" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><code class="fe nl nm nn no b">This assumes that you saved the certificate in ~/Downloads/&lt;your file name&gt;</code>å¤åˆ¶è¾“å‡ºçš„æœ€åä¸€è¡Œï¼Œ</p><p id="ffcd" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">SHA256æŒ‡çº¹=ã€‚å¤åˆ¶è¯¥å€¼å¹¶ç²˜è´´åˆ°devise.rbæ–‡ä»¶çš„idp_cert_fingerprintä¸­ã€‚</p><p id="ea0d" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:</p><p id="366c" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><code class="fe nl nm nn no b">59:10:LO:D0:9L:31:PO:AM:59:10:LO:D0:9L:31:PO:AM:59:10:LO:D0:9L:31:PO:AM:59:10:LO:D0:9L:31:PO:AM</code></p><p id="5c51" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir"> 9ã€‚</strong>åœ¨æ‚¨çš„appsé…ç½®ç›®å½•ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªåä¸ºattribute-map.ymlçš„æ–‡ä»¶ï¼Œå¹¶å°†ä»¥ä¸‹å†…å®¹æ”¾å…¥å…¶ä¸­:</p><pre class="kg kh ki kj gt np no nq nr aw ns bi"><span id="d3e4" class="nt ks iq no b gy nu nv l nw nx">"urn:mace:dir:attribute-def:uid": â€œloginâ€<br/>"urn:mace:dir:attribute-def:email": "email"</span></pre><p id="f929" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">è¿™å‘Šè¯‰Devise SAMLä»Id Providerè¿”å›çš„å±æ€§æ˜ å°„åˆ°ç”¨æˆ·æ¨¡å‹çš„å“ªä¸ªå±æ€§ã€‚</p><p id="4b51" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir"> 10 </strong>ã€‚ç°åœ¨ä½ å·²ç»å‡†å¤‡å¥½æµ‹è¯•ï¼Œä½¿ç”¨<strong class="ll ir">/ç”¨æˆ·/saml/sign_in </strong>ï¼Œè¿™å°†é‡å®šå‘åˆ°Line Worksç™»å½•é¡µé¢ï¼Œç„¶ååœ¨è®¤è¯åè¿”å›åˆ°ä½ çš„åº”ç”¨ç¨‹åºã€‚</p><p id="6a0a" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">å°±æ˜¯è¿™æ ·ï¼ğŸ‘ğŸ‘ğŸ‘ğŸ‘</p><p id="7b6a" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">æ„Ÿè°¢æ‚¨æŠ½å‡ºå®è´µçš„æ—¶é—´é˜…è¯»ã€‚</p><p id="35f5" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">äº«å—ç¼–ç ã€‚</p><p id="7d4e" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir">è°¢è°¢&amp;æœ€è¯šæŒšçš„é—®å€™<br/> Alok Rawat </strong></p></div><div class="ab cl on oo hu op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="ij ik il im in"><p id="1e51" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><em class="mn">åŸè½½äº</em><a class="ae mr" href="https://qiita.com/alokrawat050/items/98a40c414d06a6e679ca" rel="noopener ugc nofollow" target="_blank"><em class="mn">qiita.com</em></a><em class="mn">ã€‚</em></p></div></div>    
</body>
</html>