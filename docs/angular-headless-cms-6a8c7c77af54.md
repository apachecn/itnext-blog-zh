# è§’çŠ¶å’Œæ— å¤´ CMS

> åŸæ–‡ï¼š<https://itnext.io/angular-headless-cms-6a8c7c77af54?source=collection_archive---------0----------------------->

## å»ºç«‹ä¸€ä¸ªæœ‰è§’åº¦å’Œå†…å®¹ä¸°å¯Œçš„åšå®¢

æˆ‘ç”¨ Angular å’Œä¸€ä¸ª headless CMS æ„å»ºäº†ä¸€ä¸ªåšå®¢åº”ç”¨ç¨‹åºã€‚Contentful ä¸ºå¼€å‘äººå‘˜å’Œéå¼€å‘äººå‘˜æä¾›äº†ç®¡ç† web åº”ç”¨ç¨‹åºå†…å®¹çš„èƒ½åŠ›ã€‚æˆ‘ä½¿ç”¨ Contentful æ¥ç®¡ç†æˆ‘ç½‘ç«™ä¸Šçš„å†…å®¹ã€‚â€”â€”æˆ‘ä¸æ˜¯ Contentful èµåŠ©çš„ï¼Œä»»ä½•æ— å¤´ CMS éƒ½å¯ä»¥æ›¿ä»£ã€‚å‚è§å¤‡é€‰æ–¹æ¡ˆ[1]

[ç°åœºæ¼”ç¤ºğŸŒŒ](http://blog-demo-5c8d8.web.app)

[ä¸‹è½½æºä»£ç ğŸš€](https://github.com/Everduin94/angular-headless-cms)

![](img/67dcc5c3207161816740db7143faa093.png)

åº”ç”¨æ¦‚è¿°

# æ‘˜è¦

*   ä»€ä¹ˆæ˜¯æ— å¤´ CMS
*   ä»¤äººæ»¡æ„çš„åŸºç¡€çŸ¥è¯†
*   è§’åº¦:è®¿é—®å’Œæ˜¾ç¤ºå†…å®¹
*   ä¸»åŠï¼›ä¸»æŒ

# ä»€ä¹ˆæ˜¯æ— å¤´ CMS

å½“æˆ‘å­¦ä¹ æ„å»º web åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘å¬è¯´äº†å†…å®¹ç®¡ç†ç³»ç»Ÿ(CMS)ï¼Œå¦‚ Wordpress æˆ– Drupalã€‚æˆ‘å¿ƒæƒ³ï¼Œå¦‚æœä¸€ä¸ªå¼€å‘äººå‘˜å·²ç»çŸ¥é“å¦‚ä½•å»ºç«‹ä¸€ä¸ªç½‘ç«™ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨è¿™ä¸ªå‘¢ï¼Ÿå½“æ—¶ï¼Œæˆ‘ä¸ç†è§£éœ€æ±‚æˆ–ç”¨ä¾‹ã€‚

åæ¥ï¼Œå½“æˆ‘å‡†å¤‡åˆ›å»ºè‡ªå·±çš„å‰¯é¡¹ç›®å¹¶å°†å…¶äº¤ä»˜ç»™éå¼€å‘äººå‘˜æ—¶ï¼Œæˆ‘æš‚åœäº†ã€‚

> ä¸æ˜¯**å¼€å‘äººå‘˜çš„äººå¦‚ä½•æ›´æ–°æˆ‘çš„ç½‘ç»œåº”ç”¨ç¨‹åºçš„å†…å®¹ï¼Ÿ**

æˆ‘å·²ç»èŠ±äº†å¤§é‡çš„æ—¶é—´æ¥å¼€å‘æ„å»ºå‰ç«¯åº”ç”¨ç¨‹åºçš„æŠ€èƒ½ã€‚æˆ‘ç°åœ¨éœ€è¦å­¦ä¹ åƒ WordPress è¿™æ ·çš„ä¸œè¥¿æ¥æ„å»ºåº”ç”¨ç¨‹åºå—ï¼Ÿ

> **æ— å¤´ CMS å·²è¿›å…¥èŠå¤©ã€‚**

åƒ Contentful ä¸€æ ·ï¼ŒHeadless CMS æœ¬è´¨ä¸Šæ˜¯ web åº”ç”¨ç¨‹åºï¼Œå®ƒä»å¼€å‘äººå‘˜å’Œéå¼€å‘äººå‘˜é‚£é‡ŒæŠ½è±¡å‡ºæ•°æ®åº“/åç«¯ã€‚

æ— å¤´ CMS ä¸**è€Œ**æä¾›å‰ç«¯ã€‚â€”å®ƒä»¬ç¡®å®ä¸ºå¼€å‘äººå‘˜æä¾›äº†ä»åç«¯è·å–å†…å®¹çš„ APIï¼Œå¹¶ä¸ºéå¼€å‘äººå‘˜æä¾›äº†å‘åç«¯è¾“å…¥å†…å®¹çš„ç”¨æˆ·ç•Œé¢ã€‚

æˆ‘ä»¬å°†æ„å»ºä¸€ä¸ª Angular åº”ç”¨ç¨‹åºæ¥æ˜¾ç¤ºæ•°æ®ï¼Œå¹¶ä½¿ç”¨ Contentful æ¥åˆ›å»º/ç®¡ç†è¿™äº›æ•°æ®ã€‚

# ä»¤äººæ»¡æ„çš„åŸºç¡€çŸ¥è¯†

æˆ‘ä»¬å°†æ¶µç›–å†…å®¹ä¸°å¯Œçš„åŸºç¡€çŸ¥è¯†ã€‚â€”æœ‰å…³å…¨é¢ä»‹ç»ï¼Œè¯·å‚è§æ­¤å¤„çš„[ã€2ã€‘](https://www.contentful.com/developers/docs/tutorials/)ã€‚

![](img/790b5e6cff2b06ca3e44e39d602e9bd5.png)

ä»¤äººæ»¡æ„çš„æ¦‚è¿°

ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬åœ¨**äº”ä¸ªæ­¥éª¤**ä¸­å»ºç«‹ä¸€ä¸ªå…·æœ‰å•ä¸€å†…å®¹ç±»å‹çš„æ–°ç©ºé—´ã€‚

## 1.åˆ›å»ºä¸€ä¸ªç©ºé—´

å…¥é—¨å°±åƒæ³¨å†Œä¸€æ ·ç®€å•ã€‚â€”ä¸€æ—¦æ³¨å†Œï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºè‡ªå·±çš„ç©ºé—´ã€‚æ‰“ä¸ªæ¯”æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªç©ºé—´æƒ³è±¡æˆæˆ‘ä»¬è‡ªå·±çš„ä¸ªäººæ•°æ®åº“ã€‚

![](img/e0d50a169089bd857ed9fe69dee7007d.png)

å·¦ä¸Šè§’èœå•:åˆ›å»ºç©ºé—´

## 2.åˆ›å»ºå†…å®¹ç±»å‹

æˆ‘ä»¬å°†å‘æˆ‘ä»¬çš„ç©ºé—´æ·»åŠ ä¸€ä¸ªå†…å®¹ç±»å‹ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå†…å®¹ç±»å‹æƒ³è±¡æˆæ•°æ®åº“ä¸­çš„è¡¨å®šä¹‰ã€‚â€”å†…å®¹ç±»å‹ä¸æ˜¯å®é™…çš„å†…å®¹ï¼Œåªæ˜¯è®¾è®¡ã€‚

![](img/60fbdcc7ee241ffdafd85d5cd75e93a8.png)

åˆ›å»ºå†…å®¹ç±»å‹

## 3.åˆ›å»ºå­—æ®µ

ç°åœ¨ï¼Œæˆ‘ä»¬å°†å‘å†…å®¹ç±»å‹æ·»åŠ å­—æ®µã€‚å°†å­—æ®µæƒ³è±¡æˆæ•°æ®åº“è¡¨ä¸­çš„åˆ—ã€‚â€”åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€ç¯‡åšå®¢æ–‡ç« ï¼Œå®ƒå°†åŒ…å«è¯¸å¦‚æ ‡é¢˜ã€æè¿°ã€æ­£æ–‡ç­‰å­—æ®µ

![](img/b382e22c993cd102cb9e5b149b13bea8.png)

å‘å†…å®¹ç±»å‹æ·»åŠ å­—æ®µ

## 4.åˆ›å»ºå†…å®¹

æˆ‘ä»¬æ·»åŠ çš„æ¯ä¸€æ¡å†…å®¹éƒ½ç±»ä¼¼äºæ•°æ®åº“ä¸­çš„ä¸€ä¸ªæ–°è¡Œã€‚æˆ‘ä»¬å°†å¡«å†™å‰é¢åœ¨ blogPost å†…å®¹ç±»å‹ä¸­å®šä¹‰çš„æ¯ä¸ªå­—æ®µã€‚

![](img/aa0b6fe288ab91525fe7186be4042cc8.png)

åˆ›å»ºæ–°å†…å®¹

## 5.è®¿é—® API

åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æˆ‘ä»¬çš„ç©ºé—´ ID å’Œå†…å®¹äº¤ä»˜è®¿é—®ä»¤ç‰Œæ¥æ£€ç´¢æˆ‘ä»¬çš„å†…å®¹ä¸°å¯Œçš„æ•°æ®ï¼Œå¹¶å°†å…¶æ˜¾ç¤ºåœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ã€‚

![](img/619bc1efbc10984d20d42b18fd5a2819.png)

ç©ºé—´ ID å’Œå†…å®¹äº¤ä»˜è®¿é—®ä»¤ç‰Œ

# è§’åº¦:è®¿é—®å’Œæ˜¾ç¤ºå†…å®¹

ä¸ºäº†å¼€å§‹ä½¿ç”¨ Contentful APIï¼Œæˆ‘ä»¬å°†ä¸‹é¢çš„å¯¹è±¡æ·»åŠ åˆ°æˆ‘ä»¬çš„`environment.ts`æ–‡ä»¶ä¸­ã€‚æˆ‘ä»¬è¾“å…¥å†…å®¹ä¸°å¯Œçš„åŸºç¡€çŸ¥è¯†çš„**æ­¥éª¤ 5** çš„ä¿¡æ¯ã€‚

ç¯å¢ƒ. ts

## 1.æ˜¾ç¤ºå†…å®¹ç±»å‹çš„æ‰€æœ‰æ¡ç›®

ä½¿ç”¨`cdaClient.getEntries(content_type)`ï¼Œæˆ‘ä»¬æ£€ç´¢åŒ…å«ç‰¹å®šå†…å®¹ç±»å‹çš„æ‰€æœ‰å†…å®¹çš„æ‰¿è¯ºã€‚è§£æçš„æ•°æ®æ˜¯ä¸€ç»„åšå®¢æ–‡ç« ã€‚æ¯ä¸ªæ¡ç›®æœ‰ä¸¤ä¸ªå±æ€§ï¼Œ`fields`å’Œ`sys`ã€‚

`Sys`åŒ…å«åˆ›å»ºæ—¥æœŸå’Œ ID ç­‰ä¿¡æ¯ã€‚`Fields`æ˜¯æˆ‘ä»¬åœ¨ Contentful Basics çš„æ­¥éª¤ 3 ä¸­å®šä¹‰çš„å­—æ®µã€‚

contentful.service.ts â€” 1.1

åˆ©ç”¨è§’åº¦ç»“æ„æŒ‡ä»¤`*ngFor`ï¼Œæˆ‘ä»¬å¯ä»¥åŠ¨æ€åœ°å°†æ‰€æœ‰åšå®¢æ–‡ç« æ·»åŠ åˆ° DOM ä¸­ã€‚â€”å½“æˆ‘ä»¬å‘ Contentful æ·»åŠ æ–°çš„åšå®¢æ–‡ç« æ—¶ï¼Œæˆ‘ä»¬çš„æ–‡ç« å°†ç”±æˆ‘ä»¬çš„ Contentful æœåŠ¡è‡ªåŠ¨æ·»åŠ ã€‚

ä½¿ç”¨ Angular æ¨¡æ¿è¯­æ³•ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºåˆ—è¡¨é¡¹ï¼Œæ˜¾ç¤ºæ¥è‡ªæˆ‘ä»¬çš„å†…å®¹ä¸°å¯Œçš„æœåŠ¡çš„ä¿¡æ¯ï¼Œå¦‚ createdAtã€IDã€titleã€description ç­‰

main.component.htmlâ€”1.2

## 2.æ˜¾ç¤ºå†…å®¹ç±»å‹çš„ç‰¹å®šæ¡ç›®

ä½¿ç”¨`cdaClient.getEntry(id)`ï¼Œæˆ‘ä»¬å¯ä»¥ä»å†…å®¹ä¸°å¯Œçš„æ•°æ®ä¸­æŸ¥è¯¢ç‰¹å®šçš„æ¡ç›®ã€‚è§£æåçš„æ•°æ®æ˜¯ä¸€ç¯‡å¸¦æœ‰`sys`å’Œ`fields`å±æ€§çš„åšå®¢æ–‡ç« ã€‚

contentful.service.ts â€” 2.1

å½“ç”¨æˆ·ç‚¹å‡»ç¬¬ä¸€éƒ¨åˆ†ä¸­çš„ä¸€ä¸ªå®¹å™¨æ—¶ï¼Œè·¯ç”±å™¨å¯¼èˆªåˆ°ä¸€ä¸ªåŠ¨æ€è·¯ç”±`/posts/:id`ã€‚åœ¨ä»£ç ç‰‡æ®µ 1.2 ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ routerLink å°† ID ä½œä¸ºå‚æ•°ä¼ é€’ã€‚â€”æˆ‘ä»¬å¯ä»¥ä» Angular çš„ ActivatedRoute `paramMap`ä¸­æ£€ç´¢ IDã€‚

post.component.ts â€” 2.2

app-routing.module.ts â€” 2.3

Contentful ä¸ºæ‰€æœ‰æ–‡æœ¬å­—æ®µæä¾›äº†ä¸€ä¸ª Markdown ç¼–è¾‘å™¨ã€‚æˆ‘ä»¬å°†é€šè¿‡å°† Markdown è½¬æ¢ä¸º HTML å¹¶åœ¨ div ä¸Šè®¾ç½®å†…éƒ¨ HTML æ¥åˆ©ç”¨è¿™ä¸€ç‚¹ã€‚[ã€4ã€‘](https://fireship.io/)

æ˜æ™ºåœ°ä½¿ç”¨ innerHTMLï¼Œå¦‚æœæˆ‘ä»¬ä¸èƒ½å®Œå…¨æ§åˆ¶è¾“å…¥åˆ° innerHTML ä¸­çš„å†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦å‡€åŒ–è¾“å…¥ä»¥[é˜²æ­¢ xss æ”»å‡»ã€5ã€‘](https://angular.io/api/platform-browser/DomSanitizer)ã€‚

post.component.ts â€” 2.4

ä½¿ç”¨ Angular çš„ç»“æ„æŒ‡ä»¤`*ngIf`ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©æ˜¾ç¤ºä¸€ä¸ªå­—æ®µï¼Œå¦‚æœå®ƒå­˜åœ¨çš„è¯ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†æ˜¾ç¤ºä¸€ä¸ªåˆ°åŸå§‹å‡ºç‰ˆç‰©çš„é“¾æ¥(å¦‚æœæœ‰çš„è¯)ã€‚

## 3.æ·»åŠ æ–°çš„å†…å®¹ä¸°å¯Œçš„æ¡ç›®

åœ¨å‘å¸ƒä¸€ä¸ªæ–°çš„å†…å®¹ä¸°å¯Œçš„æ¡ç›®åï¼Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¼šåœ¨åˆ·æ–°æ—¶ç«‹å³æ›´æ–°æœ€æ–°çš„å†…å®¹ã€‚â€”æˆ‘ä»¬çš„ Angular é¡¹ç›®ä¸éœ€è¦ä»»ä½•æ›´æ”¹ã€‚

![](img/b70592a84709dbf145842af6f26f8f49.png)

æœ€ç»ˆäº§å“

# ä¸»åŠï¼›ä¸»æŒ

ç°åœºæ¼”ç¤ºç”± Firebase ä¸»æŒã€‚å…³äºä½¿ç”¨ Firebase æ‰˜ç®¡é¡¹ç›®çš„æŒ‡å¯¼ï¼Œè¯·å‚è§[æ­¤å¤„ã€6ã€‘](https://www.youtube.com/watch?v=aICeVhu2mAE)ã€‚å¯¹äºæ‰˜ç®¡çš„æ›¿ä»£å½¢å¼ï¼Œè¯·å‚è§æ­¤å¤„[7]ã€‚

> æˆ‘ä¸éš¶å±äº Firebase æˆ–ä»»ä½•æ›¿ä»£æ–¹æ¡ˆï¼Œä¹Ÿä¸å—å…¶èµåŠ©ã€‚

> â˜ï¸ [Flotes](https://flotes.app) â€”å°è¯•æ¼”ç¤ºï¼Œä¸éœ€è¦ç™»å½•ã€‚æˆ–è€…å…è´¹æŠ¥åã€‚Flotes æ˜¯æˆ‘è®°ç¬”è®°å’Œé«˜æ•ˆå­¦ä¹ çš„æ–¹å¼ï¼Œå³ä½¿åœ¨æˆ‘å¾ˆå¿™çš„æ—¶å€™ã€‚

![](img/8e468f6e74135bbbc2ecbfce7e2db2bf.png)

[flots](https://flotes.app)

# èµ„æºå’Œå‚è€ƒ

[1] [ç†æ™º](https://www.sanity.io/) | [ç«ç„°é“¾æ¥](https://flamelink.io/?gclid=CjwKCAjwsIbpBRBNEiwAZF8-z2vWGi3LO1o6EqAg8Mh9njo35Y5F5l464KcCz7yK0-hPjtg9GuLcKxoC7jgQAvD_BwE) | [æ— å¤´æ–‡å­—å‡ºç‰ˆç¤¾](https://www.sitepoint.com/wordpress-headless-cms/)

[2] [å¿ƒæ»¡æ„è¶³â€”â€”æ•™ç¨‹](https://www.contentful.com/developers/docs/tutorials/)

[3] [ç»“æ„æŒ‡ä»¤](https://angular.io/guide/structural-directives)

[4]åœ¨ [fireship](https://fireship.io/) ä¸Šå­¦ä¹ äº† Markdown-to-HTML æŠ€æœ¯

[5] [DOM æ¶ˆæ¯’å‰‚](https://angular.io/api/platform-browser/DomSanitizer)

[6] [ä¸»æœºå¸¦ç«åŸº](https://www.youtube.com/watch?v=aICeVhu2mAE)

[7][Netlify](https://www.netlify.com/)|[AWS](https://aws.amazon.com/)|[æ•°å­—æµ·æ´‹](https://www.digitalocean.com/)