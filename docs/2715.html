<html>
<head>
<title>TimingLogger: An idiomatic Android approach to measuring execution time</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TimingLogger:ä¸€ç§æµ‹é‡æ‰§è¡Œæ—¶é—´çš„æƒ¯ç”¨Androidæ–¹æ³•</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/timinglogger-an-idiomatic-android-approach-to-measuring-execution-time-8ac10a8fa0ba?source=collection_archive---------4-----------------------#2019-07-17">https://itnext.io/timinglogger-an-idiomatic-android-approach-to-measuring-execution-time-8ac10a8fa0ba?source=collection_archive---------4-----------------------#2019-07-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="948e" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">é€šè¿‡å®ä¾‹å­¦ä¹ </h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div class="gh gi jz"><img src="../Images/177c9fc6dc5b6dccaf0b5894c00702e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*c4iJb0CvOnuOo6Nc8Cg_5g.png"/></div></figure><p id="6206" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi le translated">åœ¨ä½ ä½œä¸ºAndroidå¼€å‘äººå‘˜çš„èŒä¸šç”Ÿæ¶¯ä¸­ï¼Œä½ æœ€ç»ˆä¼šé‡åˆ°ä¸€äº›æ€§èƒ½ä¸ä½³çš„ä»£ç ã€‚ä¹Ÿè®¸è¿™æ˜¯ä½ åˆ›ä½œçš„ä»£ç ï¼Œä¹Ÿè®¸è¿™æ˜¯ä½ ç»§æ‰¿çš„ä»£ç ï¼Œä½†å®ƒçš„èµ·æºå¹¶ä¸é‡è¦ã€‚ä»£ç ç°åœ¨åœ¨ä½ çš„ç®¡ç†ä¸‹ï¼Œä½ çš„å›¢é˜Ÿå’Œä½ çš„ç”¨æˆ·éƒ½åœ¨çœ‹ç€ä½ ï¼Œè¿™ä¸ªå®Œç¾çš„Androidæ‘‡æ»šæ˜æ˜Ÿï¼Œæ¥è§£å†³å›°æ‰°åº”ç”¨çš„æ€§èƒ½é—®é¢˜ã€‚</p><p id="e9c8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¼€å‘Androidä»£ç çš„å¼€å‘äººå‘˜å¯ä»¥é‡‡ç”¨å‡ ç§ä¸åŒçš„æ–¹æ³•æ¥è¡¡é‡ä»£ç å—çš„æ€§èƒ½ã€‚ç”±äºè®¸å¤šAndroidå¼€å‘äººå‘˜éƒ½æœ‰Javaç¼–ç¨‹èƒŒæ™¯ï¼Œæ‚¨å°†çœ‹åˆ°çš„ä¸€ç§æ›´å¸¸è§çš„ç­–ç•¥æ˜¯é€šè¿‡è°ƒç”¨<code class="fe ln lo lp lq b"><a class="ae lr" href="https://docs.oracle.com/javase/7/docs/api/java/lang/System.html#nanoTime()" rel="noopener ugc nofollow" target="_blank">System.nanoTime()</a></code>æ¥åŒ…å›´å¯ç–‘ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="ls lt lu lv gt lw lq lx ly aw lz bi"><span id="6c61" class="ma mb it lq b gy mc md l me mf"><em class="mg">// capture the start time<br/></em><strong class="lq jd">val </strong>startTime = System.nanoTime()<br/><br/><em class="mg">// suspiciously long running block of code<br/></em><strong class="lq jd">var </strong>number = 0L<br/><strong class="lq jd">for </strong>(x <strong class="lq jd">in </strong>0..10_000_000)<br/>    number += x<br/><br/><em class="mg">// capture the end time<br/></em><strong class="lq jd">val </strong>endTime = System.nanoTime()<br/><br/><em class="mg">// dump the execution time out<br/></em>Log.d(<strong class="lq jd">"TimingLoggerDemo"</strong>,<strong class="lq jd">"${</strong>TimeUnit.<strong class="lq jd">MILLISECONDS</strong>.convert(endTime -<br/>        startTime, TimeUnit.<strong class="lq jd">NANOSECONDS</strong>)<strong class="lq jd">} ms, (1)"</strong>)</span></pre><p id="4245" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿™å¾ˆå¥½ï¼Œè€Œä¸”å®ƒè‚¯å®šä¼šå®Œæˆå·¥ä½œï¼Œä½†æ˜¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨æ­£åœ¨åˆ†æçš„æ–¹æ³•ä¸­ä¼šæœ‰å¤šä¸ªæ½œåœ¨çš„è°ƒç”¨æˆ–ä»£ç å—ï¼Œå®ƒä»¬å¯èƒ½æ˜¯æ‰§è¡Œæ—¶é—´æ¥æ”¶å™¨çš„æ¥æºã€‚ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†ä½¿ç”¨<code class="fe ln lo lp lq b"><a class="ae lr" href="https://docs.oracle.com/javase/7/docs/api/java/lang/System.html#nanoTime()" rel="noopener ugc nofollow" target="_blank">System.nanoTime()</a></code>æˆ–è€…å®ƒçš„ä¸€ä¸ªå˜ä½“(ä¾‹å¦‚<code class="fe ln lo lp lq b">System.elapsedTime()</code>)ä¼šå¾ˆå¿«å˜å¾—éš¾ä»¥ä½¿ç”¨:</p><pre class="ls lt lu lv gt lw lq lx ly aw lz bi"><span id="d155" class="ma mb it lq b gy mc md l me mf"><em class="mg">// capture the start time<br/></em><strong class="lq jd">var </strong>startTime = System.nanoTime()<br/><br/><em class="mg">// suspiciously long running block of code<br/></em><strong class="lq jd">var </strong>number = 0L<br/><strong class="lq jd">for </strong>(x <strong class="lq jd">in </strong>0..10_000_000)<br/>    number += x<br/><br/><em class="mg">// capture the end time<br/></em><strong class="lq jd">var </strong>endTime = System.nanoTime()<br/><br/><em class="mg">// dump the execution time out<br/></em>Log.d(<strong class="lq jd">"TimingLoggerDemo"</strong>,<strong class="lq jd">"${</strong>TimeUnit.<strong class="lq jd">MILLISECONDS</strong>.convert(endTime -<br/>        startTime, TimeUnit.<strong class="lq jd">NANOSECONDS</strong>)<strong class="lq jd">} ms, (1)"</strong>)<br/><br/><em class="mg">// capture the start time<br/></em>startTime = System.nanoTime()<br/><br/><em class="mg">// another suspiciously long running block of code<br/></em>callSomeMethod()<br/><br/><em class="mg">// capture the end time<br/></em>endTime = System.nanoTime()<br/><br/><em class="mg">// dump the execution time out again<br/></em>Log.d(<strong class="lq jd">"TimingLoggerDemo"</strong>,<strong class="lq jd">"${</strong>TimeUnit.<strong class="lq jd">MILLISECONDS</strong>.convert(endTime -<br/>        startTime, TimeUnit.<strong class="lq jd">NANOSECONDS</strong>)<strong class="lq jd">} ms, (2)"</strong>)</span><span id="4504" class="ma mb it lq b gy mh md l me mf"><br/>...and on and on for each possible culprit</span></pre><p id="1dd7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä»¤äººæ¬£æ…°çš„æ˜¯ï¼ŒAndroidçš„å®ç”¨ç¨‹åºåŒ…ä¸­æœ‰ä¸€ä¸ªæ›´ç®€å•ã€æ›´ç®€æ´ã€æ›´æƒ¯ç”¨çš„ç±»ï¼Œå¯ä»¥ç”¨æ¥åˆ†æåƒä¸Šé¢è¿™æ ·æœ‰é—®é¢˜çš„æ–¹æ³•ã€‚å¼•å…¥<a class="ae lr" href="https://developer.android.com/reference/android/util/TimingLogger" rel="noopener ugc nofollow" target="_blank"> TimingLogger </a>ç±»(æˆ–è€…<em class="mg">é‡æ–°å¼•å…¥</em>ï¼Œå› ä¸ºå®ƒä»API Level 1å¼€å§‹å°±å¯ç”¨äº†)ï¼</p><figure class="ls lt lu lv gt kd"><div class="bz fp l di"><div class="mi mj l"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">äººç¾¤å¬åˆ°è®¡æ—¶æ—¥å¿—ç±»æ—¶çš„ååº”</figcaption></figure><p id="f411" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è®©æˆ‘ä»¬é‡å†™ä¸Šé¢çš„ç¤ºä¾‹ï¼Œä½†æ˜¯è¿™æ¬¡æˆ‘ä»¬å°†åˆ©ç”¨<a class="ae lr" href="https://developer.android.com/reference/kotlin/android/util/TimingLogger.html" rel="noopener ugc nofollow" target="_blank"> TimingLogger </a>ç±»æ¥æ•è·æ‰§è¡Œæ—¶é—´åº¦é‡ã€‚æˆ‘ä»¬èµ°å§ã€‚æ˜¯çš„ï¼Œæ˜¯çš„ï¼Œæˆ‘ä»¬ä¼š:</p><pre class="ls lt lu lv gt lw lq lx ly aw lz bi"><span id="a7d9" class="ma mb it lq b gy mc md l me mf"><em class="mg">// instantiate a timing logger<br/></em><strong class="lq jd">val </strong>timingLogger = TimingLogger(<strong class="lq jd">"TimingLoggerDemo"</strong>, <strong class="lq jd">""</strong>)<br/><br/><em class="mg">// suspiciously long running block of code<br/></em><strong class="lq jd">var </strong>number = 0L<br/><strong class="lq jd">for </strong>(x <strong class="lq jd">in </strong>0..10_000_000)<br/>    number += x<br/>timingLogger.addSplit(<strong class="lq jd">"(1)"</strong>)<br/><br/><em class="mg">// another suspiciously long running block of code<br/></em>callSomeMethod()<br/>timingLogger.addSplit(<strong class="lq jd">"(2)"</strong>)<br/><br/><em class="mg">// dump all of the execution times out<br/></em>timingLogger.dumpToLog()</span></pre><p id="ea28" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿è¡Œä¸Šè¿°ä»£ç çš„è¾“å‡ºå¦‚ä¸‹:</p><figure class="ls lt lu lv gt kd gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/2cd7932e60ac372136a05bbeaa8b0714.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*6HqMqCWXG58ET0AhHbX9aw.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">å®šæ—¶æ—¥å¿—è¾“å‡º</figcaption></figure><p id="3c2a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æ‰€ä»¥åŸºæœ¬ä¸Šä½ åªéœ€è¦å®ä¾‹åŒ–ä¸€ä¸ª<a class="ae lr" href="https://developer.android.com/reference/kotlin/android/util/TimingLogger.html" rel="noopener ugc nofollow" target="_blank"> TimingLogger </a>å¯¹è±¡ï¼Œç„¶åä¸ºä½ æƒ³è¦æµ‹é‡çš„æ¯æ®µä»£ç è°ƒç”¨<code class="fe ln lo lp lq b"><a class="ae lr" href="https://developer.android.com/reference/kotlin/android/util/TimingLogger.html#addsplit" rel="noopener ugc nofollow" target="_blank">addSplit(<em class="mg">split-label)</em></a></code>æ–¹æ³•ã€‚ä¸€æ—¦ä½ æŠŠæ‰€æœ‰çš„<a class="ae lr" href="https://www.braums.com/wp-content/uploads/2018/06/BananaSpit.jpg" rel="noopener ugc nofollow" target="_blank">é¦™è•‰èˆ¹</a>éƒ½å‡†å¤‡å¥½äº†ï¼Œä½ å°±è°ƒç”¨<code class="fe ln lo lp lq b"><a class="ae lr" href="https://developer.android.com/reference/kotlin/android/util/TimingLogger.html#dumptolog" rel="noopener ugc nofollow" target="_blank">dumpToLog()</a></code>æŠŠæµ‹é‡ç»“æœå†™åˆ°<a class="ae lr" href="https://developer.android.com/studio/command-line/logcat" rel="noopener ugc nofollow" target="_blank"> logcat </a>ä¸­ã€‚</p><p id="dd01" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ğŸ””<a class="ae lr" href="https://developer.android.com/reference/kotlin/android/util/TimingLogger.html" rel="noopener ugc nofollow" target="_blank"> TimingLogger </a>ç±»çš„ä¸€ä¸ªå¸¸è§ç¼ºé™·æ˜¯ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä¸ä¼šäº§ç”Ÿä»»ä½•è¾“å‡ºã€‚è¦æŸ¥çœ‹è¾“å‡ºï¼Œå¿…é¡»å°†ç±»å®ä¾‹åŒ–æœŸé—´æŒ‡å®šçš„æ ‡è®°çš„æ—¥å¿—è®°å½•çº§åˆ«è®¾ç½®ä¸ºVERBOSEã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬æŒ‡å®šäº†ä¸€ä¸ªæ ‡è®°â€œTimingLoggerDemo â€,å› æ­¤ä¸‹é¢çš„å‘½ä»¤å¿…é¡»é€šè¿‡ç»ˆç«¯æ‰§è¡Œï¼Œä»¥ä¾¿æŸ¥çœ‹æˆ‘ä»¬ç¤ºä¾‹çš„è¾“å‡ºã€‚</p><pre class="ls lt lu lv gt lw lq lx ly aw lz bi"><span id="2bd6" class="ma mb it lq b gy mc md l me mf">adb shell setprop log.tag.TimingLoggerDemo VERBOSE</span></pre></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><p id="d27a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jd">ç»“è®º<br/>å› æ­¤ï¼Œå¦‚æœä½ å‘ç°è‡ªå·±åœ¨ä¸ä¸€ä¸ªéº»çƒ¦çš„ã€æ€§èƒ½å·®çš„æ–¹æ³•äº‰è®ºï¼Œé‚£ä¹ˆå¸Œæœ›ä½ èƒ½è®°ä½è¿™ä¸ªéå¸¸æœ‰ç”¨çš„ç±»ã€‚</strong></p><p id="c18e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æ„Ÿè°¢æ‚¨çš„å…³æ³¨ï¼æ‰˜é©¬æ–¯Â·æ¡‘å¾·å…°</p><div class="mw mx gp gr my mz"><a href="https://www.linkedin.com/in/thomas-sunderland/" rel="noopener  ugc nofollow" target="_blank"><div class="na ab fo"><div class="nb ab nc cl cj nd"><h2 class="bd jd gy z fp ne fr fs nf fu fw jc bi translated">æ‰˜é©¬æ–¯Â·æ¡‘å¾·å…°-å®‰å“å¼€å‘è€…| LinkedIn</h2><div class="ng l"><h3 class="bd b gy z fp ne fr fs nf fu fw dk translated">åŠ å…¥LinkedInæˆ‘å«Thomas Sunderlandï¼Œæ˜¯ä¸€åè½¯ä»¶å·¥ç¨‹å¸ˆï¼Œä¸“æ³¨äºåŸç”ŸAndroidå¼€å‘ã€‚æˆ‘â€¦</h3></div><div class="nh l"><p class="bd b dl z fp ne fr fs nf fu fw dk translated">www.linkedin.com</p></div></div><div class="ni l"><div class="nj l nk nl nm ni nn ke mz"/></div></div></a></div></div></div>    
</body>
</html>