<html>
<head>
<title>How to set up local Apache Spark environment (5 ways)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•è®¾ç½®æœ¬åœ°Apache Sparkç¯å¢ƒ(5ç§æ–¹æ³•)</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/how-to-set-up-local-apache-spark-environment-5-ways-62910fa0e8ad?source=collection_archive---------0-----------------------#2020-08-15">https://itnext.io/how-to-set-up-local-apache-spark-environment-5-ways-62910fa0e8ad?source=collection_archive---------0-----------------------#2020-08-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/e9fd2401d5e921b7f9ae4b19685248e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JCYZnLIV-yrkbBE5.jpg"/></div></div></figure><div class=""/><p id="8666" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Apache Sparkæ˜¯æœ€æµè¡Œçš„åˆ†å¸ƒå¼æ•°æ®å¤„ç†å’Œåˆ†æå¹³å°ä¹‹ä¸€ã€‚è™½ç„¶å®ƒä¸æœåŠ¡å™¨åœºã€Hadoopå’Œäº‘æŠ€æœ¯ç›¸å…³è”ï¼Œä½†æ‚¨å¯ä»¥åœ¨æ‚¨çš„æœºå™¨ä¸ŠæˆåŠŸå¯åŠ¨å®ƒã€‚åœ¨æœ¬æ¡ç›®ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å‡ ç§é…ç½®Apache Sparkå¼€å‘ç¯å¢ƒçš„æ–¹æ³•ã€‚</p><p id="82e6" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å‡è®¾</p><p id="eb30" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŸºæœ¬ç³»ç»Ÿæ˜¯Ubuntuæ¡Œé¢20.04 LTSã€‚</p><h1 id="14eb" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">ç«èŠ±å£³</h1><p id="7a8a" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">ç¬¬ä¸€ç§æ–¹æ³•æ˜¯åœ¨ç»ˆç«¯ä¸­è¿è¡ŒSparkã€‚è®©æˆ‘ä»¬ä»ä¸‹è½½Apache Sparkå¼€å§‹ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½ã€‚ä¸‹è½½åï¼Œæˆ‘ä»¬å¿…é¡»ç”¨taræ‰“å¼€åŒ…ã€‚</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="3cf2" class="ml la je mh b gy mm mn l mo mp">wget ftp://ftp.task.gda.pl/pub/www/apache/dist/spark/spark-3.0.0/spark-3.0.0-bin-hadoop3.2.tgz<br/>tar zxvf spark-3.0.0-bin-hadoop3.2.tgz</span></pre><p id="caae" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Apache Sparkæ˜¯ç”¨Scalaå†™çš„ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦ä¸€ä¸ªJavaè™šæ‹Ÿæœº(JVM)ã€‚å¯¹äºSpark 3.0ï¼Œå®ƒå°†æ˜¯Java 11ã€‚</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="e10d" class="ml la je mh b gy mm mn l mo mp">sudo<!-- --> <!-- -->apt install<!-- --> <!-- -->default-jre</span></pre><p id="2a0b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ç°åœ¨ä½ æ‰€è¦åšçš„å°±æ˜¯è¿›å…¥binç›®å½•å¹¶è¿è¡Œspark-shell</p><figure class="mc md me mf gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mq"><img src="../Images/bf03744efe6a7a98cdd82b71827796b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xAXKc3wCMR3Em2ol.png"/></div></div></figure><p id="4f0b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å¦‚æœæ‚¨éœ€è¦ä¸€ä¸ªåº“(ä¾‹å¦‚ï¼Œæ‚¨æƒ³ä»MySQLä¸‹è½½æ•°æ®ï¼Œå¯¹å…¶è¿›è¡Œå¤„ç†å¹¶ä¿å­˜åˆ°å…¶ä»–åœ°æ–¹)ï¼Œæ‚¨å¯ä»¥æ‰‹åŠ¨é™„åŠ jar(â€”jars)æˆ–ä»mavenå­˜å‚¨åº“ä¸‹è½½å®ƒä»¬(â€” packages)ã€‚</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="4ae6" class="ml la je mh b gy mm mn l mo mp">./spark-shell<!-- --> <!-- -->--driver-memory 8G --packages mysql:mysql-connector-java:5.1.49</span></pre><h1 id="7109" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">pyspark</h1><p id="dae4" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">åœ¨spark-shellä¸­æˆ‘ä»¬ç”¨Scalaç¼–å†™ï¼Œå¦‚æœä½ æ›´å–œæ¬¢Pythonï¼Œä½ çš„é€‰æ‹©å°†æ˜¯PySparkã€‚</p><p id="e00c" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ç³»ç»Ÿé‡Œæ²¡æœ‰Pythonï¼Œæˆ‘ä»¬å°±æ¥ä¸€æ‹›ã€‚æˆ‘ä»¬å°†å®‰è£…pip3ï¼ŒPythonå°†ä½œä¸ºä¸€ä¸ªä¾èµ–é¡¹å®‰è£…ğŸ™‚ã€‚</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="bd54" class="ml la je mh b gy mm mn l mo mp">sudo<!-- --> <!-- -->apt install<!-- --> <!-- -->python3-pip</span></pre><p id="4ca7" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ä½†äº‹å®è¯æ˜è¿™è¿˜ä¸å¤Ÿã€‚Pysparkæ²¡æœ‰æ‰¾åˆ°å˜é‡pythonã€‚</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="bd65" class="ml la je mh b gy mm mn l mo mp">maciej@ubuntu:~/spark-3.0.0-bin-hadoop3.2/bin$ ./pyspark<br/>env: â€˜pythonâ€™: No such file or directory</span></pre><p id="b35c" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">æˆ‘ä»¬éœ€è¦ä½¿ç”¨ç¯å¢ƒå˜é‡æ¥æŒ‡ç¤ºPythonç‰ˆæœ¬ã€‚</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="d4e0" class="ml la je mh b gy mm mn l mo mp">export<!-- --> <!-- -->PYSPARK_PYTHON=python3</span></pre><p id="8a1a" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ç°åœ¨pysparkåœ¨ç»ˆç«¯å¯åŠ¨ã€‚</p><figure class="mc md me mf gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mr"><img src="../Images/18ef344cc88fb1a762d80dca2d616e6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ug_usz3HZByvzDte.png"/></div></div></figure><h1 id="82dc" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">æœ±åº‡ç‰¹ç¬”è®°æœ¬é‡Œçš„pyspark</h1><p id="925a" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">å¤§å¤šæ•°ä½¿ç”¨Pythonçš„äººï¼Œè€Œä¸æ˜¯ç»ˆç«¯ï¼Œæ›´å–œæ¬¢ç¬”è®°æœ¬ã€‚æœ€å—æ¬¢è¿çš„æ˜¯Jupyterç¬”è®°æœ¬ã€‚è®©æˆ‘ä»¬å®‰è£…å®ƒã€‚æˆ‘ä»¬å°†ä½¿ç”¨pip3ï¼Œç„¶åæ·»åŠ <em class="ms"> /ã€‚local/bin </em>æ–‡ä»¶å¤¹åˆ°è·¯å¾„ã€‚</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="8d04" class="ml la je mh b gy mm mn l mo mp">pip3 install notebook<br/>export PATH=$PATH:~/.local/bin</span></pre><p id="e9b7" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å½“æ‚¨æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡æ—¶â€¦</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="5a8b" class="ml la je mh b gy mm mn l mo mp">export PYSPARK_DRIVER_PYTHON="jupyter"<br/>export PYSPARK_DRIVER_PYTHON_OPTS="notebook"</span></pre><p id="ab6c" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">â€¦Jupyterç¬”è®°æœ¬å°†ä¸pysparkä¸€èµ·è‡ªåŠ¨æ¨å‡ºã€‚</p><figure class="mc md me mf gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mt"><img src="../Images/3315eaef76598fc16eac121713342ee8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WwRB4eJt0A1M6LQH.png"/></div></div></figure><p id="873e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å¦‚æœéœ€è¦æ·»åŠ åº“ï¼Œè¯·ä½¿ç”¨ä¸‹é¢çš„ç¯å¢ƒå˜é‡ã€‚</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="75bf" class="ml la je mh b gy mm mn l mo mp">export<!-- --> <!-- -->PYSPARK_SUBMIT_ARGS='--packages mysql:mysql-connector-java:5.1.49'</span></pre><h1 id="ee76" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">Jupterç¬”è®°æœ¬ä¸­çš„spylon (scala)</h1><p id="e629" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æ›´å–œæ¬¢ä½¿ç”¨Scalaï¼Œå¯ä»¥é€‰æ‹©spylonå†…æ ¸ã€‚å®‰è£…è¿‡ç¨‹å¦‚ä¸‹:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="6925" class="ml la je mh b gy mm mn l mo mp">pip3 install spylon-kernel<br/>python3 -m spylon_kernel install --user</span></pre><p id="6fe5" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ç„¶åè®¾ç½®ç¯å¢ƒå˜é‡SPARK_HOMEã€‚</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="bf0e" class="ml la je mh b gy mm mn l mo mp">export<!-- --> <!-- -->SPARK_HOME=/home/maciej/spark-3.0.0-bin-hadoop3.2</span></pre><p id="4dbf" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥è®¿é—®æœ¨æ˜Ÿç¬”è®°æœ¬ä¸­çš„spylonå†…æ ¸äº†ã€‚</p><figure class="mc md me mf gt iv gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/cd6b360f636b72877a7edcb8f6a49a53.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/0*mCqwMlo_XFmpAT6e.png"/></div></figure><figure class="mc md me mf gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mv"><img src="../Images/9f098b334729e75c3ef8339b92f98249.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HWhC6_cwwRxom8OR.png"/></div></div></figure><p id="1848" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å¦‚æœæ‚¨éœ€è¦ç‰¹å®šçš„åŒ…æˆ–é…ç½®ï¼Œè¯·ä½¿ç”¨%%init_spark</p><figure class="mc md me mf gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mw"><img src="../Images/87a0acfedf6f15aa7f92d0d4b0151a40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xwrluSHKgYZFDUtD.png"/></div></div></figure><h1 id="ef79" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">IntelliJç†å¿µä¸­çš„é¡¹ç›®</h1><p id="8ec4" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">ä½ éœ€è¦Scalaæ’ä»¶ã€‚</p><figure class="mc md me mf gt iv gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/7c23c8c82112cbc25c7cb321f14245f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/0*YZ_oqqEOCC-96e6R.png"/></div></figure><p id="c696" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">æˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€ä¸ªæ–°çš„Scala -&gt; sbté¡¹ç›®ã€‚</p><figure class="mc md me mf gt iv gh gi paragraph-image"><div class="gh gi my"><img src="../Images/c708498f3d6cd89a001a040839c2bf00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/0*Pf10NOCg-Mvi72e5.png"/></div></figure><p id="f18d" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">æˆ‘ä»¬é€‰æ‹©Scala 2.12å’ŒJDKã€‚æˆ‘é€‰æ‹©äº†äºšé©¬é€ŠCorretto 11ã€‚</p><figure class="mc md me mf gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mz"><img src="../Images/173e0bc9f767f87c9b7b841a100113c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/0*TCeXbrtgqWsEORUy.png"/></div></div></figure><p id="458c" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">è®©æˆ‘ä»¬å°†å¿…è¦çš„åŒ…æ·»åŠ åˆ°build.sbtæ–‡ä»¶ä¸­ã€‚</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="f95e" class="ml la je mh b gy mm mn l mo mp">libraryDependencies ++= Seq(<br/>  "org.apache.spark" %% "spark-core" % "3.0.0",<br/>  "org.apache.spark" %% "spark-sql" % "3.0.0"<br/>)</span></pre><p id="391d" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">åœ¨sbtåŠ è½½æ›´æ”¹åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹åœ¨Sparkä¸­ç¼–å†™åº”ç”¨ç¨‹åºã€‚åœ¨src/main/scalaè·¯å¾„ä¸­åˆ›å»ºä¸€ä¸ªå¯¹è±¡å¹¶å¼€å§‹ç¼–ç ğŸ˜ã€‚</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="01a5" class="ml la je mh b gy mm mn l mo mp">import org.apache.spark.sql._<br/> <br/>object MyAwesomeApp {<br/>  def main(args: Array[String]) {<br/> <br/>    val spark = SparkSession<br/>      .builder<br/>      .appName("MyAwesomeApp")<br/>      .master("local[*]")<br/>      .getOrCreate()<br/> <br/>    import spark.implicits._<br/> <br/>    val df = Seq(<br/>      ("x", 4),<br/>      ("y", 2),<br/>      ("z", 5)<br/>    ).toDF("some_id", "some_int")<br/> <br/>    df.show()<br/>  }<br/>}</span></pre></div></div>    
</body>
</html>