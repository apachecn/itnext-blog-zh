<html>
<head>
<title>Adding Codable support to UserDefaults with Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨Swiftä¸ºç”¨æˆ·é»˜è®¤å€¼æ·»åŠ å¯ç¼–ç æ”¯æŒ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/adding-codable-support-to-userdefaults-with-swift-26a799bf00e1?source=collection_archive---------6-----------------------#2019-09-16">https://itnext.io/adding-codable-support-to-userdefaults-with-swift-26a799bf00e1?source=collection_archive---------6-----------------------#2019-09-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/c1fd6b890598506895a7613c755879dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x5koZvoUUD2oLw7pjG6ZeQ.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://unsplash.com/photos/E0AHdsENmDg" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/E0AHdsENmDg</a></figcaption></figure><div class=""/><p id="3d36" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¦‚æœä½ æ˜¯ä¸€åiOSå¼€å‘è€…ï¼Œä½ å¾ˆæœ‰å¯èƒ½åœ¨è¿‡å»ä½¿ç”¨è¿‡<strong class="ki jk">ç”¨æˆ·é»˜è®¤å€¼</strong>æ¥ä¿å­˜å’ŒåŠ è½½æœ¬åœ°æ•°æ®ã€‚</p><p id="1263" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç›®å‰ï¼ŒUserDefaultsæ”¯æŒä»¥ä¸‹æ•°æ®ç±»å‹:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="35b3" class="ln lo jj lj b gy lp lq l lr ls">- URL<br/>- Any (NSData, NSString, NSNumber, NSDate, NSArray, or NSDictionary)<br/>- Bool<br/>- Double<br/>- Float<br/>- Int<br/>- String</span></pre><h1 id="203b" class="lt lo jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">å¥½å§ï¼Œä½†æ˜¯Codableå‘¢ï¼ŸğŸ¤”</h1><p id="bddf" class="pw-post-body-paragraph kg kh jj ki b kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">å‡è®¾æˆ‘ä»¬æœ‰ä¸€è‰˜ç¬¦åˆ<strong class="ki jk">ä»£ç </strong>çš„<strong class="ki jk">æ˜Ÿé™…é£èˆ¹</strong>ç»“æ„ã€‚</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="8cad" class="ln lo jj lj b gy lp lq l lr ls">struct Starship: Codable {<br/>    let name: String<br/>    let captain: String<br/>}</span><span id="2861" class="ln lo jj lj b gy mv lq l lr ls">let enterprise = Starship(name: "Enterprise D", captain: "Jean Luc Picard")</span></pre><p id="8f55" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬å¦‚ä½•<strong class="ki jk">ä¿å­˜</strong>ä¼ä¸š<em class="mw">å¸¸é‡åˆ°ç”¨æˆ·é»˜è®¤å€¼ï¼Ÿ</em></p><p id="ba42" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç›®å‰ï¼Œå”¯ä¸€çš„æ–¹æ³•æ˜¯åœ¨ä¿å­˜ä¹‹å‰å°†ä¼ä¸šæ•°æ®è½¬æ¢ä¸ºæ•°æ®ã€‚ç¨åï¼Œå½“è·å–å€¼æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†<strong class="ki jk">æ•°æ®</strong>è½¬æ¢æˆStarshipã€‚</p><p id="da5c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¾ˆæ— èŠå§ï¼ŸğŸ˜´</p><p id="c012" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æœ‰å‡ ä¸ªæ–¹æ³•å¯ä»¥è®©<strong class="ki jk">ä¿å­˜</strong>å’Œ<strong class="ki jk">åŠ è½½</strong>ä¸€ä¸ªå¯ç¼–ç çš„å€¼ï¼Œéš¾é“æ²¡æœ‰ç”¨å—ï¼Ÿ</p><h1 id="84d9" class="lt lo jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">æ”¹å–„ç”¨æˆ·é»˜è®¤å€¼</h1><p id="00a1" class="pw-post-body-paragraph kg kh jj ki b kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">å¥½ï¼Œè®©æˆ‘ä»¬å°†ä¸‹é¢çš„UserDefaultæ‰©å±•æ·»åŠ åˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¸­ã€‚</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="6a54" class="ln lo jj lj b gy lp lq l lr ls">extension UserDefaults {</span><span id="0e1d" class="ln lo jj lj b gy mv lq l lr ls">func set&lt;Element: Codable&gt;(value: Element, forKey key: String) {<br/>        let data = try? JSONEncoder().encode(value)<br/>        UserDefaults.standard.setValue(data, forKey: key)<br/>    }</span><span id="87e3" class="ln lo jj lj b gy mv lq l lr ls">func codable&lt;Element: Codable&gt;(forKey key: String) -&gt; Element? {<br/>        guard let data = UserDefaults.standard.data(forKey: key) else { return nil }<br/>        let element = try? JSONDecoder().decode(Element.self, from: data)<br/>        return element<br/>    }</span><span id="2fd4" class="ln lo jj lj b gy mv lq l lr ls">}</span></pre><ul class=""><li id="1e25" class="mx my jj ki b kj kk kn ko kr mz kv na kz nb ld nc nd ne nf bi translated">ç¬¬ä¸€ä¸ªæ–¹æ³•æ¥æ”¶ä¸€ä¸ª<strong class="ki jk">å¯ç¼–ç å€¼</strong>ï¼Œå¹¶å°†å…¶ä¿å­˜åˆ°UserDefaultsã€‚</li><li id="6a72" class="mx my jj ki b kj ng kn nh kr ni kv nj kz nk ld nc nd ne nf bi translated">ç¬¬äºŒç§æ–¹æ³•è¿”å›ä¸ç»™å®šé”®ç›¸å…³è”çš„å¯ç¼–ç å€¼ã€‚</li></ul><p id="6b06" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¤šäºäº†è¿™äº›æ–¹æ³•ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥å¯¹ä»»ä½•å¯ç¼–ç ç±»å‹ä½¿ç”¨UserDefaultsã€‚</p><h1 id="7f60" class="lt lo jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">è¯•éªŒğŸ”¨</h1><p id="5225" class="pw-post-body-paragraph kg kh jj ki b kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">æœ€åï¼Œæˆ‘ä»¬æ¥åšä¸€ä¸ªæµ‹è¯•ã€‚</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="87b0" class="ln lo jj lj b gy lp lq l lr ls">struct Starship: Codable {<br/>    let name: String<br/>    let captain: String<br/>}</span><span id="a27d" class="ln lo jj lj b gy mv lq l lr ls">let enterprise = Starship(name: "Enterprise D", captain: "Jean Luc Picard")</span><span id="f40f" class="ln lo jj lj b gy mv lq l lr ls">UserDefaults.standard.set(value: enterprise, forKey: "enterprise")</span><span id="46d4" class="ln lo jj lj b gy mv lq l lr ls">let value: Starship? = UserDefaults.standard.codable(forKey: "enterprise")</span></pre><p id="afed" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬ç°åœ¨å¯ä»¥æ‰“å°å‡º<strong class="ki jk">å€¼</strong> <em class="mw"> </em>å¸¸æ•°<em class="mw">ã€‚</em></p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="8534" class="ln lo jj lj b gy lp lq l lr ls">Optional(Starship(name: "Enterprise D", captain: "Jean Luc Picard"))</span></pre><h1 id="8860" class="lt lo jj bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å£°æ˜è¦è·å–çš„å€¼çš„ç±»å‹ï¼ŸğŸ¤”</h1><p id="09f3" class="pw-post-body-paragraph kg kh jj ki b kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">å¥½é—®é¢˜ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å†™è¿™ä¸ª</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="8763" class="ln lo jj lj b gy lp lq l lr ls">let value<strong class="lj jk">: Starship?</strong> = UserDefaults.standard.codable(forKey: "enterprise")</span></pre><p id="4bb9" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è€Œä¸æ˜¯è¿™ä¸ªï¼Ÿ</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="3d33" class="ln lo jj lj b gy lp lq l lr ls">let value = UserDefaults.standard.codable(forKey: "enterprise")</span></pre><p id="29b4" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä¸å…¶ä»–UserDefaultsæ–¹æ³•(å¦‚<strong class="ki jk">userderfaults . standard . integer(forKey:)</strong>)ä¸åŒï¼Œæˆ‘ä»¬çš„<strong class="ki jk"> codable(forKey:) </strong>æ–¹æ³•å¹¶ä¸æ€»æ˜¯è¿”å›ç›¸åŒçš„ç±»å‹ã€‚</p><p id="d282" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å–‚ğŸ‘‡</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="0e85" class="ln lo jj lj b gy lp lq l lr ls">struct Starship: Codable {<br/>    let name: String<br/>    let captain: String<br/>}</span><span id="fdc4" class="ln lo jj lj b gy mv lq l lr ls">struct SpaceStation: Codable {<br/>    let name: String<br/>}</span><span id="ce76" class="ln lo jj lj b gy mv lq l lr ls">let enterprise = Starship(name: "Enterprise D", captain: "Jean Luc Picard")<br/>let deepSpace9 = SpaceStation(name: "Deep Space Nine")</span><span id="961a" class="ln lo jj lj b gy mv lq l lr ls">UserDefaults.standard.set(value: enterprise, forKey: "enterprise")<br/>UserDefaults.standard.set(value: deepSpace9, forKey: "deepSpace9")</span><span id="cf28" class="ln lo jj lj b gy mv lq l lr ls">let value0: Starship? = UserDefaults.standard.codable(forKey: "enterprise")<br/>let value1: SpaceStation? = UserDefaults.standard.codable(forKey: "deepSpace9")</span></pre><p id="6f5c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è§‚å¯Ÿæœ€åä¸¤è¡Œï¼Œæˆ‘ä»¬çš„æ–¹æ³•æ˜¯è¿”å›ä¸€è‰˜<strong class="ki jk">æ˜Ÿé™…é£èˆ¹</strong>ï¼Œç„¶åè¿”å›ä¸€è‰˜<strong class="ki jk">ç©ºé—´ç«™</strong>ã€‚</p><p id="b7df" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦å‘Šè¯‰æˆ‘ä»¬çš„æ–¹æ³•æˆ‘ä»¬æœŸæœ›çš„ç±»å‹ã€‚</p></div></div>    
</body>
</html>