# ç”¨ cypress è¿›è¡Œ excel æ–‡ä»¶ä¸‹è½½çš„ E2E æµ‹è¯•

> åŸæ–‡ï¼š<https://itnext.io/e2e-testing-of-excel-downloads-with-cypress-d6e46ccdc232?source=collection_archive---------1----------------------->

![](img/f32c5faffa5a769b2ae2f69d86534c45.png)

Maggie Appleton ä¸º egghead.io æ‰€ä½œçš„æ’å›¾

æœ€è¿‘åœ¨åšä¸€ä¸ªé¡¹ç›®æ—¶ï¼Œæˆ‘ä¸å¾—ä¸åˆ›å»ºä¸€ä¸ªåŠŸèƒ½ï¼Œè®©ç”¨æˆ·å¯ä»¥ä¸‹è½½åŒ…å«ä¸€äº›æ•°æ®çš„ excel æ–‡ä»¶ã€‚

åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œç”±äºæˆ‘éå¸¸å–œæ¬¢ç”¨ [Cypress.io](https://medium.com/u/47c842e55929?source=post_page-----d6e46ccdc232--------------------------------) è¿›è¡Œ E2E æµ‹è¯•ï¼Œæ‰€ä»¥æˆ‘å†³å®šç¼–å†™ä¸€ä¸ªæµ‹è¯•å¥—ä»¶ï¼Œç¡®ä¿ excel è¢«æ­£ç¡®ä¸‹è½½ï¼Œå¹¶ä¸”åŒ…å«ç”¨æˆ·æœŸæœ›çš„æ­£ç¡®æ•°æ®ã€‚

æœ¬æ–‡å‡è®¾å¯¹ cypress æœ‰ä¸€ä¸ªåŸºæœ¬çš„äº†è§£ã€‚

**å…è´£å£°æ˜**

å¦‚æœä½ ä»¥å‰æ²¡æœ‰å°è¯•è¿‡ç”¨ cypress è¿›è¡Œ e2e æµ‹è¯•ï¼Œæˆ‘å¼ºçƒˆæ¨èä½ è·³åˆ°â€œå‚è€ƒâ€éƒ¨åˆ†ï¼ŒæŒ‰ç…§ä¸€äº›å…¥é—¨æŒ‡å—å»åšã€‚

# ğŸ“¦è£…ç½®

1.  å‡è®¾æ‚¨æœ‰ä¸€ä¸ªåä¸º`dashboard-ui`çš„ repoï¼Œåœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`e2e`çš„æ–°æ–‡ä»¶å¤¹ã€‚
2.  `cd`åˆ°é‚£ä¸ªæ–‡ä»¶å¤¹ï¼Œåœ¨é‡Œé¢æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚

3)é€šè¿‡æ‰“å¼€`package.json`æ›´æ–°é¡¹ç›®è„šæœ¬ï¼Œå¹¶å°†æ‚¨çš„è„šæœ¬æ›´æ–°ä¸º:

4)å®‰è£… cypress åï¼Œæ‚¨è¿˜åº”è¯¥ä¼šçœ‹åˆ° cypress ä¸ºæ‚¨åˆ›å»ºçš„ä¸€äº›é»˜è®¤æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ã€‚

![](img/1c02e00ce7f73087704886107de9dd8d.png)

5)æˆ‘ä»¬å°†è¦ç¼–å†™çš„æµ‹è¯•å°†æ”¾åœ¨`integration`æ–‡ä»¶å¤¹ä¸­ã€‚

# âš™ï¸åŠŸèƒ½

ä¸ºäº†ç®€å•èµ·è§ï¼Œå‡è®¾æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåªæœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œç”¨æˆ·å¯ä»¥ç‚¹å‡»ä¸€ä¸ª`download template`æŒ‰é’®ï¼Œå®ƒå¯ä»¥ä¸‹è½½ä¸€ä¸ªåŒ…å«ä¸€äº›æ•°æ®çš„ excel æ–‡ä»¶ã€‚

![](img/031867e411e40b5433dc10f1499c3704.png)

å•å‡»ä¸‹è½½æ¨¡æ¿æŒ‰é’®ï¼Œä¸‹è½½ä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤º:

![](img/618365743fc241bc82d08dfa6b38b0c9.png)

## æ¼”ç¤º

![](img/15bbed0852168e080e9b9e406a0e23be.png)

gif åˆ°æ¼”ç¤º excel æ–‡ä»¶ä¸‹è½½

# ğŸ§ª E2E æµ‹è¯•

1.  åœ¨`integration`æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`ExcelDownload.spec.js`çš„æ–°æ–‡ä»¶ã€‚
2.  åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬çš„æµ‹è¯•å°†é¦–å…ˆæ£€æŸ¥æŒ‰é’®æ˜¯å¦å­˜åœ¨ï¼Œç„¶åæˆ‘ä»¬å°†å•å‡»å®ƒã€‚

3)ç‚¹å‡»æ–‡ä»¶åï¼Œç†æƒ³æƒ…å†µä¸‹æ–‡ä»¶åº”è¯¥å·²ç»ä¸‹è½½ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦ä»¥æŸç§æ–¹å¼è¯»å–è¯¥æ–‡ä»¶ï¼Œæ£€æŸ¥å®ƒæ˜¯å¦å­˜åœ¨ï¼Œå¹¶æ£€æŸ¥å®ƒæ˜¯å¦åŒ…å«æ­£ç¡®çš„æ•°æ®ã€‚

4)ä¸ºæ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å®‰è£…å¦ä¸€ä¸ª npm åŒ…ï¼Œå®ƒå¯ä»¥è§£æ excel å¹¶å°†å…¶è½¬æ¢ä¸º jsonã€‚

5)ä¹‹åï¼Œåœ¨æ‚¨çš„`plugins/index.js`æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæ–°ä»»åŠ¡æ¥è§£æ excelã€‚

è¿™ä¸ªå‡½æ•°å°†è§£ææˆ‘ä»¬çš„ excel æ–‡ä»¶ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸º jsonã€‚

6)æœ€åï¼Œè®©æˆ‘ä»¬å®Œæˆ excel æ–‡ä»¶ä¸‹è½½çš„æµ‹è¯•

7)è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¡®ä¿æˆ‘ä»¬çš„ excel ä¸‹è½½åŠŸèƒ½æ­£å¸¸å·¥ä½œã€‚

## æµ‹è¯•æ‰§è¡Œ

![](img/02f51243f778b14e4006002ee5300cf6.png)

åœ¨ cypress ä¸­è¿è¡Œ e2e æµ‹è¯•çš„æ¼”ç¤º

8)è¿™é‡Œå”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚ä½•çŸ¥é“ CI/CD ç®¡é“çš„ä¸‹è½½è·¯å¾„ï¼Œæˆ–è€…å¦‚ä½•å°†è¯¥è·¯å¾„æ›´æ”¹ä¸ºå…¶ä»–è·¯å¾„ã€‚

è§£å†³åŠæ³•æ˜¯åœ¨æŸæ ‘ä¸Šå»ºé€ ã€‚åœ¨`plugins/index.js`æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†å†æ¬¡åˆ›å»ºå¦ä¸€ä¸ªä»»åŠ¡ã€‚

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä¸‹è½½çš„é»˜è®¤ç›®å½•æ›´æ”¹ä¸º cypress æ–‡ä»¶å¤¹ä¸­çš„ä¸€ä¸ªåä¸º`excelDownloads`çš„ç›®å½•ã€‚

[https://docs . cypress . io/API/plugins/browser-launch-API . html # Change-download-directory](https://docs.cypress.io/api/plugins/browser-launch-api.html#Change-download-directory)

# ğŸ’¡ç»“è®º

æ€»ä¹‹ï¼ŒE2E æµ‹è¯•å¯¹æ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½éå¸¸é‡è¦ï¼Œä½ ä¹Ÿåº”è¯¥å†™ä¸€ä¸ªï¼Œå› ä¸ºè¿™æ˜¯ä½ èƒ½å¾—åˆ°çš„æœ€æ¥è¿‘æµ‹è¯•å®é™…ç”¨æˆ·å¦‚ä½•ä½¿ç”¨ä½ çš„åº”ç”¨ç¨‹åºçš„æ–¹æ³•ã€‚

æ­£å¦‚æ‰˜é©¬æ–¯Â·æ‹‰ç§‘ç±³æ‰€è¯´:

> æœ‰äº† e2e æµ‹è¯•å’Œ cypress.ioï¼Œæ™šä¸Šç¡å¾—æ›´é¦™

ğŸ‘¯å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©ï¼Œè¯·åˆ†äº«ï¼

æ›´å¤šæ›´æ–°å¯ä»¥åœ¨ twitter [@VivekNayyar09](https://twitter.com/VivekNayyar09) å…³æ³¨æˆ‘ã€‚

å¦å¤–ï¼Œè¯·ä¸è¦å¿˜è®°ä¿æŒç¤¾äº¤è·ç¦»ï¼Œä»¥é˜²æ­¢ç—…æ¯’ä¼ æ’­ï¼Œå¹¶å®šæœŸæ´—æ‰‹ã€‚æ³¨æ„å®‰å…¨ï¼Œå‘†åœ¨å®¶é‡Œã€‚

# ğŸš€**å‚è€ƒæ–‡çŒ®**

*   [https://softchris.github.io/pages/cypress.html](https://softchris.github.io/pages/cypress.html)
*   [https://docs . cypress . io/guides/getting-started/installing-cypress . html #ç³»ç»Ÿè¦æ±‚](https://docs.cypress.io/guides/getting-started/installing-cypress.html#System-requirements)
*   [https://dev . to/tlakomy/sleeping-better-night-with-cypress-io-59 m2](https://dev.to/tlakomy/sleeping-better-at-night-with-cypress-io-59m2)
*   [https://blog . log rocket . com/how-to-write-useful-end-to-end-tests-with-cypress/](https://blog.logrocket.com/how-to-write-useful-end-to-end-tests-with-cypress/)