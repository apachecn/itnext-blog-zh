<html>
<head>
<title>React Hooks â€” designing a simple forms API â€” part 6 â€” yup schema validation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">react Hooksâ€”â€”è®¾è®¡ç®€å•çš„è¡¨å•APIâ€”â€”ç¬¬6éƒ¨åˆ†â€”â€”æ¨¡å¼éªŒè¯</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/react-hooks-designing-a-simple-forms-api-part-6-yup-schema-validation-5a800cb1c330?source=collection_archive---------1-----------------------#2019-04-25">https://itnext.io/react-hooks-designing-a-simple-forms-api-part-6-yup-schema-validation-5a800cb1c330?source=collection_archive---------1-----------------------#2019-04-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="9cd8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ‰©å±•æˆ‘ä»¬çš„è¡¨å•APIæ¥æ”¯æŒ<a class="ae ko" href="https://github.com/jquense/yup" rel="noopener ugc nofollow" target="_blank">åŸºäºyupçš„æ¨¡å¼éªŒè¯</a>ã€‚</p><p id="d056" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨æœ¬ç³»åˆ—çš„ç¬¬1éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬ç ”ç©¶äº†å¦‚ä½•ä½¿ç”¨Reacté’©å­æ¥è®¾è®¡ä¸€ä¸ªReactè¡¨å•åº“ã€‚ç¬¬1éƒ¨åˆ†ä»‹ç»äº†è¿™ä¸ªåº“çš„åŠ¨æœºå’Œä¸€äº›æ€»ä½“è®¾è®¡ç›®æ ‡ã€‚</p><p id="b83f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨æœ¬ç³»åˆ—çš„ç¬¬2éƒ¨åˆ†<a class="ae ko" href="https://medium.com/@shanplourde/react-hooks-designing-a-simple-forms-api-part-2-1fe5d12f23d9" rel="noopener">ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª<code class="fe kp kq kr ks b">useInput</code>é’©å­ï¼Œå°†å…¶é›†æˆåˆ°æˆ‘ä»¬çš„<code class="fe kp kq kr ks b">useForm</code>é’©å­ä¸­ï¼Œå›é¡¾äº†æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆçš„çŠ¶æ€ç®¡ç†ï¼Œåˆå¹¶äº†ä¸€äº›é¢å¤–çš„æµ‹è¯•ï¼Œå¹¶ä¸”æ›´è¯¦ç»†åœ°å›é¡¾äº†æµ‹è¯•ç­–ç•¥ã€‚</a></p><p id="f5a1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨ç¬¬3éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†éªŒè¯ã€å¼‚æ­¥éªŒè¯å’Œå¼‚æ­¥è¡¨å•æäº¤ã€‚å®ƒä¸ºæˆ‘ä»¬æä¾›äº†åŸºäºReact hooksçš„è¡¨å•APIçš„å…³é”®å…ƒç´ ã€‚</p><p id="748b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae ko" rel="noopener ugc nofollow" target="_blank" href="/react-hooks-designing-a-simple-forms-api-part-4-scaling-to-other-input-types-e738db0a3fc3">åœ¨ç¬¬4éƒ¨åˆ†</a>ä¸­ï¼Œæˆ‘ä»¬æ‰©å±•äº†æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆï¼Œä»¥æ”¯æŒæ ‡å‡†HTMLè¾“å…¥ç±»å‹å’Œè‡ªå®šä¹‰è¾“å…¥ã€‚</p><p id="3399" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨ç¬¬5éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬æ‰©å±•äº†<code class="fe kp kq kr ks b">useForm</code>ä»¥æ”¯æŒåŠ¨æ€è¡¨å•ã€‚</p><h1 id="b1db" class="kt ku it bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">å·¥ä½œç¤ºä¾‹</h1><p id="6098" class="pw-post-body-paragraph jq jr it js b jt lr jv jw jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn im bi translated">è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¸¦æœ‰æ¨¡å¼éªŒè¯æ”¯æŒçš„<code class="fe kp kq kr ks b">useForm</code>é’©å­çš„æ¼”ç¤º:</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="mb mc l"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">å¸¦æœ‰æ¨¡å¼éªŒè¯çš„useFormæ¼”ç¤º</figcaption></figure><p id="38f9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae ko" href="https://github.com/shanplourde/react-hooks-form-util" rel="noopener ugc nofollow" target="_blank">å®Œæ•´çš„è§£å†³æ–¹æ¡ˆå¯ä»¥åœ¨æˆ‘çš„GitHub </a>ä¸­æ‰¾åˆ°ã€‚æ¼”ç¤ºä¸­æœ‰å¾ˆå¤šæ ·æ¿æ–‡ä»¶ï¼Œä½†æˆ‘å¸Œæœ›åœ¨è¿™ä¸€ç‚¹ä¸Šæœ‰éå¸¸æ˜ç¡®çš„ä¾‹å­ã€‚è¯·æ³¨æ„ï¼Œç”±äºCodeSandboxè®¾è®¡å†³å®šä¸æ”¯æŒä»<code class="fe kp kq kr ks b">package.json</code>åŠ è½½<code class="fe kp kq kr ks b">devDependencies</code>ï¼Œæµ‹è¯•æ­¤æ—¶ä¸ä¼šé€šè¿‡CodeSandboxã€‚</p><h1 id="771b" class="kt ku it bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">æ˜¯çš„æ¨¡å¼éªŒè¯æ¦‚è¿°å’Œå¥½å¤„</h1><p id="dd12" class="pw-post-body-paragraph jq jr it js b jt lr jv jw jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn im bi translated">Yupæ˜¯ä¸€ä¸ªæ¨¡å¼éªŒè¯åº“ã€‚æ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥å®šä¹‰ä¸€ä¸ªJavaScriptæ¨¡å¼ï¼Œç„¶åæ ¹æ®è¯¥æ¨¡å¼éªŒè¯ä»»æ„å¯¹è±¡ã€‚Yupä¸ºæ‚¨æä¾›äº†ä¸€æ•´å¥—æ ‡å‡†çš„æ¨¡å¼éªŒè¯ï¼Œå¦‚requiredã€min lengthã€max lengthã€emailç­‰ã€‚</p><p id="a656" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æœ‰å¾ˆå¤šæ¨¡å¼éªŒè¯åº“ï¼Œyupæ°å¥½æ˜¯å…¶ä¸­è¾ƒå¤§ä¸”è¾ƒæ´»è·ƒçš„ä¸€ä¸ªã€‚è®©æˆ‘ä»¬é€šè¿‡æŸ¥çœ‹ä¸€ä¸ª<a class="ae ko" href="https://runkit.com/jquense/yup#" rel="noopener ugc nofollow" target="_blank">ä»£ç ç¤ºä¾‹</a>æ¥çœ‹çœ‹yupéªŒè¯æ˜¯ä»€ä¹ˆæ ·å­çš„:</p><pre class="lw lx ly lz gt mh ks mi mj aw mk bi"><span id="a11e" class="ml ku it ks b gy mm mn l mo mp">const { object, string, number, date } = require('yup')</span><span id="b446" class="ml ku it ks b gy mq mn l mo mp">const contactSchema = object({<br/>  name: string()<br/>    .required(),<br/>  age: number()<br/>    .required()<br/>    .positive()<br/>    .integer(),<br/>  email: string()<br/>    .email(),<br/>  website: string()<br/>    .url(),<br/>  createdOn: date()<br/>    .default(() =&gt; new Date())<br/>})</span><span id="ff5f" class="ml ku it ks b gy mq mn l mo mp">let contact = {<br/>  name: 'jimmy',<br/>  age: 24,<br/>  email: '<a class="ae ko" href="mailto:jdog@cool.biz" rel="noopener ugc nofollow" target="_blank">jdog@cool.biz</a>'<br/>}</span><span id="0c5a" class="ml ku it ks b gy mq mn l mo mp">await contactSchema.isValid(contact) // true = valid</span></pre><p id="c2ea" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe kp kq kr ks b">contactSchema</code>æ˜¯yupæ¨¡å¼ã€‚<code class="fe kp kq kr ks b">contact</code>æ˜¯æ‚¨çš„æ•°æ®å¯¹è±¡(è¿™å¯èƒ½æ˜¯æ¥è‡ªè¡¨å•çš„æ•°æ®)ã€‚æœ€åè°ƒç”¨<code class="fe kp kq kr ks b">contactSchema.isValid()</code>æ ¹æ®<code class="fe kp kq kr ks b">contactSchema</code>æ¨¡å¼éªŒè¯<code class="fe kp kq kr ks b">contact</code>å¯¹è±¡ã€‚Yupæä¾›äº†ä¸€ä¸ªæµç•…çš„APIæ¥å®šä¹‰æ¨¡å¼ã€‚å®é™…ä¸Šï¼Œè¿™å¯èƒ½ä¸æ˜¯æ‚¨æƒ³è¦çš„å®šä¹‰æ¨¡å¼çš„æ–¹å¼ã€‚</p><p id="e40b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„å­—æ®µæ˜¯ä»æ•°æ®åº“ä¸­åŠ¨æ€åˆ›å»ºçš„ï¼Œæ‚¨å°†å¦‚ä½•å­˜å‚¨æ‰€æœ‰è¿™äº›æµç•…çš„APIè°ƒç”¨ï¼Ÿåœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å…è®¸æ‚¨ä»¥JSONæ ¼å¼å­˜å‚¨æ¨¡å¼çš„åº“ï¼Œç„¶åå¯ä»¥å°†æ¨¡å¼åºåˆ—åŒ–å¹¶å­˜å‚¨åœ¨ä»»ä½•æ•°æ®åº“ä¸­ã€‚<a class="ae ko" href="https://github.com/kristianmandrup/schema-to-yup" rel="noopener ugc nofollow" target="_blank"> schema-to-yup </a>å°±æ˜¯è¿™æ ·ä¸€ä¸ªåº“ï¼Œå®ƒå…è®¸æ‚¨åœ¨JSONä¸­å®šä¹‰æ¨¡å¼ï¼Œç„¶åå°†æ¨¡å¼è½¬æ¢ä¸ºyupæ¨¡å¼å¯¹è±¡ã€‚</p><p id="fcd4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æŒ‚é’©éœ€è¦ä¸yupé›†æˆã€‚å½“å‘<code class="fe kp kq kr ks b">useForm</code>æä¾›yupæ¨¡å¼æ—¶ï¼Œ<code class="fe kp kq kr ks b">useForm</code>å°†éœ€è¦å¯¹è¾“å…¥å­—æ®µåº”ç”¨é‚£äº›éªŒè¯ã€‚</p><h1 id="59b1" class="kt ku it bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">åœ¨ä»»æ„æ—¶é—´åº”ç”¨æ¨¡å¼éªŒè¯</h1><p id="d88c" class="pw-post-body-paragraph jq jr it js b jt lr jv jw jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn im bi translated">å°±åƒæˆ‘ä»¬åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­åˆ›å»ºçš„<a class="ae ko" rel="noopener ugc nofollow" target="_blank" href="/react-hooks-designing-a-simple-forms-api-part-3-validation-and-a-running-example-18b835a3b817">å¼€ç®±å³ç”¨éªŒè¯ä¸€æ ·ï¼Œæ¨¡å¼éªŒè¯åº”è¯¥èƒ½å¤Ÿä¸å¼€ç®±å³ç”¨éªŒè¯åŒæ—¶è¿è¡Œã€‚æˆ‘ä»¬åº”è¯¥å…è®¸è¡¨å•åˆ›å»ºè€…è¯´â€œå˜¿ï¼Œæˆ‘æƒ³åœ¨æˆ‘çš„åå­—å­—æ®µä¸Šè¿è¡ŒonBlurå’ŒonSubmitçš„æ¨¡å¼éªŒè¯â€ï¼Œæˆ–è€…â€œå˜¿ï¼Œæˆ‘æƒ³å¯¹æˆ‘çš„åå­—å­—æ®µåº”ç”¨æ¨¡å¼éªŒè¯ï¼ŒåŒæ—¶åº”ç”¨æˆ‘çš„</a><a class="ae ko" href="https://medium.com/@shanplourde/inline-form-validations-ux-design-considerations-and-react-examples-c2f53f89bebc" rel="noopener">å¥–åŠ±æ—©æœŸéªŒè¯æ™šæœŸè®¾è®¡æ¨¡å¼</a>â€ã€‚</p><h1 id="77a4" class="kt ku it bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">è®¾è®¡å…¬å…±APIä»¥æ”¯æŒæ¨¡å¼éªŒè¯</h1><p id="a9e2" class="pw-post-body-paragraph jq jr it js b jt lr jv jw jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn im bi translated">åœ¨æˆ‘çœ‹æ¥ï¼Œå½¢å¼æ˜¯æ¨¡å¼çš„å­é›†ã€‚ä¸¤è€…ä¹‹é—´å­˜åœ¨è€¦åˆã€‚æ‰€ä»¥æˆ‘æ›´å–œæ¬¢ç”¨æœ€åˆçš„<code class="fe kp kq kr ks b">useForm</code>é’©å­è°ƒç”¨æ¥ä¼ é€’æ¨¡å¼ã€‚</p><pre class="lw lx ly lz gt mh ks mi mj aw mk bi"><span id="5fdb" class="ml ku it ks b gy mm mn l mo mp">export const useForm = ({ id, initialState = {}, validationSchema = {} }) =&gt; {<br/>  const inputValues = useRef({<br/>    ...initialState<br/>  });</span></pre><p id="8217" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe kp kq kr ks b">useForm</code>ç°åœ¨æ¥æ”¶ä¸€ä¸ª<code class="fe kp kq kr ks b">validationSchema</code>å±æ€§ï¼Œå½“è®¾ç½®è¯¥å±æ€§æ—¶ï¼Œå®ƒå°†å¯¹è¡¨å•ä¸­æœ€ç»ˆå®šä¹‰çš„å­—æ®µåº”ç”¨æ¨¡å¼éªŒè¯ã€‚è¦ä½¿ç”¨æ¨¡å¼éªŒè¯ï¼Œè¡¨å•åˆ›å»ºè€…éœ€è¦æ‰§è¡Œä»¥ä¸‹æ“ä½œ:</p><pre class="lw lx ly lz gt mh ks mi mj aw mk bi"><span id="235d" class="ml ku it ks b gy mm mn l mo mp">const { required, mustBeTrue, schema } = validators;</span><span id="4bcc" class="ml ku it ks b gy mq mn l mo mp">const contactSchema = object({<br/>    firstName: string()<br/>      .required()<br/>      .min(3),<br/>    lastName: string()<br/>      .required()<br/>      .length(10),<br/>    email: string().email()<br/>  });</span><span id="f30d" class="ml ku it ks b gy mq mn l mo mp">const {<br/>    getFormProps,<br/>    inputValues,<br/>    uiState,<br/>    api,<br/>    formValidity,<br/>    inputUiState<br/>  } = useForm({<br/>    id: "kitchenSinkForm",<br/>    initialState,<br/>    validationSchema: contactSchema<br/>  });</span><span id="e5bd" class="ml ku it ks b gy mq mn l mo mp">const firstNameInput = api.addInput({<br/>    id: "firstName",<br/>    value: inputValues.firstName,<br/>    validators: [<br/>      {<br/>        ...schema,<br/>        when: [<br/>          {<br/>            eventType: onChange,<br/>            evaluateCondition: evaluateConditions.rewardEarlyValidateLate<br/>          },<br/>          onBlur,<br/>          onSubmit<br/>        ]<br/>      }<br/>    ]<br/>  });</span><span id="526a" class="ml ku it ks b gy mq mn l mo mp">const lastNameInput = api.addInput({<br/>    id: "lastName",<br/>    value: inputValues.lastName,<br/>    validators: [{ ...schema, when: [onBlur, onSubmit] }]<br/>  });</span><span id="66d3" class="ml ku it ks b gy mq mn l mo mp">const emailInput = api.addInput({<br/>    id: "email",<br/>    value: inputValues.email,<br/>    validators: [<br/>      { ...schema, when: [onBlur, onSubmit] }<br/>      // {<br/>      //   ...email,<br/>      //   when: [onBlur, onSubmit]<br/>      // }<br/>    ]<br/>  });</span></pre><p id="326a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨ä¸Šé¢çš„ç¤ºä¾‹è¡¨å•ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†<code class="fe kp kq kr ks b">contactSchema</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªyupæ¨¡å¼ã€‚æˆ‘ä»¬å°†å®ƒä¼ é€’ç»™<code class="fe kp kq kr ks b">useForm</code>é’©å­ã€‚ç„¶åï¼Œå½“æˆ‘ä»¬å®šä¹‰è¾“å…¥æ—¶ï¼Œæˆ‘ä»¬æŒ‡å‡ºæˆ‘ä»¬å¸Œæœ›ç”¨<code class="fe kp kq kr ks b">validators: [ { ...schema } ]</code>éªŒè¯å™¨å¯¹å®ƒä»¬åº”ç”¨æ¨¡å¼éªŒè¯ã€‚è¿™ç§æ–¹æ³•çš„å¥½å¤„åœ¨äºï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å®šä¹‰ä½•æ—¶åº”ç”¨è¿™äº›æ¨¡å¼éªŒè¯â€”â€”onBlurã€onSubmitç­‰ã€‚</p><p id="8e71" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨<code class="fe kp kq kr ks b">api.addInput</code>ä¸­ï¼Œå½“æˆ‘ä»¬æŒ‡å®šæƒ³è¦ä½¿ç”¨<code class="fe kp kq kr ks b">schema</code>éªŒè¯å™¨æ—¶ï¼Œ<code class="fe kp kq kr ks b">useForm</code>æ ¹æ®è¾“å…¥<code class="fe kp kq kr ks b">id</code>è¿æ¥é€‚å½“çš„æ¨¡å¼å­—æ®µã€‚</p><h1 id="fe4f" class="kt ku it bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">å®æ–½ç»†èŠ‚</h1><h2 id="b1b8" class="ml ku it bd kv mr ms dn kz mt mu dp ld kb mv mw lh kf mx my ll kj mz na lp nb bi translated">åˆ›å»ºæ¨¡å¼éªŒè¯å™¨</h2><p id="2f3c" class="pw-post-body-paragraph jq jr it js b jt lr jv jw jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn im bi translated">åœ¨ä¸Šé¢çš„<code class="fe kp kq kr ks b">useForm</code>ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<code class="fe kp kq kr ks b">schema</code>éªŒè¯å™¨ã€‚ä¸‹é¢æ˜¯validators.jsä¸­çš„<code class="fe kp kq kr ks b">schema</code>éªŒè¯å™¨ä»£ç :</p><pre class="lw lx ly lz gt mh ks mi mj aw mk bi"><span id="c1b3" class="ml ku it ks b gy mm mn l mo mp">validators.schema = createValidator({<br/>  validateFn: async ({ value, validationSchema }) =&gt; {<br/>    if (!validationSchema || !validationSchema.validate) return true;<br/>    try {<br/>      await validationSchema.validate(value);<br/>      return true;<br/>    } catch (e) {<br/>      return false;<br/>    }<br/>  },<br/>  error: "INVALID_SCHEMA"<br/>});</span></pre><p id="a25b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æˆ‘ä»¬ä½¿ç”¨yup <code class="fe kp kq kr ks b">validate</code> APIæ¥æ‰§è¡ŒéªŒè¯ã€‚æˆ‘ä»¬éµå¾ªå…¶ä»–éªŒè¯å™¨çš„ç›¸åŒæ¨¡å¼â€”â€”åŸºäºéªŒè¯æˆåŠŸè¿”å›true/falseã€‚å¦‚æœä¸€ä¸ªyupéªŒè¯å¤±è´¥ï¼Œyupå°†è¿”å›è®¸å¤šå…¶ä»–å±æ€§ï¼Œç”šè‡³æ˜¯é”™è¯¯æè¿°ï¼Œä½†æ˜¯æˆ‘çš„åå¥½æ˜¯ä¸åœ¨éªŒè¯é”™è¯¯ä¸­åŒ…å«å†…å®¹ã€‚å› æ­¤ï¼Œå¦‚æœæ¨¡å¼éªŒè¯å¤±è´¥ï¼Œå®ƒä»¬åªä¼šè¿”å›<code class="fe kp kq kr ks b">INVALID_SCHEMA</code>é”™è¯¯æ¶ˆæ¯ã€‚è¡¨å•åˆ›å»ºè€…å¯ä»¥å†³å®šåœ¨è¿™äº›æƒ…å†µä¸‹æ˜¾ç¤ºä»€ä¹ˆæ ·çš„å‰¯æœ¬ã€‚æˆ‘ç›¸ä¿¡è¿™å¯ä»¥æ”¹è¿›ï¼Œä½†æˆ‘ä¸ç¡®å®šå¦‚ä½•æ”¹è¿›ï¼Œå› ä¸ºè¡¨å•åˆ›å»ºè€…å¯ä»¥è®¿é—®æ¨¡å¼å®šä¹‰ï¼Œæ‰€ä»¥å¦‚æœä»–ä»¬æ„¿æ„ï¼Œä»–ä»¬å¯ä»¥æŸ¥è¯¢æ¨¡å¼å®šä¹‰æ¥åˆ›å»ºé”™è¯¯æ¶ˆæ¯ã€‚</p><p id="6287" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe kp kq kr ks b">useForm</code>åªä¼šå°†ä¸€ä¸ªæ¨¡å¼å­—æ®µä¼ é€’ç»™æ¨¡å¼éªŒè¯ã€‚é¢„æœŸæ˜¯ï¼Œå¦‚æœæˆ‘ä»¬éªŒè¯åå­—å­—æ®µï¼Œ<code class="fe kp kq kr ks b">useForm</code>å°†åªæŠŠ<code class="fe kp kq kr ks b">firstName</code>å­—æ®µä¼ é€’ç»™æ¨¡å¼éªŒè¯å™¨ï¼Œè€Œä¸æ˜¯å®Œæ•´çš„æ¨¡å¼</p><h2 id="19af" class="ml ku it bd kv mr ms dn kz mt mu dp ld kb mv mw lh kf mx my ll kj mz na lp nb bi translated">æ›´æ–°useFormä»¥å°†æ¶æ„å­—æ®µä¼ é€’ç»™æ¶æ„éªŒè¯ç¨‹åº</h2><p id="8cf6" class="pw-post-body-paragraph jq jr it js b jt lr jv jw jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn im bi translated"><code class="fe kp kq kr ks b">useForm</code>éœ€è¦æœ€å°çš„æ”¹åŠ¨ã€‚ç°åœ¨è¡¨å•åˆ›å»ºè€…å¯ä»¥å°†<code class="fe kp kq kr ks b">validationSchema</code>ä¼ é€’ç»™<code class="fe kp kq kr ks b">useForm</code>ï¼Œä»»ä½•æ—¶å€™éœ€è¦éªŒè¯æ—¶ï¼Œ<code class="fe kp kq kr ks b">useForm</code>éƒ½å¯ä»¥å°†æ­£ç¡®çš„æ¨¡å¼å­—æ®µä¼ é€’ç»™éªŒè¯ã€‚validators.jsåªéœ€è¦å°†<code class="fe kp kq kr ks b">validationSchema</code>ä½œä¸ºä¸€ä¸ªå‚æ•°ï¼Œå¹¶åœ¨é€‚å½“çš„æ—¶å€™å°†å…¶ä¼ é€’ç»™æ¨¡å¼éªŒè¯å™¨ã€‚</p><pre class="lw lx ly lz gt mh ks mi mj aw mk bi"><span id="270e" class="ml ku it ks b gy mm mn l mo mp"><strong class="ks iu">const getSchemaField = (validationSchema, field) =&gt;<br/>  validationSchema.fields ? validationSchema.fields[field] : null;</strong></span><span id="3ad0" class="ml ku it ks b gy mq mn l mo mp">...</span><span id="7c6e" class="ml ku it ks b gy mq mn l mo mp">const validateAll = async eventType =&gt; {<br/>    const promises = [];<br/>    let newUiState = { ...uiState };</span><span id="42e1" class="ml ku it ks b gy mq mn l mo mp">Object.keys(validators.current).forEach(async field =&gt; {<br/>      promises.push(<br/>        runValidators({<br/>          field,<br/>          validators: validators.current[field],<br/>          eventType,<br/>          value: inputs.current[field].value,<br/>          inputValues: inputValues.current,<br/>  <strong class="ks iu">        validationSchema: getSchemaField(validationSchema, field)</strong><br/>        })<br/>      );<br/>    });</span><span id="c1e0" class="ml ku it ks b gy mq mn l mo mp">...</span><span id="0b59" class="ml ku it ks b gy mq mn l mo mp">const runInputValidations = async ({ id, value, eventType, timeStamp }) =&gt; {<br/>...</span><span id="f93e" class="ml ku it ks b gy mq mn l mo mp">try {<br/>        const validationResults = await runValidators({<br/>          field: id,<br/>          validators: validators.current[id],<br/>          eventType: eventType,<br/>          value,<br/>          runId: timeStamp,<br/>          inputValues: inputValues.current,<br/><strong class="ks iu">          validationSchema: getSchemaField(validationSchema, id)</strong><br/>        });</span></pre><h1 id="0c00" class="kt ku it bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">æ‘˜è¦</h1><p id="f5bb" class="pw-post-body-paragraph jq jr it js b jt lr jv jw jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn im bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬é‡æ„äº†æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆï¼Œä»¥æ”¯æŒåŸºäºyupçš„æ¨¡å¼éªŒè¯ã€‚</p><p id="0f09" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨åé¢çš„éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºå…¶ä»–ä¸»é¢˜ï¼Œæ¯”å¦‚å‡å°‘æ ·æ¿æ–‡ä»¶ã€å–æ¶ˆæ‰¿è¯ºã€å»æŠ–ã€é’©å­æ€§èƒ½è€ƒè™‘å’Œå…¶ä»–è®¾è®¡ä¼˜åŒ–ã€‚</p><p id="64df" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ­¤æ—¶ï¼Œè¯¥åº“å¯èƒ½å·²ç»â€œè¶³å¤Ÿå¥½â€å¯ä»¥ç”¨äºç”Ÿäº§äº†ğŸ˜ƒã€‚åœ¨å¼€å§‹è‡ªå·±åˆ¶ä½œè¡¨å•åº“ä¹‹å‰ï¼Œè¯·è®°ä½åˆ¶ä½œä¸€ä¸ªâ€œè¶³å¤Ÿå¥½â€çš„è¡¨å•åº“éœ€è¦ä»˜å‡ºçš„åŠªåŠ›å’Œæ€è€ƒï¼</p><p id="2455" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">é™¤éæ‚¨æœ‰ä¸€ä¸ªä¸éœ€è¦éªŒè¯é€»è¾‘çš„æå…¶ç®€å•çš„è¡¨å•ï¼Œæ˜¯çš„ï¼Œæ‚¨å¯ä»¥ç”¨Reactæ‹¼å‡‘ä¸€ä¸ªè¡¨å•ï¼Œä½†æ˜¯å®ƒä¼šéå¸¸æœ‰é™ã€‚ä¸€æ—¦ä½ éœ€è¦è¶Šè¿‡ç®€å•çš„è¡¨å•ï¼Œä½¿ç”¨è¡¨å•åº“ã€‚å¦åˆ™ï¼Œä½ å¯èƒ½æ²¡æœ‰å……åˆ†åˆ©ç”¨ä½ çš„æ—¶é—´ã€‚é™¤éä½ æ˜¯å‡ºäºè‡ªå·±çš„å­¦ä¹ ç›®çš„ï¼Œå½“ç„¶ï¼Œæˆ‘æ€»æ˜¯å»ºè®®é€šè¿‡å¼€å‘ä½ æ„Ÿå…´è¶£çš„ä¸œè¥¿æ¥å­¦ä¹ ã€‚</p><p id="a8b3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜ã€åé¦ˆæˆ–å»ºè®®ï¼Œæˆ–è€…æ‚¨å¸Œæœ›æˆ‘ä»‹ç»æœ¬ç³»åˆ—ä¸­çš„å…¶ä»–å†…å®¹ï¼Œè¯·å‘Šè¯‰æˆ‘ã€‚</p></div></div>    
</body>
</html>