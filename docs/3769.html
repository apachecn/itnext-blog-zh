<html>
<head>
<title>How to use Open Application Model to run applications on Kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä½¿ç”¨å¼€æ”¾åº”ç”¨æ¨¡å‹åœ¨Kubernetesä¸Šè¿è¡Œåº”ç”¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/how-to-use-open-application-model-to-run-applications-on-kubernetes-fb6b5ebb9f56?source=collection_archive---------5-----------------------#2020-02-20">https://itnext.io/how-to-use-open-application-model-to-run-applications-on-kubernetes-fb6b5ebb9f56?source=collection_archive---------5-----------------------#2020-02-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1019" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://oam.dev/" rel="noopener ugc nofollow" target="_blank">å¼€æ”¾åº”ç”¨æ¨¡å‹</a> (OAM)æ˜¯æ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„è§„èŒƒï¼Œä»¥<code class="fe km kn ko kp b"><a class="ae kl" href="https://github.com/oam-dev/rudr" rel="noopener ugc nofollow" target="_blank">Rudr</a></code>ä½œä¸ºå…¶<a class="ae kl" href="https://kubernetes.io/" rel="noopener ugc nofollow" target="_blank"> Kubernetes </a>çš„å…·ä½“å®ç°ã€‚åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡å‡ ä¸ªä¾‹å­æ¥å¼ºåŒ–å‰ä¸€ç¯‡åšå®¢ä¸­æåˆ°çš„ä¸<code class="fe km kn ko kp b">OAM</code>å’Œ<code class="fe km kn ko kp b">Rudr</code>ç›¸å…³çš„æ¦‚å¿µã€‚</p><div class="kq kr gp gr ks kt"><a href="https://medium.com/@abhishek1987/building-cloud-native-apps-intro-to-open-application-model-and-rudr-bd1b55df9bf3" rel="noopener follow" target="_blank"><div class="ku ab fo"><div class="kv ab kw cl cj kx"><h2 class="bd ir gy z fp ky fr fs kz fu fw ip bi translated">æ„å»ºäº‘åŸç”Ÿåº”ç”¨:å¼€æ”¾åº”ç”¨æ¨¡å‹å’ŒRudrç®€ä»‹</h2><div class="la l"><h3 class="bd b gy z fp ky fr fs kz fu fw dk translated">ç”Ÿäº§çº§åˆ†å¸ƒå¼äº‘åŸç”Ÿå¾®æœåŠ¡é€šå¸¸ç”±å¤šä¸ªåˆä½œä¼™ä¼´æ„å»ºå’Œè¿è¥â€¦</h3></div><div class="lb l"><p class="bd b dl z fp ky fr fs kz fu fw dk translated">medium.com</p></div></div><div class="lc l"><div class="ld l le lf lg lc lh li kt"/></div></div></a></div><p id="de2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å°†ä»ä½¿ç”¨<code class="fe km kn ko kp b">Rudr</code>ç»„ä»¶åœ¨Kubernetesä¸Šè¿è¡Œä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºå¼€å§‹ï¼Œç„¶åçœ‹ä¸€ä¸ªå¦‚ä½•ä½¿ç”¨<code class="fe km kn ko kp b"><a class="ae kl" href="https://github.com/oam-dev/rudr/blob/master/docs/concepts/traits.md" rel="noopener ugc nofollow" target="_blank">Rudr</a></code> <a class="ae kl" href="https://github.com/oam-dev/rudr/blob/master/docs/concepts/traits.md" rel="noopener ugc nofollow" target="_blank">ç‰¹å¾</a>çš„ä¾‹å­ã€‚</p><blockquote class="lj lk ll"><p id="a3f4" class="jn jo lm jp b jq jr js jt ju jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj kk ij bi translated"><em class="iq">ä»£ç åœ¨</em> <a class="ae kl" href="https://github.com/abhirockzz/rudr-k8s-sample" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> GitHub </em> </a>ä¸Šæœ‰</p></blockquote></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h1 id="88d2" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">å…ˆå†³æ¡ä»¶</h1><p id="e86e" class="pw-post-body-paragraph jn jo iq jp b jq mv js jt ju mw jw jx jy mx ka kb kc my ke kf kg mz ki kj kk ij bi translated">åœ¨å…¶æ ¸å¿ƒï¼Œ<code class="fe km kn ko kp b">Rudr</code>æ˜¯ä¸€ä¸ªå®šåˆ¶æ§åˆ¶å™¨ï¼Œä½œä¸ºKubernetes <code class="fe km kn ko kp b">Deployment</code>è¿è¡Œã€‚è¦å®‰è£…Rudrï¼Œæ‚¨å°†éœ€è¦ä¸€ä¸ªç‰ˆæœ¬ä¸º<code class="fe km kn ko kp b">1.15.x</code>æˆ–<code class="fe km kn ko kp b">1.16.x</code>çš„Kubernetesé›†ç¾¤(åœ¨æ’°å†™æœ¬æ–‡æ—¶è¿™äº›æ˜¯å—æ”¯æŒçš„ç‰ˆæœ¬)ã€‚ä»»ä½•é›†ç¾¤éƒ½å¯ä»¥å·¥ä½œï¼Œä½†æ˜¯æˆ‘åœ¨è¿™ç¯‡åšå®¢ä¸­ä½¿ç”¨äº†<a class="ae kl" href="https://docs.microsoft.com/azure/aks/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Azure KubernetesæœåŠ¡</a>ä½œä¸ºä¾‹å­ã€‚</p><p id="d67a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœä½ æƒ³ä½¿ç”¨AKSï¼Œä½ åªéœ€è¦ä¸€ä¸ªAzureè®¢é˜…(<a class="ae kl" href="https://azure.microsoft.com/free/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">åœ¨è¿™é‡ŒæŠ¢ä¸€ä¸ªå…è´¹è´¦å·ï¼</a>)å’Œ<a class="ae kl" href="https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest&amp;WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Azure CLI </a>æ¥ä½¿ç”¨<code class="fe km kn ko kp b"><a class="ae kl" href="https://docs.microsoft.com/cli/azure/aks?view=azure-cli-latest&amp;WT.mc_id=medium-blog-abhishgu#az-aks-create" rel="noopener ugc nofollow" target="_blank">az aks create</a></code>å‘½ä»¤è®¾ç½®ä¸€ä¸ªæ‰˜ç®¡çš„Kubernetesé›†ç¾¤ã€‚</p><p id="a659" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸‹é¢æ˜¯ä¸€ä¸ªè¿è¡ŒKubernetesç‰ˆæœ¬<code class="fe km kn ko kp b">1.15.7</code>çš„å•èŠ‚ç‚¹é›†ç¾¤çš„ä¾‹å­</p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="a703" class="ni ly iq kp b gy nj nk l nl nm">az aks create --resource-group &lt;AZURE_RESOURCE_GROUP&gt; --name &lt;AKS_CLUSTER_NAME&gt; --kubernetes-version 1.15.7 --node-count 1 --node-vm-size Standard_B2s --node-osdisk-size 30 --generate-ssh-keys</span><span id="814d" class="ni ly iq kp b gy nn nk l nl nm">//point kubectl to AKS<br/>az aks get-credentials --resource-group &lt;AZURE_RESOURCE_GROUP&gt; --name &lt;AKS_CLUSTER_NAME&gt;</span><span id="465d" class="ni ly iq kp b gy nn nk l nl nm">//confirm<br/>kubectl get nodes</span></pre><p id="4373" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨<a class="ae kl" href="https://helm.sh/docs/intro/" rel="noopener ugc nofollow" target="_blank">å®‰è£…</a> <code class="fe km kn ko kp b"><a class="ae kl" href="https://helm.sh/docs/intro/" rel="noopener ugc nofollow" target="_blank">Helm 3</a></code>åï¼Œæ‚¨å¯ä»¥ç»§ç»­è¿›è¡Œ<code class="fe km kn ko kp b">Rudr</code>çš„è®¾ç½®</p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="c922" class="ni ly iq kp b gy nj nk l nl nm">//clone the repo<br/>git clone https://github.com/oam-dev/rudr.git</span><span id="21ce" class="ni ly iq kp b gy nn nk l nl nm">//install it using Helm<br/>helm install rudr ./charts/rudr --wait</span><span id="713f" class="ni ly iq kp b gy nn nk l nl nm">//confirm Rudr Deployment<br/>kubectl get deployment rudr</span><span id="0b75" class="ni ly iq kp b gy nn nk l nl nm">//check Rudr CRDs<br/>kubectl get crds -l app.kubernetes.io/part-of=core.oam.dev</span></pre></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h1 id="3aa5" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">ç”¨Rudréƒ¨ç½²ä¸€ä¸ªç®€å•çš„åº”ç”¨</h1><p id="0270" class="pw-post-body-paragraph jn jo iq jp b jq mv js jt ju mw jw jx jy mx ka kb kc my ke kf kg mz ki kj kk ij bi translated">æˆ‘ä»¬å°†ä»ä¸€ä¸ªä½¿ç”¨ä»¥ä¸‹Rudrå¯¹è±¡éƒ¨ç½²ç®€å•åº”ç”¨ç¨‹åºçš„åŸºæœ¬ç¤ºä¾‹å¼€å§‹:<code class="fe km kn ko kp b">ComponentSchematic</code>å’Œ<code class="fe km kn ko kp b">ApplicationConfig</code>ã€‚</p><p id="cf74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™ä¸ªåº”ç”¨ç¨‹åºéå¸¸ç®€å•â€”â€”å®ƒæ˜¯ä¸€ä¸ªå®¹å™¨åŒ–çš„åº”ç”¨ç¨‹åºï¼Œå…¬å¼€äº†ä¸€ä¸ªç«¯ç‚¹ï¼Œé»˜è®¤æƒ…å†µä¸‹ç”¨<code class="fe km kn ko kp b">Hello World!</code>å“åº”ï¼Œå¦‚æœè®¾ç½®äº†<code class="fe km kn ko kp b">GREETING</code>ç¯å¢ƒå˜é‡ï¼Œåˆ™ç”¨<code class="fe km kn ko kp b">Hello &lt;greeting&gt;</code>å“åº”ã€‚è¦åœ¨Kubernetesä¸­è¿è¡Œè¿™ä¸ªï¼Œæ˜¾è€Œæ˜“è§çš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ª<code class="fe km kn ko kp b">Deployment</code>å¯¹è±¡ã€‚ç›¸åï¼Œæˆ‘ä»¬å°†åˆ›å»º<code class="fe km kn ko kp b">Rudr</code>è‡ªå®šä¹‰èµ„æºå®šä¹‰(CRD)æ¥è¡¨ç¤ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºï¼Œå°†å®ƒä»¬æäº¤ç»™Kubernetesï¼Œå¹¶è®©<code class="fe km kn ko kp b">Rudr</code>æ§åˆ¶å™¨/æ“ä½œå‘˜è´Ÿè´£å¤„ç†ç‰¹å®šçš„Kubernetesèµ„æºã€‚</p><h2 id="e600" class="ni ly iq bd lz no np dn md nq nr dp mh jy ns nt ml kc nu nv mp kg nw nx mt ny bi translated">éƒ¨ç½²Rudr CRDs</h2><p id="2cb9" class="pw-post-body-paragraph jn jo iq jp b jq mv js jt ju mw jw jx jy mx ka kb kc my ke kf kg mz ki kj kk ij bi translated">æˆ‘ä»¬å°†ä»åˆ›å»ºä¸€ä¸ª<code class="fe km kn ko kp b">ComponentSchematic</code>å¼€å§‹ã€‚æˆ‘ä»¬æ¥è‡ªçœä¸€ä¸‹:</p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="0f2c" class="ni ly iq kp b gy nj nk l nl nm">apiVersion: core.oam.dev/v1alpha1<br/>kind: ComponentSchematic<br/>metadata:<br/>  name: greeter-component<br/>spec:<br/>  workloadType: core.oam.dev/v1alpha1.Server<br/>  containers:<br/>    - name: greeter<br/>      image: abhirockzz/greeter-go<br/>      env:<br/>        - name: GREETING<br/>          fromParam: greeting<br/>      ports:<br/>        - protocol: TCP<br/>          containerPort: 8080<br/>          name: http<br/>      resources:<br/>        cpu:<br/>          required: 0.1<br/>        memory:<br/>          required: "128"<br/>  parameters:<br/>    - name: greeting<br/>      type: string<br/>      default: abhi_tweeter</span></pre><p id="b41e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™æ˜¯ä¸€ä¸ªåä¸º<code class="fe km kn ko kp b">greeter-component</code>çš„<code class="fe km kn ko kp b">ComponentSchematic</code>ï¼Œå®ƒçš„<code class="fe km kn ko kp b">workloadType</code>æ˜¯<code class="fe km kn ko kp b">core.oam.dev/v1alpha1.Server</code>â€”â€”å®ƒå†³å®šäº†ä¸ºå¤„ç†è¿™ä¸ªç»„ä»¶è€Œåˆ›å»ºçš„Kubernetesèµ„æºçš„ç±»å‹ã€‚å®ƒæœ‰ä¸€ä¸ªå•ç‹¬çš„<code class="fe km kn ko kp b">container</code>å¼•ç”¨Docker Hubä¸Šçš„<code class="fe km kn ko kp b">abhirockzz/greeter-go</code>å›¾åƒã€‚<code class="fe km kn ko kp b">parameters</code>éƒ¨åˆ†å®šä¹‰äº†ä¸€ä¸ªåä¸º<code class="fe km kn ko kp b">greeting</code>çš„å¯é…ç½®å±æ€§ï¼Œå…¶é»˜è®¤å€¼ä¸º<code class="fe km kn ko kp b">abhi_tweeter</code>ã€‚è¯¥å‚æ•°åœ¨<code class="fe km kn ko kp b">containers</code>éƒ¨åˆ†çš„<code class="fe km kn ko kp b">env</code>å±æ€§ä¸­ä½œä¸ºç¯å¢ƒå˜é‡è¢«å¼•ç”¨ã€‚</p><p id="4377" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æ­¤åˆ›å»º<code class="fe km kn ko kp b">ComponentSchematic</code>:</p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="987c" class="ni ly iq kp b gy nj nk l nl nm">kubectl apply -f https://raw.githubusercontent.com/abhirockzz/rudr-k8s-sample/master/deploy/component.yaml</span><span id="0617" class="ni ly iq kp b gy nn nk l nl nm">//output</span><span id="6479" class="ni ly iq kp b gy nn nk l nl nm">componentschematic.core.oam.dev/greeter-component created</span></pre><p id="06b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™å°†åœ¨Kubernetesä¸­åˆ›å»ºä¸€ä¸ª<code class="fe km kn ko kp b">ComponentSchematic</code>å¯¹è±¡â€”â€”æ‚¨å¯ä»¥ä½¿ç”¨<code class="fe km kn ko kp b">kubectl get components</code>æ¥ç¡®è®¤ã€‚å•é è‡ªå·±çœŸçš„åšä¸äº†å¤šå°‘äº‹æƒ…ã€‚å®ƒéœ€è¦å¦ä¸€ä¸ª<code class="fe km kn ko kp b">Rudr</code>å®ä½“ä¸ä¹‹åˆä½œâ€”â€”å³<code class="fe km kn ko kp b">ApplicationConfig</code>ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™ç§æƒ…å†µä¸‹æ˜¯ä»€ä¹ˆæ ·çš„:</p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="2f2a" class="ni ly iq kp b gy nj nk l nl nm">apiVersion: core.oam.dev/v1alpha1<br/>kind: ApplicationConfiguration<br/>metadata:<br/>  name: greeter-app-config<br/>spec:<br/>  components:<br/>    - componentName: greeter-component<br/>      instanceName: greeter-app</span></pre><p id="195d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe km kn ko kp b">ApplicationConfig</code>æ˜¯ä¸€ä¸ª<code class="fe km kn ko kp b">ComponentSchematic</code>çš„å®ä¾‹â€”â€”åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒæŒ‡çš„æ˜¯<code class="fe km kn ko kp b">greeter-component</code>T3ã€‚</p><p id="2127" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åˆ›é€ äº†<code class="fe km kn ko kp b">ApplicationConfig</code>:</p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="4652" class="ni ly iq kp b gy nj nk l nl nm">kubectl apply -f https://raw.githubusercontent.com/abhirockzz/rudr-k8s-sample/master/deploy/app-config.yaml</span><span id="41e7" class="ni ly iq kp b gy nn nk l nl nm">//output<br/>applicationconfiguration.core.oam.dev/greeter-app-config configured</span></pre><p id="e834" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¦ç¡®è®¤:</p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="7bc0" class="ni ly iq kp b gy nj nk l nl nm">kubectl get applicationconfiguration.core.oam.dev/greeter-app-config -o yaml</span></pre><p id="98b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä»”ç»†æŸ¥çœ‹<code class="fe km kn ko kp b">status</code>éƒ¨åˆ†â€”â€”æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹:</p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="b74b" class="ni ly iq kp b gy nj nk l nl nm">apiVersion: core.oam.dev/v1alpha1<br/>kind: ApplicationConfiguration<br/>...<br/>status:<br/>  components:<br/>    greeter-component:<br/>      deployment/greeter-app: running<br/>      service/greeter-app: created<br/>  phase: synced<br/>  phase: synced</span></pre><h2 id="063a" class="ni ly iq bd lz no np dn md nq nr dp mh jy ns nt ml kc nu nv mp kg nw nx mt ny bi translated">æ£€æŸ¥Kuberneteså¯¹è±¡</h2><p id="8a68" class="pw-post-body-paragraph jn jo iq jp b jq mv js jt ju mw jw jx jy mx ka kb kc my ke kf kg mz ki kj kk ij bi translated"><code class="fe km kn ko kp b">Rudr</code>ä¸ºæˆ‘ä»¬åˆ›é€ äº†ä¸€å †Kubernetesèµ„æº- <code class="fe km kn ko kp b">Deployment</code>ã€<code class="fe km kn ko kp b">Pod</code>å’Œ<code class="fe km kn ko kp b">Service</code></p><p id="60b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ£€æŸ¥<code class="fe km kn ko kp b">Deployment</code></p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="6121" class="ni ly iq kp b gy nj nk l nl nm">kubectl get deployment/greeter-app</span><span id="e954" class="ni ly iq kp b gy nn nk l nl nm">NAME          READY   UP-TO-DATE   AVAILABLE   AGE<br/>greeter-app   1/1     1            1           42s</span></pre><p id="4893" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ£€æŸ¥<code class="fe km kn ko kp b">Pod</code></p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="a0c2" class="ni ly iq kp b gy nj nk l nl nm">kubectl get pod -l=app.kubernetes.io/name=greeter-app-config</span><span id="b599" class="ni ly iq kp b gy nn nk l nl nm">NAME                           READY   STATUS    RESTARTS   AGE<br/>greeter-app-586b5d4ddc-wrqtb   1/1     Running   0          2m30s</span></pre><p id="6ef9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ€åï¼ŒKubernetes <code class="fe km kn ko kp b">Service</code>èµ„æº</p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="d704" class="ni ly iq kp b gy nj nk l nl nm">kubectl get service/greeter-app</span><span id="175d" class="ni ly iq kp b gy nn nk l nl nm">NAME          TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)    AGE<br/>greeter-app   ClusterIP   10.0.135.117   &lt;none&gt;        8080/TCP   4m15s</span></pre></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h1 id="1b25" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">æµ‹è¯•åº”ç”¨ç¨‹åº</h1><p id="8a0b" class="pw-post-body-paragraph jn jo iq jp b jq mv js jt ju mw jw jx jy mx ka kb kc my ke kf kg mz ki kj kk ij bi translated">è®¿é—®åº”ç”¨ç¨‹åºæœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ç«¯å£è½¬å‘</p><blockquote class="lj lk ll"><p id="ce71" class="jn jo lm jp b jq jr js jt ju jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj kk ij bi translated"><em class="iq">ç¡®ä¿ä½ æ›¿æ¢äº†</em>çš„åå­—<code class="fe km kn ko kp b"><em class="iq">Pod</em></code></p></blockquote><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="f0e5" class="ni ly iq kp b gy nj nk l nl nm">kubectl port-forward pod/&lt;pod name&gt; 9090:8080</span><span id="6847" class="ni ly iq kp b gy nn nk l nl nm">Forwarding from 127.0.0.1:9090 -&gt; 8080<br/>Forwarding from [::1]:9090 -&gt; 8080</span></pre><p id="e55c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨ä½ å¯ä»¥ç®€å•åœ°<code class="fe km kn ko kp b"><a class="ae kl" href="https://curl.haxx.se/" rel="noopener ugc nofollow" target="_blank">curl</a></code>ç»ˆç‚¹</p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="7275" class="ni ly iq kp b gy nj nk l nl nm">curl localhost:9090</span><span id="9910" class="ni ly iq kp b gy nn nk l nl nm">//output<br/>Hello abhi_tweeter!</span></pre><p id="8247" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å°±è¿™æ ·ã€‚è¿™æ˜¯ä¸€ä¸ªåœ¨Kubernetesä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºçš„éå¸¸ç®€å•çš„ä¾‹å­ï¼Œå®ƒä»…ä½¿ç”¨Rudræ„é€ åˆ›å»ºã€‚</p><p id="b0f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½œä¸ºç»ƒä¹ ï¼Œæ‚¨å¯ä»¥å°è¯•åˆ›å»ºä¸‹é¢çš„<code class="fe km kn ko kp b">ApplicationConfig</code>å¹¶æŒ‰ç…§ä¸Šé¢æ¦‚è¿°çš„æ­¥éª¤æ¥è®¿é—®åº”ç”¨ç¨‹åºä»¥åŠç»“æœæ˜¯ä»€ä¹ˆ</p><blockquote class="lj lk ll"><p id="815e" class="jn jo lm jp b jq jr js jt ju jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj kk ij bi translated"><em class="iq">æ³¨æ„ï¼Œè¿™ä¸ª</em> <code class="fe km kn ko kp b"><em class="iq">ApplicationConfig</em></code> <em class="iq">ä½¿ç”¨</em> <code class="fe km kn ko kp b"><em class="iq">parameterValues</em></code> <em class="iq">æ®µæ¥è¦†ç›–</em> <code class="fe km kn ko kp b"><em class="iq">parameters</em></code> <em class="iq">ä¸­å®šä¹‰çš„</em> <code class="fe km kn ko kp b"><em class="iq">ComponentSchematic</em></code> <em class="iq">ã€‚</em></p></blockquote><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="0952" class="ni ly iq kp b gy nj nk l nl nm">apiVersion: core.oam.dev/v1alpha1<br/>kind: ApplicationConfiguration<br/>metadata:<br/>  name: greeter-app-config-2<br/>spec:<br/>  components:<br/>    - componentName: greeter-component<br/>      instanceName: greeter-app-2<br/>      parameterValues:<br/>        - name: greeting<br/>          value: foobar</span></pre></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h1 id="b6f7" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">åˆ©ç”¨ç‰¹è´¨</h1><p id="ce74" class="pw-post-body-paragraph jn jo iq jp b jq mv js jt ju mw jw jx jy mx ka kb kc my ke kf kg mz ki kj kk ij bi translated">åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­ï¼Œåˆ›å»ºçš„éƒ¨ç½²å¯¹è±¡æœ‰ä¸€ä¸ªPod(å•ä¸ªåº”ç”¨ç¨‹åºå®ä¾‹)ã€‚æ‚¨å¯ä»¥ä½¿ç”¨<code class="fe km kn ko kp b">kubectl scale</code>å‘½ä»¤æ¥æ‰©å±•å®ƒï¼Œä½†æ˜¯æˆ‘è®¤ä¸ºæ‚¨ç°åœ¨å·²ç»å¾—åˆ°äº†æµç¨‹â€”â€”æˆ‘ä»¬ä¸ä¼šè¿™æ ·åšï¼è®©æˆ‘ä»¬åˆ©ç”¨Rudrä¸­çš„æ‰‹åŠ¨ç¼©æ”¾å™¨ç‰¹æ€§æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p><p id="83d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å°†ç»§ç»­ä½¿ç”¨ç›¸åŒçš„<code class="fe km kn ko kp b">ComponentSchematic</code>ï¼Œå¹¶å¼•å…¥ä¸€ä¸ªæ–°çš„<code class="fe km kn ko kp b">ApplicationConfig</code>å®šä¹‰ï¼Œä»¥ç¡®ä¿æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæœ‰ä¸¤ä¸ªå‰¯æœ¬ã€‚æˆ‘ä»¬å°†å€ŸåŠ©æ‰‹åŠ¨å®šæ ‡å™¨ç‰¹æ€§æ¥å®ç°è¿™ä¸€ç‚¹</p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="0f53" class="ni ly iq kp b gy nj nk l nl nm">apiVersion: core.oam.dev/v1alpha1<br/>kind: ApplicationConfiguration<br/>metadata:<br/>  name: greeter-app-config-3<br/>spec:<br/>  components:<br/>    - componentName: greeter-component<br/>      instanceName: scalable-greeter-app<br/>      parameterValues:<br/>        - name: greeting<br/>          value: scalable<br/>      traits:<br/>        - name: manual-scaler<br/>          properties:<br/>            replicaCount: 2</span></pre><p id="cf8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe km kn ko kp b">greeter-app-config-3ApplicationConfiguration</code>å¼•ç”¨äº†<code class="fe km kn ko kp b">greeter-component</code> <code class="fe km kn ko kp b">ComponentSchematic</code>ã€‚æ³¨æ„<code class="fe km kn ko kp b">traits</code>éƒ¨åˆ†ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ª<code class="fe km kn ko kp b">manual-scaler</code>ï¼Œå¹¶å°†<code class="fe km kn ko kp b">replicaCount</code>æŒ‡å®šä¸º<code class="fe km kn ko kp b">2</code>ã€‚ä¸ºäº†ç¡®ä¿æˆ‘ä»¬èƒ½å¤Ÿå°†å®ƒä¸å‰é¢çš„åº”ç”¨ç¨‹åºåŒºåˆ†å¼€æ¥ï¼Œæˆ‘ä»¬é‡å†™äº†paramaterï¼Œå°†<code class="fe km kn ko kp b">greeting</code>çš„å€¼ä½œä¸º<code class="fe km kn ko kp b">scalable</code>ä¼ å…¥</p><p id="67b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åˆ›å»º<code class="fe km kn ko kp b">ApplicationConfiguration</code></p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="359e" class="ni ly iq kp b gy nj nk l nl nm">kubectl apply -f https://raw.githubusercontent.com/abhirockzz/rudr-k8s-sample/master/deploy/manual-scaler-trait/app-config.yaml</span><span id="f46a" class="ni ly iq kp b gy nn nk l nl nm">//output<br/>applicationconfiguration.core.oam.dev/greeter-app-config-3 created</span></pre><p id="158b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç­‰å¾…å‡ ç§’é’Ÿï¼Œç¡®è®¤Rudrå·²ç»è§¦å‘äº†<code class="fe km kn ko kp b">Kubernetes</code>å¯¹è±¡çš„åˆ›å»º:</p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="2ff3" class="ni ly iq kp b gy nj nk l nl nm">kubectl get applicationconfiguration.core.oam.dev/greeter-app-config-3 -o yaml</span></pre><p id="3c07" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä¸€ä¸ª<code class="fe km kn ko kp b">status</code>éƒ¨åˆ†</p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="9b87" class="ni ly iq kp b gy nj nk l nl nm">status:<br/>  components:<br/>    greeter-component:<br/>      deployment/scalable-greeter-app: running<br/>      service/scalable-greeter-app: created<br/>  phase: synced</span></pre><blockquote class="lj lk ll"><p id="fb88" class="jn jo lm jp b jq jr js jt ju jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj kk ij bi translated"><em class="iq">å¦‚æœ</em> <code class="fe km kn ko kp b"><em class="iq">deployment/scalable-greeter-app</em></code> <em class="iq">å¤„äº</em> <code class="fe km kn ko kp b"><em class="iq">unavailable</em></code> <em class="iq">çŠ¶æ€ï¼Œè¯·åœ¨10ç§’å·¦å³åé‡è¯•</em></p></blockquote><p id="b5e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç¡®è®¤<code class="fe km kn ko kp b">Deployment</code>å¯¹è±¡</p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="a943" class="ni ly iq kp b gy nj nk l nl nm">kubectl get deployment/scalable-greeter-app</span><span id="3d40" class="ni ly iq kp b gy nn nk l nl nm">NAME                   READY   UP-TO-DATE   AVAILABLE   AGE<br/>scalable-greeter-app   2/2     2            2           4m</span></pre><p id="a5b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¹Ÿæ£€æŸ¥å•ä¸ªçš„<code class="fe km kn ko kp b">Pod</code></p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="a802" class="ni ly iq kp b gy nj nk l nl nm">kubectl get pods -l=app.kubernetes.io/name=greeter-app-config-3</span><span id="7b0f" class="ni ly iq kp b gy nn nk l nl nm">NAME                                    READY   STATUS    RESTARTS   AGE<br/>scalable-greeter-app-6488f64cb4-mj6nw   1/1     Running   0          5m<br/>scalable-greeter-app-6488f64cb4-rpfvp   1/1     Running   0          5m</span></pre><p id="7e1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¦è®¿é—®è¯¥åº”ç”¨ç¨‹åºï¼Œåªéœ€è¿è¡Œå®‰è£…æœ‰<code class="fe km kn ko kp b">curl</code>çš„ä¸€æ¬¡æ€§<code class="fe km kn ko kp b">Pod</code>å³å¯ã€‚ä¸€æ—¦è¿›å…¥Podï¼Œæ‚¨å¯ä»¥ç®€å•åœ°ä½¿ç”¨<code class="fe km kn ko kp b">curl $SCALABLE_GREETER_APP_SERVICE_HOST:$SCALABLE_GREETER_APP_SERVICE_PORT</code>æ¥è°ƒç”¨åº”ç”¨ç¨‹åºçš„ç«¯ç‚¹ã€‚</p><pre class="na nb nc nd gt ne kp nf ng aw nh bi"><span id="3353" class="ni ly iq kp b gy nj nk l nl nm">kubectl run curl --image=radial/busyboxplus:curl -i --tty --rm</span><span id="d304" class="ni ly iq kp b gy nn nk l nl nm">[ root@curl-6bf6db5c4f-5hw6t:/ ]$ curl $SCALABLE_GREETER_APP_SERVICE_HOST:$SCALABLE_GREETER_APP_SERVIC<br/>E_PORT<br/>Hello scalable!</span></pre><blockquote class="lj lk ll"><p id="2a65" class="jn jo lm jp b jq jr js jt ju jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj kk ij bi translated"> <code class="fe km kn ko kp b"><em class="iq">Rudr</em></code> <em class="iq">åˆ›å»ºçš„</em> <code class="fe km kn ko kp b"><em class="iq">ClusterIP</em></code> <em class="iq"> </em> <code class="fe km kn ko kp b"><em class="iq">Service</em></code> <em class="iq">ä½¿<code class="fe km kn ko kp b"><em class="iq">SCALABLE_GREETER_APP_SERVICE_HOST</em></code> <em class="iq">å’Œ</em> <code class="fe km kn ko kp b"><em class="iq">SCALABLE_GREETER_APP_SERVICE_PORT</em></code> <em class="iq">æˆä¸ºç¯å¢ƒå˜é‡ã€‚</em></em></p></blockquote><p id="af00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é¢„æœŸçš„å“åº”æ˜¯<code class="fe km kn ko kp b">Hello scalable!</code>ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»è¦†ç›–äº†<code class="fe km kn ko kp b">ApplicationConfiguraton</code>ä¸­çš„<code class="fe km kn ko kp b">greeting</code> <code class="fe km kn ko kp b">parameter</code></p></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h1 id="7971" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">æ‰“æ‰«</h1><p id="25d0" class="pw-post-body-paragraph jn jo iq jp b jq mv js jt ju mw jw jx jy mx ka kb kc my ke kf kg mz ki kj kk ij bi translated">æ‚¨å¯ä»¥ä½¿ç”¨<code class="fe km kn ko kp b"><a class="ae kl" href="https://docs.microsoft.com/cli/azure/aks?view=azure-cli-latest&amp;WT.mc_id=medium-blog-abhishgu#az-aks-delete" rel="noopener ugc nofollow" target="_blank">az aks delete</a></code>å‘½ä»¤åˆ é™¤æ•´ä¸ªAKSé›†ç¾¤æˆ–è€…åˆ é™¤å•ä¸ªçš„<code class="fe km kn ko kp b">ApplicationConfiguration</code>æ¥è§¦å‘çº§è”åˆ é™¤æ‰€æœ‰ä¸å®ƒç›¸å…³çš„Kubernetesèµ„æº(<code class="fe km kn ko kp b">Deployment</code>ç­‰)ã€‚).è¦åˆ é™¤<code class="fe km kn ko kp b">Rudr</code>éƒ¨ç½²ï¼Œå¦‚æœæ‚¨è¿˜æƒ³åˆ é™¤<code class="fe km kn ko kp b">Rudr</code> CRDs ( <code class="fe km kn ko kp b">components</code>ã€<code class="fe km kn ko kp b">configurations</code>ç­‰)ï¼Œåªéœ€ä½¿ç”¨<code class="fe km kn ko kp b">helm delete rudr</code>å’Œ<code class="fe km kn ko kp b">kubectl delete crd -l app.kubernetes.io/part-of=core.oam.dev</code>å³å¯ã€‚)</p></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><p id="8b89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™å°±æ˜¯è¿™ä¸ªå…³äº<code class="fe km kn ko kp b">Open Application Model</code>å’Œ<code class="fe km kn ko kp b">Rudr</code>çš„ä¸¤éƒ¨åˆ†ç³»åˆ—çš„å…¨éƒ¨å†…å®¹ï¼Œè¿˜æœ‰ä¸€ä¸ªå®é™…æ“ä½œçš„ä¾‹å­ï¼Œè®©ä½ æ„Ÿå—ä¸€ä¸‹å¦‚ä½•åœ¨Kubernetesä¸Šå®é™…ä½¿ç”¨å®ƒã€‚å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©ï¼Œè¯·å–œæ¬¢å¹¶å…³æ³¨ğŸ™Œå¾ˆé«˜å…´é€šè¿‡<a class="ae kl" href="https://twitter.com/abhi_tweeter" rel="noopener ugc nofollow" target="_blank"> Twitter </a>è·å¾—åé¦ˆï¼Œæˆ–è€…éšæ—¶å‘è¡¨è¯„è®ºã€‚</p></div></div>    
</body>
</html>