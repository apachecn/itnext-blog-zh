<html>
<head>
<title>How to build an Image processor bot using Microsoft Bot framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä½¿ç”¨Microsoft botæ¡†æ¶æ„å»ºå›¾åƒå¤„ç†å™¨Bot</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/how-to-build-an-image-processor-bot-using-microsoft-bot-framework-d736919721f8?source=collection_archive---------6-----------------------#2019-12-21">https://itnext.io/how-to-build-an-image-processor-bot-using-microsoft-bot-framework-d736919721f8?source=collection_archive---------6-----------------------#2019-12-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8511" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ€è¿‘ï¼Œå›´ç»•æœºå™¨äººå’Œæœºå™¨å­¦ä¹ çš„ç‚’ä½œéœ€æ±‚å·¨å¤§ã€‚æœ€è¿‘å‚åŠ äº†<a class="ae kl" href="https://globalai.community/global-ai-bootcamp/" rel="noopener ugc nofollow" target="_blank">å…¨çƒAzureè®­ç»ƒè¥</a>ã€‚å› ä¸ºæˆ‘æ˜¯ä¸€åä¸»æŒäººï¼Œæˆ‘å­¦åˆ°äº†æ‰€æœ‰è¿™äº›å…³äºå»ºé€ æœºå™¨äººçš„ç¥å¥‡çš„ä¸œè¥¿ï¼Œå¹¶ä¸å¤§å®¶åˆ†äº«ã€‚</p><h2 id="9dac" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">å…ˆå†³æ¡ä»¶</h2><ul class=""><li id="e4a2" class="lf lg iq jp b jq lh ju li jy lj kc lk kg ll kk lm ln lo lp bi translated"><a class="ae kl" href="https://visualstudio.microsoft.com/vs/" rel="noopener ugc nofollow" target="_blank">å¾®è½¯è§†è§‰å·¥ä½œå®¤</a> âœŒï¸</li><li id="b9a9" class="lf lg iq jp b jq lq ju lr jy ls kc lt kg lu kk lm ln lo lp bi translated"><a class="ae kl" href="https://github.com/Microsoft/BotFramework-Emulator/blob/master/README.md" rel="noopener ugc nofollow" target="_blank"> Azure Botæ¡†æ¶æ¨¡æ‹Ÿå™¨</a>ğŸ®</li><li id="e817" class="lf lg iq jp b jq lq ju lr jy ls kc lt kg lu kk lm ln lo lp bi translated">Azureè®¢é˜…ğŸ†</li><li id="5986" class="lf lg iq jp b jq lq ju lr jy ls kc lt kg lu kk lm ln lo lp bi translated">è€å¿ƒé˜…è¯»è¿™ç¯‡æ–‡ç« ğŸ</li></ul><h2 id="1c63" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">ç›®æ ‡æˆ–é¡¹ç›®ç›®æ ‡</h2><p id="5404" class="pw-post-body-paragraph jn jo iq jp b jq lh js jt ju li jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ij bi translated">å¯¹æˆ‘æ¥è¯´ï¼Œç›®æ ‡æ˜¯ç»™æœºå™¨äººä¸€ä¸ªå›¾åƒæˆ–å›¾åƒURLï¼Œå®ƒåº”è¯¥è¿”å›ç‰¹å®šå›¾åƒçš„åˆ†æã€‚</p><h2 id="863c" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">å…¥é—¨æŒ‡å—</h2><p id="7420" class="pw-post-body-paragraph jn jo iq jp b jq lh js jt ju li jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ij bi translated">æˆ‘ä»¬å»Visual Studioåˆ›å»ºä¸€ä¸ªBotæ¡†æ¶V4é¡¹ç›®ã€‚</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi ly"><img src="../Images/96c3aa2625a3b648c5e26e6f6fe8dcca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CO765oZNI1vLGPT2Ydl2-g.png"/></div></div></figure><p id="eea3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½†æ˜¯ç­‰ç­‰ï¼Œä½ ä¸ä¼šé©¬ä¸Šå°±æœ‰Botæ¡†æ¶æ¨¡æ¿ã€‚æ‚¨éœ€è¦ä»<a class="ae kl" href="https://marketplace.visualstudio.com/items?itemName=BotBuilder.botbuilderv4" rel="noopener ugc nofollow" target="_blank">å¸‚åœº</a>å®‰è£…ç”¨äºVisual Studioçš„Bot Framework v4 SDKæ¨¡æ¿ã€‚</p><p id="d2f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨æ‚¨å·²ç»å®‰è£…äº†æ¨¡æ¿ï¼Œé€‰æ‹©å®ƒå¹¶åˆ›å»ºä¸€ä¸ª<strong class="jp ir"> Echo Botï¼Œ</strong>æ‚¨å°†æ‹¥æœ‰ä¸€ä¸ªç±»ä¼¼è¿™æ ·çš„è§£å†³æ–¹æ¡ˆã€‚</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/b27ee13881e1e00866e0d9f7d32cbba9.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*XmNrOCWwlcu9VONIeG2Osw.png"/></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk translated">æº¶æ¶²ç»“æ„</figcaption></figure><h2 id="d151" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">æ¢ç´¢è§£å†³æ–¹æ¡ˆ</h2><p id="f3bd" class="pw-post-body-paragraph jn jo iq jp b jq lh js jt ju li jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ij bi translated">è¿™çœ‹èµ·æ¥ä¸. NETæ ¸å¿ƒWeb APIåº”ç”¨ç¨‹åºçš„ç»“æ„ç›¸åŒã€‚å®ƒæœ‰ä¸€ä¸ªæ§åˆ¶å™¨ï¼Œç”¨äºä¸å¸¦æœ‰<code class="fe mp mq mr ms b">[Route(â€œapi/messagesâ€)].</code>çš„æœºå™¨äººäº¤äº’ï¼Œå®ƒæœ‰ä¸€ä¸ªå¯åŠ¨ç¨‹åºï¼Œç”¨äºæ³¨å…¥ä½ çš„ä¾èµ–é¡¹ï¼Œè¿˜æœ‰ä¸€ä¸ª<code class="fe mp mq mr ms b">ErrorHandler </code>ç±»ã€‚</p><h1 id="8998" class="mt kn iq bd ko mu mv mw kr mx my mz ku na nb nc kx nd ne nf la ng nh ni ld nj bi translated">EchoBot.cs</h1><p id="1249" class="pw-post-body-paragraph jn jo iq jp b jq lh js jt ju li jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ij bi translated">å¦‚æœä½ çœ‹ä¸€ä¸‹Botsæ–‡ä»¶å¤¹ä¸‹çš„<code class="fe mp mq mr ms b">EchoBot.cs</code>ï¼Œè¿™æ˜¯å®é™…çš„botå¤„ç†å’Œé€»è¾‘å®Œæˆçš„åœ°æ–¹ã€‚è¿™é‡Œè¦æ³¨æ„çš„ä¸»è¦æ˜¯<code class="fe mp mq mr ms b">OnMessageActivityAsync</code>å’Œ<code class="fe mp mq mr ms b">OnMembersAddedAsync</code></p><h2 id="5a6b" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">OnMembersAddedAsync</h2><p id="0b1e" class="pw-post-body-paragraph jn jo iq jp b jq lh js jt ju li jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ij bi translated">è¯¥å‡½æ•°æœ¬èº«çš„åç§°è¡¨ç¤ºæ¯å½“æœ‰æ–°æˆå‘˜æ·»åŠ åˆ°æœºå™¨äººè¿›è¡Œäº¤äº’æ—¶ï¼Œæˆ–è€…æœºå™¨äººç¬¬ä¸€æ¬¡è¿æ¥æ—¶ï¼Œä¸ç”¨æˆ·è¿›è¡Œäº¤äº’ã€‚æˆ‘ä»¬å…ˆä¿®æ”¹ä¸€ä¸‹è¿™ä¸ªã€‚</p><pre class="lz ma mb mc gt nk ms nl nm aw nn bi"><span id="52fc" class="km kn iq ms b gy no np l nq nr">var welcomeText = â€œHello and welcome to ImageDescriber Bot. Enter a image url or upload a image to begin analysis :â€;</span><span id="4563" class="km kn iq ms b gy ns np l nq nr">foreach (var member in membersAdded){<br/>  if (member.Id != turnContext.Activity.Recipient.Id)<br/>  await    turnContext.SendActivityAsync(MessageFactory.Text(welcomeText), cancellationToken);<br/>}</span></pre><p id="161a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘æŠŠ<code class="fe mp mq mr ms b">CreateActivityWithTextAndSpeak</code>å»æ‰äº†ï¼Œæ”¹æˆäº†ä¸Šé¢çš„æ ·å­ã€‚å®ƒæ‰€åšçš„åªæ˜¯æ¬¢è¿ç”¨æˆ·ã€‚</p><h2 id="0f68" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">OnMessageActivityAsync</h2><p id="569c" class="pw-post-body-paragraph jn jo iq jp b jq lh js jt ju li jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ij bi translated">è¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦å¤„ç†å›¾åƒæˆ–URLçš„åœ°æ–¹ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¯èƒ½æ€§ã€‚å¦‚æœä½ æ²¡æœ‰æ„è¯†åˆ°ï¼Œä½ å¯ä»¥åˆ©ç”¨<strong class="jp ir"> Azureè®¤çŸ¥æœåŠ¡</strong>æ¥è¿›è¡Œè¿™æ ·çš„äººå·¥æ™ºèƒ½æ“ä½œã€‚</p><p id="3d2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ€»æ˜¯æœ‰ä¸¤ç§æ–¹å¼ä¸AzureæœåŠ¡äº¤äº’ã€‚</p><ul class=""><li id="1c9f" class="lf lg iq jp b jq jr ju jv jy nt kc nu kg nv kk lm ln lo lp bi translated">REST API</li><li id="3134" class="lf lg iq jp b jq lq ju lr jy ls kc lt kg lu kk lm ln lo lp bi translated">å®¢æˆ·ç«¯SDK</li></ul><p id="dc9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘æ˜¯ä¸€ä¸ªæ‡’æƒ°çš„äººï¼Œæ‰€ä»¥æˆ‘ä¸ä¼šå»æ¢ç´¢REST APIæµè§ˆå™¨å¹¶æ‰¾åˆ°åˆé€‚çš„APIï¼Œæ‰¾åˆ°å®ƒçš„å¤´æ–‡ä»¶ï¼Œå¼ºåˆ¶å‚æ•°ç­‰ç­‰ç­‰ç­‰..è¿™ä¹Ÿæ˜¯æˆ‘åˆ›å»ºè‡ªå·±çš„åº“æ¥ä¸StackExchange APIäº¤äº’çš„åŸå› ã€‚å®ƒå«åš<a class="ae kl" href="https://github.com/gethari/StackExchange.NET" rel="noopener ugc nofollow" target="_blank">StackExchange.NET</a>ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨<a class="ae kl" href="https://www.nuget.org/packages/StackExchange.NET/" rel="noopener ugc nofollow" target="_blank"> Nuget </a>ä¸­æ‰¾åˆ°å®ƒ</p><h2 id="2dd3" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">Azureè®¤çŸ¥æœåŠ¡SDK</h2><p id="3b2c" class="pw-post-body-paragraph jn jo iq jp b jq lh js jt ju li jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ij bi translated">æ‰€ä»¥æˆ‘å°†åœ¨æˆ‘çš„é¡¹ç›®ä¸Šå®‰è£…Azure Cognitive services SDKæ¥å¤„ç†å›¾åƒã€‚ä½†åœ¨æ­¤ä¹‹å‰ï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªAzureè®¤çŸ¥æœåŠ¡æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><ul class=""><li id="bde2" class="lf lg iq jp b jq jr ju jv jy nt kc nu kg nv kk lm ln lo lp bi translated">æ‰“å¼€Azureé—¨æˆ·å¹¶ç‚¹å‡»æ·»åŠ æ–°èµ„æº</li><li id="d978" class="lf lg iq jp b jq lq ju lr jy ls kc lt kg lu kk lm ln lo lp bi translated">é€‰æ‹©äººå·¥æ™ºèƒ½å’Œæœºå™¨å­¦ä¹ ç±»åˆ«ï¼Œç„¶åç‚¹å‡»è®¡ç®—æœºè§†è§‰</li></ul><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/22ea917638c4af838ef02b5e11b0c6b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*nKjZp4dUZtbk5de3UgYmBQ.png"/></div></figure><p id="9eec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç»™å®ƒä¸€ä¸ªä½ æƒ³è¦çš„æ›´å¥½çš„åå­—ï¼Œåœ¨é€‰æ‹©å®šä»·æ–¹æ¡ˆæ—¶ï¼Œé€‰æ‹©<strong class="jp ir"> F0 </strong>å› ä¸ºå®ƒæ˜¯å…è´¹çš„ï¼Œå®ƒå°†æœåŠ¡äºæˆ‘ä»¬çš„ç›®çš„ã€‚æˆ‘ä»¬ä¸æ‰“ç®—ç”Ÿäº§ï¼Œæ‰€ä»¥å…è´¹åº”è¯¥æ²¡é—®é¢˜ã€‚</p><p id="5013" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">æ³¨æ„:</strong>å¦‚æœæ‚¨å·²ç»æœ‰ä¸€ä¸ªè®¡ç®—æœºè§†è§‰èµ„æºï¼Œæ‚¨ä¸èƒ½é‡æ–°åˆ›å»ºä¸€ä¸ªå…è´¹çš„ã€‚ä½ å¯ä»¥åˆ©ç”¨å®ƒã€‚</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/08a592775e0709035c52f53286258d69.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*1AGLnDHBCfIZzCKdG2ihDQ.png"/></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk translated">å·²ç»å­˜åœ¨çš„èµ„æº</figcaption></figure></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><h2 id="fe4b" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">è¿æ¥åˆ°è®¤çŸ¥æœåŠ¡</h2><p id="4d6a" class="pw-post-body-paragraph jn jo iq jp b jq lh js jt ju li jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ij bi translated">ä¸€æ—¦èµ„æºåˆ›å»ºå®Œæˆï¼Œä½ å¯ä»¥æ‰“å¼€èµ„æºï¼Œä½ ä¼šå‘ç°ä¸€ä¸ª<code class="fe mp mq mr ms b">Key </code>å’Œä¸€ä¸ª<code class="fe mp mq mr ms b">Endpoint</code></p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi of"><img src="../Images/33e461346c12e093dba4743b9f536d1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nkJV9jBqUzv1RVpjLwrf0Q.png"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk translated">Azureè®¤çŸ¥æœåŠ¡</figcaption></figure><p id="307c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨å¯¼èˆªå›è§£å†³æ–¹æ¡ˆï¼Œæ‰“å¼€<code class="fe mp mq mr ms b">appsettings.json</code>ï¼Œåˆ›å»ºå¦‚ä¸‹jsonã€‚å¤åˆ¶å¯†é’¥å’Œç«¯ç‚¹å¹¶ç²˜è´´å®ƒã€‚</p><pre class="lz ma mb mc gt nk ms nl nm aw nn bi"><span id="f0d4" class="km kn iq ms b gy no np l nq nr">{<br/>  â€œMicrosoftAppIdâ€: â€œâ€,<br/>  â€œMicrosoftAppPasswordâ€: â€œâ€,<br/>  â€œCredentialsâ€: {<br/>    â€œComputerVisionKeyâ€: â€œenter your Keyâ€,<br/>    â€œComputerVisionEndpointâ€:â€œenter endpoint URL"<br/>   }<br/>}</span></pre><h2 id="eb85" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">æ³¨å…¥å‡­æ®</h2><ul class=""><li id="143a" class="lf lg iq jp b jq lh ju li jy lj kc lk kg ll kk lm ln lo lp bi translated">åˆ›å»ºä¸€ä¸ªæ–°ç±»ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</li></ul><pre class="lz ma mb mc gt nk ms nl nm aw nn bi"><span id="cf4e" class="km kn iq ms b gy no np l nq nr">public class Credentials {<br/>  public string ComputerVisionKey { get; set; }<br/>  public string ComputerVisionEndpoint { get; set; }<br/>}</span></pre><ul class=""><li id="aaf6" class="lf lg iq jp b jq jr ju jv jy nt kc nu kg nv kk lm ln lo lp bi translated">ç°åœ¨æ‰“å¼€<code class="fe mp mq mr ms b">Startup.cs</code>ï¼Œåœ¨<code class="fe mp mq mr ms b">ConfigureServices</code>æ–¹æ³•ä¸‹æ·»åŠ ä¸‹é¢ä¸€è¡Œã€‚</li></ul><pre class="lz ma mb mc gt nk ms nl nm aw nn bi"><span id="00c4" class="km kn iq ms b gy no np l nq nr">services.Configure&lt;Credentials(Configuration.GetSection(â€œCredentialsâ€));</span></pre><ul class=""><li id="58b5" class="lf lg iq jp b jq jr ju jv jy nt kc nu kg nv kk lm ln lo lp bi translated">æˆ‘å¸Œæœ›ä½ çŸ¥é“æˆ‘ä»¬æ˜¯å¦‚ä½•ä»appsettings.jsonè·å–å€¼çš„ã€‚</li></ul><h2 id="0e49" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">å®‰è£…SDK</h2><ul class=""><li id="990a" class="lf lg iq jp b jq lh ju li jy lj kc lk kg ll kk lm ln lo lp bi translated">ä»NugetåŒ…ç®¡ç†å™¨å®‰è£…<code class="fe mp mq mr ms b">Microsoft.Azure.CognitiveServices.Vision.ComputerVision</code>ã€‚</li><li id="4ca5" class="lf lg iq jp b jq lq ju lr jy ls kc lt kg lu kk lm ln lo lp bi translated">æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»æ¥ä½¿ç”¨å®¢æˆ·ç«¯sdkæ‰§è¡Œæ“ä½œã€‚</li></ul><pre class="lz ma mb mc gt nk ms nl nm aw nn bi"><span id="c6eb" class="km kn iq ms b gy no np l nq nr">public class ImageAnalyzer {<br/> private readonly string _computerVisionEndpoint;<br/> private readonly string _computerVisionKey;</span><span id="d82d" class="km kn iq ms b gy ns np l nq nr"> public ImageAnalyzer(IOptions&lt;Credentials&gt; options {<br/>  _computerVisionKey = options.Value.ComputerVisionKey;<br/>  _computerVisionEndpoint = options.Value.ComputerVisionEndpoint;<br/> }<br/>}</span></pre><ul class=""><li id="777e" class="lf lg iq jp b jq jr ju jv jy nt kc nu kg nv kk lm ln lo lp bi translated">æˆ‘æœ‰ä¸€ä¸ªç®€å•çš„ç±»ï¼Œå…¶ä¸­çš„æ„é€ å‡½æ•°å°†åœ¨è¿è¡Œæ—¶è‡ªåŠ¨æ³¨å…¥ã€‚</li></ul><h2 id="46fd" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">ä½¿ç”¨SDKè¿›è¡Œè®¡ç®—</h2><p id="84f5" class="pw-post-body-paragraph jn jo iq jp b jq lh js jt ju li jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ij bi translated">æˆ‘ä»¬ä½¿ç”¨çš„ä»»ä½•API / SDKéƒ½éœ€è¦é¦–å…ˆç»è¿‡è®¤è¯ã€‚æ‰€ä»¥æˆ‘åˆ›é€ äº†ä¸€ä¸ªè¿™æ ·çš„æ–¹æ³•</p><pre class="lz ma mb mc gt nk ms nl nm aw nn bi"><span id="4115" class="km kn iq ms b gy no np l nq nr">public static ComputerVisionClient Authenticate(string endpoint, string key) {<br/>  var client = new ComputerVisionClient(new     ApiKeyServiceClientCredentials(key)) { <br/>  Endpoint = endpoint };<br/>return client;<br/>}</span></pre><p id="2f6e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å› ä¸ºæˆ‘ä»¬å°†è¦åˆ†æä¸€ä¸ª<code class="fe mp mq mr ms b">Stream</code>æˆ–è€…ä¸€ä¸ª<code class="fe mp mq mr ms b">URL</code>ï¼Œæ‰€ä»¥æˆ‘ä¸ºå®ƒåˆ›å»ºäº†ä¸¤ä¸ªæ–¹æ³•ã€‚</p><pre class="lz ma mb mc gt nk ms nl nm aw nn bi"><span id="2296" class="km kn iq ms b gy no np l nq nr">public async Task&lt;ImageAnalysis&gt; AnalyzeImageAsync(Stream image) {<br/>  var client = Authenticate(_computerVisionEndpoint, _computerVisionKey);<br/>  var analysis = await client.AnalyzeImageInStreamAsync(image, Features);<br/>  return analysis;<br/>  }<br/>}</span><span id="ad70" class="km kn iq ms b gy ns np l nq nr">public async Task&lt;ImageAnalysis&gt; AnalyzeUrl(string url){<br/>  var client = Authenticate(_computerVisionEndpoint, _computerVisionKey);<br/>  var result = await client.AnalyzeImageWithHttpMessagesAsync(url, Features);<br/>  return result.Body;<br/>}</span></pre><p id="88e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åŸæ¥å¦‚æ­¤ã€‚SDKæ“ä½œå·²ç»å®Œæˆã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¬¬äºŒä¸ªå‚æ•°åœ¨ä¸¤ä¸ªå®¢æˆ·ç«¯è°ƒç”¨ä¸­éƒ½è¢«ç§°ä¸º<code class="fe mp mq mr ms b">Features</code>ã€‚è¿™æ˜¯ä»€ä¹ˆï¼Ÿ</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi og"><img src="../Images/319746ace0b6eab440f5706cf86cb31d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x6g68dw-xRLIkVSSQtSRhw.png"/></div></div></figure><p id="682b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‰€ä»¥æ˜¯SDKæ¥å—çš„ä¸€ä¸ª<code class="fe mp mq mr ms b">List&lt;Enums&gt;</code>ã€‚æˆ‘å·²ç»ä»æ–‡æ¡£ä¸­å¤åˆ¶äº†å®ƒã€‚</p><pre class="lz ma mb mc gt nk ms nl nm aw nn bi"><span id="a4cc" class="km kn iq ms b gy no np l nq nr">private static readonly List&lt;VisualFeatureTypes&gt; Features = new List&lt;VisualFeatureTypes&gt; {<br/>  VisualFeatureTypes.Categories, <br/>  VisualFeatureTypes.Description,<br/>  VisualFeatureTypes.Faces,   <br/>  VisualFeatureTypes.ImageType,<br/>  VisualFeatureTypes.Tags<br/>};</span></pre><h2 id="d0ea" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">ä¸æœºå™¨äººäº’åŠ¨</h2><p id="ddf0" class="pw-post-body-paragraph jn jo iq jp b jq lh js jt ju li jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ij bi translated"><code class="fe mp mq mr ms b">ITurnContext&lt;IMessageActivity&gt; turnContext</code>æ˜¯ä¸»è¦çš„ä¸œè¥¿ï¼ŒåŒ…å«ä½ ä¸æœºå™¨äººå…±äº«çš„ä»»ä½•ä¸œè¥¿ã€‚çœ‹çœ‹ä¸‹é¢çš„ä»£ç ã€‚æˆ‘æŠŠå®ƒä¿æŒå¾—å¾ˆç®€å•ï¼Œä»¥ä¾¿äºç†è§£ã€‚</p><p id="5892" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç®€å•æ¥è¯´ï¼Œä¸‹é¢çš„ä»£ç æ˜¯</p><p id="7fd4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="oh">å¦‚æœæ˜¯é™„ä»¶image = &gt;è°ƒç”¨processImageæ–¹æ³•ï¼Œå¦åˆ™å¦‚æœæ˜¯url = &gt;è°ƒç”¨urlæ–¹æ³•å¹¶è¿”å›ç»“æœ</em></p><pre class="lz ma mb mc gt nk ms nl nm aw nn bi"><span id="8068" class="km kn iq ms b gy no np l nq nr">var result = new ImageAnalysis();<br/>if (turnContext.Activity.Attachments?.Count &gt; 0) {<br/>  var attachment = turnContext.Activity.Attachments[0];<br/>  var image = await _httpClient.GetStreamAsync(attachment.ContentUrl);</span><span id="a391" class="km kn iq ms b gy ns np l nq nr"> if (image != null) {<br/> result = await _imageAnalyzer.AnalyzeImageAsync(image);<br/> }<br/>}<br/>else {<br/> result = await _imageAnalyzer.AnalyzeUrl(turnContext.Activity.Text);<br/>}<br/>var stringResponse = $â€I think the Image you uploaded is a {result.Tags[0].Name.ToUpperInvariant()} and it is {result.Description.Captions[0].Text.ToUpperInvariant()} â€œ;<br/>return stringResponse;</span></pre><h2 id="9f3e" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">æ¼”ç¤º</h2><p id="0561" class="pw-post-body-paragraph jn jo iq jp b jq lh js jt ju li jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ij bi translated">ç°åœ¨æ˜¯æ—¶å€™çœ‹çœ‹è¿™ä¸ªæœºå™¨äººæ˜¯å¦çœŸçš„å·¥ä½œäº†ã€‚ä¸ºæ­¤ï¼Œ</p><ul class=""><li id="5863" class="lf lg iq jp b jq jr ju jv jy nt kc nu kg nv kk lm ln lo lp bi translated">æ„å»ºè§£å†³æ–¹æ¡ˆï¼Œç„¶åæŒ‰<code class="fe mp mq mr ms b">F5</code>ã€‚</li><li id="1dd0" class="lf lg iq jp b jq lq ju lr jy ls kc lt kg lu kk lm ln lo lp bi translated">æ­£å¦‚å…ˆå†³æ¡ä»¶ä¸­æåˆ°çš„ï¼Œæˆ‘å·²ç»å®‰è£…äº†Azure Botæ¡†æ¶æ¨¡æ‹Ÿå™¨ï¼Œè®©æˆ‘ä»¬æ‰“å¼€å®ƒã€‚</li><li id="ae7e" class="lf lg iq jp b jq lq ju lr jy ls kc lt kg lu kk lm ln lo lp bi translated">å½“ä½ æ‰“å¼€å®ƒæ—¶ï¼Œä½ ä¼šçœ‹åˆ°è¿™æ ·ä¸€ä¸ªé¡µé¢</li></ul><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/4098a933955b45e8ef41a7e057dfe0bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*o8u4fSKxu0KPb1vyc5al5w.png"/></div></figure><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi oj"><img src="../Images/1ae0486cf497909039731400cc4e180e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8v5TkVF3exLR1GCS8kx6rA.png"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk translated">æœºå™¨äººä¼˜å…ˆäº¤äº’</figcaption></figure><p id="912f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ­£åœ¨ä¸Šä¼ å›¾åƒã€‚</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/71b09e6008cef991b4f360e3e70d8a81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/1*relMeC1pXM-0lZmQvRwbyA.gif"/></div></figure><p id="4e0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸‡å²ã€‚ä»»åŠ¡å®Œæˆï¼ğŸ”¥</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/724dbde980a2fc2db337e374fc1d4e36.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/0*qWTpvUMp4x-yn_Pb"/></div></figure><p id="0c65" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å®Œæ•´çš„è§£å†³æ–¹æ¡ˆå¯ä»¥ä»è¿™é‡Œçš„<a class="ae kl" href="https://github.com/gethari/ImageDescriber" rel="noopener ugc nofollow" target="_blank"> Github </a>ä¸‹è½½</p><p id="e42d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ„Ÿè°¢é˜…è¯»ã€‚è¯·ç»§ç»­å…³æ³¨æ›´å¤šåšå®¢ã€‚</p></div></div>    
</body>
</html>