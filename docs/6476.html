<html>
<head>
<title>Chrome Extension Development with Nx Workspace &amp; Angular v13 â€” Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨Nx Workspaceå’ŒAngular v13å¼€å‘Chromeæ‰©å±•â€”ç¬¬2éƒ¨åˆ†</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/chrome-extension-development-with-nx-workspace-angular-v13-f9163e545c8f?source=collection_archive---------2-----------------------#2021-11-28">https://itnext.io/chrome-extension-development-with-nx-workspace-angular-v13-f9163e545c8f?source=collection_archive---------2-----------------------#2021-11-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/b24417ca6d6608f5f6a3682f4379deee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PMzoZwbaE54iYTRdSR3MsA.png"/></div></div></figure><p id="89fa" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">æˆ‘è¯•å›¾ä¸ºä¸ªäººä½¿ç”¨åˆ›å»ºä¸€ä¸ªç®€å•çš„Chromeæ‰©å±•ã€‚ç„¶åæŒ‡å‡ºè¿™å¯ä»¥ä½¿ç”¨HTMLã€CSS &amp; JavaScriptæ¥å®Œæˆã€‚</p><p id="0a44" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/chrome-extension-development-with-nx-workspace-angular-v13-48cf3d2c2a41"> <strong class="kd iu">ç¬¬1éƒ¨åˆ†:å…¥é—¨</strong> </a> <strong class="kd iu"> <br/> </strong> <a class="ae kz" href="https://medium.com/@dalenguyen/chrome-extension-development-with-nx-workspace-angular-v13-f9163e545c8f" rel="noopener"> <strong class="kd iu">ç¬¬2éƒ¨åˆ†:æ›´æ”¹èƒŒæ™¯é¢œè‰²</strong></a><strong class="kd iu"><br/></strong><a class="ae kz" href="https://medium.com/@dalenguyen/chrome-extension-development-with-nx-workspace-angular-v13-part-3-f824c0baf75f" rel="noopener"><strong class="kd iu">ç¬¬3éƒ¨åˆ†:æ·»åŠ ä¸Šä¸‹æ–‡èœå•</strong></a><strong class="kd iu"><br/></strong><a class="ae kz" href="https://medium.com/@dalenguyen/chrome-extension-development-with-nx-workspace-angular-v13-part-4-948fcc51e0f8" rel="noopener"><strong class="kd iu">ç¬¬4éƒ¨åˆ†:å‘é€HTTPè¯·æ±‚</strong></a><br/><a class="ae kz" href="https://dalenguyen.medium.com/chrome-extension-development-with-nx-workspace-angular-v13-part-5-7245829ea87c" rel="noopener"><strong class="kd iu">ç¬¬5éƒ¨åˆ†:æ·»åŠ å†…å®¹è„šæœ¬</strong> </a></p><p id="8632" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae kz" href="https://github.com/dalenguyen/dalenguyen.github.io/tree/dev/apps/ext-utils" rel="noopener ugc nofollow" target="_blank"> Githubç¤ºä¾‹</a></p><p id="35d2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»‹ç»äº†ç”¨Nx &amp; Angularå¼€å‘chromeæ‰©å±•çš„åŸºæœ¬ç»“æ„ã€‚åœ¨è¿™ä¸€é›†é‡Œï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºä¸€äº›çœŸå®çš„è¡ŒåŠ¨ã€‚</p><p id="16dd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">åœ¨<a class="ae kz" href="https://developer.chrome.com/docs/extensions/mv3/getstarted/" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ªä¾‹å­</a>ä¸­ï¼Œæˆ‘å°†åˆ›å»ºä¸€ä¸ªæŒ‰é’®ï¼Œä»¥ä¾¿ç”¨ç»¿è‰²æ›´æ–°ç«™ç‚¹çš„èƒŒæ™¯è‰²ã€‚</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi la"><img src="../Images/686d08822bb5b136bbdb7b1ca73be89b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*vw5B5NXndF5E3x4Pn0wSog.png"/></div></figure><p id="6759" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">å®‰è£…@types/chrome </strong></p><p id="911e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">åœ¨Angularä¸­è¾“å…¥éå¸¸æœ‰ç”¨ï¼Œå› æ­¤æ‚¨å°†çœ‹åˆ°å¯¹æ‚¨çš„å®ç°çš„å»ºè®®</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="2966" class="lk ll it lg b gy lm ln l lo lp">yarn add -D @types/chrome</span></pre><p id="ef74" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">åˆ›å»ºåå°è„šæœ¬</strong></p><blockquote class="lq lr ls"><p id="70a0" class="kb kc lt kd b ke kf kg kh ki kj kk kl lu kn ko kp lv kr ks kt lw kv kw kx ky im bi translated">æ‰©å±•æ˜¯åŸºäºäº‹ä»¶çš„ç¨‹åºï¼Œç”¨äºä¿®æ”¹æˆ–å¢å¼ºChromeæµè§ˆä½“éªŒã€‚äº‹ä»¶æ˜¯æµè§ˆå™¨è§¦å‘å™¨ï¼Œä¾‹å¦‚å¯¼èˆªåˆ°æ–°é¡µé¢ã€ç§»é™¤ä¹¦ç­¾æˆ–å…³é—­æ ‡ç­¾ã€‚æ‰©å±•åœ¨å…¶åå°è„šæœ¬ä¸­ç›‘æ§è¿™äº›äº‹ä»¶ï¼Œç„¶åæ ¹æ®æŒ‡å®šçš„æŒ‡ä»¤åšå‡ºååº”ã€‚</p></blockquote><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="c7eb" class="lk ll it lg b gy lm ln l lo lp">// src/background.ts</span><span id="c31a" class="lk ll it lg b gy lx ln l lo lp">/// &lt;reference types="chrome"/&gt;</span><span id="9bd1" class="lk ll it lg b gy lx ln l lo lp">const color = '#3aa757'</span><span id="9b3e" class="lk ll it lg b gy lx ln l lo lp">chrome.runtime.onInstalled.addListener(() =&gt; {<br/>  chrome.storage.sync.set({ color })<br/>  console.log('Default background color set to %cgreen', `color: ${color}`)<br/>})</span></pre><p id="5cad" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">è¯¥è„šæœ¬ä»¥ä¸€ä¸ªç›‘å¬äº‹ä»¶<code class="fe ly lz ma lg b">onInstalled</code>å¼€å§‹ï¼Œç„¶åä¸ºå­˜å‚¨è®¾ç½®ä¸€ä¸ªé¢œè‰²å€¼â€”â€”è®°ä½å°†<strong class="kd iu">å­˜å‚¨</strong>æ·»åŠ åˆ°manifest.jsonä¸­çš„æƒé™ä¸­</p><p id="c54e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">æ­¤æ—¶ï¼Œæ‚¨çš„manifest.jsonå°†å¦‚ä¸‹æ‰€ç¤º</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="e530" class="lk ll it lg b gy lm ln l lo lp">{<br/>  "name": "Great Extension",<br/>  "version": "1.0",<br/>  "description": "Build an Extension with Angular",<br/>  "manifest_version": 3,<br/>  "action": {<br/>    "default_popup": "index.html",<br/>    "default_icon": {<br/>      "16": "assets/images/get_started16.png",<br/>      "32": "assets/images/get_started32.png",<br/>      "48": "assets/images/get_started48.png",<br/>      "128": "assets/images/get_started128.png"<br/>    }<br/>  },<br/>  "icons": {<br/>    "16": "assets/images/get_started16.png",<br/>    "32": "assets/images/get_started32.png",<br/>    "48": "assets/images/get_started48.png",<br/>    "128": "assets/images/get_started128.png"<br/>  },<br/>  "background": {<br/>    "service_worker": "<strong class="lg iu">background.js</strong>"<br/>  },<br/>  "permissions": ["<strong class="lg iu">storage</strong>", "activeTab", "scripting"]<br/>}</span></pre><p id="17c5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">åœ¨Angularé¡¹ç›®ä¸­å‡†å¤‡èƒŒæ™¯è„šæœ¬</strong></p><p id="c622" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ç”±äº<code class="fe ly lz ma lg b">background.js</code>ä¸<code class="fe ly lz ma lg b">main.js</code>ç›¸æ¯”æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è„šæœ¬ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªè‡ªå®šä¹‰çš„æµç¨‹ï¼Œè€Œä¸æ˜¯å°†è„šæœ¬ç›´æ¥å¯¼å…¥åˆ°<code class="fe ly lz ma lg b">main.ts</code>ã€‚å®ƒå°†è¢«ç¼–è¯‘æˆå¡ç›˜å¹¶ç”±<code class="fe ly lz ma lg b">index.html</code>åŠ è½½ã€‚</p><p id="08a8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">åœ¨Angularä¸­ï¼Œæˆ‘ä»¬æœ‰è‡ªå®šä¹‰webpackæ„å»ºå™¨ï¼Œå¯ä»¥å°†è‡ªå®šä¹‰webpackæ–‡ä»¶æ·»åŠ åˆ°æ„å»ºé€‰é¡¹ä¸­ã€‚</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="0460" class="lk ll it lg b gy lm ln l lo lp">yarn add -D @angular-builders/custom-webpack</span></pre><p id="459b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ç„¶ååœ¨angular.jsonä¸­ï¼Œæ‚¨å·²ç»ä»`<strong class="kd iu">@ angular-devkit/build-angular</strong>åˆ‡æ¢åˆ°`<strong class="kd iu">@ angular-builders/custom-webpack</strong>`,å¹¶åŒ…å«äº†æ‚¨çš„è‡ªå®šä¹‰web packçš„è·¯å¾„ã€‚</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="e2ca" class="lk ll it lg b gy lm ln l lo lp">// angular.json</span><span id="e5f0" class="lk ll it lg b gy lx ln l lo lp">"architect": {<br/>   "build": {<br/>      "builder": "<a class="ae kz" href="http://twitter.com/angular" rel="noopener ugc nofollow" target="_blank"><strong class="lg iu">@angular</strong></a><strong class="lg iu">-builders/custom-webpack:browser</strong>",<br/>      "outputs": ["{options.outputPath}"],<br/>      "options": {<br/>          ....<br/>          "aot": true,<br/>          <strong class="lg iu">"customWebpackConfig": { "path": "apps/ext-utils/custom-webpack.config.js" }</strong><br/>},</span></pre><p id="1702" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ä½ çš„è‡ªå®šä¹‰ç½‘ç»œåŒ…åŒ…å«äº†<code class="fe ly lz ma lg b">background.ts</code>çš„è·¯å¾„</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="e961" class="lk ll it lg b gy lm ln l lo lp">// custom-webpack.config.js</span><span id="a916" class="lk ll it lg b gy lx ln l lo lp">module.exports = {<br/>  entry: { background: 'apps/ext-utils/src/background.ts' },<br/>  optimization: {<br/><strong class="lg iu">    runtimeChunk: false,<br/></strong>  },<br/>}</span></pre><p id="752c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ä¸è¦å¿˜è®°åœ¨tsconfig.app.jsonä¸­åŒ…å«background.ts &amp; types</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="598b" class="lk ll it lg b gy lm ln l lo lp">// tsconfig.app.json</span><span id="1a94" class="lk ll it lg b gy lx ln l lo lp">{<br/>  "extends": "./tsconfig.json",<br/>  "compilerOptions": {<br/>    "outDir": "../../dist/out-tsc",<br/>    <strong class="lg iu">"types": ["chrome"]</strong><br/>  },<br/>  "files": ["src/main.ts", "src/polyfills.ts", <strong class="lg iu">"src/background.ts"</strong>],<br/>  "include": ["src/**/*.d.ts"],<br/>  "exclude": ["**/*.test.ts", "**/*.spec.ts"]<br/>}</span></pre><p id="3c92" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬æ„å»ºæ‰©å±•ï¼Œä½ ä¼šçœ‹åˆ°èƒŒæ™¯ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ã€‚</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/5c5b13e2105386ba7c90da4f088cf2f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*ecIOkn8GXdDuiPoRYLmmpA.png"/></div></figure><p id="ceec" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ä¸ºäº†ä¿æŒåŸæ¥çš„æ–‡ä»¶åï¼Œä¸è¦å¿˜è®°æ›´æ”¹<code class="fe ly lz ma lg b">outputHashing</code>ã€‚</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="6518" class="lk ll it lg b gy lm ln l lo lp">"configurations": {<br/>  "production": {<br/>       ...<br/>       <strong class="lg iu">"outputHashing": "none"</strong><br/>   },<br/>},</span></pre><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/d9b5d3fe0ca7631954352871344856eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*Fm__Fxuom8ELLU7aCW2urg.png"/></div></figure><p id="f575" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ä¹‹åï¼Œæ‚¨å¯ä»¥é‡æ–°åŠ è½½æ‰©å±•å¹¶æ£€æŸ¥æ˜¯å¦åŒ…å«äº†<code class="fe ly lz ma lg b">background.js</code>ã€‚</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi md"><img src="../Images/1c537b583f1fa196c12ae9fc6182af4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*wfAGvTPgrDj8e7otrYFeZQ.png"/></div></figure><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi me"><img src="../Images/fe83038e3a65fd78e14cd8191738e3e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*Fq3yOGkjV0Ktgzzax35_cA.png"/></div></figure><p id="a3f8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">æ·»åŠ å±‚é€»è¾‘</strong></p><p id="abae" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">æ‰©å±•ç°åœ¨æœ‰ä¸€ä¸ªå¼¹å‡ºçª—å£ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªæŒ‰é’®è¿›è¡Œäº¤äº’ã€‚</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="88d0" class="lk ll it lg b gy lm ln l lo lp">// app.component.html</span><span id="dd6a" class="lk ll it lg b gy lx ln l lo lp">&lt;h1&gt;Utils Extension&lt;/h1&gt;<br/>&lt;button (click)="changeBackground()"&gt;Change Background&lt;/button&gt;</span></pre><p id="546e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å°†å‡½æ•°æ·»åŠ åˆ°ç»„ä»¶ä¸­ã€‚è¿™ä¸ªå‡½æ•°å°†ä»å­˜å‚¨å™¨ä¸­è·å–é¢œè‰²ï¼Œå¹¶æ›´æ–°ä½ æ‰€æµè§ˆçš„ä»»ä½•ç½‘ç«™çš„èƒŒæ™¯ã€‚</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="9282" class="lk ll it lg b gy lm ln l lo lp">// app.component.ts</span><span id="8764" class="lk ll it lg b gy lx ln l lo lp">export class AppComponent {<br/>  async changeBackground() {<br/>    const [tab] = await chrome.tabs.query({ active: true, currentWindow: true })</span><span id="56af" class="lk ll it lg b gy lx ln l lo lp">if (tab.id != null) {<br/>      chrome.scripting.executeScript({<br/>        target: { tabId: tab.id },<br/>        func: () =&gt; {<br/>          chrome.storage.sync.get('color', ({ color }) =&gt; {<br/>            document.body.style.backgroundColor = color<br/>          })<br/>        },<br/>      })<br/>    }<br/>  }<br/>}</span></pre><p id="e68e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ä¸è¦å¿˜è®°ï¼Œæ¸…å•éœ€è¦<code class="fe ly lz ma lg b"><a class="ae kz" href="https://developer.chrome.com/docs/extensions/mv3/manifest/activeTab/" rel="noopener ugc nofollow" target="_blank">activeTab</a></code>æƒé™æ¥å…è®¸æ‰©å±•ä¸´æ—¶è®¿é—®å½“å‰é¡µé¢ï¼Œè¿˜éœ€è¦<code class="fe ly lz ma lg b"><a class="ae kz" href="https://developer.chrome.com/docs/extensions/reference/scripting/" rel="noopener ugc nofollow" target="_blank">scripting</a></code>æƒé™æ¥ä½¿ç”¨è„šæœ¬APIçš„<code class="fe ly lz ma lg b"><a class="ae kz" href="https://developer.chrome.com/docs/extensions/reference/scripting#method-executeScript" rel="noopener ugc nofollow" target="_blank">executeScript</a></code>æ–¹æ³•ã€‚</p><p id="7950" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å°±æ˜¯è¿™æ ·ã€‚ç°åœ¨ä½ çŸ¥é“å¦‚ä½•é€šè¿‡æ”¹å˜èƒŒæ™¯æ¥ä¸ç½‘ç«™äº’åŠ¨ã€‚å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–è¦æ±‚ï¼Œè¯·åœ¨è¯„è®ºåŒºæå‡ºã€‚</p><p id="355a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae kz" href="https://twitter.com/dale_nguyen" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">åœ¨Twitterä¸Šå…³æ³¨æˆ‘</strong> </a>äº†è§£Angularã€JavaScript &amp; WebDevelopmentçš„æœ€æ–°å†…å®¹ğŸ‘</p></div></div>    
</body>
</html>