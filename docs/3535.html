<html>
<head>
<title>Dockerize a React app with Node.js backend connected to MongoDb</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨è¿æ¥åˆ°MongoDbçš„Node.jsåç«¯å¯¹æ¥ä¸€ä¸ªReactåº”ç”¨ç¨‹åº</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/dockerize-a-react-app-with-node-js-backend-connected-to-mongodb-63740fc0f9e7?source=collection_archive---------1-----------------------#2020-01-05">https://itnext.io/dockerize-a-react-app-with-node-js-backend-connected-to-mongodb-63740fc0f9e7?source=collection_archive---------1-----------------------#2020-01-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5fe1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½ å¥½äº²çˆ±çš„ç¨‹åºå‘˜ï¼Œæ¬¢è¿æ¥åˆ°æˆ‘çš„ç³»åˆ—æŠ€æœ¯æ–‡ç« çš„æœ€åä¸€ç¯‡ï¼ŒçŒ®ç»™<em class="kl"> Node.js </em>å’Œ<em class="kl"> Docker </em>ã€‚å¸Œæœ›ä½ å–œæ¬¢ï¼</p><p id="bae1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¯·æ‰¾åˆ°ç³»åˆ—çš„ç¬¬ä¸€éƒ¨åˆ†:<br/> 1ã€‚<a class="ae km" rel="noopener ugc nofollow" target="_blank" href="/dockerize-a-node-js-app-with-vs-code-bd471710dc22">â€œç”¨VSä»£ç Dockerize a node . js appâ€</a><br/>2ã€‚<a class="ae km" rel="noopener ugc nofollow" target="_blank" href="/dockerize-a-node-js-app-connected-to-mongodb-64fdeca94797"> " </a> <a class="ae km" rel="noopener ugc nofollow" target="_blank" href="/dockerize-a-node-js-app-connected-to-mongodb-64fdeca94797">å¯¹æ¥ä¸€ä¸ªè¿æ¥åˆ°MongoDbçš„node . js app</a>"</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/f62dc5e3aa868dec86d75eba02b66da0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QT6KAYmJhU7iMRPTZUvWhQ.jpeg"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae km" href="https://unsplash.com/@kimsondoan" rel="noopener ugc nofollow" target="_blank"> Kimson Doan </a>åœ¨<a class="ae km" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</figcaption></figure></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h1 id="eda5" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">é—®é¢˜:</h1><p id="5e9d" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">æˆ‘ä»¬å·²ç»ä»æœ¬ç³»åˆ—çš„å‰ä¸€ç¯‡æ–‡ç« ä¸­äº†è§£äº†å¦‚ä½•å°†Dockerä¸Nodeå’ŒMongoç»“åˆä½¿ç”¨ã€‚ä¸ºäº†å®Œæˆæˆ‘ä»¬çš„MERNå †æ ˆåº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ å‰ç«¯éƒ¨åˆ†ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œfrontendå°†ä½¿ç”¨Reactå®ç°ã€‚è®©æˆ‘ä»¬å­¦ä¹ å¦‚ä½•åˆ›å»ºå®Œæ•´çš„å‰ç«¯ï¼Œåç«¯ï¼Œæ•°æ®åº“å’Œè¿è¡ŒDockerä¸­çš„ä¸€åˆ‡å·¥ä½œçš„åº”ç”¨ç¨‹åºï¼</p><h1 id="a4a5" class="lk ll iq bd lm ln mn lp lq lr mo lt lu lv mp lx ly lz mq mb mc md mr mf mg mh bi translated">1.å…‹éš†åç«¯èŠ‚ç‚¹. js</h1><p id="9774" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">åœ¨æœ¬ç³»åˆ—ä¹‹å‰çš„<a class="ae km" href="https://dev.to/vguleaev/dockerize-a-node-js-app-connected-to-mongodb-5bp1" rel="noopener ugc nofollow" target="_blank">éƒ¨åˆ†</a>ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨MongoDbå’ŒDockeråˆ›å»ºäº†ä¸€ä¸ªNode.jsåº”ç”¨ç¨‹åºã€‚å¯¹äºæœ¬æ•™ç¨‹ï¼Œæˆ‘ä»¬å°†éœ€è¦ç›¸åŒçš„é¡¹ç›®ã€‚ä»è¿™é‡Œå…‹éš†<a class="ae km" href="https://github.com/vguleaev/Express-Mongo-Docker-tutorial" rel="noopener ugc nofollow" target="_blank">æºä»£ç </a>æˆ–è€…è¿è¡Œè¿™ä¸ªå‘½ä»¤:</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="1484" class="mx ll iq mt b gy my mz l na nb">git clone <a class="ae km" href="https://github.com/vguleaev/Express-Mongo-Docker-tutorial.git" rel="noopener ugc nofollow" target="_blank">https://github.com/vguleaev/Express-Mongo-Docker-tutorial.git</a></span></pre><p id="537b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å…‹éš†å®Œæˆåï¼Œå°†æ–‡ä»¶å¤¹ä»<code class="fe nc nd ne mt b">test-mongo-app</code>é‡å‘½åä¸º<code class="fe nc nd ne mt b">api</code>ã€‚è¿™å°†æ˜¯æˆ‘ä»¬çš„åç«¯ã€‚</p><p id="9697" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºäº†æµ‹è¯•ä¸€åˆ‡æ­£å¸¸ï¼Œæ‰“å¼€<code class="fe nc nd ne mt b">api</code>æ–‡ä»¶å¤¹å¹¶è¿è¡Œ<code class="fe nc nd ne mt b">npm install</code>ã€‚å®‰è£…å®Œä¾èµ–é¡¹åï¼Œè®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦ä¸€åˆ‡æ­£å¸¸ã€‚ğŸ¾</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="78c7" class="mx ll iq mt b gy my mz l na nb">docker-compose up</span></pre><p id="013e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™ä¸ªå‘½ä»¤å°†ä½¿ç”¨æˆ‘ä»¬çš„<code class="fe nc nd ne mt b">docker-compose.yml</code>æ¥è·å–mongoæ˜ åƒå¹¶å¯åŠ¨è¿æ¥åˆ°MongoDbçš„expressæœåŠ¡å™¨ã€‚</p><p id="ec46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œæ‚¨åº”è¯¥åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°å¦‚ä¸‹å†…å®¹:</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="93b4" class="mx ll iq mt b gy my mz l na nb">web_1 | Listening on 8080 <br/>web_1 | MongoDb connected</span></pre><p id="5296" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€è¿™ä¸ªç«¯ç‚¹<a class="ae km" href="http://localhost:8080/users" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/users</a>ï¼Œæ‚¨åº”è¯¥å¾—åˆ°ä¸€ä¸ªç©ºæ•°ç»„ä½œä¸ºå“åº”ã€‚è¿™æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„æ•°æ®åº“ç°åœ¨å®Œå…¨æ˜¯ç©ºçš„ã€‚</p><h1 id="5e1a" class="lk ll iq bd lm ln mn lp lq lr mo lt lu lv mp lx ly lz mq mb mc md mr mf mg mh bi translated">2.åˆ›å»ºReactåº”ç”¨</h1><p id="3dab" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">æ˜¯æ—¶å€™å¼€å‘æˆ‘ä»¬çš„å‰ç«¯éƒ¨åˆ†äº†ã€‚è½¬åˆ°çˆ¶ç›®å½•å¹¶è¿è¡Œ:</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="9ceb" class="mx ll iq mt b gy my mz l na nb">npm i create-react-app -g <br/>create-react-app ui</span></pre><p id="877c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨æˆ‘ä»¬çš„æ–‡ä»¶å¤¹ç»“æ„åº”è¯¥æ˜¯è¿™æ ·çš„:<br/><strong class="jp ir">â€¦</strong><br/>â”œâ”€â”€/api<br/>â””â”€â”€/ui<br/>(<em class="kl">å…¶ä¸­APIæ˜¯å…‹éš†çš„åç«¯åº”ç”¨ï¼Œuiæ˜¯æ–°åˆ›å»ºçš„Reactåº”ç”¨ã€‚</em></p><p id="f48a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºäº†ç¡®ä¿ä¸€åˆ‡æ­£å¸¸ï¼Œè®©æˆ‘ä»¬æ‰“å¼€<strong class="jp ir"> ui </strong>æ–‡ä»¶å¤¹å¹¶å¯åŠ¨Reactåº”ç”¨ç¨‹åº:</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="e2aa" class="mx ll iq mt b gy my mz l na nb">cd ui<br/>npm start</span></pre><p id="c1c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½ åº”è¯¥åœ¨<a class="ae km" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>çœ‹åˆ°åŸºæœ¬çš„React appã€‚ğŸˆ</p><h1 id="12c3" class="lk ll iq bd lm ln mn lp lq lr mo lt lu lv mp lx ly lz mq mb mc md mr mf mg mh bi translated">3.Dockerize Reactåº”ç”¨ç¨‹åº</h1><p id="2f90" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">åœ¨<strong class="jp ir"> uiçš„</strong>æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª<code class="fe nc nd ne mt b">.dockeringore</code>æ–‡ä»¶:</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="67b4" class="mx ll iq mt b gy my mz l na nb">node_modules <br/>.git <br/>.gitignore</span></pre><p id="a105" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">(å¦‚æœæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬çš„</em> <code class="fe nc nd ne mt b"><em class="kl">docker build</em></code> <em class="kl">å‘½ä»¤å°†åªæ˜¯æŒ‚åœ¨Windowsä¸Šã€‚)</em></p><p id="59c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åŒæ—¶åœ¨<strong class="jp ir"> ui </strong>æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª<code class="fe nc nd ne mt b">Dockerfile</code>æ–‡ä»¶:</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="5200" class="mx ll iq mt b gy my mz l na nb">FROM node:8<br/># Create app directory<br/>WORKDIR /usr/src/app<br/># Install app dependencies<br/>COPY package*.json ./<br/><br/>RUN npm install --silent<br/># Copy app source code<br/>COPY . .<br/><br/>#Expose port and start application<br/>EXPOSE 3000<br/>CMD ["npm", "start"]</span></pre><p id="c9b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è®©æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹Reactåœ¨dockerä¸­çš„å·¥ä½œæƒ…å†µã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ ‡è®°react:appæ„å»ºå›¾åƒ:</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="e2e0" class="mx ll iq mt b gy my mz l na nb">docker build -t react:app .</span></pre><p id="01e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨è¿è¡Œæˆ‘ä»¬çš„æ ‡è®°å›¾åƒï¼Œå¹¶å¯¹dockerä½¿ç”¨ç›¸åŒçš„ç«¯å£:</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="5363" class="mx ll iq mt b gy my mz l na nb">docker run -p 3000:3000 react:app</span></pre><p id="57d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‰“å¼€<a class="ae km" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>ï¼Œåº”è¯¥ä¼šçœ‹åˆ°Dockeræä¾›çš„Reactã€‚ğŸ‘</p><p id="8c23" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">âš ï¸:å¦‚æœä½ åƒå¾€å¸¸ä¸€æ ·ç”¨Ctrl+Cå…³é—­å®¹å™¨ï¼Œå®ƒä¸ä¼šåœæ­¢ã€‚è¦åœæ­¢å®¹å™¨è¿è¡Œï¼Œæ‰§è¡Œ<code class="fe nc nd ne mt b">docker ps</code>å‘½ä»¤ã€‚</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="4c0f" class="mx ll iq mt b gy my mz l na nb">CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES <br/>06c982ce6ae9 react:app "docker-entrypoint.s..." 12 days ago Up About a minute 0.0.0.0:3000-&gt;3000/tcp strange_montalcini</span></pre><p id="d5fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç„¶åé€‰æ‹©æ‰€éœ€çš„idå¹¶åœæ­¢å®¹å™¨ã€‚</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="4c13" class="mx ll iq mt b gy my mz l na nb">docker stop 06c982ce6ae9</span></pre><h1 id="57fe" class="lk ll iq bd lm ln mn lp lq lr mo lt lu lv mp lx ly lz mq mb mc md mr mf mg mh bi translated">4.ä»Reactåº”ç”¨ç¨‹åºè°ƒç”¨api</h1><p id="edd9" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">æ‰“å¼€<strong class="jp ir"> ui </strong>æ–‡ä»¶å¤¹ï¼Œå®‰è£…<code class="fe nc nd ne mt b">axios</code></p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="d358" class="mx ll iq mt b gy my mz l na nb">cd ui<br/>npm i axios</span></pre><p id="2489" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å°†ç¨å¾®æ”¹å˜ä¸€ä¸‹<code class="fe nc nd ne mt b">App</code>ç»„ä»¶ï¼Œè®©å®ƒæœ‰ä¸€ä¸ªåˆ›å»ºç”¨æˆ·å’Œæ˜¾ç¤ºç”¨æˆ·idåˆ—è¡¨çš„æŒ‰é’®ã€‚æˆ‘ä»¬å°†è°ƒç”¨<em class="kl"> /user-create </em>å’Œ<em class="kl"> /users </em>ä»æˆ‘ä»¬çš„Nodejsåº”ç”¨ç¨‹åºè·å–ç«¯ç‚¹ã€‚</p><p id="2c01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å°†æ­¤ç²˜è´´åˆ°App.jsæ–‡ä»¶ä¸­:</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="dcd5" class="mx ll iq mt b gy my mz l na nb">import React, { Component } from 'react';<br/>import logo from './logo.svg';<br/>import axios from 'axios';<br/>import './App.css';<br/><br/>const apiUrl = `http://localhost:8080`;<br/><br/>class App extends Component {<br/>  state = {<br/>    users: []<br/>  };<br/><br/>  async createUser() {<br/>    await axios.get(apiUrl + '/user-create');<br/>    this.loadUsers();<br/>  }<br/><br/>  async loadUsers() {<br/>    const res = await axios.get(apiUrl + '/users');<br/>    this.setState({<br/>      users: res.data<br/>    });<br/>  }<br/><br/>  componentDidMount() {<br/>    this.loadUsers();<br/>  }<br/><br/>  render() {<br/>    return (<br/>      &lt;div className="App"&gt;<br/>        &lt;header className="App-header"&gt;<br/>          &lt;img src={logo} className="App-logo" alt="logo" /&gt;<br/>          &lt;button onClick={() =&gt; this.createUser()}&gt;Create User&lt;/button&gt;<br/>          &lt;p&gt;Users list:&lt;/p&gt;<br/>          &lt;ul&gt;<br/>            {this.state.users.map(user =&gt; (<br/>              &lt;li key={user._id}&gt;id: {user._id}&lt;/li&gt;<br/>            ))}<br/>          &lt;/ul&gt;<br/>        &lt;/header&gt;<br/>      &lt;/div&gt;<br/>    );<br/>  }<br/>}<br/><br/>export default App;</span></pre><p id="6f3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç”±äºæˆ‘ä»¬åœ¨ç«¯å£3000ä¸Šè¿è¡Œå‰ç«¯ï¼Œä½†åç«¯åœ¨ç«¯å£8080ä¸Šè¿è¡Œï¼Œæˆ‘ä»¬å°†é‡åˆ°ä¸€ä¸ª<a class="ae km" href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing" rel="noopener ugc nofollow" target="_blank"> CORS </a>é—®é¢˜ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œè¯·è½¬åˆ°<strong class="jp ir"> api </strong>é¡¹ç›®å¹¶å®‰è£…corsåŒ…ã€‚</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="968f" class="mx ll iq mt b gy my mz l na nb">npm i cors</span></pre><p id="8179" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç„¶ååœ¨<code class="fe nc nd ne mt b">server.js</code>æ–‡ä»¶ä¸­ä½¿ç”¨å®ƒ:</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="af53" class="mx ll iq mt b gy my mz l na nb">const express = require('express');<br/>const app = express();<br/>const connectDb = require('./src/connection');<br/>const User = require('./src/User.model');<br/>const cors = require('cors');<br/><br/>app.use(cors());<br/>// ...</span></pre><h1 id="ded9" class="lk ll iq bd lm ln mn lp lq lr mo lt lu lv mp lx ly lz mq mb mc md mr mf mg mh bi translated">5.åœ¨Dockerä¸­ä¸€èµ·è¿è¡ŒReactå’ŒNode</h1><p id="8ec2" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">æœ€åä¸€æ­¥ï¼ç°åœ¨ä»ç›®å½•<strong class="jp ir"> api </strong>ä¸­ç§»é™¤<code class="fe nc nd ne mt b">docker-compose.yml</code>å¹¶åœ¨æ ¹æ–‡ä»¶å¤¹ä¸­åˆ›å»º<code class="fe nc nd ne mt b">docker-compose.yml</code>ã€‚ç²˜è´´è¿™ä¸ª:</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="5ee2" class="mx ll iq mt b gy my mz l na nb">version: '2'<br/>services:<br/>  ui:<br/>    build: ./ui<br/>    ports:<br/>      - '3000:3000'<br/>    depends_on:<br/>      - api<br/>  api:<br/>    build: ./api<br/>    ports:<br/>      - '8080:8080'<br/>    depends_on:<br/>      - mongo<br/>  mongo:<br/>    image: mongo<br/>    ports:<br/>      - '27017:27017'</span></pre><p id="db3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬çš„æ ¹æ–‡ä»¶å¤¹ç»“æ„ç°åœ¨çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:<br/><strong class="jp ir">â€¦</strong><br/>â”œâ”€â”€/API<br/>â”œâ”€â”€/ui<br/>â””â”€â”€docker-compose . yml</p><p id="f305" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬æœ‰ä¸€ä¸ªdocker-composeï¼Œå®ƒæè¿°äº†æˆ‘ä»¬å¸Œæœ›åœ¨dockerä¸­è¿è¡Œçš„æœåŠ¡ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸‰ä¸ªæœåŠ¡:<strong class="jp ir"> uiã€apiã€mongo </strong>ã€‚ğŸ‹</p><p id="fb44" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¯¹äºæ¯ä¸ªæœåŠ¡ï¼Œå°†åœ¨æ¯ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨<code class="fe nc nd ne mt b">Dockerfile</code>åˆ›å»ºdockerå›¾åƒã€‚æˆ‘ä»¬åœ¨è¡Œæ„å»ºä¸­æŒ‡å®šè·¯å¾„ã€‚(ä¾‹å¦‚<code class="fe nc nd ne mt b">build: ./ui</code>)</p><p id="a71a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¯¹äº<strong class="jp ir"> mongo </strong>æˆ‘ä»¬æ²¡æœ‰æ„å»ºå›¾åƒçš„é¡¹ç›®ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨æ¥è‡ªdocker <a class="ae km" href="https://hub.docker.com/_/mongo/" rel="noopener ugc nofollow" target="_blank"> hub </a>çš„é¢„å®šä¹‰å›¾åƒã€‚(å¦‚<code class="fe nc nd ne mt b">image: mongo</code>)</p><p id="2ab2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬è¿˜æŒ‡å®šç«¯å£å’Œä¾èµ–é¡¹ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œé¦–å…ˆå°†åœ¨ç«¯å£<em class="kl"> 27017 </em>ä¸Šå¯åŠ¨<strong class="jp ir"> mongo </strong>ï¼Œå› ä¸ºapiä¾èµ–äºmongoã€‚ç¬¬äºŒä¸ªå®¹å™¨æ˜¯ç«¯å£<em class="kl"> 8080 </em>ä¸Šçš„<strong class="jp ir"> api </strong>ï¼Œå› ä¸º<strong class="jp ir"> ui </strong>ä¾èµ–äºå®ƒã€‚æœ€åä¸€ä¸ªå®¹å™¨æ˜¯ä»ç«¯å£<em class="kl"> 3000 </em>å¼€å§‹çš„<strong class="jp ir"> ui </strong>ã€‚</p><p id="74bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ€åï¼Œä»æ ¹æ–‡ä»¶å¤¹è¿è¡Œæ‰€æœ‰çš„æœåŠ¡ä¸ä¸€ä¸ªå‘½ä»¤ï¼ğŸ§™</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="612b" class="mx ll iq mt b gy my mz l na nb">docker-compose up --build</span></pre><p id="0c7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‰“å¼€<a class="ae km" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000/ </a>ç‚¹å‡»æŒ‰é’®åˆ›å»ºç”¨æˆ·ã€‚æ‰“å¼€å¼€å‘è€…å·¥å…·æŸ¥çœ‹è°ƒç”¨ã€‚ç°åœ¨æˆ‘ä»¬ä»dockerè¿è¡Œå‰ç«¯å’Œåç«¯ï¼</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi nf"><img src="../Images/9ed33fe936797edee8f721711c19c7c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DHA88hJ_qJFRZYoB.PNG"/></div></div></figure><h1 id="498c" class="lk ll iq bd lm ln mn lp lq lr mo lt lu lv mp lx ly lz mq mb mc md mr mf mg mh bi translated">6.ä½¿ç”¨Reactç”Ÿäº§æ„å»º</h1><p id="68a9" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬ç”¨å¼€å‘æœåŠ¡å™¨å¯åŠ¨Reactåº”ç”¨ç¨‹åºï¼Œè¿™å¯èƒ½ä¸æ˜¯æˆ‘ä»¬æƒ³è¦åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨çš„ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p id="d25d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬åªéœ€è¦åœ¨<strong class="jp ir"> ui </strong>é¡¹ç›®ä¸­æ”¹å˜æˆ‘ä»¬çš„<code class="fe nc nd ne mt b">Dockerfile</code>ã€‚æˆ‘ä»¬å°†å¯åŠ¨ä¸€ä¸ªç”Ÿäº§æ„å»ºï¼Œå¹¶ä½¿ç”¨nginxæœåŠ¡å™¨ä¸ºå…¶æä¾›æœåŠ¡ã€‚å°†æ‰€æœ‰å†…å®¹æ›¿æ¢ä¸º:</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="ed0d" class="mx ll iq mt b gy my mz l na nb"># build environment<br/>FROM node:12.2.0-alpine as build<br/>WORKDIR /app<br/>ENV PATH /app/node_modules/.bin:$PATH<br/>COPY package.json /app/package.json<br/>RUN npm install --silent<br/>RUN npm install react-scripts@3.0.1 -g --silent<br/>COPY . /app<br/>RUN npm run build<br/><br/># production environment<br/>FROM nginx:1.16.0-alpine<br/>COPY --from=build /app/build /usr/share/nginx/html<br/>EXPOSE 80<br/>CMD ["nginx", "-g", "daemon off;"]</span></pre><p id="9561" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç”±äºæˆ‘ä»¬ç°åœ¨æš´éœ²äº†ç«¯å£80ï¼Œæˆ‘ä»¬éœ€è¦åœ¨<code class="fe nc nd ne mt b">docker-compose.yml</code>å°†å®ƒä»3000æ”¹ä¸º80ã€‚</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="4629" class="mx ll iq mt b gy my mz l na nb">ui:<br/>    build: ./ui<br/>    ports:<br/>      - '80:80'<br/>    depends_on:<br/>      - api</span></pre><p id="3a9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨å†æ¬¡è¿è¡Œç¥å¥‡çš„å‘½ä»¤æ¥å¯åŠ¨dockerä¸­çš„ä¸€åˆ‡ğŸ”®</p><pre class="ko kp kq kr gt ms mt mu mv aw mw bi"><span id="73ac" class="mx ll iq mt b gy my mz l na nb">docker-compose up --build</span></pre><p id="9253" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‰“å¼€<a class="ae km" href="http://localhost/" rel="noopener ugc nofollow" target="_blank"> http://localhost/ </a>ï¼Œæ‚¨åº”è¯¥çœ‹åˆ°å®Œå…¨ç›¸åŒçš„å·¥ä½œåº”ç”¨ç¨‹åºï¼Œä½†æ˜¯ç°åœ¨Reactæ­£åœ¨ç”Ÿäº§æ¨¡å¼ä¸‹è¿è¡Œã€‚</p><p id="5201" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨è¿™é‡Œçœ‹åˆ°<a class="ae km" href="https://github.com/vguleaev/React-Express-Mongo-Docker-tutorial/tree/master/react-express-mongo-app" rel="noopener ugc nofollow" target="_blank">æºä»£ç </a>ã€‚å°½æƒ…äº«å—å§ï¼</p><p id="3081" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ­å–œä½ æˆåŠŸæ³¨å†Œäº†Reactï¼ŒNodejså’ŒMongodbï¼ğŸ‰ğŸ‰ğŸ‰</p><p id="66b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ğŸš€å¦‚æœä½ ä»é‚£ç¯‡æ–‡ç« ä¸­è¯»åˆ°äº†ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿ï¼Œè¯·å–œæ¬¢å¹¶å…³æ³¨æˆ‘çš„æ›´å¤šå¸–å­ã€‚è°¢è°¢ä½ äº²çˆ±çš„ç¼–ç å‘˜ï¼ğŸ˜</p></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><p id="bad8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">åŸè½½äº2020å¹´1æœˆ5æ—¥</em><a class="ae km" href="https://dev.to/vguleaev/dockerize-a-react-app-with-node-js-backend-connected-to-mongodb-10ai" rel="noopener ugc nofollow" target="_blank"><em class="kl">https://dev . to</em></a><em class="kl">ã€‚</em></p></div></div>    
</body>
</html>