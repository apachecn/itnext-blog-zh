# ä½¿ç”¨ Github æ“ä½œéƒ¨ç½² Next.js åº”ç”¨ç¨‹åº

> åŸæ–‡ï¼š<https://itnext.io/deploy-next-js-apps-using-github-actions-6322261757bc?source=collection_archive---------0----------------------->

æ¨åŠ¨éƒ¨ç½²ã€‚ç®€å•çš„æ–¹æ³•ã€‚

![](img/a5d5f0d1eb9856529394fc1ce057fbe2.png)

ç…§ç‰‡ç”±[å…‹é‡Œæ–¯è’‚å¨œ@ wocintechchat.com](https://unsplash.com/@wocintechchat?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)åœ¨ [Unsplash](https://unsplash.com/s/photos/server?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ä¸Šæ‹æ‘„

## 1.å…ˆå†³æ¡ä»¶â€”next . js | Github | PM2 | node . js | Nginx | Linux

æœ¬æŒ‡å—å‡è®¾æ‚¨åœ¨ Github çš„ç§æœ‰å­˜å‚¨åº“ä¸­å·²ç»æœ‰ä¸€ä¸ª Next.js åº”ç”¨ç¨‹åºã€‚è¿™é‡Œæˆ‘æœ‰ä½¿ç”¨`npx create-next-app`åˆ›å»ºçš„åŸºæœ¬æ ·æ¿ Next.js åº”ç”¨ç¨‹åº

![](img/b8ad7efec47d9ef538e6fc592ed48415.png)

æˆ‘ä»¬å‡è®¾æ‚¨æœ‰ä¸€ä¸ªè¿è¡Œ Ubuntu çš„ VPS å®ä¾‹ã€‚ä½ å¯ä»¥ä»[æ•°å­—æµ·æ´‹](https://m.do.co/c/f4a5fcc71df6)å¾—åˆ°ä¸€ä¸ªã€‚ç¡®ä¿åœ¨æ‚¨çš„å®ä¾‹ä¸­ï¼Œæ‚¨å…·æœ‰:

1.  å·²å®‰è£…çš„ Node.js
2.  å®‰è£…å¹¶é…ç½® Nginx ä½œä¸º Next.js åº”ç”¨ç¨‹åºè¿è¡Œç«¯å£çš„åå‘ä»£ç†ã€‚æˆ‘çš„æ˜¯`localhost:3000`ï¼Œå› ä¸ºè¿™æ˜¯é»˜è®¤å€¼ã€‚
3.  å®‰è£…äº† PM2 æ¥è¿è¡Œæˆ‘ä»¬çš„ Next.js åº”ç”¨ç¨‹åºï¼Œä½†æ˜¯**æˆ‘ä»¬å°†ç¨åå†åšã€‚**

å¦å¤–ï¼Œ**ä¸è¦ä» Github å…‹éš†**ä½ çš„åº”ç”¨ç¨‹åºã€‚

## 2.é…ç½® Github æ“ä½œå·¥ä½œæµ

åœ¨ Github ä¸Šå¯¼èˆªåˆ°æ‚¨çš„å­˜å‚¨åº“ï¼Œç„¶åç‚¹å‡»â€œActionsâ€é€‰é¡¹å¡ã€‚Github ä¼šå±•ç¤ºä¸€äº›ç›¸å…³çš„å·¥ä½œæµç¨‹ã€‚é€šè¿‡å•å‡»â€œè®¾ç½®æ­¤å·¥ä½œæµâ€é€‰æ‹© Node.js å·¥ä½œæµã€‚

![](img/63e151604670906ef1b6c9de781a2670.png)

ä¸€ä¸ª`.yml`æ–‡ä»¶çš„ç¼–è¾‘å™¨çª—å£å°†ä¼šå‡ºç°ã€‚

![](img/da87d6d87352972bfd1af534b1a74422.png)

ä¹‹å‰:nodejs.yml

è®©æˆ‘ä»¬ç¼–è¾‘è¿™ä¸ªæ–‡ä»¶ã€‚æˆ‘æƒ³**è·³è¿‡æµ‹è¯•**ï¼Œå¹¶æƒ³**ä¸ºæˆ‘ä»¬çš„ Next.js åº”ç”¨ç¨‹åºæ·»åŠ ä¸€ä¸ªæ„å»ºè„šæœ¬**ã€‚åœ¨åº”ç”¨ç¨‹åºæ„å»ºå®Œæˆåï¼Œæˆ‘æƒ³æ·»åŠ ä¸€ä¸ª`pm2 reload`å‘½ä»¤ï¼Œè¿™æ ·æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå°†ä½¿ç”¨æ–°æ„å»ºçš„ç‰ˆæœ¬è¿›è¡Œæ›´æ–°ã€‚æˆ‘è¿˜åˆ é™¤äº†`matrix`ä¸­çš„å¦ä¸€ä¸ª`node-version`ã€‚æˆ‘ä»¬è¿˜æƒ³æŠŠ`runs-on`æ”¹æˆ`self-hosted`ã€‚æˆ‘çš„æœ€ç»ˆç‰ˆæœ¬æ˜¯è¿™æ ·çš„:

ä¹‹å:nodejs.yml

ä¿å­˜è¿™ä¸ªæ–‡ä»¶å¹¶æäº¤åˆ°æ‚¨çš„å­˜å‚¨åº“ä¸­ã€‚

## 3.è®¾ç½®åŠ¨ä½œè¿è¡Œå™¨

è½¬åˆ°å­˜å‚¨åº“çš„è®¾ç½®é€‰é¡¹å¡ï¼Œå¹¶é€‰æ‹©â€œ**æ“ä½œ**â€ã€‚ç‚¹å‡»**æ·»åŠ æµé“**

![](img/722a6fda60449abcba91067132837b58.png)

ç°åœ¨ï¼Œæ‚¨å°†çœ‹åˆ°åœ¨ VPS å®ä¾‹ä¸Šè¿è¡Œ**æ‰€éœ€çš„å‘½ä»¤åˆ—è¡¨ã€‚**

![](img/d821dd3d07ed983d7ae64660735af448.png)

åœ¨æ‚¨çš„å®ä¾‹ä¸Šè¿è¡Œæ‰€æœ‰è¿™äº›å‘½ä»¤ï¼Œæ‚¨å¯ä»¥é€‰æ‹©æ‰€æœ‰çš„é»˜è®¤å€¼ã€‚åœ¨æœ€åä¸€ä¸ªå‘½ä»¤`./run.sh`ä¸­ï¼Œä½ ä¼šåœ¨å‘½ä»¤è¡Œä¸­çœ‹åˆ°æˆ‘ä»¬å·²ç»å¼€å§‹ç›‘å¬ä½ çš„ git æ¨é€ã€‚è®©æˆ‘ä»¬é€šè¿‡æ‰§è¡Œ`Ctrl + C`æ¥æš‚æ—¶**é€€å‡ºè¿™ä¸ªç›‘å¬å™¨**ã€‚

## 4.å¼€å§‹ PM2

ä¸‹ä¸€æ­¥æ˜¯å¼€å§‹ä½ çš„ PM2ã€‚ä½¿ç”¨ Action Runner æ—¶ï¼Œåº”ç”¨ç¨‹åºçš„ç›®å½•å°†è¢«æ”¾ç½®åœ¨ç‰¹å®šçš„æ–‡ä»¶å¤¹ä¸­ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬æ ¹æ®ä¸Šé¢çš„å‘½ä»¤åˆ›å»ºäº†ä¸€ä¸ª`actions-runner`ç›®å½•ã€‚åœ¨è¿™ä¸ªç›®å½•ä¸­ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ª`_work`ç›®å½•ã€‚åœ¨é‡Œé¢ï¼Œæ‚¨ä¼šçœ‹åˆ°ä¸€ä¸ªä»¥æ‚¨çš„å­˜å‚¨åº“å‘½åçš„ç›®å½•ã€‚`cd`è¿›å…¥å…¶ä¸­ï¼Œå†`cd`è¿›å…¥ä½ çœ‹åˆ°çš„å”¯ä¸€ç›®å½•ã€‚é€šå¸¸è¿™ä¸ªç›®å½•ä¹Ÿåƒä½ çš„ä»“åº“ä¸€æ ·å‘½åã€‚åœ¨è¿™ä¸ªç›®å½•ä¸­ï¼Œæ‚¨å°†çœ‹åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºæºä»£ç ã€‚å› æ­¤ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å°†ä½¿ç”¨ PM2 å¯åŠ¨åº”ç”¨ç¨‹åºçš„åœ°æ–¹ã€‚æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªç®€å•çš„å‘½ä»¤å¯åŠ¨åä¸º`next-js`çš„åº”ç”¨ç¨‹åºã€‚

```
pm2 start npm --name "next-js" -- start
```

è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹ã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªä½¿ç”¨ Nginx çš„åå‘ä»£ç†ï¼Œä¸ºæˆ‘ä»¬æ¥è‡ª`localhost:3000`çš„åº”ç”¨æœåŠ¡ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨ PM2 å¯åŠ¨äº†æˆ‘ä»¬çš„åº”ç”¨ï¼Œå¹¶åœ¨`localhost:3000`ä¸Šè¿è¡Œã€‚æ‰€ä»¥ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬çš„ç½‘ç«™æ˜¯æ´»çš„ã€‚

## 5.å°† Action Runner ä½œä¸ºåå°æœåŠ¡è¿è¡Œ

ç°åœ¨ï¼Œå›åˆ°æˆ‘ä»¬çš„`actions-runner`æ–‡ä»¶å¤¹ã€‚è¿™é‡Œä½ ä¼šæ³¨æ„åˆ°ä¸€ä¸ª`./svc.sh`æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶å…è®¸æˆ‘ä»¬åœ¨åå°è¿è¡Œ action runner ä½œä¸ºæœåŠ¡ã€‚æ‚¨éœ€è¦ä»¥`sudo`çš„èº«ä»½è¿è¡Œè¿™ä¸ªæ–‡ä»¶ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬è¿è¡Œå®‰è£…å‘½ä»¤:

```
sudo ./svc.sh install
```

ç„¶åè¿è¡Œ:

```
sudo ./svc.sh start
```

ç°åœ¨ï¼Œæ‚¨çš„ action runner æ­£åœ¨åå°ç›‘å¬æ‚¨å¯¹ git å­˜å‚¨åº“çš„ä»»ä½•æ¨é€ã€‚è¦æ£€æŸ¥è¯¥ä¾¦å¬å™¨çš„çŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤:

```
sudo ./svc.sh status
```

ä½ ä¼šæ³¨æ„åˆ°åœ¨ **Github Repo >è®¾ç½®>åŠ¨ä½œæ ‡ç­¾**ä¸­ï¼Œæœ‰ä¸€ä¸ªè·‘æ­¥è€…åœ¨è·‘:

![](img/2eb27346b48263a858b78013ca8dcdae.png)

å°±æ˜¯è¿™æ ·ï¼ç°åœ¨ï¼Œå¯¹æ‚¨çš„ä»£ç è¿›è¡Œä»»ä½•æ›´æ”¹ï¼Œå¹¶æ¨é€è‡³ä¸»åˆ†æ”¯ï¼Œåœ¨æœåŠ¡å™¨ä¸­æŸ¥çœ‹æ‚¨çš„ä»£ç æ›´æ”¹ã€‚æ²¡æœ‰ç½‘ç»œæŒ‚é’©ï¼Œæˆ–æ‰‹åŠ¨éƒ¨ç½²ã€‚å°±æ˜¯ç®¡ç”¨ï¼âœ¨

å¦‚æœä½ æƒ³çœ‹å…³äºå¦‚ä½•è®¾ç½®å…ˆå†³æ¡ä»¶çš„æ›´è¯¦ç»†çš„æ•™ç¨‹ï¼Œè¯·ç•™ä¸‹è¯„è®ºã€‚ğŸ™

æŸ¥çœ‹æˆ‘åœ¨ Medium ä¸Šçš„å…¶ä»– Next.js æ–‡ç« :

[](https://medium.com/javascript-in-plain-english/next-js-where-have-you-been-all-my-life-1dedba2d2431) [## next . jsâ€”â€”æˆ‘è¿™è¾ˆå­ä½ éƒ½å»å“ªäº†ï¼Ÿ

### Next.js å¦‚ä½•è®©æˆ‘åœ¨ç”Ÿäº§ä¸­ç¼–å†™ Reactã€‚

medium.com](https://medium.com/javascript-in-plain-english/next-js-where-have-you-been-all-my-life-1dedba2d2431) [](/one-domain-multiple-next-js-apps-5e39b0ffa1bf) [## ä¸€ä¸ªåŸŸâ€”å¤šä¸ª Next.js åº”ç”¨ç¨‹åº

### å…³äºå¦‚ä½•ä½¿ç”¨ Nginx åœ¨ä¸€ä¸ªåŸŸä¸Šä½¿ç”¨å­ç›®å½•æœåŠ¡å¤šä¸ª Next.js åº”ç”¨ç¨‹åºçš„å¿«é€Ÿæ•™ç¨‹ã€‚

itnext.io](/one-domain-multiple-next-js-apps-5e39b0ffa1bf)