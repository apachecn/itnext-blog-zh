# ä½¿ç”¨ Flutter è¿›è¡Œè·¨å¹³å°æ–‡ä»¶ä¸‹è½½

> åŸæ–‡ï¼š<https://itnext.io/cross-platform-file-downloads-using-flutter-6723d40ee730?source=collection_archive---------0----------------------->

![](img/be0c3c2ff1f854adb22bfdc67bcbb894.png)

æ¥æº:Unsplash | [é“¾æ¥](https://images.unsplash.com/photo-1544396821-4dd40b938ad3?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=873&q=80)

# ä»‹ç»

å—¨ï¼Œåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘æƒ³åˆ†äº«ä¸€ä¸ªæˆ‘ä»¥å‰æ²¡æœ‰æ‰¾åˆ°çš„å…³äºä½¿ç”¨ Flutter ä¸‹è½½æ–‡ä»¶çš„è§£å†³æ–¹æ¡ˆã€‚å¯¹äºæ¯ä¸ªç‰¹å®šçš„å¹³å°ï¼Œè¿™ä¸ªé—®é¢˜å·²ç»è§£å†³äº†ï¼Œä½†æ˜¯å¯¹äºè·¨å¹³å°åº”ç”¨ç¨‹åº(åŒ…æ‹¬ web)è¿˜æ²¡æœ‰ä¸€ä¸ªæ ‡å‡†çš„è§£å†³æ–¹æ¡ˆã€‚

è¿™å¯¹äºåœ¨ç§»åŠ¨è®¾å¤‡å’Œç½‘ç»œä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åºå°¤å…¶é‡è¦ã€‚ç”±äºæ¯ä¸€ä¸ªå¹³å°çš„ç¯å¢ƒå’Œç¡¬ä»¶éƒ½ä¸åŒï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªé€šç”¨çš„ flutter å®ç°ï¼Œå®ƒä¸ºæ‰€æœ‰å¹³å°æŠ½è±¡å‡ºç›¸åŒçš„åŠŸèƒ½ï¼Œå¹¶åœ¨å¹•åå®šåˆ¶å®ç°ã€‚

# å®šä¹‰é—®é¢˜

ç°åœ¨ä¸ºäº†æ›´å¥½åœ°ç†è§£æˆ‘ä»¬æƒ³è¦åšä»€ä¹ˆï¼Œè®©æˆ‘ä»¬å®šä¹‰ä»€ä¹ˆæ˜¯**å‰ææ¡ä»¶**å’Œ**é¢„æœŸè¡Œä¸º**ã€‚

ä½œä¸ºå…ˆå†³æ¡ä»¶ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªè¿è¡Œåœ¨ Androidã€iOS å’Œ web ä¸Šçš„ Flutter åº”ç”¨ç¨‹åºï¼Œä¸€ä¸ªæŒ‡å‘æœåŠ¡å™¨ä¸Šæ‰˜ç®¡çš„æ–‡ä»¶(åœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯ PDF)çš„ URLã€‚

Android å’Œ iOS çš„**é¢„æœŸè¡Œä¸º**æ˜¯å°†æ–‡ä»¶å­˜å‚¨åœ¨æ‰‹æœºæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå¹¶åœ¨æ‰‹æœºçš„çŠ¶æ€æ ä¸­æ˜¾ç¤ºç»“æœï¼Œåœ¨ web åº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›ä»¥å¸¸è§„æµè§ˆå™¨ä¸‹è½½çš„æ–¹å¼ä¸‹è½½æ–‡ä»¶ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†æ‰“å¼€æµè§ˆå™¨é€‰é¡¹å¡å¹¶æ˜¾ç¤º PDF æ–‡ä»¶ã€‚

# å®ç”¨è§£å†³æ–¹æ¡ˆ:DownloadButton å°éƒ¨ä»¶

ç”±äº(å‡ ä¹)Flutter ä¸­çš„æ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯ä¸€ä¸ªå°éƒ¨ä»¶ï¼Œæˆ‘è®¤ä¸ºè¿™ä¸ä¼šæ˜¯ä¾‹å¤–ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªä¸‹è½½æ–‡ä»¶çš„è‡ªå®šä¹‰æŒ‰é’®ï¼Œè¯¥å°éƒ¨ä»¶åªæ¥æ”¶æˆ‘ä»¬æƒ³è¦æ‰§è¡Œä¸‹è½½çš„ URLï¼Œå®ƒåº”è¯¥åšæ‰€æœ‰çš„å·¥ä½œã€‚

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„ Flutter åº”ç”¨ç¨‹åºï¼Œåœ¨æ”¯æ¶ä¸»ä½“çš„ä¸­å¿ƒåªæœ‰ä¸€ä¸ªæŒ‰é’®ã€‚

ä¸ºäº†å°†å®ç°æ”¾å…¥æŒ‰é’®ä¸­ï¼Œè®©æˆ‘ä»¬ä¸ºæŒ‰é’®åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚

## æ·»åŠ å¿…éœ€çš„ä¾èµ–é¡¹

ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›æ–¹ä¾¿çš„ä¾èµ–é¡¹æ¥è®¿é—®æ–‡ä»¶ç³»ç»Ÿã€æŸ¥æ‰¾ç›®å½•è·¯å¾„å’Œè¯·æ±‚æƒé™ç­‰ã€‚

ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†å‘ pubspec.yaml æ·»åŠ ä»¥ä¸‹åŒ…

> **æ³¨æ„**:æ£€æŸ¥ä¾èµ–ç‰ˆæœ¬ã€‚
> 
> **æ³¨æ„#2:** æŸ¥çœ‹ [permission_handler è®¾ç½®æŒ‡å—](https://pub.dev/packages/permission_handler)åœ¨ç»§ç»­ä¹‹å‰ï¼Œæ‚¨éœ€è¦ä¸º iOS å’Œ Android é…ç½®è®¾ç½®ä¸€äº›æƒé™ã€‚

`**path_provider**`:å¯¹äºç§»åŠ¨å®ç°ï¼Œæ‚¨éœ€è¦è®¿é—®åº”ç”¨æ–‡æ¡£ç›®å½•ï¼Œ`path_provider`åŒ…ä¸ºå…¶æä¾›äº†ä¸€ä¸ªç®€å•çš„åŠŸèƒ½ã€‚

`**dio**`:ç”¨äºæ‰§è¡Œä¸‹è½½çš„ä¾¿æ·åŒ…ï¼Œæ— éœ€æ‹…å¿ƒåº•å±‚å®ç°(åœ¨å¤§æ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œå®ƒè¿˜æä¾›ä¸‹è½½è¿›åº¦å›è°ƒ)ã€‚

`**permissin_handler**` **:** æ­¤åº“ç”¨äºä¸‹è½½å‰è¦æ±‚ Android/iOS æƒé™ã€‚

`**open_file**` **:** ç”¨äºç›´æ¥ä»åº”ç”¨ç¨‹åºä¸­æ‰“å¼€ä¸‹è½½çš„æ–‡ä»¶ã€‚

`**universal_html**`:è¿™å¯¹äºé¿å…å…¼å®¹æ€§é—®é¢˜å°¤ä¸ºé‡è¦ã€‚ç”±äºæ‰‹æœºåº”ç”¨ç¨‹åºä¸æ”¯æŒ`dart:html`åŒ…ã€‚

## æŒ‰å¹³å°åˆ†ç¦»å®ç°

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨å¹³å° APIï¼Œå› ä¸ºå®ƒåœ¨ Flutter Web ä¸Šä¸å—æ”¯æŒï¼Œä½†å¹¸è¿çš„æ˜¯ï¼ŒFlutter å›¢é˜Ÿæä¾›äº†ä¸€ä¸ªå¸¸é‡æ¥æ£€æµ‹åº”ç”¨ç¨‹åºæ˜¯å¦æ˜¯ Webã€‚

ä¸ºäº†ä½¿å®ƒå˜å¾—æ¸…æ™°ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæŠ½è±¡æœåŠ¡ï¼Œå®ƒæ ¹æ®å¹³å°é‡‡å–ä¸åŒçš„å®ç°ã€‚

## é¢¤æŒ¯ç½‘ç»œå®ç°

è®©æˆ‘ä»¬ä»æœ€ç®€å•çš„éƒ¨åˆ†å¼€å§‹ï¼Œweb è§£å†³æ–¹æ¡ˆã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åªéœ€è¦æ‰“å¼€ä¸€ä¸ªæŒ‡å‘æ‰€æä¾›çš„ URL çš„æ–°æµè§ˆå™¨é€‰é¡¹å¡ï¼Œæµè§ˆå™¨å°±ä¼šå®Œæˆå‰©ä¸‹çš„å·¥ä½œã€‚å¬èµ·æ¥å¾ˆç®€å•ï¼Œå¯¹å—ï¼Ÿè®©æˆ‘ä»¬çœ‹çœ‹ä»£ç ã€‚

æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œè¿™éå¸¸ç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥è®©æµè§ˆå™¨é€šè¿‡æ‰“å¼€ä¸€ä¸ªå¸¦æœ‰ URL çš„æ–°æ ‡ç­¾æ¥å®Œæˆæ‰€æœ‰çš„å·¥ä½œã€‚

## Flutter ç§»åŠ¨å®ç°

ä¸å¹¸çš„æ˜¯ï¼Œåœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œè§£å†³æ–¹æ¡ˆå¹¶ä¸ç®€å•æ˜äº†ã€‚ä¸ºäº†æ­£ç¡®å¤„ç†ä¸‹è½½ï¼Œæˆ‘ä»¬å¿…é¡»åšæ›´å¤šçš„å¾®è§‚ç®¡ç†ã€‚

æˆ‘ä»¬åº”è¯¥æ³¨æ„æ–‡ä»¶ç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºçš„æƒé™ï¼Œä»¥å®ç°è®¿é—®ã€‚æ‰€ä»¥å®ƒéœ€è¦ä¸€äº›é¢å¤–çš„é…ç½®ã€‚

# æŠŠæ‰€æœ‰çš„æ”¾åœ¨ä¸€èµ·

ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹ä¸‹è½½æŒ‰é’®å°éƒ¨ä»¶å¦‚ä½•æ­£ç¡®ä¸‹è½½æ–‡ä»¶ã€‚

> **æ³¨æ„**:ç°åœ¨ä¸‹è½½æŒ‰é’®æœ‰äº†ä¸€ä¸ªå¿…éœ€çš„å‚æ•°`url`ï¼Œå®ƒå°†ç”±çˆ¶å°éƒ¨ä»¶(åœ¨æœ¬ä¾‹ä¸­æ˜¯ä¸»é¡µ)æä¾›ã€‚

# ç»“æœ

è®©æˆ‘ä»¬åœ¨ç§»åŠ¨å’Œç½‘ç»œä¸­æµ‹è¯•åº”ç”¨ç¨‹åºï¼Œçœ‹çœ‹ç»“æœå¦‚ä½•ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ª[è™šæ‹Ÿ pdf](https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf) ä½œä¸ºè¾“å…¥ã€‚

![](img/b3a647ff1a900fcf2bb64bf9c30a175e.png)

Web ç¤ºä¾‹

![](img/d2a9c1355c8327557ea3f885c5fd20e2.png)

ç§»åŠ¨ç¤ºä¾‹

# ç»“è®º

Flutter å¾ˆæ£’ï¼Œä½†ä»å¤„äºæˆé•¿è¿‡ç¨‹ä¸­ï¼Œå¹¶åœ¨ä¸ºå¸¸è§åœºæ™¯å¯»æ‰¾æ ‡å‡†è§£å†³æ–¹æ¡ˆï¼Œå°±åƒæœ¬æ–‡ä¸­æè¿°çš„é‚£æ ·ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œå®ƒè¿˜æ˜¯å¸¦æ¥äº†è§£å†³é—®é¢˜çš„å¼ºå¤§åŠŸèƒ½å’Œçµæ´»æ€§ï¼Œwidgets æ–¹æ³•ä½¿å¾—åœ¨ä¸–ç•Œå„åœ°çš„å¼€å‘äººå‘˜ä¹‹é—´æ‰©å±•å’Œå…±äº«è§£å†³æ–¹æ¡ˆå˜å¾—å®¹æ˜“ï¼Œè¿™éå¸¸å¥½ï¼Œå°¤å…¶æ˜¯å¯¹äºå¼€æºç¤¾åŒºã€‚

æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œå¦‚æœä½ å‘ç°ä¸€äº›å¯ä»¥æ”¹è¿›çš„åœ°æ–¹æˆ–ä»»ä½•å»ºè®®ï¼Œè¯·åœ¨è¯„è®ºä¸­å‘Šè¯‰æˆ‘ï¼Œå¦‚æœä½ æ­£åœ¨é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼Œéå¸¸æ„Ÿè°¢ä½ çš„æ—¶é—´ã€‚ğŸ˜Š

> ä½ å¯ä»¥ä½¿ç”¨[è¿™ä¸ªé“¾æ¥](https://github.com/MCarlomagno/flutter_download_button)è·å¾—å®Œæ•´çš„ä»£ç 