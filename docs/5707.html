<html>
<head>
<title>Deploy Cloud Run for Nodejs Projects in Nx Workspace</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åœ¨Nxå·¥ä½œåŒºä¸­éƒ¨ç½²Nodejsé¡¹ç›®çš„äº‘è¿è¡Œ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/deploy-cloud-run-for-nodejs-projects-in-nx-workspace-ac1611f17f4e?source=collection_archive---------3-----------------------#2021-05-07">https://itnext.io/deploy-cloud-run-for-nodejs-projects-in-nx-workspace-ac1611f17f4e?source=collection_archive---------3-----------------------#2021-05-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d1be67f08267d763aa97be8b483b1843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*u0Jy7-K0if9UuUH-"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/photos/4RCvKbu_kcY" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/4RCvKbu_kcY</a></figcaption></figure><blockquote class="kd ke kf"><p id="3f3c" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kj ir"> Nx </strong>æ˜¯ä¸€å¥—å¼ºå¤§çš„å¯æ‰©å±•å¼€å‘å·¥å…·ï¼Œå¯å¸®åŠ©æ‚¨è®¾è®¡ã€æµ‹è¯•å’Œæ„å»ºä»»ä½•è§„æ¨¡çš„è½¯ä»¶â€”â€”ä¸ç°ä»£æŠ€æœ¯å’Œåº“æ— ç¼é›†æˆï¼ŒåŒæ—¶æä¾›å¼ºå¤§çš„CLIã€ç¼“å­˜ã€ä¾èµ–ç®¡ç†ç­‰åŠŸèƒ½ã€‚</p></blockquote><p id="688c" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">æˆ‘æ­£è®¡åˆ’å¼€å‘å¤šä¸ª<a class="ae kc" href="https://cloud.google.com/run" rel="noopener ugc nofollow" target="_blank">äº‘è¿è¡Œ</a>é¡¹ç›®ï¼Œä¹Ÿæƒ³åˆ©ç”¨monorepoå…±äº«åº“&amp;æœåŠ¡ã€‚</p><p id="64cc" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">è¿™ç§é›†æˆçš„æ–‡æ¡£å¾ˆéš¾æ‰¾åˆ°ï¼Œå³ä½¿æ‚¨å°è¯•Googleä¸€ä¸‹ã€‚å› æ­¤ï¼Œæˆ‘åœ¨è¿™é‡Œï¼Œè¯•å›¾è®©å®ƒå‘ç”Ÿã€‚è¿™æ˜¯ç¬¬ä¸€æ­¥ï¼Œè¿˜æœ‰æ”¹è¿›æµç¨‹çš„ç©ºé—´ã€‚</p><p id="c4be" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><strong class="kj ir">åœ¨Nxä¸­åˆ›å»ºä¸€ä¸ªExpressèŠ‚ç‚¹é¡¹ç›®</strong></p><p id="bb06" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">å»ºç«‹ä¸€ä¸ªNxå·¥ä½œç©ºé—´</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="2844" class="lr ls iq ln b gy lt lu l lv lw">npx create-nx-workspace myworkspace --preset=empty</span></pre><p id="1930" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><strong class="kj ir">åˆ›å»ºå¿«é€’èŠ‚ç‚¹é¡¹ç›®</strong></p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="2903" class="lr ls iq ln b gy lt lu l lv lw">yarn add -D @nrwl/express</span><span id="9ec9" class="lr ls iq ln b gy lx lu l lv lw">nx generate @nrwl/express:application &lt;express-app&gt;</span></pre><p id="323c" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><strong class="kj ir">è®¾ç½®æœ¬åœ°äº‘è¿è¡Œ</strong></p><p id="e921" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">æˆ‘ä½¿ç”¨çš„<a class="ae kc" href="https://cloud.google.com/code/docs/vscode/quickstart-cloud-run#installing_cloud_code" rel="noopener ugc nofollow" target="_blank">äº‘ä»£ç </a>æ˜¯ä¸€ä¸ªæ’ä»¶ï¼Œæ”¯æŒäº‘è¿è¡Œ&amp; Kubernetesçš„æœ¬åœ°å¼€å‘&amp;éƒ¨ç½²ã€‚</p><p id="6cbf" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><strong class="kj ir">å‡†å¤‡Dockerfile &amp; Vscodeè®¾ç½®</strong></p><p id="5cd4" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">å¯¹äºNx Workspaceä¸­çš„ä¸åŒé¡¹ç›®ï¼Œæˆ‘ä½¿ç”¨ä»¥ä¸‹å‘½åçº¦å®šã€‚</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="79dc" class="lr ls iq ln b gy lt lu l lv lw"># Dockerfile.api - for api project</span><span id="a70d" class="lr ls iq ln b gy lx lu l lv lw"># Use the official lightweight Node.js 14 image.<br/>FROM node:14-slim</span><span id="a153" class="lr ls iq ln b gy lx lu l lv lw"># Create and change to the app directory.<br/>WORKDIR /usr/src/app</span><span id="7c32" class="lr ls iq ln b gy lx lu l lv lw"># Copy application dependency manifests to the container image.<br/>COPY package*.json ./<br/>COPY yarn.lock ./<br/>COPY decorate-angular-cli.js ./</span><span id="1560" class="lr ls iq ln b gy lx lu l lv lw"># Install dependencies.<br/>RUN yarn</span><span id="c191" class="lr ls iq ln b gy lx lu l lv lw"># Copy local code to the container image.<br/>COPY . ./</span><span id="2c0c" class="lr ls iq ln b gy lx lu l lv lw"># Build the app<br/>RUN yarn build:api --production</span><span id="f01a" class="lr ls iq ln b gy lx lu l lv lw"># Run the web service on container startup.<br/>CMD ["node", "./dist/apps/api/main.js"]</span></pre><p id="e22a" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">è€Œå¯¹äº<strong class="kj ir">ã€‚vscode/launch.json </strong></p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="425d" class="lr ls iq ln b gy lt lu l lv lw">{<br/>  "configurations": [<br/>    {<br/>      "name": "Cloud Run: Run/Debug Locally - API",<br/>      "type": "cloudcode.cloudrun",<br/>      "request": "launch",<br/>      "build": {<br/>        "docker": {<br/>          "path": "Dockerfile.api"<br/>        }<br/>      },<br/>      "image": "workspace-name",<br/>      "service": {<br/>        "name": "workspace-name",<br/>        "containerPort": 8080,<br/>        "resources": {<br/>          "limits": {<br/>            "memory": "256Mi"<br/>          }<br/>        }<br/>      },<br/>      "target": {<br/>        "minikube": {}<br/>      },<br/>      "watch": true<br/>    },<br/>    {<br/>      "name": "Cloud Run: Run/Debug Locally - Web",<br/>      ......<br/>    }<br/>  ]<br/>}</span></pre><p id="ee41" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">æœ‰äº†è¿™ä¸ªè®¾ç½®ï¼Œæ¯æ¬¡åœ¨æœ¬åœ°è¿è¡Œæˆ–éƒ¨ç½²æ—¶ï¼Œæ‚¨éƒ½ä¼šçœ‹åˆ°ä½¿ç”¨å“ªä¸ªdockeræ–‡ä»¶çš„é€‰é¡¹ã€‚</p><figure class="li lj lk ll gt jr gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/a861a43dd106c99440f1adecedc28682.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*D1ltpLEtvShyOCvd6M3IEQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">æœ¬åœ°é€‰é¡¹</figcaption></figure><figure class="li lj lk ll gt jr gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/2cf275f983fbd0dd279d20bcf4b2d21e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*JWSzSlsHYEH1ccgbUIe0LA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">éƒ¨ç½²é€‰é¡¹</figcaption></figure><p id="8fd5" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">ä¹‹åï¼Œæ‚¨å·²ç»ä¸ºNx Workspaceä¸­çš„æœ¬åœ°äº‘è¿è¡Œå¼€å‘åšå¥½äº†ä¸€åˆ‡å‡†å¤‡ã€‚</p><figure class="li lj lk ll gt jr gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/bd76874a267a24dfd9fc110b17592505.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*32FsZFrVtiuWwvppDfrrlg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">äº‘è¿è¡Œæ­£åœ¨localhost:8080ä¸Šè¿è¡Œ</figcaption></figure><p id="af56" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">è¿™æ˜¯æˆ‘çš„å®éªŒï¼Œå¦‚æœä½ æœ‰æ›´å¥½çš„é€‰æ‹©ï¼Œè¯·å¸®åŠ©æ”¹è¿›å®ƒğŸ™</p></div></div>    
</body>
</html>