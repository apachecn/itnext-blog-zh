# ä» stuff.kt åˆ°å»ºç­‘

> åŸæ–‡ï¼š<https://itnext.io/from-stuff-kt-to-architecture-905426799dae?source=collection_archive---------5----------------------->

å¦‚ä½•é‡å†™ä½ çš„å…¨åŠŸèƒ½åŸå‹ï¼Œå¢åŠ  20 ä¸ªæ–‡ä»¶çš„æ•°é‡ï¼Œåœæ­¢æ‹…å¿ƒã€‚

è¿™æ˜¯å…³äºæˆ‘çš„ä¹¦ç±æ¸²æŸ“ ar å®éªŒçš„ç¬¬ä¸‰ç¯‡æ–‡ç« ï¼Œæˆ‘ç®€è¦è®°å½•äº†ä¸€äº›æ¶æ„å†³ç­–å¹¶å±•ç¤ºäº†é¡¹ç›®è¿›å±•ã€‚

1.  [ä½¿ç”¨ Kotlin ä» Android è¯»å– API](https://medium.com/@intmainreturn00/goodreads-api-from-android-with-kotlin-fd8c2c7338d8)
2.  [æˆ‘æ‰€æœ‰çš„ä¹¦éƒ½åœ¨ AR](https://medium.com/@intmainreturn00/all-my-books-in-ar-c4d740a3ecbb)
3.  ä» stuff.kt åˆ°å»ºç­‘ã€ä½ æ¥äº†ï¼]

android åº”ç”¨ç¨‹åºæ¶æ„çš„è¯é¢˜æå…·äº‰è®®æ€§ï¼Œäº‰è®ºæ¿€çƒˆã€‚æœ€è¿‘ï¼Œåœ¨è°·æ­Œå‘å¸ƒæ¶æ„ç»„ä»¶åï¼Œæ–°ä¸€è½®çš„è®¨è®ºå·²ç»åˆ°æ¥ã€‚ç»è¿‡ 10 å¹´çš„ä»£ç ç¼–å†™ï¼Œæˆ‘ä»¬æ”¶åˆ°äº†æŒ‡å—ï¼Œå½“ç„¶ï¼Œè¿™å¼•å‘äº†æ–°ä¸€è½®çš„è®¨è®ºã€‚

ä»¥ä¸‹æ‰€æœ‰å†…å®¹éƒ½åº”è¢«è§†ä¸ºæˆ‘ä¸ªäºº 8 å¹´ç»éªŒçš„æµ…è§ï¼Œæ— æ„è®©ä»»ä½•äººéš¾è¿‡æˆ–ç”Ÿæ°”ã€‚

# åŸå‹

æˆ‘ä»ä¸Šä¸€ç¯‡æ–‡ç« ç¦»å¼€çš„åœ°æ–¹å¼€å§‹([æ•™ç¨‹åˆ†æ”¯](https://github.com/intmainreturn00/Bookar/tree/tutorial))ã€‚æˆ‘ä»¬åœ¨ AR ä¸­åˆ¶ä½œäº†ä¸€ä¸ªåŸå‹ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹ç»“æ„:

![](img/d37845964bd7f587b1a6c7b3208ea30f.png)

è®¸å¤šå¯èƒ½æ˜¯ç”±äºæ˜æ˜¾ç¼ºå°‘å¹²å‡€çš„å›¾å±‚ï¼Œç”šè‡³æ˜¯ MVVM å’Œè§†å›¾æ¨¡å‹è€Œè§¦å‘çš„ã€‚ä½†è¿™æ˜¯æˆ‘åœ¨å¤§å¤šæ•°åŸå‹ä¸­æœ‰æ„è¯†çš„æ„å›¾â€”â€”å½“ä½ å¯¹ä½ çš„åº”ç”¨ä¸€æ— æ‰€çŸ¥æ—¶ï¼Œä¸è¦æ„å»ºä¸€ä¸ªæ¶æ„ã€‚è¿™æ˜¯æ¢ç´¢è¿™ä¸ªæƒ³æ³•çš„é˜¶æ®µ:ARCore æ˜¯å¦ä¼šå…è®¸æ¸²æŸ“è¿™æ ·çš„ä¹¦ï¼Œæˆ–è€…å®ƒä¼šå¾ˆæ…¢è€Œä¸”æœ‰é—®é¢˜ï¼Ÿè¿™æ˜¯å­¦ä¹  AR å’Œå°è¯• AR çš„é˜¶æ®µï¼Œå­¦ä¹ åº”è¯¥æ˜¯æœ‰è¶£å’Œä¸“æ³¨çš„ã€‚æˆ‘å¯ä»¥å¾ˆå®¹æ˜“åœ°æ”¹å˜è¿™ä¸ªä¾‹å­ä¸­çš„ä»»ä½•ä¸œè¥¿ï¼Œå› ä¸ºå®ƒè¿˜æ²¡æœ‰ç»“æ„ã€‚å®ƒæ²¡æœ‰ä¸€ä¸ªç»“æ„ï¼Œå› ä¸ºæˆ‘è¿˜ä¸çŸ¥é“å®ƒåº”è¯¥åšä»€ä¹ˆã€‚

> ğŸ§˜â€â™€ï¸:è®©åŸå‹å°½å¯èƒ½ç®€å•ï¼Œä½ å°±èƒ½è·å¾—å¤§éƒ¨åˆ†ä¹è¶£ã€‚ä¸è¦è¢«å¹²å‡€æ¿€æ€’â€”â€”ä½ æ­£åœ¨å¼€å‘ä½ çš„åŸå‹ï¼Œè€Œä¸æ˜¯æœ€å¥½çš„é€šç”¨æ¶æ„ã€‚

# æˆ‘ä»¬åˆ°åº•éœ€è¦å¤šå°‘å°–å«ï¼Ÿ

æˆ‘çš„[æ¶æ„å°–å«](https://blog.cleancoder.com/uncle-bob/2011/09/30/Screaming-Architecture.html)æ˜¯ä¸ºäº†ä»€ä¹ˆï¼Ÿä»ä¸Šé¢çš„æ–¹æ¡ˆæ¥çœ‹ï¼Œä¼¼ä¹æˆ‘çš„åº”ç”¨ç¨‹åºæ­£åœ¨æŸä¸ªåœ°æ–¹ç™»å½•ï¼Œå¹¶åœ¨ AR ä¸­åšä¸€äº›äº‹æƒ…ã€‚è€Œè¿™æ­£æ˜¯æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ï¼å¦‚æœæˆ‘æœ‰ç±»ä¼¼äº[å’Œ](https://github.com/android10/Android-CleanArchitecture)çš„ä¸œè¥¿ï¼Œä¼šä¸ä¼šæ›´å¥½ï¼Ÿ

![](img/9a011e9a268786c7524ee9602a6bced9.png)

è¿™å°–å«å¤Ÿäº†å—ï¼Ÿè¿™ä¸ªç¤ºä¾‹æ˜¾ç¤ºäº†ç”¨æˆ·å’Œç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ï¼Œä½†æ˜¯å®ƒåŒ…å«äº†è¶³å¤Ÿæ§åˆ¶ä¸€æ¬¡å°å‹å¯¼å¼¹å‘å°„çš„ä½“ç³»ç»“æ„å‚¨å¤‡ã€‚æˆ‘åœ¨åŸå‹é˜¶æ®µéœ€è¦å®ƒå—ï¼Ÿæˆ‘æƒ³ä¸ä¼šã€‚å¦‚æœæˆ‘éœ€è¦èŠ±å‡ åˆ†é’Ÿéå†æ–‡ä»¶å¤¹æ¥æ‰¾å‡ºé‚£ä¸ªä¸œè¥¿æ˜¯åšä»€ä¹ˆçš„â€”â€”å®ƒä¸ä¼šå°–å«ã€‚ä½†æ˜¯è®©æˆ‘ä»¬çœ‹çœ‹ï¼Œå½“é¡¹ç›®å¼€å§‹å‘å±•æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚

> ğŸ§˜â€â™€ï¸å¤ªå¤šçš„å»ºç­‘å™ªéŸ³ä¼šè®©ä½ å¤´ç–¼ã€‚

# ç”¨æˆ·ç•Œé¢å’Œå¯¼èˆªç»„ä»¶

å†æ¥åŠ ç‚¹ UI å§ï¼

![](img/da1fd6ac4d3abca914077bb79bd5bf5d.png)

ç§»åŠ¨åº”ç”¨çš„ç”¨æˆ·ç•Œé¢é€šå¸¸ä¼šå®£å¸ƒä½ å¼€å§‹ä½¿ç”¨ç”¨ä¾‹çš„é˜¶æ®µã€‚Simon å…³äº Clean æœ‰ä¸€ä¸ªå¾ˆå¥½çš„è§‚ç‚¹â€”â€”åƒ web æˆ– mobile [è¿™æ ·çš„â€œçƒ¦äººçš„äº¤ä»˜æœºåˆ¶â€å¯èƒ½ä¼šéå¸¸å¤§](http://www.codingthearchitecture.com/2011/11/06/the_delivery_mechanism_is_an_annoying_detail.html)ã€‚æˆ‘éå¸¸åŒæ„ã€‚

å½“ä½ ç¬¬ä¸€æ¬¡æ‰“å¼€æŸä¸ªä¸çŸ¥åçš„ appï¼Œä½ æƒ³æŠ“ä½é‚£ä¸ªä¸œè¥¿æ˜¯åšä»€ä¹ˆçš„æ—¶å€™ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿä¸€å¼€å§‹ä½ çœŸçš„å…³æ³¨å®ä½“å—(æ¯”å¦‚ç”¨æˆ·æ•°æ®ç±»æˆ–è€… DefaultObserverInterface)ï¼Ÿæˆ‘çœ‹ç€å±å¹•ã€‚å› ä¸ºè¿™é€šå¸¸æ¯”ä»»ä½•å…¶ä»–éƒ¨åˆ†éƒ½æ›´èƒ½ä½“ç°ç”¨ä¾‹ã€‚è‡ªä»[å¯¼èˆªç»„ä»¶](https://developer.android.com/guide/navigation/navigation-getting-started)ä»¥æ¥ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·

![](img/62f92dc0b5533bdf8e23353106a18503.png)

> ğŸ§˜â€â™€ï¸å¯¼èˆªå›¾ç»™ä½ å¾ˆå¤§çš„åº”ç”¨åœ°å›¾ã€‚

è¿™ä»ç„¶æ˜¯ä¸€ä¸ªæ—©æœŸç‰ˆæœ¬ï¼Œå®ƒæœ‰ä¸€äº›æ·±å±‚é“¾æ¥çš„é—®é¢˜ï¼Œä½†ä¼˜åŠ¿å¤ªè¯±äººï¼Œä¸å®¹å¿½è§†ã€‚

# æ·»åŠ ä¸€äº›é€»è¾‘

ä¸ºäº†åœ¨æ¶æ„ä¸Šåšæ›´å¤šçš„å·¥ä½œï¼Œè®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæ–°çš„ç‰¹æ€§â€”ä¸€ä¸ªæ–°çš„å›¾ä¹¦æ”¾ç½®(åˆ†é…)ã€‚æˆ‘çš„çµæ„Ÿæ¥è‡ªè‘—åçš„ç›æ ¼ä¸½ç‰¹Â·å“ˆç±³å°”é¡¿ç…§ç‰‡:

![](img/4106fd73ec7ea7d898c5fe07ffae58da.png)

æ‚¨å¯ä»¥åœ¨ google play åˆ¶ä½œè‡ªå·±çš„ç…§ç‰‡=)

æ‰€ä»¥ç°åœ¨æˆ‘ä»¬å¼€å§‹äº†è§£æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ˜¯å…³äºä»€ä¹ˆçš„ã€‚ä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°æƒ³è±¡æœªæ¥æˆ‘ä»¬å¯ä»¥æ·»åŠ ä»€ä¹ˆã€‚ç°åœ¨æ˜¯æ—¶å€™æ·»åŠ ä¸€äº›æ¶æ„äº†ã€‚

> ğŸ§˜â€â™€ï¸åªæœ‰å½“ä½ åšäº†ä¸€äº›é€»è¾‘å·¥ä½œï¼Œå¹¶ä¸”å¯ä»¥é¢„æµ‹ä½ çš„åº”ç”¨ç¨‹åºåœ¨å‡ æ¬¡è¿­ä»£åä¼šæ˜¯ä»€ä¹ˆæ ·å­çš„æ—¶å€™ï¼Œä½ æ‰å¯ä»¥å¼€å§‹ç»˜åˆ¶å®ä½“å’Œå±‚ã€‚

# æ¸…æ´å’Œ MVVM

è®©æˆ‘ä»¬æ¥çœ‹çœ‹è°·æ­Œ[å»ºç­‘æŒ‡å—](https://developer.android.com/jetpack/docs/guide)å’Œå¹¶æ’æ¸…ç†:

![](img/cd63730dc72985b6766f9d9ef11cb58b.png)

å¹¶å°½åŠ›å°†è¿™ä¸¤ä¸ªæŒ‡å—åˆå¹¶ï¼Œçœ‹çœ‹æˆ‘ä»¬ä¼šå¾—åˆ°ä»€ä¹ˆã€‚åœ¨æˆ‘çš„ä¾‹å­ä¸­ï¼Œæˆ‘å°†ä»¥è¿™ä¸ªç»“å°¾:

![](img/a8ef35f676182cf4d982188045891452.png)![](img/c88fdbe0f82a6d4bc1e8b08a41d3d5d5.png)

> ğŸ§˜â€â™€ï¸Â·è°·æ­Œçš„æŒ‡å—å…³æ³¨æœ€å¤–å±‚çš„å¹²å‡€å±‚ï¼Œå®ƒæŠŠå®ä½“å’Œç”¨ä¾‹ç•™ç»™äº†å¼€å‘è€…ã€‚

å¦‚æœæ‚¨å’Œæˆ‘ä¸€æ ·ï¼Œå¯¹æ‚¨çš„â€œä¼ä¸šä¸šåŠ¡è§„åˆ™â€(å®šä¹‰å®ä½“çš„ç®€æ˜å»ºè®®)æ„Ÿåˆ°å›°æƒ‘ï¼Œæ‚¨å¯ä»¥å°è¯•ä½¿ç”¨ä»¥ä¸‹è§„åˆ™:

> ğŸ§˜â€â™€ï¸è‰¯å¥½çš„å®ä½“å’Œç”¨ä¾‹å±‚åº”è¯¥å…è®¸åœ¨è·¨å¹³å°è§£å†³æ–¹æ¡ˆä¸­é‡ç”¨å®ƒã€‚æ‚¨åº”è¯¥èƒ½å¤Ÿåœ¨ iOS åº”ç”¨ç¨‹åºä¸­é‡ç”¨è¿™äº›ä»£ç (ä¾‹å¦‚ï¼Œä½¿ç”¨ Kotlin Native)ã€‚

è¿™æ¯”é²å‹ƒå”å”çš„å®šä¹‰ç¨å¾®å…·ä½“ä¸€äº›ï¼Œä½†æˆ‘å‘ç°å®ƒå¾ˆæœ‰ç”¨ã€‚æˆ‘ç•™ä¸‹äº†å•è¯ *_some_* ï¼Œå› ä¸ºå¤§å¤šæ•°é¡¹ç›®æ°¸è¿œä¸éœ€è¦è·¨å¹³å°ï¼Œè¿™æ²¡å…³ç³»ã€‚å®ƒå¯èƒ½ä¼šä¹Ÿå¯èƒ½ä¸ä¼šè‡ªåŠ¨å®ç°ï¼Œä½†ç†æƒ³æƒ…å†µä¸‹ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿå®ç°å®ƒï¼Œå¹¶ä¸”æ‚¨çš„æ¶æ„è®¾è®¡å°†ä»ä¸­å—ç›Šã€‚

è®©æˆ‘ä»¬ç®€å•åœ°åˆ—å‡ºé€šå¸¸ä¼šå¦¨ç¢ä½ çš„æ˜¯ä»€ä¹ˆï¼Ÿ

# è¯­å¢ƒ

android ä¸­æœ€æ˜æ˜¾çš„ä¸Šä¸‹æ–‡ç±»ã€‚ä½ æ€»æ˜¯éœ€è¦ä¸Šä¸‹æ–‡æ¥åšäº‹æƒ…ã€‚æˆ‘çš„ BookFactory éœ€è¦ colors.xml ä¸­çš„é¢œè‰²å¸¸é‡ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•ä¼ é€’ä¸Šä¸‹æ–‡çš„è¯±æƒ‘ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆâ€”èµ„æºæä¾›è€…:

SingletoneHolder æ‚¨å¯ä»¥åœ¨è¿™é‡Œè·å–â€”[Kotlin singletons with argument](https://medium.com/@BladeCoder/kotlin-singletons-with-argument-194ef06edd9e)(åƒåŒé‡æ£€æŸ¥é”å®šè¿™æ ·çš„è¡Œä¸ºæœ€å¥½å®ç°ä¸€æ¬¡ï¼Œç„¶åé‡ç”¨)ã€‚ç°åœ¨æˆ‘çš„ clean class BookFactory ä¾èµ–äºè¿™æ ·çš„ ResourceProviderï¼Œè€Œä¸æ˜¯ Android ä¸Šä¸‹æ–‡æœ¬èº«ã€‚åœ¨è·¨å¹³å°ä¸­ï¼Œå°†æœ‰ä¸¤ç§ä¸åŒçš„å®ç°(æ‚¨å°†æä¾›ä¸€ä¸ªå…¬å…±çš„å…±äº«æ¥å£)ã€‚

å¦ä¸€ä¸ªå¸¸è§çš„ä¾‹å­æ˜¯å›¾åƒåŠ è½½ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿå¾ˆæœ‰æ•ˆ:

ç°åœ¨æˆ‘ä»¬çš„ BookFactory ç»ˆäºå¹²å‡€äº†(æ²¡æœ‰ android å¯¼å…¥)ï¼Œä½†ç»§ç»­ä½¿ç”¨å›¾åƒåŠ è½½å¹¶ä»èµ„æºæ–‡ä»¶ä¸­è·å–é¢œè‰²:

> å½“ä½ ä¸è®°å¾—ä½ æ­£åœ¨ç¼–ç¨‹ä»€ä¹ˆæ“ä½œç³»ç»Ÿçš„æ—¶å€™ï¼ŒğŸ§˜â€â™€ï¸å¯ä»¥éšæ„åœæ­¢æä¾›è€…ã€‚å¦‚æœæ‚¨è¿˜æœ‰æ—¶é—´ï¼Œè¯·éšæ„å°†æ¥å£ä»å®ç°ä¸­åˆ†ç¦»å‡ºæ¥(æ‚¨å°†è·å¾—è¾“å…¥/è¾“å‡ºç«¯å£)

# æ¨¡å‹/å®ä½“

clean attendant æœ‰æ—¶å£°æ˜æˆ‘ä»¬åº”è¯¥åœ¨æ¯ä¸€å±‚æœ‰å¤šä¸ªä¸åŒçš„æ¨¡å‹ï¼Œå¹¶æœ‰ä¸€å †æ¥å£é€‚é…å™¨æ¥è½¬æ¢/æ˜ å°„å®ƒä»¬ã€‚åœ¨ç§»åŠ¨é¡¹ç›®ä¸­ï¼Œæˆ‘ç»å¸¸è¿åè¿™æ ·çš„è§„åˆ™:å³ä½¿æ˜¯ REST æ¨¡å‹ä¹Ÿç»å¸¸é’ˆå¯¹ UI è¿›è¡Œè®¾è®¡ã€‚å¦‚æœæ‚¨çš„ UI æ˜¾ç¤ºäº†å®ä½“ä¸­çš„æ¯ä¸ª(æˆ–å‡ ä¹æ¯ä¸ª)å­—æ®µï¼Œè¿™ä¼¼ä¹æ²¡é—®é¢˜ã€‚æ›´å¤šå…³äºè¿™ä¸ªçš„è®¨è®ºä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ã€‚

åœ¨ [Bookar](https://play.google.com/store/apps/details?id=com.intmainreturn00.bookar) ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†ä¸¤å¥—æ¨¡å‹:ä¸€å¥—æ˜¯ä» [grapi](https://github.com/intmainreturn00/grapi) åº“(ç½‘ç»œå±‚)è·å¾—çš„ï¼Œå¦ä¸€å¥—æ˜¯ä»å®ƒè½¬æ¢æˆå®ä½“/æ¨¡å‹ï¼Œç„¶åç”¨äºæˆ¿é—´ã€UI å’Œç”¨ä¾‹ã€‚æ˜¯çš„ï¼Œæˆ‘ä¸èƒ½åƒè·¨å¹³å°é‚£æ ·é‡ç”¨å®ƒ(å› ä¸ºæˆ¿é—´çš„å®ä½“è§„èŒƒ)ï¼Œä½†å¦ä¸€æ–¹é¢ï¼Œæˆ‘æœ‰ä¸€ä¸ª Book ç±»ç”¨äºæ•´ä¸ªåº”ç”¨ç¨‹åºï¼Œè€Œä¸æ˜¯è®¸å¤šã€‚ä½† Room åœ¨è¿™é‡Œåªæ˜¯ Android ä¾èµ–ã€‚ä¾‹å¦‚ï¼Œæˆ‘å¯¹åŸè¯­ä½¿ç”¨äº†æ¥å£é€‚é…å™¨ï¼Œå¯ä»¥ä» Sceneform å¯¼å…¥:

> ğŸ§˜â€â™€ï¸:å¦‚æœä½ æœ‰æ—¶ä¸åŒºåˆ† UI æ¨¡å‹å’Œå®ä½“æ¨¡å‹ï¼Œä¸è¦éš¾è¿‡ã€‚å®ƒå‘ç”Ÿäº†ã€‚å¦‚æœä½ çš„ UI ä½¿ç”¨ä½ çš„å®ä½“è€Œæ²¡æœ‰ä¸éœ€è¦çš„æ˜ å°„ï¼Œè¿™å¹¶ä¸è¿åä¾èµ–è§„åˆ™ã€‚

# æ·±å±‚é“¾æ¥

ç®€å•çš„ OAuth ç™»å½•æµç¨‹åŒ…æ‹¬å°†ç”¨æˆ·å‘é€åˆ°æµè§ˆå™¨å¹¶æ•è·æ·±å±‚é“¾æ¥é‡å®šå‘ã€‚å¯¹äºæµè§ˆå™¨æ„å›¾ï¼Œä½ éœ€è¦ä¸Šä¸‹æ–‡ã€‚ä¸ºäº†æ•æ‰æ·±å±‚é“¾æ¥ï¼Œæ‚¨éœ€è¦æ´»åŠ¨(å› ä¸ºæ¸…å•ä¸­çš„ [intent-filter å£°æ˜](https://developer.android.com/training/app-links/deep-linking)å¯èƒ½åªä¸æ´»åŠ¨ç›¸å…³)ã€‚æ‰€ä»¥å¾ˆéš¾å®Œå…¨åœ¨ UI å±‚ä¹‹å¤–å®ç°ç™»å½•ç”¨ä¾‹ã€‚

> ğŸ§˜â€â™€ï¸Deep é“¾æ¥å¯¼è‡´ç–¼ç—›ã€‚ä¸æ—©æœŸå¯¼èˆªæ§åˆ¶å™¨çš„æ·±åº¦é“¾æ¥å¯¼è‡´æ›´å¤šçš„ç—›è‹¦ã€‚

# å®æ—¶æ•°æ®ã€é¢„å¤„ç†å’ŒåµŒå¥—å›æ”¶è§†å›¾

å¦ä¸€ä¸ªä¼Ÿå¤§çš„æ¶æ„ç»„ä»¶æ˜¯ [LiveData](https://developer.android.com/topic/libraries/architecture/livedata) ã€‚è¿™é‡Œè®¨è®ºçš„[åŸºåœ°ä½¿ç”¨æ¨¡å¼](https://medium.com/androiddevelopers/viewmodels-and-livedata-patterns-antipatterns-21efaef74a54)ã€‚è¿™é‡Œçš„[è¯¦ç»†æè¿°äº†å¸¸è§ç”¨ä¾‹(â€œä¸€æ¬¡æ€§è¯·æ±‚â€)ã€‚æœ‰äº›å‡ºç‰ˆç‰©ç‰¹åˆ«å¼ºè°ƒ](https://medium.com/androiddevelopers/coroutines-on-android-part-iii-real-work-2ba8a2ec2f45)[æµæ’­äº‹ä»¶](https://medium.com/androiddevelopers/livedata-with-snackbar-navigation-and-other-events-the-singleliveevent-case-ac2622673150)çš„æ¶è¡Œï¼Œè€Œä¸æ˜¯å›½å®¶ã€‚ä½†æ˜¯åœ¨æˆ‘çš„å…·ä½“ä¾‹å­ä¸­ï¼Œæˆ‘åµŒå¥—äº†å›æ”¶å™¨è§†å›¾ã€‚è€Œä¸”æˆ‘è¿˜éœ€è¦åœ¨å±•ç¤ºå®ƒä»¬ä¹‹å‰ï¼Œå¯¹æ¯æœ¬ä¹¦é€ä¸€è¿›è¡Œé¢„å¤„ç†ã€‚

![](img/16b22d98c349949173f16d576635c160.png)

æ‰€ä»¥ï¼Œ[æµçŠ¶æ€+ä½¿ç”¨ Maers ç®—æ³•](https://medium.com/@iammert/using-diffutil-in-android-recyclerview-bdca8e4fbb00) (DiffUtils)è¿›è¡Œ RecyclerView çš„å¸¸è§æ¨¡å¼åœ¨è¿™é‡Œä¸èµ·ä½œç”¨ã€‚ç”±äºé¢„å¤„ç†å¯èƒ½ä¼šèŠ±è´¹å¾ˆå¤šæ—¶é—´ï¼Œå¹¶ä¸”ç”¨æˆ·å¸Œæœ›çœ‹åˆ°è¿›åº¦æ›´æ–°ï¼Œæ‰€ä»¥æˆ‘æœ€ç»ˆæµå¼å¤„ç†äº‹ä»¶:

æ˜¯çš„ï¼Œå¦‚æœç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºä¹‹é—´åˆ‡æ¢ï¼Œprogress å¯èƒ½ä¼šä¸¢å¤±å‡ æœ¬ä¹¦ã€‚æ˜¯çš„ï¼Œæµå¼äº‹ä»¶ä¸å¥½ã€‚ä½†æ˜¯ä½¿ç”¨ DiffUtils å¯¹å¤šä¸ªåµŒå¥—åˆ—è¡¨è¿›è¡Œé¡ºåºæ›´æ–°æ›´ç³Ÿç³•ã€‚æ‚¨å¯ä»¥é€šè¿‡åœ¨å¤„ç†ç»“æŸæ—¶æ›´æ–°æ•°æ®åº“æ¥æ¢å¤æœ€ç»ˆçŠ¶æ€ï¼Œåœ¨äº‹åŠ¡å†…[â€”â€”è¿™æ ·æ‚¨å°†åœ¨ç»“æŸæ—¶åŒæ­¥çŠ¶æ€ã€‚](https://github.com/intmainreturn00/Bookar/blob/master/app/src/main/java/com/intmainreturn00/bookar/data/BooksRepository.kt)

> ğŸ§˜â€â™€ ï¸Sometimes é€šè¿‡ LiveData ç›´æ’­éƒ¨åˆ†èµ›äº‹æ˜¯æœ€ä½³æ–¹å¼ã€‚ä¸è¦å¿˜è®°é€šè¿‡äº‹åŠ¡æ›´æ–°ä»æ•°æ®åº“åŒæ­¥æœ€ç»ˆçŠ¶æ€ã€‚

# åŒ…å

å¯¹äºç»„ç»‡åŒ…è£…ç»“æ„ï¼Œåˆ‡å“ˆæ–¯çš„æ–¹æ¡ˆ([android architectureâ€”â€”the clean way](https://fernandocejas.com/2014/09/03/architecting-android-the-clean-way/))æ˜¾ç„¶æˆä¸º Android ä¸–ç•Œçš„é»˜è®¤æ–¹å¼ã€‚åœ¨è¯¥æ–¹æ¡ˆä¸­ï¼Œæ¸…æ´åœˆè¢«ç»„ç»‡æˆè¿™æ ·çš„å­å±‚:

![](img/b4ad7be66e3853a83ffebf0e19af0f15.png)

# ç»“æœ

é•¿è¯çŸ­è¯´â€”â€”æˆ‘æ·»åŠ äº†ä¸€äº›åŠŸèƒ½ï¼Œé‡å†™äº†è¿™ä¸ªéå¸¸å¥½ç”¨çš„åº”ç”¨ç¨‹åºï¼Œå¹¶è®°å½•äº†ä¸€äº›å…³äº android åº”ç”¨ç¨‹åºæ¶æ„çš„æƒ³æ³•ã€‚æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆä¼¼ä¹å…·æœ‰æ›´å¥½çš„çµæ´»æ€§å’Œç»“æ„ã€‚æ˜¯çš„ï¼Œå®ƒä»ç„¶æœ‰æ•ˆã€‚

![](img/eb50a73cbd32081304dd7d81a495716a.png)

è°æ˜¯å¥½å­©å­ï¼Ÿ

> åœ¨[Google play](https://play.google.com/store/apps/details?id=com.intmainreturn00.bookar)ğŸ§˜â€â™€checkout åº”ç”¨ï¼Œåœ¨ [GitHub](https://github.com/intmainreturn00/Bookar) æŸ¥çœ‹å®Œæ•´æºä»£ç ã€‚
> 
> æ¬¢è¿æ‹‰è¦æ±‚å’Œè¯„è®ºï¼

# é“¾æ¥

1.  [å¹²å‡€çš„å»ºç­‘](https://blog.cleancoder.com/uncle-bob/2011/11/22/Clean-Architecture.html)
2.  [äº¤ä»˜æœºåˆ¶æ˜¯ä¸€ä¸ªæ¼äººçš„ç»†èŠ‚...](http://www.codingthearchitecture.com/2011/11/06/the_delivery_mechanism_is_an_annoying_detail.html)
3.  [åº”ç”¨æ¶æ„æŒ‡å—](https://developer.android.com/jetpack/docs/guide)
4.  Ğ·Ğ°Ğ±Ğ»ÑƒĞ¶Ğ´ĞµĞ½Ğ¸Ñæ¸…æ´å»ºç­‘
5.  [æ„å»º Androidâ€¦â€¦å¹²å‡€çš„æ–¹å¼ï¼Ÿ](https://fernandocejas.com/2014/09/03/architecting-android-the-clean-way/)