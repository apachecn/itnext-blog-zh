<html>
<head>
<title>Follow-up: Web Push Notifications And PWA In 2020</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åç»­:2020å¹´çš„ç½‘ç»œæ¨é€é€šçŸ¥å’ŒPWA</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/follow-up-web-push-notifications-and-pwa-in-2020-54d27fbc829a?source=collection_archive---------2-----------------------#2020-04-14">https://itnext.io/follow-up-web-push-notifications-and-pwa-in-2020-54d27fbc829a?source=collection_archive---------2-----------------------#2020-04-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5986" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">è¿™æ˜¯æˆ‘ä¸€å¹´å‰çš„æ•™ç¨‹â€œä½¿ç”¨Ionicå’ŒAngularçš„æ¸è¿›å¼ç½‘ç»œåº”ç”¨ä¸­çš„ç½‘ç»œæ¨é€é€šçŸ¥â€çš„åç»­</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4c8e0523700f1fb18870d32d79bf971a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W6Eot89ZwJa994WQum55Sg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Javier Allegue Barros åœ¨<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><p id="b3c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘åˆ†äº«<a class="ae ky" href="https://medium.com/@david.dalbusco/one-trick-a-day-d-34-469a0336a07e" rel="noopener">ä¸€å¤©ä¸€æ‹›</a>ç›´åˆ°åŸå®šçš„2020å¹´4æœˆ19æ—¥ç‘å£«æ–°å† è‚ºç‚éš”ç¦»æœŸç»“æŸã€‚ç¦»ç¬¬ä¸€ä¸ªé‡Œç¨‹ç¢‘è¿˜æœ‰äº”å¤©ã€‚å¸Œæœ›æ›´å¥½çš„æ—¥å­å°±åœ¨å‰é¢ã€‚</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="7559" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¦‚æœä½ åœ¨Twitterä¸Šå…³æ³¨æˆ‘ï¼Œä½ å¯èƒ½å·²ç»çŸ¥é“æˆ‘å¼€å‘çš„ä¸€ä¸ªåº”ç”¨ç¨‹åºæœ€è¿‘è¢«è‹¹æœå’Œè°·æ­Œæ‹’ç»ï¼Œå› ä¸ºå®ƒä¸ç¬¦åˆä»–ä»¬å¯¹å½“å‰æ–°å† è‚ºç‚ç–«æƒ…çš„é™åˆ¶æ€§æ”¿ç­–ã€‚</p><p id="b090" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘å†™è¿™äº›æ–‡ç« ä¸æ˜¯ä¸ºäº†åˆ†äº«æˆ‘å¯¹è¿™äº›å…¬å¸çš„çœ‹æ³•ï¼Œè€Œæ˜¯ä¸ºäº†åˆ†äº«æˆ‘ä¸€å¹´å‰çš„æ•™ç¨‹çš„åç»­å†…å®¹:<a class="ae ky" href="https://medium.com/@david.dalbusco/add-web-push-notifications-to-your-ionic-pwa-358f6ec53c6f" rel="noopener">æ¸è¿›å¼ç½‘ç»œåº”ç”¨ä¸­çš„ç½‘ç»œæ¨é€é€šçŸ¥</a>ã€‚</p><p id="8dc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">äº‹å®ä¸Šï¼Œè¢«æ‹’ç»çš„åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µä¾èµ–äºæ¨é€é€šçŸ¥ã€‚ç”±äºå®ƒæ˜¯ç”¨<a class="ae ky" href="https://ionicframework.com" rel="noopener ugc nofollow" target="_blank"> Ionic </a>å’Œ<a class="ae ky" href="https://angular.io" rel="noopener ugc nofollow" target="_blank"> Angular </a>å¼€å‘çš„ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå‘å¸ƒä¸€ä¸ªæ¸è¿›å¼çš„ç½‘ç»œåº”ç”¨ç¨‹åºï¼Œä½†è¿™æ ·çš„åŠŸèƒ½è¿˜èƒ½å¾—åˆ°å¾ˆå¥½çš„æ”¯æŒå—ï¼Ÿ</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ac4e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">ä»‹ç»</h1><p id="2cdd" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">æˆ‘æ­£åœ¨å†™è¿™ç¯‡æ–‡ç« <strong class="lb iu">2020å¹´4æœˆ14æ—¥æ˜ŸæœŸäºŒ</strong>ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒåæ˜ äº†é‚£ä¸ªç‰¹å®šæ—¥æœŸçš„çŠ¶æ€ã€‚å¦‚æœä½ å°†æ¥è¯»åˆ°è¿™ç¯‡æ–‡ç« å¹¶æ³¨æ„åˆ°æ”¹è¿›æˆ–å˜åŒ–ï¼Œè¯·è”ç³»æˆ‘ï¼</p><p id="a5aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä»Šå¤©ä¸‹åˆï¼Œæˆ‘åœ¨è¿è¡ŒAndroid v10çš„OnePlus 6å’Œè¿è¡ŒiOS 13çš„iPhone 6sä¸Šè¿›è¡Œäº†æµ‹è¯•ã€‚</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="304b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">æœºå™¨äºº</h1><p id="43b9" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">å®ƒå°±åƒä¸€ä¸ªé­”å’’ï¼Œå¥å·ã€‚æˆ‘æµ‹è¯•ç½‘ç»œæ¨é€é€šçŸ¥æ—¶ï¼Œæ‰‹æœºå¤„äºç©ºé—²æ¨¡å¼ï¼Œå¤„äºå”¤é†’çŠ¶æ€ï¼Œå¹¶ä¸”åº”ç”¨ç¨‹åºå¤„äºæ‰“å¼€çŠ¶æ€ã€‚åœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼Œæˆ‘éƒ½æ”¶åˆ°äº†é€šçŸ¥ã€‚å¹²å¾—å¥½ï¼Œè°·æ­ŒğŸ‘ã€‚</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1d6d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">ios</h1><p id="4ffe" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">iOSä¸Šä»ç„¶<strong class="lb iu">ä¸æ”¯æŒ</strong>ç½‘é¡µæ¨é€é€šçŸ¥ã€‚è‡ªä»æˆ‘åœ¨2019å¹´2æœˆå‘å¸ƒæˆ‘çš„æ•™ç¨‹ä»¥æ¥ï¼ŒçŠ¶æ€æ²¡æœ‰æ”¹å˜ã€‚åœ¨<a class="ae ky" href="https://caniuse.com/#search=notification" rel="noopener ugc nofollow" target="_blank">can use</a>çš„å¸®åŠ©ä¸‹ï¼Œä½ å¯ä»¥æ³¨æ„åˆ°iOS Safariè¿˜æ²¡æœ‰å®ç°é€šçŸ¥APIã€‚</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f05e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">è®¾ç½®</h1><p id="f786" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­å±•ç¤ºçš„<a class="ae ky" href="https://firebase.google.com/docs/cloud-messaging" rel="noopener ugc nofollow" target="_blank"> Firebase Cloud Messaging </a>è®¾ç½®ä»ç„¶æœ‰æ•ˆã€‚å½“ç„¶ï¼Œä¹Ÿè®¸ä¸€äº›æˆªå›¾å·²ç»æ”¹å˜æˆ–å·²ç»å®ç°ï¼Œä½†æƒ³æ³•æ˜¯ä¸€æ ·çš„ã€‚æ­¤å¤–ï¼Œæˆ‘å·²ç»ç”¨å®Œå…¨ç›¸åŒçš„æ–¹å¼ä¸ºæˆ‘çš„åº”ç”¨ç¨‹åºè®¾ç½®äº†ä»¤ç‰Œï¼Œä¸€åˆ‡éƒ½å¾ˆå¥½ã€‚</p><p id="b528" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¸è¿‡ï¼Œå€¼å¾—æ³¨æ„çš„ä¸€ä»¶æœ‰è¶£çš„äº‹æƒ…æ˜¯ï¼Œæ¥è‡ª<a class="ae ky" href="https://medium.com/@galilo7g" rel="noopener">åŠ åˆ©ç½—</a>çš„<a class="ae ky" href="https://medium.com/@galilo7g/good-tutorial-just-mention-the-need-to-specify-the-firebase-version-in-the-service-worker-that-e90d3d8a2231" rel="noopener">è¯„è®º</a>ã€‚æ ¹æ®ä»–/å¥¹çš„ç»éªŒï¼ŒæœåŠ¡äººå‘˜ä½¿ç”¨çš„Firebaseä¾èµ–é¡¹å¿…é¡»è®¾ç½®ä¸ºä¸<code class="fe mz na nb nc b">package.json</code>ä¸­ä½¿ç”¨çš„ç‰ˆæœ¬å·å®Œå…¨ç›¸åŒçš„ç‰ˆæœ¬å·ã€‚æˆ‘æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œä½†è¿™å¯èƒ½æ˜¯å€¼å¾—è®°ä½çš„äº‹æƒ…ã€‚</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b513" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">å±¥è¡Œ</h1><p id="a262" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">é™¤äº†ä¸‹é¢çš„åå¯¹æ„è§(å¯ä»¥æ”¹è¿›ä¹Ÿå¯ä»¥ä¸æ”¹è¿›)ä¹‹å¤–ï¼Œåœ¨æˆ‘ä¹‹å‰çš„æ•™ç¨‹ä¸­æ˜¾ç¤ºçš„<a class="ae ky" href="https://medium.com/@david.dalbusco/deeplinking-in-ionic-apps-with-branch-io-ba1a1c4ed227" rel="noopener">å®ç°</a>ä»ç„¶æœ‰æ•ˆã€‚å®ƒæ˜¯æˆ‘åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­å®ç°çš„ï¼Œå› æ­¤æˆ‘ä»Šå¤©åœ¨æˆ‘çš„Androidæ‰‹æœºä¸ŠæˆåŠŸæµ‹è¯•äº†å®ƒã€‚</p><p id="921a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘è®¤ä¸ºå¯èƒ½æœ‰ä¸€ç§æ›´ç®€å•çš„æ–¹æ³•ï¼Œç‰¹åˆ«æ˜¯å¦‚æœä½ æ­£åœ¨ä½¿ç”¨<a class="ae ky" href="https://github.com/angular/angularfire" rel="noopener ugc nofollow" target="_blank"> AngularFire </a>ï¼Œåœ¨æ¸è¿›å¼Webåº”ç”¨ä¸­å®ç°Webæ¨é€é€šçŸ¥ã€‚æˆ‘æ²¡æœ‰æ£€æŸ¥å®ƒï¼Œä½†åœ¨éµå¾ªæˆ‘çš„æ•™ç¨‹ä¹‹å‰ï¼Œå®ƒå¯èƒ½å€¼å¾—ä¸€ä¸ªå¿«é€Ÿçš„ç ”ç©¶ï¼Œä»¥é˜²ä½ èƒ½æŠ½å‡ºä¸€äº›æ—¶é—´ğŸ˜‰ã€‚</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="9b05" class="nd md it bd me ne nf dn mi ng nh dp mm li ni nj mo lm nk nl mq lq nm nn ms no bi translated">è´¬å€¼</h2><p id="4dd2" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">æ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Œä½†æ˜¯åœ¨çœ‹ä»£ç çš„æ—¶å€™ï¼Œæˆ‘æ³¨æ„åˆ°<code class="fe mz na nb nc b">await messaging.requestPermission();</code>è¢«æ ‡è®°ä¸ºä¸æ¨èä½¿ç”¨ã€‚å®ƒå¯ä»¥æ›´æ–°å¦‚ä¸‹:</p><pre class="kj kk kl km gt np nc nq nr aw ns bi"><span id="121d" class="nd md it nc b gy nt nu l nv nw">if (Notification.permission !== 'denied') {<br/>    await Notification.requestPermission();<br/>}</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="f3e4" class="nd md it bd me ne nf dn mi ng nh dp mm li ni nj mo lm nk nl mq lq nm nn ms no bi translated">æ€»å…±</h2><p id="a4cb" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">æ€»ä¹‹ï¼Œæˆ‘çš„å¢å¼ºå‹AngularæœåŠ¡è´Ÿè´£æ³¨å†ŒWebæ¨é€é€šçŸ¥å’Œè¯·æ±‚æƒé™ã€‚</p><pre class="kj kk kl km gt np nc nq nr aw ns bi"><span id="112f" class="nd md it nc b gy nt nu l nv nw">import {Injectable} from '@angular/core';<br/><br/>import {firebase} from '@firebase/app';<br/>import '@firebase/messaging';<br/><br/>import {environment} from '../../../environments/environment';<br/><br/>@Injectable({<br/>    providedIn: 'root'<br/>})<br/>export class FirebaseNotificationsPwaService {<br/><br/>    async init() {<br/>        navigator.serviceWorker.ready.then((registration) =&gt; {<br/>            if (!firebase.messaging.isSupported()) {<br/>                return;<br/>            }<br/><br/>            const messaging = firebase.messaging();<br/><br/>            messaging.useServiceWorker(registration);<br/><br/>             messaging<br/>                 .usePublicVapidKey(environment.firebase.vapidKey);<br/><br/>            messaging.onMessage((payload) =&gt; {<br/>                // If we want to display <br/>                // a msg when the app is in foreground<br/>                console.log(payload);<br/>            });<br/><br/>            // Handle token refresh<br/>            messaging.onTokenRefresh(() =&gt; {<br/>                messaging.getToken().then(<br/>                    (refreshedToken: string) =&gt; {<br/>                    console.log(refreshedToken);<br/>                }).catch((err) =&gt; {<br/>                    console.error(err);<br/>                });<br/>            });<br/>        }, (err) =&gt; {<br/>            console.error(err);<br/>        });<br/>    }<br/><br/>    async requestPermission() {<br/>        if (!Notification) {<br/>            return;<br/>        }<br/><br/>        if (!firebase.messaging.isSupported()) {<br/>            return;<br/>        }<br/><br/>        try {<br/>            const messaging = firebase.messaging();<br/><br/>            if (Notification.permission !== 'denied') {<br/>                await Notification.requestPermission();<br/>            }<br/><br/>            const token: string = await messaging.getToken();<br/><br/>            // User token<br/>            console.log(token);<br/>        } catch (err) {<br/>            console.error(err);<br/>        }<br/>    }<br/>}</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b0c3" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">æ‘˜è¦</h1><p id="4de4" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">å¸Œæœ›æœ‰ä¸€å¤©æˆ‘ä»¬ä¹Ÿèƒ½åœ¨iOSè®¾å¤‡ä¸Šå‘é€ç½‘é¡µæ¨é€é€šçŸ¥ğŸ¤ã€‚</p><p id="2fb7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å‘†åœ¨å®¶é‡Œï¼Œæ³¨æ„å®‰å…¨ï¼</p><p id="3cc5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¤§å«</p></div></div>    
</body>
</html>