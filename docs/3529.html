<html>
<head>
<title>CQRS Pattern &amp; NestJS (Node.js)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CQRSæ¨¡å¼&amp; NestJS (Node.js)</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/cqrs-pattern-nestjs-node-js-cf20fd9bb07?source=collection_archive---------0-----------------------#2020-01-04">https://itnext.io/cqrs-pattern-nestjs-node-js-cf20fd9bb07?source=collection_archive---------0-----------------------#2020-01-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d31d" class="pw-subtitle-paragraph jr is it bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">æœ‰æŒ‡å¯¼çš„ä»‹ç»</h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/a29227c58e89f4c9d854f381490310a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*duvh8Axq_UO0fA96nMVFZQ.png"/></div></div></figure><p id="7f54" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å½“è®¾è®¡ä¸€ä¸ªéµå¾ªä¼ ç»Ÿæ¶æ„çš„åº”ç”¨ç¨‹åºæ—¶ï¼Œè¯»å’Œå†™æ“ä½œç»å¸¸ä½¿ç”¨ç›¸åŒçš„æ•°æ®æ¨¡å‹ã€‚å°½ç®¡å®ƒå¯èƒ½åœ¨å°å‹åº”ç”¨ç¨‹åºæˆ–ä¾èµ–ç®€å•é€»è¾‘çš„åº”ç”¨ç¨‹åºä¸Šå·¥ä½œå¾—å¾ˆå¥½ï¼Œä½†æ˜¯å½“æˆ‘ä»¬æœ‰ä¸€ä¸ªæ›´å¤æ‚çš„ç¯å¢ƒæ—¶ï¼Œæˆ‘ä»¬æœ€ç»ˆéœ€è¦æ›´å¤æ‚çš„è§£å†³æ–¹æ¡ˆã€‚</p><p id="87d7" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢CQRS <em class="lr">è®¾è®¡æ¨¡å¼</em>çš„åŸºç¡€ï¼Œå®ƒçš„ä¼˜ç‚¹å’Œç¼ºç‚¹ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨å¦‚ä½•é€šè¿‡ä½¿ç”¨Node.jsçš„<a class="ae ls" href="https://nestjs.com/" rel="noopener ugc nofollow" target="_blank"> NestJSæ¡†æ¶</a>æ¥å®ç°è¿™ç§æ¨¡å¼</p><p id="3f13" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><em class="lr"> obs:å¦‚æœä½ è¿˜æ²¡æœ‰æ£€æŸ¥è¿‡</em> <a class="ae ls" href="https://docs.nestjs.com/" rel="noopener ugc nofollow" target="_blank"> <em class="lr"> NestJSæ¡†æ¶</em> </a> <em class="lr">çš„è¯ï¼Œæˆ‘ä¼šå…¨åŠ›æ¨èå®ƒã€‚å—Angularæ¶æ„çš„å¯å‘ï¼Œå®ƒæ˜¯ä¸€ä¸ªç®€å•ã€é«˜æ•ˆä¸”å¯æ‰©å±•çš„Node.jsæ¡†æ¶ã€‚</em></p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="9e80" class="ma mb it bd mc md me mf mg mh mi mj mk ka ml kb mm kd mn ke mo kg mp kh mq mr bi translated">CQRSæ¨¡å¼</h1><blockquote class="ms mt mu"><p id="9a12" class="kv kw lr kx b ky kz jv la lb lc jy ld mv lf lg lh mw lj lk ll mx ln lo lp lq im bi translated">â€œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ²¡æœ‰ç†ç”±è®©ä¸­å°å‹åº”ç”¨ç¨‹åºå˜å¾—æ›´å¤æ‚ã€‚ç„¶è€Œï¼Œæœ‰æ—¶è¿™è¿˜ä¸å¤Ÿï¼Œå½“æˆ‘ä»¬çš„éœ€æ±‚å˜å¾—æ›´åŠ å¤æ‚æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›æ‹¥æœ‰å…·æœ‰ç®€å•æ•°æ®æµçš„å¯æ‰©å±•ç³»ç»Ÿã€‚â€<br/> <strong class="kx iu">å†…æ–¯ç‰¹Â·CQRS</strong></p></blockquote><p id="58a6" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å½“ä»æœåŠ¡å™¨è¯·æ±‚æ•°æ®æ—¶ï¼Œåº”ç”¨ç¨‹åºå¯èƒ½ä¼šæ‰§è¡Œå¤šä¸ªæŸ¥è¯¢ï¼Œå¹¶æ ¹æ®è¯·æ±‚çš„æ•°æ®ä½¿ç”¨dto(æ•°æ®ä¼ è¾“å¯¹è±¡)ã€‚æ­¤å¤–ï¼Œå½“éœ€è¦æ›´æ”¹æ•°æ®æˆ–å‘æ•°æ®åº“æ·»åŠ æ•°æ®æ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨d toæ‰§è¡Œä¸€äº›æ“ä½œã€‚</p><p id="0c38" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">åœ¨æ›´å¤§çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæ˜ å°„è¿™äº›å¯¹è±¡å¹¶æŒæ¡å…¶ä¸åŒçš„æ ¼å¼ä¼šæˆä¸ºä¸€ä¸ªçœŸæ­£çš„é—®é¢˜ã€‚å½“æ‰§è¡Œä¸€ä¸ªå†™æ“ä½œæ—¶ï¼Œæ‚¨å¯èƒ½è¿˜ä¼šå¾—åˆ°å®ç°å¤šä¸ªéªŒè¯å’Œä¸šåŠ¡é€»è¾‘çš„å¤æ‚æ¨¡å‹ã€‚</p><p id="e8cc" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">è¯»å–å’Œå†™å…¥æ“ä½œä¹‹é—´çš„æ•°æ®è¡¨ç¤ºç»å¸¸ä¸åŒ¹é…ï¼Œè¿™ä¹Ÿä½¿å¾—æ§åˆ¶åœ¨æ¯ä¸ªä¸Šä¸‹æ–‡ä¸­å…¬å¼€ä»€ä¹ˆæ•°æ®å˜å¾—æ›´åŠ å›°éš¾ã€‚å› æ­¤ï¼Œè¿™ç§æ–¹æ³•å¯èƒ½ä¼šå¯¹åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€å¤æ‚æ€§å’Œå®‰å…¨æ€§äº§ç”Ÿè´Ÿé¢å½±å“ã€‚</p><p id="3060" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">CQRSæ¨¡å¼åœ°å€å°†è¯»å–å’Œå†™å…¥åˆ†ç¦»åˆ°ä¸åŒçš„æ¨¡å‹ä¸­ï¼Œä½¿ç”¨<strong class="kx iu">å‘½ä»¤</strong>æ›´æ–°æ•°æ®ï¼Œä½¿ç”¨<strong class="kx iu">æŸ¥è¯¢</strong>è¯»å–æ•°æ®ã€‚</p><p id="12f6" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å‘½ä»¤åº”è¯¥é¢å‘å®ƒä»¬åº”è¯¥å®Œæˆçš„ä»»åŠ¡ã€‚<br/> <strong class="kx iu">å‘½ä»¤</strong>å¯èƒ½è¢«æ”¾å…¥é˜Ÿåˆ—è¿›è¡Œå¼‚æ­¥å¤„ç†ã€‚</p><p id="8bfc" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">æŸ¥è¯¢</strong>ä»ä¸ä¿®æ”¹æ•°æ®åº“ã€‚<br/> <strong class="kx iu">æŸ¥è¯¢</strong>è¿”å›<em class="lr">æ²¡æœ‰ä»»ä½•é¢†åŸŸçŸ¥è¯†çš„dto</em>ã€‚</p><h2 id="55f6" class="my mb it bd mc mz na dn mg nb nc dp mk le nd ne mm li nf ng mo lm nh ni mq nj bi translated"><em class="jq">ä¼˜ç‚¹</em></h2><p id="1b0b" class="pw-post-body-paragraph kv kw it kx b ky nk jv la lb nl jy ld le nm lg lh li nn lk ll lm no lo lp lq im bi translated"><strong class="kx iu">ç¦»æã€‚é€šè¿‡åˆ†ç¦»å…³æ³¨ç‚¹â€”â€”è¯»(æŸ¥è¯¢)å’Œå†™(å‘½ä»¤)æ“ä½œâ€”â€”å®ƒæœ‰åŠ©äºæ‹¥æœ‰æ›´çµæ´»çš„æ¨¡å‹ï¼Œæœ‰åŠ©äºå¼€å‘é€Ÿåº¦å’Œä¾¿äºç»´æŠ¤ã€‚</strong></p><p id="b17c" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">å¯æ‰©å±•æ€§</strong>ã€‚<strong class="kx iu"> </strong>å®ƒå…è®¸æ‚¨çš„æŸ¥è¯¢å’Œå‘½ä»¤ç‹¬ç«‹ä¼¸ç¼©ï¼Œä»è€Œå‡å°‘é”äº‰ç”¨ã€‚</p><p id="be65" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">ä¼˜åŒ–æ¨¡å¼</strong>ã€‚è¯»å†™æ“ä½œçš„æ¨¡å¼é’ˆå¯¹å…¶ç›®çš„è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä¹Ÿæ›´å®¹æ˜“ç†è§£å’Œç»´æŠ¤ã€‚</p><p id="e02f" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">å®‰å…¨</strong>ã€‚æ›´å®¹æ˜“ç¡®ä¿åªæœ‰æ­£ç¡®ä¸Šä¸‹æ–‡ä¸­çš„æ­£ç¡®å®ä½“èƒ½å¤Ÿè®¿é—®æ•°æ®çš„è¯»å†™æ“ä½œã€‚</p><h2 id="6d10" class="my mb it bd mc mz na dn mg nb nc dp mk le nd ne mm li nf ng mo lm nh ni mq nj bi translated">é¢å‘è¿æ¥çš„ç½‘ç»œæœåŠ¡(Connection Oriented Network Service)</h2><p id="62d7" class="pw-post-body-paragraph kv kw it kx b ky nk jv la lb nl jy ld le nm lg lh li nn lk ll lm no lo lp lq im bi translated"><strong class="kx iu">å¤æ‚</strong>ã€‚CQRSçš„maisé—®é¢˜æ˜¯ï¼Œå°½ç®¡CQRSçš„åŸºæœ¬åŸåˆ™å¾ˆç®€å•ï¼Œä½†å…¶å®æ–½å¯èƒ½å¾ˆå¤æ‚ï¼Œè€Œä¸”æˆæœ¬å¾ˆé«˜ã€‚æ‰€ä»¥ï¼Œåº”è¯¥åªæœ‰åœ¨æœ‰æ„ä¹‰çš„æ—¶å€™æ‰ä½¿ç”¨ï¼›å½“å¯ä¼¸ç¼©æ€§æ˜¯åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªé‡è¦é—®é¢˜æ—¶ï¼Œå½“æ‚¨å¤„ç†å¤æ‚çš„æ¨¡å‹å’Œä¸šåŠ¡é€»è¾‘æ—¶ï¼Œç­‰ç­‰ã€‚å¦åˆ™ï¼Œä½ å®é™…ä¸Šä¸æ˜¯åœ¨ç®€åŒ–ï¼Œè€Œæ˜¯ç»™åº”ç”¨ç¨‹åºå¸¦æ¥äº†ä¸å¿…è¦çš„å¤æ‚æ€§ã€‚</p><p id="4c3e" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">ä¸€è‡´æ€§ã€‚</strong>é€šè¿‡å¯¹æŸ¥è¯¢å’Œå‘½ä»¤ä½¿ç”¨ä¸åŒçš„æ¨¡å‹ï¼Œä¿æŒå®ƒä»¬ä¹‹é—´çš„ä¸€è‡´æ€§å¯èƒ½ä¼šå˜å¾—æ›´åŠ å›°éš¾ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤æ‚æ•°æ®æ—¶ã€‚</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="8a80" class="ma mb it bd mc md me mf mg mh mi mj mk ka ml kb mm kd mn ke mo kg mp kh mq mr bi translated">åœ¨NestJSä¸­å®æ–½CQRSæ¨¡å¼</h1><p id="18e7" class="pw-post-body-paragraph kv kw it kx b ky nk jv la lb nl jy ld le nm lg lh li nn lk ll lm no lo lp lq im bi translated">å¥½äº†ï¼Œç°åœ¨è®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶å¦‚ä½•å®ç°è¿™ä¸ªæ¨¡å¼ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æˆ‘ä»¬å°†é€šè¿‡ä½¿ç”¨NestJSæ¡†æ¶æ¥å®ç°å®ƒã€‚NestJSä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ª<strong class="kx iu">é¢„å»ºçš„CQRSæ¨¡å—</strong>ï¼Œä¸ºäº†åœ¨NestJSä¸­ä½¿ç”¨è¿™ç§æ¨¡å¼ï¼Œè¿™å°†ä½¿æˆ‘ä»¬çš„ç”Ÿæ´»å˜å¾—æ›´åŠ å®¹æ˜“ã€‚</p><p id="2ca7" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">é¦–å…ˆï¼Œè®©æˆ‘ä»¬å®‰è£…NestJSçš„CLIï¼Œç”¨å®ƒåˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼Œå¹¶å°†Nestçš„CQRSæ¨¡å—æ·»åŠ åˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¸­ã€‚</p><pre class="kk kl km kn gt np nq nr ns aw nt bi"><span id="d541" class="my mb it nq b gy nu nv l nw nx">npm install -g @nestjs/cli<br/>nest new project-cqrs<br/>cd project-cqrs<br/>npm install @nestjs/cqrs --save<br/>npm run start</span></pre><p id="a812" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬å°†å®ç°ä¸€ä¸ªç®€å•çš„ç”¨æˆ·CRUDç‰¹æ€§ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç”¨æˆ·æ§åˆ¶å™¨ï¼Œå…¶ä¸­æˆ‘ä»¬å°†ä½¿ç”¨CQRSæ¨¡å¼ã€‚è®©æˆ‘ä»¬æŠŠ<em class="lr">ç”¨æˆ·</em>åˆ†ç¦»å‡ºæ¥ä½œä¸ºä¸€ä¸ªç‰¹æ€§ï¼Œä¸ºå®ƒåˆ›å»ºä¸€ä¸ª<em class="lr">æ¨¡å—</em>ï¼Œè¿™ä¸ª<em class="lr">æ§åˆ¶å™¨</em>æœ¬èº«å’Œä¸¤ä¸ªæ–‡ä»¶å¤¹:<em class="lr">å‘½ä»¤</em>å’Œ<em class="lr">æŸ¥è¯¢</em>ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†åˆ›å»ºæˆ‘ä»¬éœ€è¦çš„æ¯ä¸ª<em class="lr">æŸ¥è¯¢</em>å’Œ<em class="lr">å‘½ä»¤</em>ã€‚</p><p id="17a7" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ä¸‹é¢æ˜¯æˆ‘ä»¬çš„é¡¹ç›®ç»“æ„å’Œæ–‡ä»¶å°†å¦‚ä½•ã€‚<br/>æˆ‘ä»¬å°†æ·±å…¥ç ”ç©¶æ‰€æœ‰çš„<em class="lr">ç”¨æˆ·</em>ç‰¹æ€§ã€‚</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/1508035268e3c8b34141c98c9e7c598b.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*wZ6BCHGuSUaqjBFBMJxw9A.png"/></div></figure><h2 id="747b" class="my mb it bd mc mz na dn mg nb nc dp mk le nd ne mm li nf ng mo lm nh ni mq nj bi translated">é—®é¢˜</h2><p id="a9d1" class="pw-post-body-paragraph kv kw it kx b ky nk jv la lb nl jy ld le nm lg lh li nn lk ll lm no lo lp lq im bi translated">è®©æˆ‘ä»¬ä»¥é€æ­¥æ„å»ºæˆ‘ä»¬çš„<em class="lr"> ListUsersQuery </em>ä¸ºä¾‹ã€‚<br/>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç±»ä½œä¸ºæˆ‘ä»¬çš„<em class="lr">æŸ¥è¯¢</em>ï¼Œå®ƒå°†åŒ…å«å…¶<em class="lr">å¤„ç†ç¨‹åº</em>æ‰€éœ€çš„ä¿¡æ¯ã€‚å› ä¸ºæˆ‘ä»¬è¦åˆ—å‡ºç”¨æˆ·ï¼Œæ‰€ä»¥çŸ¥é“è¯·æ±‚çš„é¡µç å’Œé¡µé¢å¤§å°å¾ˆé‡è¦ã€‚</p><pre class="kk kl km kn gt np nq nr ns aw nt bi"><span id="51ad" class="my mb it nq b gy nu nv l nw nx">export class ListUsersQuery {<br/>  constructor(<br/>    public page: number = 1,<br/>    public pageSize: number = 10<br/>  ) { }<br/>}</span></pre><p id="e298" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»ºæˆ‘ä»¬çš„å¤„ç†ç¨‹åºï¼Œå½“è¿™ä¸ª<em class="lr">æŸ¥è¯¢</em>åœ¨<em class="lr">æŸ¥è¯¢æ€»çº¿ä¸­è¢«è°ƒç”¨æ—¶ï¼Œå®ƒå°†è¢«è§¦å‘ã€‚</em></p><p id="1784" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><em class="lr"> QueryBus </em>æ˜¯ä¸€ä¸ªæŸ¥è¯¢æµã€‚å½“è¢«è¯·æ±‚æ—¶ï¼Œå®ƒå°†æŸ¥è¯¢å§”æ‰˜ç»™å®ƒçš„å¯¹ç­‰å¤„ç†ç¨‹åºã€‚æ¯ä¸ª<em class="lr">æŸ¥è¯¢</em>å¿…é¡»æœ‰å…¶å¯¹åº”çš„<em class="lr">å¤„ç†ç¨‹åº</em>ã€‚è¿™ç§å…³è”æ˜¯é€šè¿‡ä½¿ç”¨<em class="lr"> @QueryHandler </em>è£…é¥°å™¨æ¥å®ç°çš„ã€‚</p><pre class="kk kl km kn gt np nq nr ns aw nt bi"><span id="c4ef" class="my mb it nq b gy nu nv l nw nx">@QueryHandler(ListUsersQuery)<br/>export class ListHandler implements IQueryHandler&lt;ListUsersQuery&gt; {}</span></pre><p id="48bf" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æˆ‘ä»¬ç°åœ¨å·²ç»åˆ›å»ºäº†<em class="lr"> ListHandlerï¼Œ</em>ï¼Œå®ƒå°†å¤„ç†æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„æŸ¥è¯¢<em class="lr"> ListUsersQuery </em>ã€‚ç¨åæˆ‘ä»¬å°†çœ‹åˆ°è¿™ä¸ª<em class="lr">æŸ¥è¯¢</em>å¦‚ä½•è¢«<em class="lr">æŸ¥è¯¢æ€»çº¿è°ƒç”¨ã€‚</em></p><p id="a459" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç°åœ¨æˆ‘ä»¬è¦åšçš„æ˜¯åœ¨æˆ‘ä»¬çš„<em class="lr">å¤„ç†ç¨‹åº</em>ä¸­åŒ…å«æˆ‘ä»¬çš„é€»è¾‘ã€‚å½“<em class="lr">æŸ¥è¯¢</em>è¢«è°ƒç”¨æ—¶ï¼Œå®ƒå°†è°ƒç”¨<em class="lr">å¤„ç†ç¨‹åºçš„</em> <strong class="kx iu"> <em class="lr">æ‰§è¡Œ</em> </strong>æ–¹æ³•ã€‚æˆ‘ä»¬çš„<em class="lr">å¤„ç†ç¨‹åº</em>é€»è¾‘å°†é©»ç•™åœ¨é‚£é‡Œã€‚</p><pre class="kk kl km kn gt np nq nr ns aw nt bi"><span id="0e33" class="my mb it nq b gy nu nv l nw nx">@QueryHandler(ListUsersQuery)<br/>export class ListHandler implements IQueryHandler&lt;ListUsersQuery&gt; {</span><span id="d3ca" class="my mb it nq b gy nz nv l nw nx">  constructor(<br/>    // Here we would inject what is necessary to retrieve our data<br/>  ) { }</span><span id="db50" class="my mb it nq b gy nz nv l nw nx">  public async execute(query: ListUsersQuery): Promise&lt;User[]&gt; {<br/>    // Here we are going to have any necessary logic related<br/>    // to that Query and return the requested information<br/>    // such as a service method call<br/>  }<br/>}</span></pre><p id="8dd7" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æœ€åï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„<em class="lr">åˆ—è¡¨ç”¨æˆ·æŸ¥è¯¢</em>çš„æ ·å­:</p><pre class="kk kl km kn gt np nq nr ns aw nt bi"><span id="872d" class="my mb it nq b gy nu nv l nw nx">export class ListQuery {<br/>  constructor(<br/>    public page: number = 1,<br/>    public pageSize: number = 10<br/>  ) { }<br/>}</span><span id="ff89" class="my mb it nq b gy nz nv l nw nx">@QueryHandler(ListUsersQuery)<br/>export class ListHandler implements IQueryHandler&lt;ListUsersQuery&gt; {</span><span id="e51d" class="my mb it nq b gy nz nv l nw nx">  constructor(<br/>    // Here we would inject what is necessary to retrieve our data<br/>  ) { }</span><span id="a6b7" class="my mb it nq b gy nz nv l nw nx">  public async execute(query: ListUsersQuery): Promise&lt;User[]&gt; {<br/>    // Here we are going to have any necessary logic related<br/>    // to that Query and return the request information<br/>    // such as a service method call<br/>  }<br/>}</span></pre><p id="06f3" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ä¸‹é¢æ˜¯æˆ‘ä»¬çš„å¦ä¸€ä¸ªæŸ¥è¯¢ï¼Œ<em class="lr"> GetUserById </em> oneï¼Œ<em class="lr"> </em>çš„æ ·å­ï¼›ç°åœ¨æ·»åŠ ä¸€äº›ç¤ºä¾‹ä»£ç <a class="ae ls" href="https://docs.nestjs.com/techniques/database" rel="noopener ugc nofollow" target="_blank">ï¼Œä½¿ç”¨TypeORM è®¿é—®<em class="lr">å­˜å‚¨åº“æ¥æ£€ç´¢æ•°æ®ã€‚</em></a></p><pre class="kk kl km kn gt np nq nr ns aw nt bi"><span id="6ab5" class="my mb it nq b gy nu nv l nw nx">// All we need is the id of the user we want to retrieve the data<br/>export class GetUserByIdQuery {<br/>  constructor(<br/>    public id: number<br/>  ) { }<br/>}</span><span id="19b5" class="my mb it nq b gy nz nv l nw nx">@QueryHandler(GetUserByIdQuery)<br/>export class GetUserByIdHandler implements<br/>  IQueryHandler&lt;GetUserByIdQuery&gt; {</span><span id="8417" class="my mb it nq b gy nz nv l nw nx">  // We inject our TypeORM repository to fetch the user data<br/>  constructor(<br/>    @InjectRepository(User)<br/>    private readonly _repository: Repository&lt;User&gt;<br/>  ) { }</span><span id="6fec" class="my mb it nq b gy nz nv l nw nx">  public async execute(query: GetUserByIdQuery): Promise&lt;User&gt; {<br/>    // We fetch user data and return it on the execute method       <br/>    return await this._repository.findOne(query.id);<br/>  }<br/>}</span></pre><h2 id="ea1a" class="my mb it bd mc mz na dn mg nb nc dp mk le nd ne mm li nf ng mo lm nh ni mq nj bi translated">å‘½ä»¤</h2><p id="2406" class="pw-post-body-paragraph kv kw it kx b ky nk jv la lb nl jy ld le nm lg lh li nn lk ll lm no lo lp lq im bi translated">è®©æˆ‘ä»¬ä»¥é€æ­¥æ„å»ºæˆ‘ä»¬çš„<em class="lr"> AddUserCommand </em>ä¸ºä¾‹ã€‚<br/>è¿™ä¸æˆ‘ä»¬å¦‚ä½•åˆ›å»º<em class="lr">æŸ¥è¯¢</em>éå¸¸ç›¸ä¼¼ã€‚<br/>é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªç±»å®šä¹‰ä¸ºæˆ‘ä»¬çš„<em class="lr">å‘½ä»¤</em>ï¼Œå®ƒå°†åŒ…å«å…¶<em class="lr">å¤„ç†ç¨‹åº</em>æ‰€éœ€çš„ä¿¡æ¯ã€‚è¿™é‡Œæˆ‘ä»¬éœ€è¦æ·»åŠ æ–°çš„ç”¨æˆ·ä¿¡æ¯ã€‚</p><pre class="kk kl km kn gt np nq nr ns aw nt bi"><span id="985b" class="my mb it nq b gy nu nv l nw nx">export class AddUserCommand {<br/>  constructor(<br/>    public name: string,<br/>    public email: string,<br/>    public birthdate: Date<br/>  ) { }<br/>}</span></pre><p id="c460" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»ºæˆ‘ä»¬çš„<em class="lr">å¤„ç†ç¨‹åº</em>ï¼Œå®ƒå°†åœ¨<em class="lr">å‘½ä»¤æ€»çº¿ä¸­è°ƒç”¨<em class="lr">å‘½ä»¤</em>æ—¶è¢«è§¦å‘ã€‚</em></p><p id="5d2b" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><em class="lr">å‘½ä»¤æ€»çº¿</em>æ˜¯ä¸€ä¸²å‘½ä»¤ã€‚å½“è¢«è¯·æ±‚æ—¶ï¼Œå®ƒå°†å‘½ä»¤å§”æ‰˜ç»™å®ƒçš„å¯¹ç­‰å¤„ç†ç¨‹åºã€‚æ¯ä¸ª<em class="lr">å‘½ä»¤</em>å¿…é¡»æœ‰å¯¹åº”çš„<em class="lr">å¤„ç†ç¨‹åº</em>ã€‚è¿™ç§å…³è”æ˜¯é€šè¿‡ä½¿ç”¨<em class="lr"> @CommandHandler </em>è£…é¥°å™¨æ¥å®ç°çš„ã€‚</p><pre class="kk kl km kn gt np nq nr ns aw nt bi"><span id="eb94" class="my mb it nq b gy nu nv l nw nx">@CommandHandler(AddUserCommand)<br/>export class AddUserHandler implements IQueryHandler&lt;AddUserCommand&gt; {}</span></pre><p id="5bf9" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æˆ‘ä»¬ç°åœ¨å·²ç»åˆ›å»ºäº†<em class="lr"> AddUserHandlerï¼Œ</em>ï¼Œå®ƒå°†å¤„ç†æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„å‘½ä»¤<em class="lr"> AddUserCommand </em>ã€‚ç¨åæˆ‘ä»¬å°†çœ‹åˆ°<em class="lr">å‘½ä»¤</em>å¦‚ä½•è¢«<em class="lr">å‘½ä»¤æ€»çº¿è°ƒç”¨ã€‚</em></p><p id="1e70" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç°åœ¨æˆ‘ä»¬è¦åšçš„æ˜¯åœ¨æˆ‘ä»¬çš„<em class="lr">å¤„ç†ç¨‹åº</em>ä¸­åŒ…å«æˆ‘ä»¬çš„é€»è¾‘ã€‚å½“<em class="lr">å‘½ä»¤</em>è¢«è°ƒç”¨æ—¶ï¼Œå®ƒå°†è°ƒç”¨<em class="lr">å¤„ç†ç¨‹åºçš„</em> <strong class="kx iu"> <em class="lr">æ‰§è¡Œ</em> </strong>æ–¹æ³•ã€‚æˆ‘ä»¬çš„<em class="lr">å¤„ç†ç¨‹åº</em>é€»è¾‘å°†é©»ç•™åœ¨é‚£é‡Œã€‚</p><pre class="kk kl km kn gt np nq nr ns aw nt bi"><span id="e977" class="my mb it nq b gy nu nv l nw nx">@CommandHandler(AddUserCommand)<br/>export class AddUserHandler implements IQueryHandler&lt;AddUserCommand&gt; {<br/>    constructor(<br/>      // Here we would inject what is necessary to persist our data<br/>    ) { }</span><span id="c50f" class="my mb it nq b gy nz nv l nw nx">    public async execute(query: ListUsersQuery): Promise&lt;User&gt; {<br/>      // Here we are going to have any necessary logic related<br/>      // to that Command and do any change operations<br/>    }<br/>}</span></pre><p id="6a7d" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æœ€åï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„<em class="lr"> AddUserCommand </em>çš„æ ·å­:</p><pre class="kk kl km kn gt np nq nr ns aw nt bi"><span id="2060" class="my mb it nq b gy nu nv l nw nx">export class AddUserCommand {<br/>  constructor(<br/>    public name: string,<br/>    public email: string,<br/>    public birthdate: Date<br/>  ) { }<br/>}</span><span id="e7c2" class="my mb it nq b gy nz nv l nw nx">@CommandHandler(AddUserCommand)<br/>export class AddUserHandler implements IQueryHandler&lt;AddUserCommand&gt; {<br/>    constructor(<br/>      // Here we would inject what is necessary to persist our data<br/>    ) { }</span><span id="90dd" class="my mb it nq b gy nz nv l nw nx">    public async execute(query: ListUsersQuery): Promise&lt;User&gt; {<br/>      // Here we are going to have any necessary logic related<br/>      // to that Command and do any change operations<br/>    }<br/>}</span></pre><p id="fa07" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ä¸‹é¢æ˜¯æˆ‘ä»¬çš„å…¶ä»–<em class="lr">å‘½ä»¤</em>ã€<em class="lr"> UpdateUser </em>å’Œ<em class="lr"> DeleteUserã€</em>çš„æ ·å­ï¼Œç°åœ¨æ·»åŠ ä¸€äº›ç¤ºä¾‹ä»£ç <a class="ae ls" href="https://docs.nestjs.com/techniques/database" rel="noopener ugc nofollow" target="_blank">æ¥è®¿é—®ä¸€ä¸ª<em class="lr">åº“ï¼Œä½¿ç”¨TypeORM </em>å¯¹æ•°æ®åº“è¿›è¡Œæ›´æ”¹ã€‚</a></p><p id="f899" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu"> <em class="lr">æ›´æ–°ç”¨æˆ·å‘½ä»¤</em> </strong></p><pre class="kk kl km kn gt np nq nr ns aw nt bi"><span id="9f37" class="my mb it nq b gy nu nv l nw nx">export class UpdateUserCommand {<br/>  constructor(<br/>    public id: number,<br/>    public name?: string,<br/>    public email?: string,<br/>    public birthdate?: Date<br/>  ) { }<br/>}</span><span id="38d9" class="my mb it nq b gy nz nv l nw nx">@CommandHandler(UpdateUserCommand)<br/>export class UpdateUserHandler implements IQueryHandler&lt;UpdateUserCommand&gt;<br/>{<br/>    constructor(<br/>      @InjectRepository(User)<br/>      private readonly _repository: Repository&lt;User&gt;<br/>    ) { }</span><span id="3fa8" class="my mb it nq b gy nz nv l nw nx">    public async execute(request: UpdateUserCommand): Promise&lt;User&gt;<br/>    {<br/>      const user = await this._repository.findOne(request.id);</span><span id="1987" class="my mb it nq b gy nz nv l nw nx">      if (!user)<br/>        throw new NotFoundException('User does not exist');</span><span id="6b03" class="my mb it nq b gy nz nv l nw nx">      user.name = request.name || user.name;<br/>      user.email = request.email || user.email;<br/>      user.birthdate = request.birthdate|| user.birthdate;</span><span id="db12" class="my mb it nq b gy nz nv l nw nx">      return await this._repository.save( user );<br/>    }<br/>}</span></pre><p id="2621" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu"> <em class="lr">åˆ é™¤ç”¨æˆ·å‘½ä»¤</em> </strong></p><pre class="kk kl km kn gt np nq nr ns aw nt bi"><span id="ff61" class="my mb it nq b gy nu nv l nw nx">export class DeleteUserCommand {<br/>  constructor(<br/>    public id: number<br/>  ) { }<br/>}</span><span id="6c9e" class="my mb it nq b gy nz nv l nw nx">@CommandHandler(DeleteUserCommand)<br/>export class DeleteUserHandler implements IQueryHandler&lt;DeleteUserCommand&gt;<br/>{<br/>    constructor(<br/>      @InjectRepository(User)<br/>      private readonly _repository: Repository&lt;User&gt;<br/>    ) { }</span><span id="fa61" class="my mb it nq b gy nz nv l nw nx">    public async execute(request: DeleteUserCommand):<br/>      Promise&lt;DeleteResult&gt;<br/>    {<br/>      return await this._repository.delete({<br/>        'id': request.id<br/>      });<br/>    }<br/>}</span></pre><h2 id="485b" class="my mb it bd mc mz na dn mg nb nc dp mk le nd ne mm li nf ng mo lm nh ni mq nj bi translated">æ§åˆ¶å™¨</h2><p id="7ab1" class="pw-post-body-paragraph kv kw it kx b ky nk jv la lb nl jy ld le nm lg lh li nn lk ll lm no lo lp lq im bi translated">æ—¢ç„¶æˆ‘ä»¬å·²ç»æ„å»ºäº†æˆ‘ä»¬çš„æŸ¥è¯¢å’Œå‘½ä»¤ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå®ƒä»¬æ”¾åœ¨ä¸€èµ·ï¼Œä¸ºæˆ‘ä»¬çš„ç”¨æˆ·CRUDç«¯ç‚¹åˆ›å»ºæˆ‘ä»¬çš„<em class="lr"> UserController </em>ã€‚</p><p id="f21e" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºæˆ‘ä»¬çš„<em class="lr"> UserController </em>ç±»ï¼Œä½¿ç”¨<strong class="kx iu"> @Controller decorator </strong>å¹¶ä¸ºæˆ‘ä»¬çš„æ§åˆ¶å™¨æŒ‡å®šæˆ‘ä»¬çš„<strong class="kx iu"><em class="lr">â€˜userâ€™</em>è·¯ç”±å‰ç¼€</strong>ã€‚ç„¶åï¼Œæˆ‘ä»¬<strong class="kx iu">åœ¨<strong class="kx iu">æ„é€ å™¨</strong>ä¸Šä¸º</strong>æä¾›<strong class="kx iu">æŸ¥è¯¢æ€»çº¿</strong>å’Œ<strong class="kx iu">å‘½ä»¤æ€»çº¿</strong>ã€‚</p><pre class="kk kl km kn gt np nq nr ns aw nt bi"><span id="614a" class="my mb it nq b gy nu nv l nw nx">@Controller('user')<br/>export class UserController {</span><span id="25a6" class="my mb it nq b gy nz nv l nw nx">  constructor(<br/>    private readonly commandBus: CommandBus,<br/>    private readonly queryBus: QueryBus<br/>  ) { }</span><span id="1615" class="my mb it nq b gy nz nv l nw nx">}</span></pre><p id="f51e" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç°åœ¨æˆ‘ä»¬èƒ½å¤Ÿåˆ›å»ºæˆ‘ä»¬çš„ç«¯ç‚¹ï¼Œå®ƒä»¬å°†ç›¸åº”åœ°è°ƒç”¨<em class="lr"> QueryBus </em>å’Œ<em class="lr"> CommandBus </em>ã€‚</p><pre class="kk kl km kn gt np nq nr ns aw nt bi"><span id="0c3f" class="my mb it nq b gy nu nv l nw nx">@Controller('user')<br/>export class UserController {</span><span id="5540" class="my mb it nq b gy nz nv l nw nx">  constructor(<br/>    private readonly commandBus: CommandBus,<br/>    private readonly queryBus: QueryBus<br/>  ) { }</span><span id="2266" class="my mb it nq b gy nz nv l nw nx">  @Get()<br/>  public async getAllOngs(<br/>    @Query() request: ListUsersQuery,<br/>    @Res() response<br/>  ) {<br/>  <br/>    const users = await this.queryBus.execute(<br/>      new ListUsersQuery(<br/>        request.page,<br/>        request.pageSize<br/>      )<br/>    );</span><span id="14cb" class="my mb it nq b gy nz nv l nw nx">    response.status(HttpStatus.OK).json(users);<br/>  }</span><span id="c19c" class="my mb it nq b gy nz nv l nw nx">}</span></pre><p id="6f18" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æˆ‘ä»¬å·²ç»å®šä¹‰äº†@Getã€@Postã€@Putå’Œ@Deleteè£…é¥°å™¨æ¥æŒ‡å®šæ‰€éœ€çš„HTTPè¯·æ±‚æ–¹æ³•ã€‚åŒæ ·ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<strong class="kx iu"> @Query </strong> decoratorä»è¯·æ±‚ä¸­æ£€ç´¢<strong class="kx iu">æŸ¥è¯¢å‚æ•°</strong>ï¼Œä½¿ç”¨<strong class="kx iu"> @Param </strong> decoratorä»è¯·æ±‚ä¸­æ£€ç´¢<strong class="kx iu">è·¯ç”±å‚æ•°</strong>ï¼Œä½¿ç”¨<strong class="kx iu"> @Body </strong> decoratoræ£€ç´¢<strong class="kx iu">è¯·æ±‚ä½“ã€‚</strong></p><p id="c297" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç„¶åï¼Œæˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯æ ¹æ®ç«¯ç‚¹ç›®çš„è°ƒç”¨<strong class="kx iu"> QueryBus </strong>æˆ–<strong class="kx iu"> CommandBus </strong>ï¼Œè°ƒç”¨å…¶<strong class="kx iu"> execute </strong>æ–¹æ³•ï¼Œ<strong class="kx iu">å‘</strong>æä¾›æ‰€éœ€çš„<strong class="kx iu">æŸ¥è¯¢æˆ–å‘½ä»¤</strong>ï¼Œå¹¶ä¼ é€’å¿…è¦çš„ä¿¡æ¯ã€‚æœ‰äº†æ“ä½œç»“æœï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿”å›ä¸€ä¸ª<strong class="kx iu">å“åº”</strong>ï¼Œå…¶ä¸­åŒ…å«æ“ä½œç»“æœå’Œä»»ä½•éœ€è¦çš„æ•°æ®ã€‚æˆ‘ä»¬å®Œäº†ã€‚</p><h2 id="525b" class="my mb it bd mc mz na dn mg nb nc dp mk le nd ne mm li nf ng mo lm nh ni mq nj bi translated">ç»„ä»¶</h2><p id="e801" class="pw-post-body-paragraph kv kw it kx b ky nk jv la lb nl jy ld le nm lg lh li nn lk ll lm no lo lp lq im bi translated">ç°åœ¨ï¼Œå‰©ä¸‹è¦åšçš„å°±æ˜¯åœ¨ç”¨æˆ·æ¨¡å—ä¸­æ³¨å†Œå®ƒã€‚é¦–å…ˆæˆ‘ä»¬ä¸º<em class="lr">å‘½ä»¤</em>åˆ›å»ºä¸€ä¸ª<strong class="kx iu"> <em class="lr">ç´¢å¼•æ–‡ä»¶</em> </strong>ï¼Œä¸º<em class="lr">æŸ¥è¯¢</em>åˆ›å»ºå¦ä¸€ä¸ªã€‚è¿™å°†ä½¿å®ƒæ›´å®¹æ˜“å¯è§†åŒ–å¹¶åœ¨æ¨¡å—ä¸­æä¾›ã€‚<em class="lr">ç´¢å¼•</em>æ–‡ä»¶å°†å¦‚ä¸‹æ‰€ç¤º:</p><pre class="kk kl km kn gt np nq nr ns aw nt bi"><span id="cffc" class="my mb it nq b gy nu nv l nw nx">// commands &gt; _index.ts<br/>export const CommandHandlers = [<br/>  AddUserHandler,<br/>  UpdateUserHandler,<br/>  DeleteUserHandler<br/>];</span><span id="4e7b" class="my mb it nq b gy nz nv l nw nx">// queries &gt; _index.ts<br/>export const QueryHandlers = [<br/>  ListHandler,<br/>  GetUserByIdHandler<br/>];</span></pre><p id="3589" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥åˆ›å»ºæˆ‘ä»¬çš„<em class="lr">ç”¨æˆ·æ¨¡å—</em>ï¼Œå£°æ˜æˆ‘ä»¬çš„<em class="lr">ç”¨æˆ·æ§åˆ¶å™¨</em>ï¼Œå¹¶æä¾›æˆ‘ä»¬çš„<em class="lr">æŸ¥è¯¢</em>å’Œ<em class="lr">å‘½ä»¤</em>ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†å®ƒå¯¼å…¥åˆ°æˆ‘ä»¬çš„<em class="lr"> AppModule </em>ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹äº†ï¼</p><pre class="kk kl km kn gt np nq nr ns aw nt bi"><span id="8a5d" class="my mb it nq b gy nu nv l nw nx">@Module({<br/>  imports: [<br/>    CqrsModule,<br/>    ...<br/>    // Here might be included other Modules, such as<br/>    // the TypeOrmModule<br/>  ],<br/>  controllers: [<br/>    UserController<br/>  ],<br/>  providers: [<br/>    ...QueryHandlers,<br/>    ...CommandHandlers<br/>  ]<br/>})<br/>export class UserModule { }</span></pre></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="8595" class="ma mb it bd mc md me mf mg mh mi mj mk ka ml kb mm kd mn ke mo kg mp kh mq mr bi translated">æ´»åŠ¨é‡‡è´­å’ŒCQRS</h1><p id="5e1e" class="pw-post-body-paragraph kv kw it kx b ky nk jv la lb nl jy ld le nm lg lh li nn lk ll lm no lo lp lq im bi translated">CQRSçš„ä¸€äº›å®ç°ä½¿ç”¨äº†<a class="ae ls" href="https://docs.microsoft.com/en-us/azure/architecture/patterns/event-sourcing" rel="noopener ugc nofollow" target="_blank">äº‹ä»¶æºæ¨¡å¼</a>ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œåº”ç”¨ç¨‹åºçš„<strong class="kx iu">çŠ¶æ€</strong>è¢«<strong class="kx iu">å­˜å‚¨</strong>ä¸º<strong class="kx iu">äº‹ä»¶</strong>çš„<strong class="kx iu">åºåˆ—</strong>ï¼Œå…¶ä¸­æ¯ä¸ªäº‹ä»¶<strong class="kx iu">ä»£è¡¨</strong>å¯¹æ•°æ®çš„ä¸€ç»„<strong class="kx iu">å˜åŒ–</strong>ã€‚é€šè¿‡ä½¿ç”¨äº‹ä»¶æµï¼Œå®ƒ<strong class="kx iu">é¿å…äº†æ›´æ–°å†²çª</strong>å’Œ<strong class="kx iu">æœ€å¤§åŒ–äº†æ€§èƒ½</strong>å’Œ<strong class="kx iu">å¯ä¼¸ç¼©æ€§</strong>ã€‚ç„¶è€Œï¼Œäº‹ä»¶æº<strong class="kx iu">ç»™åº”ç”¨ç¨‹åºè®¾è®¡å¢åŠ äº†</strong>ç”šè‡³<strong class="kx iu">æ›´å¤šçš„å¤æ‚æ€§</strong>ï¼Œåº”ç”¨ç¨‹åºè®¾è®¡åœ¨è¿™ç§æ¨¡å¼ä¸‹å·²ç»å¾ˆå¤æ‚äº†ã€‚</p><p id="8205" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒåŸºäºäº‹ä»¶æºæ¨¡å¼çš„åº”ç”¨ç¨‹åºåªæœ‰<strong class="kx iu">æœ€ç»ˆä¸</strong>ä¸€è‡´ï¼Œå› ä¸ºåœ¨å‘ç”Ÿçš„<strong class="kx iu">äº‹ä»¶</strong>å’Œæ­£åœ¨æ›´æ–°çš„<strong class="kx iu">æ•°æ®å­˜å‚¨</strong>ä¹‹é—´æœ‰ä¸€äº›<strong class="kx iu">å»¶è¿Ÿ</strong>ã€‚æ­¤å¤–ï¼ŒæŒç»­å¤„ç†ç‰¹å®šå®ä½“æˆ–å®ä½“é›†åˆçš„äº‹ä»¶å¯èƒ½éœ€è¦<strong class="kx iu">å¤§é‡å¤„ç†æ—¶é—´</strong>å’Œ<strong class="kx iu">èµ„æºä½¿ç”¨</strong>ã€‚</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><p id="f7f2" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">åƒCQRSè¿™æ ·çš„è®¾è®¡æ¨¡å¼åœ¨æ­£ç¡®åº”ç”¨æ—¶å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨åº”ç”¨ç¨‹åºä¸­ç¼–å†™å’Œç»´æŠ¤é«˜è´¨é‡çš„ä»£ç ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ¨¡å¼ï¼Œäº†è§£å®ƒçš„åŸºæœ¬åŸç†éå¸¸é‡è¦ã€‚æ­¤å¤–ï¼Œæ­£å¦‚æˆ‘ä»¬æ‰€æ¢è®¨çš„ï¼ŒNestJSä½¿å®ç°è¿™ç§æ¨¡å¼å˜å¾—éå¸¸å®¹æ˜“ï¼Œå…è®¸æˆ‘ä»¬åˆ›å»ºå¯ä¼¸ç¼©çš„é«˜æ•ˆåº”ç”¨ç¨‹åºã€‚</p><p id="8ca6" class="pw-post-body-paragraph kv kw it kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å¸Œæœ›æœ‰å¸®åŠ©ï¼ğŸ˜‰</p><h2 id="8a04" class="my mb it bd mc mz na dn mg nb nc dp mk le nd ne mm li nf ng mo lm nh ni mq nj bi translated">å‚è€ƒèµ„æ–™:</h2><div class="oa ob gp gr oc od"><a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/cqrs" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">å‘½ä»¤å’ŒæŸ¥è¯¢è´£ä»»åˆ†ç¦»(CQRS)æ¨¡å¼â€”â€”äº‘è®¾è®¡æ¨¡å¼</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">é€šè¿‡ä½¿ç”¨ä¸åŒçš„æ¥å£ï¼Œå°†è¯»å–æ•°æ®çš„æ“ä½œä¸æ›´æ–°æ•°æ®çš„æ“ä½œåˆ†å¼€ã€‚è¿™æ ·å¯ä»¥æœ€å¤§åŒ–â€¦</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">docs.microsoft.com</p></div></div><div class="om l"><div class="on l oo op oq om or kt od"/></div></div></a></div><div class="oa ob gp gr oc od"><a href="https://docs.nestjs.com/recipes/cqrs" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">æ–‡æ¡£| NestJSâ€”â€”ä¸€ä¸ªæ¸è¿›çš„Node.js webæ¡†æ¶</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">æœ€ç®€å•çš„CRUDåº”ç”¨ç¨‹åºçš„æµç¨‹å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ­¥éª¤æ¥æè¿°:æ§åˆ¶å™¨å±‚å¥æŸ„HTTPâ€¦</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">docs.nestjs.co</p></div></div><div class="om l"><div class="os l oo op oq om or kt od"/></div></div></a></div></div></div>    
</body>
</html>