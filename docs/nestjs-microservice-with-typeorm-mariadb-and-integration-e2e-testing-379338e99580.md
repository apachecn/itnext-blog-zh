# NestJS-é‡‡ç”¨ TypeORMã€MariaDb å’Œé›†æˆ& E2E æµ‹è¯•çš„å¾®æœåŠ¡

> åŸæ–‡ï¼š<https://itnext.io/nestjs-microservice-with-typeorm-mariadb-and-integration-e2e-testing-379338e99580?source=collection_archive---------0----------------------->

ä½¿ç”¨ TypeORMã€MariaDB åœ¨ TCP ä¸Šåˆ›å»ºä¸€ä¸ª NestJS å¾®æœåŠ¡ï¼Œå¹¶å­¦ä¹ å¦‚ä½•ç¼–å†™å•å…ƒã€é›†æˆå’Œ E2E æµ‹è¯•ã€‚

![](img/678fb769171f94148d4de1a32e4de40c.png)

# TLï¼›é€Ÿåº¦ä¸‰è§’å½¢å®šä½æ³•(dead reckoning)

[ä¸‹é¢æ˜¯å¸¦æœ‰ä»£ç çš„ Github repoã€‚](https://github.com/GeoPablo/nestjs-microservice-boilerplate)

# åº

å¦‚æœä½ çœ‹åˆ°è¿™ç¯‡åšæ–‡ï¼Œæˆ‘ä¼šå‡è®¾ä½ å·²ç»å¯¹ä»€ä¹ˆæ˜¯ Nest JS å’Œä»€ä¹ˆæ˜¯å¾®æœåŠ¡æœ‰äº†ä¸€äº›åŸºæœ¬çš„äº†è§£ã€‚

ä»£ç å¯ä»¥å…è´¹ä¸‹è½½å’Œä½¿ç”¨ã€‚åœ¨è¿™ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘ä»¬å°†åªè®¨è®ºå…¶å®ç°ä¸­çš„æ£˜æ‰‹éƒ¨åˆ†ã€‚

å› æ­¤ï¼Œåœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œä¸‹è½½ä»£ç å¹¶è·Ÿéšæˆ‘ã€‚

# ä»£ç ğŸ“ƒ

æˆ‘ä»¬å°†è®¨è®ºçš„å†…å®¹:

1.  [ä» GitHub ä¸‹è½½ä»£ç ğŸ˜€](https://github.com/GeoPablo/nestjs-microservice-boilerplate)
2.  åˆ›å»ºå¾®æœåŠ¡
3.  ä¸ºæˆ‘ä»¬çš„é¡¹ç›®åˆ›å»ºé…ç½®æœåŠ¡
4.  è¿æ¥åˆ°æ•°æ®åº“
5.  åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯å¤„ç†(å¯é€‰)
6.  ä¸ºå…·æœ‰ CRUD æ“ä½œçš„ç”¨æˆ·åˆ›å»ºæ–°æ¨¡å—
7.  æµ‹è¯•(å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•å’Œ e2e æµ‹è¯•)
8.  æ•°æ®åŒ…å‘é€å™¨â€”æµ‹è¯• TCP å¾®æœåŠ¡çš„å®ç”¨ç¨‹åº

**2ã€‚åˆ›å»ºå¾®æœåŠ¡**

**main.ts**

![](img/175716ed10d8d1b5b39a9d912abb79af.png)

[ç”Ÿ](https://carbon.now.sh/?bg=rgba%28171%2C+184%2C+195%2C+1%29&t=seti&wt=none&l=javascript&ds=true&dsyoff=20px&dsblur=68px&wc=true&wa=true&pv=56px&ph=56px&ln=false&fl=1&fm=Hack&fs=14px&lh=133%25&si=false&es=2x&wm=false&code=async%2520function%2520bootstrap%28%29%2520%257B%250A%2520%2520const%2520logger%2520%253D%2520new%2520Logger%28%27Main%27%29%253B%250A%250A%2520%2520const%2520microservicesOptions%253A%2520any%2520%253D%2520%257B%250A%2520%2520%2520%2520transport%253A%2520Transport.TCP%252C%250A%2520%2520%2520%2520options%253A%2520%257B%250A%2520%2520%2520%2520%2520%2520host%253A%2520%27127.0.0.1%27%252C%250A%2520%2520%2520%2520%2520%2520port%253A%25208875%252C%250A%2520%2520%2520%2520%257D%252C%250A%2520%2520%257D%253B%250A%250A%2520%2520const%2520app%253A%2520INestMicroservice%2520%253D%2520await%2520NestFactory.createMicroservice%28%250A%2520%2520%2520%2520AppModule%252C%250A%2520%2520%2520%2520microservicesOptions%252C%250A%2520%2520%29%253B%250A%250A%2520%2520%2520app.listen%28async%2520%28%29%2520%253D%253E%2520%257B%250A%2520%2520%2520%2520logger.log%28%27Microservices%2520is%2520listening...%27%29%253B%250A%2520%2520%257D%29%253B%250A%257D%250Abootstrap%28%29%253B)

æœ‰äº†è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªå¾®æœåŠ¡ï¼Œåœ¨ PC ä¸Šçš„ 8875 ç«¯å£ä¸Šå®æ—¶ä½¿ç”¨ TCP é€šä¿¡ã€‚

**3ã€‚ä¸ºæˆ‘ä»¬çš„é¡¹ç›®åˆ›å»ºä¸€ä¸ªé…ç½®æœåŠ¡**

![](img/d29dd0078878098d3274ce91bfb81264.png)

æˆ‘ä»¬ä½¿ç”¨ **dotenv** æ¥åŠ è½½æˆ‘ä»¬çš„é…ç½®ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸¤ä¸ª**ã€‚env** æ–‡ä»¶ä¸€ä¸ªç”¨äºå¼€å‘ï¼Œä¸€ä¸ªç”¨äºæµ‹è¯•( **.env.development** å’Œ **.env.test** )

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨é…ç½®æœåŠ¡å°†è¿™äº›æ–‡ä»¶åŠ è½½åˆ°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ã€‚

åœ¨ **config.service.ts** æ–‡ä»¶ä¸­ï¼Œæ‚¨ä¼šå‘ç°ä»¥ä¸‹ä»£ç 

![](img/8aadac965e40b680219d3368ef5268ff.png)

[RAW](https://carbon.now.sh/?bg=rgba%28171%2C+184%2C+195%2C+1%29&t=seti&wt=none&l=javascript&ds=true&dsyoff=20px&dsblur=68px&wc=true&wa=true&pv=56px&ph=56px&ln=false&fl=1&fm=Hack&fs=14px&lh=133%25&si=false&es=2x&wm=false&code=switch%2520%28this.%2523nodeEnv%29%2520%257B%250A%2520%2520case%2520%27test%27%253A%250A%2520%2520%2520%2520this.%2523envPath%2520%253D%2520resolve%28process.cwd%28%29%252C%2520%27.env.test%27%29%253B%250A%2520%2520%2520%2520break%253B%250A%2520%2520case%2520%27production%27%253A%250A%2520%2520%2520%2520this.%2523envPath%2520%253D%2520resolve%28process.cwd%28%29%252C%2520%27.env.production%27%29%253B%250A%2520%2520%2520%2520break%253B%250A%2520%2520case%2520%27development%27%253A%250A%2520%2520%2520%2520this.%2523envPath%2520%253D%2520resolve%28process.cwd%28%29%252C%2520%27.env.development%27%29%253B%250A%2520%2520%2520%2520break%253B%250A%2520%2520default%253A%250A%2520%2520%2520%2520throw%2520new%2520Error%28%27Specify%2520the%2520NODE_ENV%2520variable%27%29%253B%250A%257D%250A%250Athis.%2523envConfig%2520%253D%2520dotenv.parse%28fs.readFileSync%28this.%2523envPath%29%29%253B)

è¿˜æœ‰**è¿™ä¸ªã€‚** # **nodeEnv** æ¥è‡ª

![](img/0195bc03d458ed41aa18c5f14660bde8.png)

[æœªåŠ å·¥çš„](https://carbon.now.sh/?bg=rgba%28171%2C+184%2C+195%2C+1%29&t=seti&wt=none&l=javascript&ds=true&dsyoff=20px&dsblur=68px&wc=true&wa=true&pv=56px&ph=56px&ln=false&fl=1&fm=Hack&fs=14px&lh=133%25&si=false&es=2x&wm=false&code=%2523nodeEnv%253A%2520string%2520%253D%2520process.env.NODE_ENV%250A%2520%2520%253F%2520process.env.NODE_ENV.trim%28%29%250A%2520%2520%253A%2520undefined%253B)

æ‰€ä»¥æˆ‘ä»¬æ£€æŸ¥ä»€ä¹ˆæ˜¯ **NODE_ENV** å€¼ï¼Œå¹¶ä¸”æˆ‘ä»¬å°†åŠ è½½**ã€‚å©€**çš„æ–‡ä»¶æ ¹æ®å§ã€‚

è€Œ **NODE_ENV** æ¥è‡ªæˆ‘ä»¬çš„è¿è¡Œè„šæœ¬ã€‚åœ¨ **package.json** ä¸­ä½ ä¼šçœ‹åˆ°**cross-ENV NODE _ ENV = development**å’Œ **cross-env NODE_ENV=test**

åˆ¶ä½œæ²¡æœ‰è„šæœ¬ï¼Œä½†æ˜¯å¯ä»¥æ ¹æ®è‡ªå·±çš„åˆ¶ä½œç¯å¢ƒè‡ªå·±å†™ã€‚

**4ã€‚è¿æ¥åˆ°æ•°æ®åº“**

æˆ‘ä»¬å°† MariaDB ä¸ TypeORM ä¸€èµ·ä½¿ç”¨ï¼Œæ‰€ä»¥é¦–å…ˆï¼Œç¡®ä¿æ‚¨å®‰è£…äº†æ•°æ®åº“æœåŠ¡å™¨ï¼Œå¹¶ä¸”å®ƒå·¥ä½œæ­£å¸¸ã€‚å¦‚æœä½ éœ€è¦ä»»ä½•å¸®åŠ©ï¼Œä½ å¯ä»¥åœ¨ Github é¡µé¢æ‰¾åˆ°ä¸€ä¸ªå…³äºå¦‚ä½•å®‰è£… MariaDB çš„ youtube æ•™ç¨‹çš„é“¾æ¥ã€‚

æˆ‘ä»¬å°†ä»¥å¼‚æ­¥æ¨¡å¼è¿æ¥åˆ°æ•°æ®åº“ï¼Œå› æ­¤ä»£ç å¦‚ä¸‹æ‰€ç¤º:

![](img/d35bda315b0be4443d8ec7a2146c8984.png)

[RAW](https://carbon.now.sh/?bg=rgba%28171%2C+184%2C+195%2C+1%29&t=seti&wt=none&l=javascript&ds=true&dsyoff=20px&dsblur=68px&wc=true&wa=true&pv=56px&ph=56px&ln=false&fl=1&fm=Hack&fs=14px&lh=133%25&si=false&es=2x&wm=false&code=%2540Module%28%257B%250A%2520%2520imports%253A%2520%255B%250A%2520%2520%2520%2520TypeOrmModule.forRootAsync%28%257B%250A%2520%2520%2520%2520%2520%2520imports%253A%2520%255BConfigModule%255D%252C%250A%2520%2520%2520%2520%2520%2520inject%253A%2520%255BConfigService%255D%252C%250A%2520%2520%2520%2520%2520%2520useFactory%253A%2520%28configService%253A%2520ConfigService%29%2520%253D%253E%2520%28%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520type%253A%2520%27mysql%27%252C%250A%2520%2520%2520%2520%2520%2520%2520%2520host%253A%2520configService.get%28%27DB_SERVER_HOST%27%29%252C%250A%2520%2520%2520%2520%2520%2520%2520%2520port%253A%2520Number%28configService.get%28%27DB_SERVER_PORT%27%29%29%252C%250A%2520%2520%2520%2520%2520%2520%2520%2520username%253A%2520configService.get%28%27DB_SERVER_USERNAME%27%29%252C%250A%2520%2520%2520%2520%2520%2520%2520%2520password%253A%2520configService.get%28%27DB_SERVER_PASSWORD%27%29%252C%250A%2520%2520%2520%2520%2520%2520%2520%2520database%253A%2520configService.get%28%27DATABASE%27%29%252C%250A%2520%2520%2520%2520%2520%2520%2520%2520entities%253A%2520%255BUser%255D%252C%250A%2520%2520%2520%2520%2520%2520%2520%2520%252F%252F%2520%21%2520ALWAYS%2520FALSE%2520IN%2520PROD%250A%2520%2520%2520%2520%2520%2520%2520%2520synchronize%253A%2520%21%28process.env.NODE_ENV.trim%28%29%2520%253D%253D%253D%2520%27production%27%29%252C%250A%2520%2520%2520%2520%2520%2520%257D%29%252C%250A%2520%2520%2520%2520%257D%29%252C%250A%2520%2520%255D%252C%250A%257D%29)

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ³¨å…¥ **configService** ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥è·å–æ•°æ®åº“çš„å‡­è¯ã€‚

> **åŒæ­¥â€”â€”è¿™æ˜¯ç”¨æ¥åŒæ­¥ä½ çš„æ•°æ®åº“å’Œä½ çš„å®ä½“ï¼Œå¦‚æœä½ ä¸æƒ³éšæœºä¸¢å¤±ä½ çš„æ•°æ®ï¼Œè¯·ç¡®ä¿åœ¨ç”Ÿäº§ä¸­è®¾ç½®ä¸ºå‡**

ç°åœ¨å›åˆ°ä½ çš„**ã€‚env** æ–‡ä»¶ï¼Œå¹¶ç¡®ä¿ä½¿ç”¨æ‚¨çš„æ•°æ®å®Œæˆä»¥ä¸‹å­—æ®µã€‚å¯¹äº MariaDBï¼Œè¿™äº›æ˜¯ç¼ºçœå€¼ï¼Œé™¤äº†æ•°æ®åº“åã€‚**å¦å¤–ï¼Œä¸è¦å¿˜è®°åˆ›å»ºæ•°æ®åº“ã€‚**

**.env.development**

![](img/e3fa951b02c16cbc32a608de020fe0f8.png)

[RAW](https://carbon.now.sh/?bg=rgba%28171%2C+184%2C+195%2C+1%29&t=seti&wt=none&l=javascript&ds=true&dsyoff=20px&dsblur=68px&wc=true&wa=true&pv=56px&ph=56px&ln=false&fl=1&fm=Hack&fs=14px&lh=133%25&si=false&es=2x&wm=false&code=DB_SERVER_PORT%253D3306%250ADB_SERVER_HOST%253Dlocalhost%250ADB_SERVER_USERNAME%253Droot%250ADB_SERVER_PASSWORD%253Droot%250ADATABASE%253Dusers)

![](img/149305f5fbe075952370832a04bdba99.png)

ä½ å¯ä»¥ä½¿ç”¨ MariaDB è‡ªå¸¦çš„ **HeidiSQL** ã€‚

**5ã€‚åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯å¤„ç†(å¯é€‰)**

ç°åœ¨æ˜¯å¤„ç†é”™è¯¯çš„æ—¶å€™äº†ã€‚æˆ‘çš„æ–¹æ³•æ˜¯åˆ›å»ºä¸€äº›è‡ªå®šä¹‰é”™è¯¯ä»£ç å’Œä¸€äº›å¼‚å¸¸è¿‡æ»¤å™¨ã€‚è¿™é‡Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç”¨äºæ•°æ®åº“ï¼Œä¸€ä¸ªç”¨äºéªŒè¯ï¼Œä¸€ä¸ªç”¨äº RCP å¼‚å¸¸çš„å…¨å±€é”™è¯¯è¿‡æ»¤å™¨ã€‚RCP å› ä¸ºæˆ‘ä»¬æœ‰å¾®æœåŠ¡ã€‚

åŒæ—¶åœ¨ **.env.development** å’Œ **.env.test** ä¸­ç¼–å†™ä»¥ä¸‹ä»£ç 

```
ERROR_CODE_NAMESPACE=users-microservice
```

è¯¥å®ç°å¯ä»¥åœ¨ä»¥ä¸‹æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°:**å…¬å…±- >å¼‚å¸¸è¿‡æ»¤å™¨ã€**å’Œ**æ ¸å¿ƒ- >å®šåˆ¶å“åº”**ã€‚

å¦‚æœæ‚¨ä¸æƒ³ä½¿ç”¨è¿™ç§è‡ªå®šä¹‰çš„é”™è¯¯å¤„ç†ï¼Œå¯ä»¥ä»ä»£ç ä¸­åˆ é™¤è¿™ä¸€éƒ¨åˆ†ï¼Œå¹¶è¿”å›ç®€å•çš„æ¶ˆæ¯ã€‚

**6ã€‚ä¸ºæœ‰ CRUD æ“ä½œçš„ç”¨æˆ·åˆ›å»ºä¸€ä¸ªæ–°æ¨¡å—**

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º **user çš„æ–°æ¨¡å—ã€‚**ä¸ºäº†å°†è¿™ä¸ªæ¨¡å—ä¸æ•°æ®åº“ä¸­çš„è¡¨ **user** è¿æ¥èµ·æ¥ï¼Œæˆ‘ä»¬ç¼–å†™äº†ä»¥ä¸‹ä»£ç 

ç”¨æˆ·æ¨¡å— ts :

```
TypeOrmModule.forFeature([User])
```

åœ¨ **user.service.ts** å’Œ **user.controller.ts** é‡Œé¢ï¼Œä½ ä¼šå‘ç°ä¸åŒ CRUD æ“ä½œçš„å®ç°ã€‚

**7ã€‚æµ‹è¯•(å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•å’Œ e2e æµ‹è¯•)**

åœ¨çœŸå®çš„åœºæ™¯ä¸­ï¼Œå°±æ•°é‡è€Œè¨€ï¼Œå•å…ƒæµ‹è¯•>é›†æˆæµ‹è¯•> e2e æµ‹è¯•ã€‚

å•å…ƒæµ‹è¯•æ²¡æœ‰é‚£ä¹ˆéš¾ï¼Œæ‰€ä»¥æˆ‘åªå†™äº†è¿™ä¸ªåœºæ™¯çš„ä¸€ä¸ªä¾‹å­ã€‚ä½ å¯ä»¥åœ¨ **user.service.spec.ts** é‡Œé¢æ‰¾åˆ°ã€‚

ç®€è€Œè¨€ä¹‹ï¼Œæ‚¨é€šè¿‡ä½¿ç”¨æ¨¡æ‹Ÿå®ç°å°†åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªå•å…ƒä¸ä»£ç çš„å…¶ä½™éƒ¨åˆ†éš”ç¦»å¼€æ¥ï¼Œä»è€Œå¯¹å…¶è¿›è¡Œæµ‹è¯•ã€‚

åœ¨ i **é›†æˆæµ‹è¯•ä¸­ï¼Œ**ä½ æ£€æŸ¥ä¸åŒçš„æ¨¡å—æ˜¯å¦åœ¨ä¸€èµ·å·¥ä½œã€‚æ‰€ä»¥åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¸å†æ¨¡ä»¿æ•°æ®åº“ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªçœŸå®çš„æ•°æ®åº“ã€‚

æ‚¨å¯ä»¥åœ¨**user . integration . spec . ts**ä¸­æ‰¾åˆ°æ‰€æœ‰ CRUD æ“ä½œçš„æµ‹è¯•

åœ¨ **E2E æµ‹è¯•**ä¸­ï¼Œä½ ä»å¤´åˆ°å°¾æ£€æŸ¥ç”³è¯·æµç¨‹ã€‚

å¯åŠ¨å¾®æœåŠ¡ã€è¿æ¥åˆ°å¾®æœåŠ¡å¹¶æå–å®¢æˆ·ç«¯çš„ä»£ç å¦‚ä¸‹:

**æµ‹è¯•/åº”ç”¨ e2e è§„èŒƒ**

![](img/69856ae0f23484094603e2d608b84a12.png)

[RAW](https://carbon.now.sh/?bg=rgba%28171%2C+184%2C+195%2C+1%29&t=seti&wt=none&l=javascript&ds=true&dsyoff=20px&dsblur=68px&wc=true&wa=true&pv=56px&ph=56px&ln=false&fl=1&fm=Hack&fs=14px&lh=133%25&si=false&es=2x&wm=false&code=beforeAll%28async%2520%28%29%2520%253D%253E%2520%257B%250A%2520%2520const%2520moduleFixture%253A%2520TestingModule%2520%253D%2520await%2520Test.createTestingModule%28%257B%250A%2520%2520%2520%2520imports%253A%2520%255B%250A%2520%2520%2520%2520%2520%2520AppModule%252C%250A%2520%2520%2520%2520%2520%2520ClientsModule.register%28%255B%250A%2520%2520%2520%2520%2520%2520%2520%2520%257B%2520name%253A%2520%27clientToken%27%252C%2520transport%253A%2520Transport.TCP%2520%257D%252C%250A%2520%2520%2520%2520%2520%2520%255D%29%252C%250A%2520%2520%2520%2520%255D%252C%250A%2520%2520%257D%29.compile%28%29%253B%250A%250A%2520%2520userController%2520%253D%2520moduleFixture.get%253CUserController%253E%28UserController%29%253B%250A%250A%2520%2520app%2520%253D%2520moduleFixture.createNestApplication%28%29%253B%250A%250A%2520%2520app.connectMicroservice%28%257B%250A%2520%2520%2520%2520transport%253A%2520Transport.TCP%252C%250A%2520%2520%257D%29%253B%250A%250A%2520%2520await%2520app.startAllMicroservicesAsync%28%29%253B%250A%2520%2520await%2520app.init%28%29%253B%250A%250A%2520%2520client%2520%253D%2520app.get%28%27clientToken%27%29%253B%250A%2520%2520await%2520client.connect%28%29%253B%250A%257D%29%253B)

**8ã€‚æ•°æ®åŒ…å‘é€è€…â€”æµ‹è¯• TCP å¾®æœåŠ¡çš„å®ç”¨ç¨‹åº**

å¦‚æœä½ æƒ³ä½¿ç”¨å·¥å…·æµ‹è¯•ä½ çš„å¾®æœåŠ¡ï¼Œå°±åƒç”¨ Postman æµ‹è¯•ä½ çš„ REST API ä¸€æ ·ï¼Œä½ å¯ä»¥ä½¿ç”¨[æ•°æ®åŒ…å‘é€å™¨](https://packetsender.com/)

è¦è¿›è¡Œé…ç½®ï¼Œæ‚¨å¿…é¡»æŒ‰å¦‚ä¸‹æ–¹å¼å¡«å†™å­—æ®µ:

![](img/6a974c341c014bbaeb2b76da628f7be0.png)

åœ°å€â€”æœ¬åœ°ä¸»æœºï¼›ç«¯å£â€”å¾®æœåŠ¡ç«¯å£

åœ¨ **ASCII** æ–‡ä»¶ä¸­ä½ å†™ä¸‹ä½ çš„å‘½ä»¤ã€‚

**122#** â€”è¡¨ç¤ºæ¶ˆæ¯çš„é•¿åº¦

ä½ å¯ä»¥é€šè¿‡æ‰“å¼€[blank.org](https://blank.org)æ¥æŸ¥çœ‹ä½ çš„æ¶ˆæ¯é•¿åº¦ï¼Œç„¶ååœ¨å¼€å‘è€…å·¥å…·é‡Œé¢å†™ä¸‹ä½ çš„æ¶ˆæ¯ã€‚

![](img/b2ac700aa7399287595d11f9e2103bff.png)

åœ¨ä»¥ä¸‹å­—æ®µä¸­å†™å…¥ JSON æ•°æ®:

```
â€dataâ€:{â€œemailâ€:â€[q@gmail.com](mailto:q@gmail.com)â€,â€passwordâ€:â€12345678"}
```

å­—ç¬¦ä¸²çš„æœ€åä¸€éƒ¨åˆ†è¡¨ç¤ºæ¶ˆæ¯çš„ç±»å‹ã€‚

```
â€idâ€:â€ce51ebd3â€“32b1â€“4ae6-b7ef-e018126c4cc4"
```

è¯¥å€¼å°†æ˜ å°„åˆ°**@ message pattern(' create _ user ')**

å¦‚æœæ‚¨æƒ³æ˜ å°„åˆ° **@EventPattern()** ï¼Œé‚£ä¹ˆä½¿ç”¨è¿™ä¸ª **id çš„ä»»ä½•å…¶ä»–å€¼ã€‚**

# ç»“è®º

ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸€ç‚¹ï¼Œæˆ‘æ¨èæ‚¨ä» GitHub ä¸‹è½½ä»£ç å¹¶ä½¿ç”¨å®ƒã€‚å°è¯•åˆ›å»ºä¸€ä¸ªç±»ä¼¼äº*å¸–å­*æˆ–*ç…§ç‰‡*çš„æ–°æ¨¡å—ï¼Œå¹¶å°†å…¶ä½œä¸º**å¤šå¯¹ä¸€**å’Œ**ä¸€å¯¹å¤š**ä¸æ‚¨çš„ç”¨æˆ·é“¾æ¥ï¼Œæˆ–è€…åˆ›å»ºä¸€ä¸ªä½¿ç”¨è¯¥å¾®æœåŠ¡çš„å®¢æˆ·ç«¯ã€‚

å¦‚æœä½ ä¹Ÿæƒ³åœ¨ç”Ÿäº§ä¸­æµ‹è¯•è¿™ä¸ªä»£ç ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª[æ•°å­—æµ·æ´‹](https://m.do.co/c/f0f252058644)çš„é“¾æ¥ï¼Œä»·æ ¼æ˜¯ 100 ç¾å…ƒã€‚