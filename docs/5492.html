<html>
<head>
<title>Using async/await inside loops in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åœ¨JavaScriptä¸­ä½¿ç”¨async/awaitå†…éƒ¨å¾ªç¯</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/using-async-await-inside-loops-in-javascript-5b0ccc9f0ef4?source=collection_archive---------1-----------------------#2021-03-17">https://itnext.io/using-async-await-inside-loops-in-javascript-5b0ccc9f0ef4?source=collection_archive---------1-----------------------#2021-03-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/01c61b9bf5105e9d07b0851fcb85035c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_xOXkK81QhSFoAxOZ7AmFw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">ç”±<a class="ae kf" href="https://unsplash.com/@layton?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">é›·é¡¿é’»çŸ³</a>åœ¨<a class="ae kf" href="/s/photos/marina?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><p id="17da" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">éå†æ¡ç›®å’Œå¤„ç†å¼‚æ­¥é€»è¾‘(å³APIè°ƒç”¨)å¯èƒ½æ˜¯æˆ‘ä»¬ä½œä¸ºJavaScriptå¼€å‘äººå‘˜å¿…é¡»æ‰§è¡Œçš„ä¸¤ä¸ªæœ€å¸¸è§çš„ä»»åŠ¡ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºç»“åˆasync/awaitå’Œè¿­ä»£é€»è¾‘çš„æœ€ä½³æ–¹æ³•ã€‚æœ‰æ—¶ï¼Œæ‚¨ä¼šå¸Œæœ›åœ¨forå¾ªç¯(æˆ–ä»»ä½•å…¶ä»–ç±»å‹çš„å¾ªç¯)ä¸­è¿è¡Œå¼‚æ­¥æ“ä½œã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å¤„ç†è¿™ç§æƒ…å†µã€‚</p><h1 id="8887" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">æŒ‰é¡ºåºé˜…è¯»æ‰¿è¯º</h1><p id="f516" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–‡ä»¶åˆ—è¡¨ï¼Œæˆ‘ä»¬æƒ³è¯»å–å¹¶è®°å½•åºåˆ—ä¸­æ¯ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚æˆ‘ä»¬è¯¥æ€ä¹ˆåšï¼Ÿå—¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¼‚æ­¥å‡½æ•°ä¸­ä½¿ç”¨å¾ªç¯çš„<strong class="ki iu">ã€‚ä¸‹é¢æ˜¯ä»£ç ç‰‡æ®µã€‚</strong></p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="d11b" class="mq lf it mm b gy mr ms l mt mu">async function printFiles () {<br/>  let fileNames = ['picard', 'kirk', 'geordy', 'ryker', 'worf'];<br/>  for (const file of fileNames) {<br/>    const contents = await fs.readFile(file, 'utf8');<br/>    console.log(contents);<br/>  }<br/>}</span></pre><blockquote class="mv mw mx"><p id="0bdf" class="kg kh my ki b kj kk kl km kn ko kp kq mz ks kt ku na kw kx ky nb la lb lc ld im bi translated">ğŸ’¡<em class="it">æ³¨æ„ï¼Œå¦‚æœä½ æƒ³æŒ‰é¡ºåºè¯»å–æ–‡ä»¶ï¼Œä½ </em> <strong class="ki iu"> <em class="it">ä¸èƒ½</em> </strong> <em class="it">ä½¿ç”¨</em><strong class="ki iu"><em class="it">forEach</em></strong><em class="it">å¾ªç¯ã€‚</em></p></blockquote><p id="8d8a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯¦ç»†è¯´æ˜è¿™ä¸€ç‚¹ã€‚</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="9739" class="mq lf it mm b gy mr ms l mt mu">async function someFunction(items) {<br/>  items.forEach( async(i) =&gt; {<br/>     const res = await someAPICall(i);<br/>     console.log('---&gt;', res);<br/>  });<br/>}</span><span id="cf14" class="mq lf it mm b gy nc ms l mt mu">function someAPICall(param) {<br/>    return new Promise((resolve, reject)=&gt;{<br/>      setTimeout(()=&gt;{<br/>        resolve("Resolved" + param)<br/>      },param);<br/>    })<br/>}</span><span id="ff50" class="mq lf it mm b gy nc ms l mt mu">someFunction(['3000','8000','1000','4000']);</span></pre><p id="0b8c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„å¼‚æ­¥å‡½æ•°ï¼Œåä¸º<strong class="ki iu"> someFunctionï¼Œ</strong>ï¼Œå®ƒæ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ï¼Œè¿­ä»£æ•°ç»„ï¼Œå¹¶ä¸ºæ¯ä¸€é¡¹å‘å‡ºä¸€ä¸ªAPIè¯·æ±‚(é€šè¿‡å‡çš„APIå‡½æ•°)ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æŒ‰é¡ºåºè§£æAPIè°ƒç”¨ã€‚æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„è¾“å‡ºæ‰“å°å¦‚ä¸‹</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="66d9" class="mq lf it mm b gy mr ms l mt mu">// expected<br/>3000<br/>8000<br/>1000<br/>4000</span></pre><p id="7239" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬çœ‹åˆ°çš„ä¸æ˜¯è¿™ä¸ªè¾“å‡ºï¼Œè€Œæ˜¯ä¸‹é¢çš„ç»“æœ</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="541c" class="mq lf it mm b gy mr ms l mt mu">// actual<br/>1000<br/>3000<br/>4000<br/>8000</span></pre><p id="2a72" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">forEachå¾ªç¯ä¸æ˜¯æŒ‰é¡ºåºè¿è¡ŒAPIè°ƒç”¨ï¼Œè€Œæ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è®¾ç½®APIè°ƒç”¨ã€‚å®ƒä¸ä¼šç­‰å¾…ä¸Šä¸€ä¸ªè°ƒç”¨ç»“æŸã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼šå¾—åˆ°å…ˆè§£å†³çš„æ‰¿è¯ºã€‚è¿™æ˜¯æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨forEachå¾ªç¯çš„ä¸»è¦åŸå› ã€‚</p><p id="50be" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ª<strong class="ki iu"> reduce </strong>å‡½æ•°æ¥è¿­ä»£æ•°ç»„å¹¶ä¾æ¬¡è§£ææ‰¿è¯ºã€‚è®©æˆ‘ä»¬å¿«é€Ÿçœ‹ä¸€ä¸ªä¾‹å­ã€‚</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="174e" class="mq lf it mm b gy mr ms l mt mu">function testPromise(time) {<br/>  return new Promise((resolve, reject) =&gt; {<br/>    setTimeout(() =&gt; {<br/>      console.log(`Processing ${time}`);<br/>      resolve(time);<br/>    }, time);<br/>  });<br/>}</span><span id="333b" class="mq lf it mm b gy nc ms l mt mu">let result = [3000,2000,1000, 4000].reduce( (accumulatorPromise, nextID) =&gt; {<br/>  return accumulatorPromise.then(() =&gt; {<br/>    return testPromise(nextID);<br/>  });<br/>}, Promise.resolve());</span><span id="c061" class="mq lf it mm b gy nc ms l mt mu">result.then(e =&gt; {<br/>  console.log("All Promises Resolved !!âœ¨")<br/>});</span></pre><p id="1e01" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¾ˆæ•´æ´ä¸æ˜¯å—ï¼Ÿå¦ä¸€ç§è§£å†³åºåˆ—æ‰¿è¯ºçš„æ–¹æ³•æ˜¯ä½¿ç”¨<strong class="ki iu">å¼‚æ­¥ç”Ÿæˆå™¨ã€‚</strong></p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="281c" class="mq lf it mm b gy mr ms l mt mu">async function* readFiles(files) {<br/>  for(const file of files) {<br/>    yield await readFile(file);<br/>  }<br/>};</span></pre><p id="a7ae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç”Ÿæˆå™¨å’Œå¤§å¤šæ•°ç°ä»£æµè§ˆå™¨å’ŒNode 10åŠä»¥ä¸Šç‰ˆæœ¬çš„æ”¯æŒã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œäº†è§£æ›´å¤šå…³äºJavascript <a class="ae kf" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_Generators" rel="noopener ugc nofollow" target="_blank">ä¸­çš„ç”Ÿæˆå™¨å’Œè¿­ä»£å™¨ã€‚</a></p><h1 id="dc89" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">å¹¶è¡Œè§£å†³æ‰¿è¯º</h1><p id="f305" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å¹¶è¡Œè§£å†³æ‰¿è¯ºã€‚è®©æˆ‘ä»¬å›åˆ°ç¬¬ä¸€ä¸ªä¾‹å­ã€‚æˆ‘ä»¬ç°åœ¨æƒ³å¹¶è¡Œè¯»å–æ–‡ä»¶ï¼Œè€Œä¸æ˜¯æŒ‰é¡ºåºè¯»å–ã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæˆ‘ä»¬ä¸å…³å¿ƒå†…å®¹åœ¨æ§åˆ¶å°ä¸­çš„æ‰“å°é¡ºåºã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨ä¸€ä¸ª<strong class="ki iu"> Promise.all() </strong>å‡½æ•°å’Œä¸€ä¸ª<strong class="ki iu"> map </strong>ã€‚</p><pre class="mh mi mj mk gt ml mm mn mo aw mp bi"><span id="cba7" class="mq lf it mm b gy mr ms l mt mu">async function printFiles () {<br/>  let fileNames = ['picard', 'kirk', 'geordy', 'ryker', 'worf'];<br/>  await Promise.all(fileNames.map(async (file) =&gt; {<br/>    const contents = await fs.readFile(file, 'utf8');<br/>    console.log(contents);<br/>  }));<br/>}</span></pre><p id="e0e3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æ¯ä¸ª<code class="fe nd ne nf mm b">async</code>å›è°ƒå‡½æ•°è°ƒç”¨éƒ½è¿”å›ä¸€ä¸ªæ‰¿è¯ºï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªPrmiss.all()å¹¶è¡Œåœ°ä¸€æ¬¡å­˜å‚¨å’Œè§£æå®ƒä»¬ã€‚</p><p id="ac3a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘å¸Œæœ›è¿™ç¯‡å¿«é€Ÿé˜…è¯»èƒ½è®©æ‚¨æ·±å…¥äº†è§£å¦‚ä½•åœ¨å¾ªç¯ä¸­ä½¿ç”¨å¼‚æ­¥ä»£ç ã€‚ä»Šå¤©åˆ°æ­¤ä¸ºæ­¢ï¼Œä¸‹æ¬¡å†è§ã€‚</p><p id="3b5b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">å‚è€ƒæ–‡çŒ®:</strong></p><p id="6348" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_Generators" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/JavaScript/Guide/Iterators _ and _ Generators</a></p><p id="b31d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://stackoverflow.com/questions/37576685/using-async-await-with-a-foreach-loop" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/37576685/using-async-await-with-a-foreach-loop</a></p><p id="dc9b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://css-tricks.com/why-using-reduce-to-sequentially-resolve-promises-works/" rel="noopener ugc nofollow" target="_blank">https://CSS-tricks . com/why-using-reduce-to-sequentially-resolve-promises-works/</a></p></div></div>    
</body>
</html>