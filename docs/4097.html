<html>
<head>
<title>Jenkins Shared Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">è©¹é‡‘æ–¯å…±äº«å›¾ä¹¦é¦†</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/jenkins-shared-library-f3408ddb3603?source=collection_archive---------5-----------------------#2020-04-26">https://itnext.io/jenkins-shared-library-f3408ddb3603?source=collection_archive---------5-----------------------#2020-04-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e7aa0b238feb69a72f5798bdf3c6665b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ha3ghp1nPtSwjXpn"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae kc" href="https://unsplash.com/@itfeelslikefilm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">ğŸ‡¸ğŸ‡®Â·æ‰¬ç§‘Â·è²åˆ©</a>åœ¨<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</figcaption></figure><p id="6ef3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ITç•Œçš„æ¯ä¸ªäººéƒ½çŸ¥é“ä»€ä¹ˆæ˜¯CIåŠå…¶è‘—åçš„å®ç°ï¼Œé‚£å°±æ˜¯<strong class="kf ir">è©¹é‡‘æ–¯</strong>ã€‚åœ¨è¿‡å»çš„å‡ å¹´ä¸­ï¼ŒDevOpså·¥ç¨‹å¸ˆå¯ä»¥å°†æŒç»­é›†æˆé“¾<em class="lb">ç»„ç»‡ä¸ºä¸€ä¸ªç®¡é“ï¼Œå¼•å…¥ä¸€ä¸ª<strong class="kf ir"> DSL </strong>(é¢†åŸŸç‰¹å®šè¯­è¨€)æ¥é€šè¿‡<em class="lb"> Jenkinsfile </em>ç®¡ç†å®ƒ:</em></p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="39d4" class="ll lm iq lh b gy ln lo l lp lq">pipeline {<br/>    agent any</span><span id="55c2" class="ll lm iq lh b gy lr lo l lp lq">    stages {<br/>        stage('Build') {<br/>            steps {<br/>                echo 'Building..'<br/>            }<br/>        }<br/>        stage('Test') {<br/>            steps {<br/>                echo 'Testing..'<br/>            }<br/>        }<br/>        stage('Deploy') {<br/>            steps {<br/>                echo 'Deploying....'<br/>            }<br/>        }<br/>    }<br/>}</span></pre><p id="8a6d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä¸‹é¢çš„é“¾æ¥<a class="ae kc" href="https://jenkins.io/doc/book/pipeline/jenkinsfile/" rel="noopener ugc nofollow" target="_blank">https://jenkins.io/doc/book/pipeline/jenkinsfile/</a>è§£é‡Šäº†å®ƒçš„è¯­æ³•å’Œç‰¹æ€§ï¼Œä½†æ˜¯åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘æƒ³ç”¨ä¸€ä¸ªå®é™…çš„ä¾‹å­å‘ä½ ä»‹ç»<a class="ae kc" href="https://jenkins.io/doc/book/pipeline/shared-libraries/" rel="noopener ugc nofollow" target="_blank"> Jenkinså…±äº«åº“</a>ã€‚</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/03977859142c07433f861bece402d7bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*8UiQIv0OWGSB7cn9eFWa4g.png"/></div></figure><p id="433d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å¦‚å‰é¢çš„è„šæœ¬æ‰€ç¤ºï¼ŒJenkinsfileå¯èƒ½å˜å¾—éå¸¸ä¸å¯è¯»ï¼Œä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œæ‚¨å¯ä»¥ç¼–å†™ä¸€ä¸ªåº“æ¥åŒ…è£…æ‚¨çš„ä½œä¸šã€‚è®©æˆ‘ä»¬ä»ä¸‹é¢çš„ç®¡é“å¼€å§‹:</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="bcea" class="ll lm iq lh b gy ln lo l lp lq">pipeline {<br/>    agent any <br/>    tools {<br/>        jdk 'jdk11'<br/>    }<br/>    <br/>    stages {<br/>        stage('Checkout') { <br/>            steps {<br/>                ansiColor('xterm') {<br/>                    checkout scm<br/>                }<br/>            }<br/>        }<br/>        stage('Build') { <br/>            steps {<br/>                ansiColor('xterm') {<br/>                    withMaven(maven:'maven3.6.3'){<br/>                        sh 'mvn clean package'<br/>                    }<br/>                }<br/>            }<br/>        }<br/>        <br/>    }<br/>}</span></pre><p id="e607" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä¸€ä¸ªç®€å•çš„æ£€æŸ¥å’Œæ„å»ºå·²ç»å˜å¾—ä¸å¯è¯»ï¼Œè®©æˆ‘ä»¬æƒ³æƒ³å¦‚æœä½ å¼€å§‹æ·»åŠ å…¶ä»–é˜¶æ®µï¼Œæ¯”å¦‚è´¨é‡æˆ–éƒ¨ç½²æ­¥éª¤ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆã€‚ä¸ºäº†ç®€åŒ–ç®¡é“ï¼Œä½ å¯ä»¥ä½¿ç”¨Jenkinsç¢ç‰‡åº“ï¼Œä½†æ˜¯è®©æˆ‘ä»¬ä»å¤´å¼€å§‹ã€‚ä¸ºäº†æ‰§è¡Œå‰é¢çš„ç®¡é“ï¼Œæ‚¨éœ€è¦åœ¨Jenkinsä¸Šå®‰è£…:</p><ul class=""><li id="1dcf" class="lt lu iq kf b kg kh kk kl ko lv ks lw kw lx la ly lz ma mb bi translated">JDK11</li><li id="5228" class="lt lu iq kf b kg mc kk md ko me ks mf kw mg la ly lz ma mb bi translated">ä¸“å®¶</li><li id="c066" class="lt lu iq kf b kg mc kk md ko me ks mf kw mg la ly lz ma mb bi translated"><a class="ae kc" href="https://plugins.jenkins.io/pipeline-maven/" rel="noopener ugc nofollow" target="_blank">ç®¡é“Mavené›†æˆ</a></li></ul><p id="b374" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä¸ºäº†å®‰è£…JDK11ï¼Œæˆ‘è¿˜å®‰è£…äº†<a class="ae kc" href="https://plugins.jenkins.io/adoptopenjdk/" rel="noopener ugc nofollow" target="_blank"> AdoptOpenJDKå®‰è£…ç¨‹åº</a>ï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œç°åœ¨Jenkinså¯ä»¥ä»<em class="lb"> Global instrument </em>éƒ¨åˆ†ä¸‹è½½JDK11(æˆ‘å°†æ ‡ç­¾è®¾ç½®ä¸º<em class="lb">â€˜JDK 11â€™</em>)</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mh"><img src="../Images/9c2876e241076a7c9d6efca6615b69a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RyP3XrpdqwFA3-dA.png"/></div></div></figure><p id="c641" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç„¶åæˆ‘è£…äº†Maven 3.6.3ï¼Œè´´ä¸Šäº†<em class="lb">â€˜Maven 3 . 6 . 3â€™</em>çš„æ ‡ç­¾</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/151dcf6a3b0fedbb5673605527d13e74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eWZE1HSNZ_25y9ie.png"/></div></div></figure><p id="976c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç°åœ¨ä½ å¯ä»¥æ‰§è¡Œå‰é¢çš„ç®¡é“äº†â€¦ä½†æ˜¯æˆ‘ä»¬èƒ½ä¸èƒ½åƒä¸‹é¢çš„ä»£ç ç‰‡æ®µé‚£æ ·ç”¨æ›´å¥½çš„æ–¹å¼å†™å‰é¢çš„ç®¡é“å‘¢ï¼Ÿ</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="d211" class="ll lm iq lh b gy ln lo l lp lq">@Library('jenkins-lib@1.0.0') _</span><span id="3c38" class="ll lm iq lh b gy lr lo l lp lq">jenkinslib(this, "test")<br/>    .withMavenVersion("maven3.6.3")<br/>    .withJdkVersion("jdk11")<br/>    .execute()</span></pre><p id="dfea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ˜¯çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è©¹é‡‘æ–¯å…±äº«åº“åŠŸèƒ½ï¼ç¬¬ä¸€è¡Œè¡¨ç¤ºåº“å¼•ç”¨:è¦å¼•ç”¨ä¸€ä¸ªåº“ï¼Œæ‚¨éœ€è¦é€šè¿‡Jenkinså…¨å±€é…ç½®æ¥å®‰è£…å®ƒã€‚é€šå¸¸è¿™ä¸ªåº“å¿…é¡»ä½äºSCMåº“ï¼Œæˆ‘æŠŠæˆ‘çš„åº“æ”¾åœ¨<a class="ae kc" href="https://github.com/paspao/jenkins-lib/" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ªgithub repo </a>ä¸Šï¼Œç„¶åæˆ‘åœ¨Jenkinsä¸Šé…ç½®å®ƒï¼Œå‘½åä¸º<em class="lb">â€˜Jenkins-libâ€™</em>ï¼Œæˆ‘è¿˜å¯ç”¨äº†<em class="lb">â€˜å‘ç°æ ‡ç­¾â€™</em>ã€‚</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/dc4fada272ba13d6e4f37421315c494a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yamiSDqiCTexfWVC.png"/></div></div></figure><p id="1bf7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç°åœ¨æˆ‘å¯ä»¥åœ¨Jenkinsfileä¸­å¼•ç”¨æˆ‘çš„åº“ï¼Œå¦‚<strong class="kf ir">@ Library(' Jenkins-lib @ 1 . 0 . 0 ')</strong>æˆ–<em class="lb">@ Library(' Jenkins-lib @ master ')</em>æˆ–ç®€å•åœ°é€šè¿‡æ ‡ç­¾æˆ–åˆ†æ”¯ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬çš„<em class="lb"> @Library('jenkins-lib') </em>ã€‚åœ¨åº“ç¬¦å·åé¢æœ‰ä¸€ä¸ªä¸‹åˆ’çº¿<strong class="kf ir"> _ </strong>ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬æƒ³æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½åŒ…å«åˆ°å½“å‰çš„ç®¡é“ä¸­(å¦åˆ™æˆ‘ä»¬å¿…é¡»æ”¾ä¸€ä¸ªç‰¹å®šçš„<em class="lb">å¯¼å…¥</em>ï¼Œä½†è¿™ä¸æ˜¯æˆ‘ä»¬çš„æƒ…å†µ)ã€‚</p><p id="8e11" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è®©æˆ‘ä»¬çœ‹çœ‹åº“ç»“æ„:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/60eb07f5d6881e023e66adbdabd85315.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/0*9g_6HUg84KHkfs2R.png"/></div></figure><p id="badd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘å®šä¹‰äº†ä¸€ä¸ªJenkinsåº“ç»“æ„æ‰€éœ€è¦çš„ç›®å½•<strong class="kf ir"> vars </strong>ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªgroovyè„šæœ¬<em class="lb"> jenkinslib.groovy </em>ï¼Œåœ¨è¿™ä¸ªç›®å½•ä¸­æ¯ä¸ªã€‚groovyæ–‡ä»¶å¯ä»¥è¢«<em class="lb"> Jekinsfile </em>å¼•ç”¨ã€‚åœ¨æˆ‘çš„ä¾‹å­ä¸­ï¼Œè¡Œ<em class="lb"> jenkinslib(â€¦) </em>æ˜¯å¯¹åŒ…å«ç‰¹æ®Šå‡½æ•°<em class="lb">è°ƒç”¨(â€¦) </em>çš„<em class="lb"> jenkinslib.groovy </em>æ–‡ä»¶çš„å¼•ç”¨</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="3007" class="ll lm iq lh b gy ln lo l lp lq">import org.paspao.sharedlib.JenkinsBuilder</span><span id="f312" class="ll lm iq lh b gy lr lo l lp lq">JenkinsBuilder call(def scriptReference, String projectName) {<br/>    return new JenkinsBuilder(scriptReference,projectName,env['BRANCH_NAME'])<br/>}</span><span id="96a9" class="ll lm iq lh b gy lr lo l lp lq">return this</span></pre><p id="5480" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæˆ‘ç®€å•åœ°ç”¨ä¸€äº›åˆå§‹åŒ–å‚æ•°åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡<em class="lb"> JenkinsBuilder </em>ï¼Œä½†æ˜¯çœŸæ­£çš„æ¶ˆæ¯æ˜¯ï¼Œæˆ‘æ­£åœ¨æŠŠæˆ‘çš„ç®¡é“ä»å‡½æ•°å¼ç¼–ç¨‹è½¬ç§»åˆ°é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ï¼Œè¿™ç»™äº†ç®¡é“ä»£ç æ›´å¤šçš„å¯è¯»æ€§ã€‚ç¥å¥‡çš„æ˜¯ä½¿ç”¨Closureå¯¹è±¡å®ç°çš„ï¼Œè¿™ä¸ªå¯¹è±¡(è·å¾—Groovyå®šä¹‰)<em class="lb">æ˜¯ä¸€ä¸ªå¼€æ”¾çš„ã€åŒ¿åçš„ä»£ç å—ï¼Œå®ƒå¯ä»¥æ¥å—å‚æ•°ã€è¿”å›å€¼å¹¶è¢«èµ‹ç»™å˜é‡</em>ã€‚</p></div></div>    
</body>
</html>