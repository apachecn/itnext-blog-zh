<html>
<head>
<title>Kubernetes Journey â€” Up and running out of the cloud â€” How to setup the Gateway and Busybox components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetesä¹‹æ—…â€”â€”å¯åŠ¨å¹¶è¿è¡Œäº‘è®¡ç®—â€”â€”å¦‚ä½•è®¾ç½®ç½‘å…³å’ŒBusyboxç»„ä»¶</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/kubernetes-journey-up-and-running-out-of-the-cloud-starting-the-actual-setup-737c0f3e0fb1?source=collection_archive---------3-----------------------#2019-12-10">https://itnext.io/kubernetes-journey-up-and-running-out-of-the-cloud-starting-the-actual-setup-737c0f3e0fb1?source=collection_archive---------3-----------------------#2019-12-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/4c0668a8d1459be120fd9b3d96dcab96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6lrPmjjm6Dq7ARrIIkRxJA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">å®‰å¨œæ–¯å¡”è¥¿å¨…Â·æœå°”å‰å°”åœ¨<a class="ae kc" href="https://unsplash.com/s/photos/network?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šçš„ç…§ç‰‡</figcaption></figure></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><p id="8e23" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">ä½ å¥½ã€‚æ¬¢è¿å›åˆ°æˆ‘ä»¬çš„<a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/kubernetes-journey-up-and-running-out-of-the-cloud-introduction-f04a811c92a5"> Kubernetesä¹‹æ—…â€”â€”å¯åŠ¨å¹¶è¿è¡Œäº‘</a>ã€‚åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¸ºUbuntuå’ŒDebianåˆ›å»ºäº†åŸºç¡€æ˜ åƒï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒä¸ºè§£å†³æ–¹æ¡ˆçš„ä»¥ä¸‹ç»„ä»¶åˆ›å»ºç‰¹å®šæ˜ åƒ:</p><ul class=""><li id="24fc" class="li lj iq km b kn ko kr ks kv lk kz ll ld lm lh ln lo lp lq bi translated"><strong class="km ir">ç½‘å…³</strong> ( <strong class="km ir">ä¸€ä¸ª</strong>å®ä¾‹)</li><li id="daf0" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><strong class="km ir"> Busybox </strong> ( <strong class="km ir">ä¸€ä¸ª</strong>å®ä¾‹)</li><li id="95d1" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><strong class="km ir"> HAä»£ç†</strong> ( <strong class="km ir">ä¸¤ä¸ª</strong>å®ä¾‹)</li><li id="e705" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><strong class="km ir"> Kuberneteså¤§å¸ˆ</strong> ( <strong class="km ir">ä¸‰</strong>å®ä¾‹)</li><li id="e65b" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><strong class="km ir"> Kubernetes Worker </strong> ( <strong class="km ir">ä¸‰ä¸ª</strong>å®ä¾‹)</li><li id="d4f7" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><strong class="km ir"> GlusterèŠ‚ç‚¹</strong> ( <strong class="km ir">ä¸‰ä¸ª</strong>å®ä¾‹)</li></ul><p id="2382" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">æŸ¥çœ‹æˆ‘ä»¬çš„<a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/kubernetes-journey-up-and-running-out-of-the-cloud-architecture-overview-e75763b54922">æ¶æ„æ¦‚è¿°</a>æ–‡ç« ï¼Œæ›´å¥½åœ°ç†è§£è¿™äº›ç»„ä»¶å¦‚ä½•ç›¸äº’ä½œç”¨ã€‚</p><p id="1385" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">ä¸ºäº†é¿å…å¤ªé•¿ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨<strong class="km ir">ç½‘å…³</strong>å’Œ<strong class="km ir"> Busybox </strong>ç»„ä»¶çš„é…ç½®ã€‚</p><p id="6766" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">æ­£å¦‚æˆ‘ä»¬åœ¨<a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/kubernetes-journey-up-and-running-out-of-the-cloud-network-5341831ed712">ç½‘ç»œæ–‡ç« </a>ä¸­çœ‹åˆ°çš„ï¼Œç½‘å…³å®ä¾‹å°†æä¾›ä»¥ä¸‹æœåŠ¡:<strong class="km ir"> DNSã€NATã€DHCPå’Œç½‘å…³</strong>ã€‚æœ‰å…³æ¯ä¸ªç»„ä»¶è´Ÿè´£ä»€ä¹ˆçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è€ƒå®ƒã€‚</p><p id="ba70" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">ä¸ºäº†é…ç½®æˆ‘ä»¬çš„å®ä¾‹ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨cloud-initä»¥åŠä¸€ä¸ªå®šåˆ¶çš„å‚æ•°åŒ–shellè„šæœ¬ï¼Œè¯¥è„šæœ¬å°†å¸®åŠ©æˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­åˆ›å»ºçš„åŸºæœ¬å®šåˆ¶æ˜ åƒæ¥åˆ›å»ºæ¯ä¸ªå®šåˆ¶æ˜ åƒã€‚</p></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><p id="3e76" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">å¦‚æœä½ ä¸æƒ³ç­‰åˆ°æ‰€æœ‰çš„æ–‡ç« éƒ½å‘è¡¨äº†ï¼Œåˆæƒ³é©¬ä¸ŠåŠ¨æ‰‹ï¼Œå¯ä»¥éšæ„å…‹éš†é¡¹ç›®çš„Github repoã€‚å®ƒå¾ˆå®ç”¨ï¼Œæ–‡æ¡£ä¹Ÿåœ¨ä¸æ–­æ”¹è¿›:</p><div class="lw lx gp gr ly lz"><a href="https://github.com/mvallim/kubernetes-under-the-hood" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd ir gy z fp me fr fs mf fu fw ip bi translated">ç½©ä¸‹çš„å§†ç“¦åˆ©å§†/åº“ä¼¯å†…ç‰¹æ–¯</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">å®ƒç”šè‡³è¿˜åŒ…æ‹¬ä¸€å¼ å¹»ç¯ç‰‡ï¼Œè§£é‡Šäº†å®ƒå¸å¼•ç›®æ ‡å—ä¼—çš„åŸå› â€¦</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">github.com</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn jw lz"/></div></div></a></div></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/a0c7f58a7a81093bc1ce38050980a63e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G8cIyG-c_CKDHgq-a7YgEw.png"/></div></div></figure><blockquote class="mt"><p id="98c3" class="mu mv iq bd mw mx my mz na nb nc lh dk translated"><em class="nd">â€œcloud-initæ˜¯åœ¨GPLv3å¼€æºè®¸å¯è¯å’ŒApacheè®¸å¯è¯ç‰ˆæœ¬2.0ä¸‹ä½œä¸ºè‡ªç”±è½¯ä»¶å¼€å‘å’Œå‘å¸ƒçš„ã€‚å®ƒæœ€åˆæ˜¯ä¸ºAmazon EC2ä¸­Linuxçš„Ubuntuå‘è¡Œç‰ˆè®¾è®¡çš„ï¼Œä½†ç°åœ¨åœ¨æ¯ä¸ªä¸»æµäº‘ä¸­çš„è®¸å¤šLinuxå’ŒUNIXå‘è¡Œç‰ˆä¸Šéƒ½æ”¯æŒå®ƒã€‚â€</em></p></blockquote><blockquote class="ne nf ng"><p id="3d4c" class="kk kl nh km b kn ni kp kq kr nj kt ku nk nl kx ky nm nn lb lc no np lf lg lh ij bi translated">å‚è€ƒ:ã€https://cloud-init.io/ T2ã€‘</p></blockquote><h2 id="29d9" class="nq nr iq bd ns nt nu dn nv nw nx dp ny kv nz oa ob kz oc od oe ld of og oh oi bi translated">æ¦‚è§‚</h2><p id="02af" class="pw-post-body-paragraph kk kl iq km b kn oj kp kq kr ok kt ku kv ol kx ky kz om lb lc ld on lf lg lh ij bi translated">cloud-initæ˜¯ä¸€ä¸ªå®ä¾‹åˆå§‹åŒ–å·¥å…·ã€‚å®ƒå…è®¸åœ¨åˆå§‹åŒ–å®ä¾‹æ—¶è‡ªåŠ¨é…ç½®å®ä¾‹ï¼Œåœ¨å‡ ç§’é’Ÿå†…å°†ä¸€ä¸ªé€šç”¨çš„Linuxæ˜ åƒè½¬æ¢æˆä¸€ä¸ªé…ç½®å¥½çš„æœåŠ¡å™¨ï¼Œæ—¢å¿«é€Ÿåˆæ–¹ä¾¿ã€‚</p><p id="24fd" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">æœ€æ–°Linuxå‘è¡Œç‰ˆä¸­æä¾›çš„cloud-initç¨‹åºèƒ½å¤Ÿè¿è¡ŒæœåŠ¡ã€åˆ›å»ºç”¨æˆ·ä»¥åŠå®‰è£…å’Œé…ç½®è½¯ä»¶åŒ…ã€‚<a class="ae kc" href="https://cloudinit.readthedocs.io/en/latest/topics/examples.html" rel="noopener ugc nofollow" target="_blank">ç”¨æˆ·æ•°æ®</a>è„šæœ¬æœ€æµè¡Œçš„æ ¼å¼ä¹‹ä¸€æ˜¯<a class="ae kc" href="https://cloudinit.readthedocs.io/en/latest/topics/examples.html" rel="noopener ugc nofollow" target="_blank">äº‘é…ç½®</a>æ–‡ä»¶æ ¼å¼ã€‚</p><p id="b0ec" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">äº‘é…ç½®æ–‡ä»¶æ˜¯ä¸“é—¨ä¸ºäº‘åˆå§‹åŒ–è¿›ç¨‹è®¾è®¡çš„ç‰¹æ®Šè„šæœ¬ã€‚å®ƒä»¬é€šå¸¸ç”¨äºæœåŠ¡å™¨é¦–æ¬¡å¯åŠ¨æ—¶çš„åˆå§‹è®¾ç½®ã€‚</p><h2 id="92cb" class="nq nr iq bd ns nt nu dn nv nw nx dp ny kv nz oa ob kz oc od oe ld of og oh oi bi translated">èƒ½åŠ›</h2><ul class=""><li id="6bdc" class="li lj iq km b kn oj kr ok kv oo kz op ld oq lh ln lo lp lq bi translated"><strong class="km ir">è¿è¡Œå‘½ä»¤</strong>:æ‰§è¡Œå‘½ä»¤åˆ—è¡¨å¹¶è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</li><li id="1856" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><strong class="km ir">é…ç½®sshå¯†é’¥</strong>:ä¸º~/æ·»åŠ ä¸€ä¸ªæ¡ç›®ã€‚ssh/authorized_keysç»™å·²é…ç½®çš„ç”¨æˆ·ã€‚</li><li id="8b6d" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><strong class="km ir">å®‰è£…åŒ…</strong>:é¦–æ¬¡å¯åŠ¨æ—¶å®‰è£…é¢å¤–çš„åŒ…ã€‚</li><li id="d6d0" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><strong class="km ir">é…ç½®ç½‘ç»œ</strong> : upgrade /etc/hostsï¼Œä¸»æœºåç­‰ã€‚</li><li id="3d95" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><strong class="km ir">å†™æ–‡ä»¶</strong>:å°†ä»»æ„æ–‡ä»¶å†™åˆ°ç£ç›˜ã€‚</li><li id="7d59" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><strong class="km ir">æ·»åŠ ä»“åº“</strong>:æ·»åŠ ä¸€ä¸ªaptæˆ–yumä»“åº“ã€‚</li><li id="c9a1" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><strong class="km ir">åˆ›å»ºç”¨æˆ·å’Œç»„</strong>:å‘ç³»ç»Ÿæ·»åŠ ç»„å’Œç”¨æˆ·ï¼Œå¹¶è®¾ç½®å®ƒä»¬çš„å±æ€§ã€‚</li><li id="82c3" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><strong class="km ir">æ‰§è¡Œå‡çº§</strong>:å‡çº§æ‰€æœ‰è½¯ä»¶åŒ…ã€‚</li><li id="eab8" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><strong class="km ir">é‡å¯</strong>:å®Œæˆcloud-initåé‡å¯æˆ–å…³æœºã€‚</li></ul><blockquote class="ne nf ng"><p id="0cf7" class="kk kl nh km b kn ko kp kq kr ks kt ku nk kw kx ky nm la lb lc no le lf lg lh ij bi translated">æœ‰å…³cloud-initæ¨¡å—çš„å®Œæ•´åˆ—è¡¨ï¼Œè¯·å‚è€ƒ<a class="ae kc" href="https://cloudinit.readthedocs.io/en/latest/topics/modules.html" rel="noopener ugc nofollow" target="_blank">æ–‡æ¡£</a>ã€‚</p></blockquote></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h2 id="de01" class="nq nr iq bd ns nt nu dn nv nw nx dp ny kv nz oa ob kz oc od oe ld of og oh oi bi translated">å¨å¸ˆï¼Œæœ¨å¶ï¼Œç›å‘¢ï¼Ÿ</h2><blockquote class="mt"><p id="d0b7" class="mu mv iq bd mw mx or os ot ou ov lh dk translated">åƒ<strong class="ak">Chef</strong>/<strong class="ak">Puppet</strong>/<strong class="ak">Salt</strong>è¿™æ ·çš„å·¥å…·çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œä»–ä»¬éœ€è¦åœ¨è™šæ‹Ÿæœºä¸Šéƒ¨ç½²ä¸€ä¸ªä»£ç†ï¼Œç„¶åæ‰èƒ½å¼€å§‹ç®¡ç†è¿™äº›æœåŠ¡å™¨ã€‚Cloud-initå¯ä»¥åœ¨è¿™äº›åœºæ™¯ä¸­æä¾›å¸®åŠ©ï¼Œå› ä¸ºcloud-initä¸­æœ‰æ¨¡å—å¯ä»¥ä¸º<strong class="ak">Chef</strong>/<strong class="ak">Puppet</strong>/<strong class="ak">Salt</strong>éƒ¨ç½²ä»£ç†ã€‚</p></blockquote><blockquote class="ne nf ng"><p id="93d3" class="kk kl nh km b kn ni kp kq kr nj kt ku nk nl kx ky nm nn lb lc no np lf lg lh ij bi translated">å®Œæ•´å‚è€ƒ<a class="ae kc" href="https://medium.com/cloudnativeinfra/when-to-use-which-infrastructure-as-code-tool-665af289fbde" rel="noopener">æ­¤å¤„</a> ( <a class="ae kc" href="https://medium.com/cloudnativeinfra" rel="noopener">äº‘åŸç”ŸåŸºç¡€è®¾æ–½</a>ä½œè€…<a class="ae kc" href="https://medium.com/@ramnathn?source=post_page-----665af289fbde----------------------" rel="noopener"> Ramnath Nayak </a>)</p></blockquote></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h2 id="026c" class="nq nr iq bd ns nt nu dn nv nw nx dp ny kv nz oa ob kz oc od oe ld of og oh oi bi translated">Seed ISO</h2><p id="7c91" class="pw-post-body-paragraph kk kl iq km b kn oj kp kq kr ok kt ku kv ol kx ky kz om lb lc ld on lf lg lh ij bi translated">è¿™é‡Œä½¿ç”¨çš„æ•°æ®æºåˆå§‹åŒ–å°†æ˜¯<a class="ae kc" href="https://cloudinit.readthedocs.io/en/latest/topics/datasources/nocloud.html" rel="noopener ugc nofollow" target="_blank"> nocloud </a>ã€‚è¦ä»¥è¿™ç§æ–¹å¼å¼•å¯¼ç³»ç»Ÿï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªISOæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª<strong class="km ir">å…ƒæ•°æ®</strong>æ–‡ä»¶å’Œä¸€ä¸ª<strong class="km ir">ç”¨æˆ·æ•°æ®</strong>æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><p id="0706" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">æ–‡ä»¶ç³»ç»Ÿå·æ ‡å¿…é¡»æ˜¯<code class="fe ow ox oy oz b"><strong class="km ir">cidata</strong></code>æˆ–<code class="fe ow ox oy oz b"><strong class="km ir">CIDATA</strong></code>ã€‚</p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="ade5" class="nq nr iq oz b gy pe pf l pg ph">~$ genisoimage -input-charset utf-8 \<br/>  -output hostname-cidata.iso \<br/>  -volid <strong class="oz ir">cidata</strong> -joliet -rock <strong class="oz ir">meta-data</strong> <strong class="oz ir">user-data</strong></span></pre><p id="fab3" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">å½“æˆ‘ä»¬åˆ›å»ºè‡ªå®šä¹‰æ˜ åƒæ—¶ï¼Œä¸Šé¢ç”Ÿæˆçš„hostname-cidata.isoå°†é™„åŠ åˆ°æ˜ åƒï¼Œå¹¶å°†ç”±cloud-initç”¨æ¥é…ç½®å®ä¾‹ã€‚</p><p id="a526" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">æ‚¨å¯ä»¥åœ¨<a class="ae kc" href="https://github.com/mvallim/kubernetes-under-the-hood/blob/master/create-image.sh" rel="noopener ugc nofollow" target="_blank"> create-image.sh </a>è„šæœ¬ä¸­è§‚å¯Ÿæ­¤è¿‡ç¨‹ï¼Œè¿™å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­è¯¦ç»†ä»‹ç»ã€‚</p></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="df94" class="pi nr iq bd ns pj pk pl nv pm pn po ny pp pq pr ob ps pt pu oe pv pw px oh py bi translated">åˆ›å»º-å›¾åƒ. sh</h1><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi pz"><img src="../Images/185ccb4a8f8841d3ba3f08c5bc680290.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*5okUKxX6REQIHxAsfoRxlg.jpeg"/></div></figure><p id="64ba" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">ç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬åˆ›å»ºçš„å®šåˆ¶å·¥å…·(<a class="ae kc" href="https://github.com/mvallim/kubernetes-under-the-hood/blob/master/create-image.sh" rel="noopener ugc nofollow" target="_blank"> create-image.sh </a>)æ¥åˆ›å»ºæ˜ åƒï¼Œè¯¥å·¥å…·å°†å¸®åŠ©æˆ‘ä»¬å…‹éš†åŸºç¡€æ˜ åƒå¹¶æ·»åŠ ç”¨æˆ·æ•°æ®ã€å…ƒæ•°æ®å’Œç½‘ç»œé…ç½®è„šæœ¬ï¼Œcloud-initå°†ä½¿ç”¨è¿™äº›è„šæœ¬æ¥å®‰è£…å¿…è¦çš„åŒ…å’Œé…ç½®ã€‚</p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="f407" class="nq nr iq oz b gy pe pf l pg ph">./create-image.sh \<br/>    -k or -ssh-pub-keyfile <strong class="oz ir">SSH_PUB_KEY_FILE</strong> \<br/>    -u or -user-data <strong class="oz ir">USER_DATA_FILE</strong> \<br/>    -m or -meta-data <strong class="oz ir">META_DATA_FILE</strong> \<br/>    -n or -network-interfaces <strong class="oz ir">NETWORK_INTERFACES_FILE</strong> \<br/>    -i or -post-config-interfaces <strong class="oz ir">POST_CONFIG_INTERFACES_FILE</strong> \<br/>    -s or -post-config-storages <strong class="oz ir">POST_CONFIG_STORAGES_FILE</strong> \<br/>    -r or -post-config-resources <strong class="oz ir">POST_CONFIG_RESOURCES_FILE</strong> \<br/>    -o or -hostname <strong class="oz ir">HOSTNAME</strong> \<br/>    -b or -base-image <strong class="oz ir">BASE_IMAGE</strong> \<br/>    -l or -linux-distribution <strong class="oz ir">LINUX_DISTRIBUTION</strong> \<br/>    -a or -auto-start <strong class="oz ir">AUTO_START</strong></span></pre><h2 id="418a" class="nq nr iq bd ns nt nu dn nv nw nx dp ny kv nz oa ob kz oc od oe ld of og oh oi bi translated">å› ç´ </h2><ul class=""><li id="4a24" class="li lj iq km b kn oj kr ok kv oo kz op ld oq lh ln lo lp lq bi translated"><code class="fe ow ox oy oz b"><strong class="km ir">-k</strong></code>ç”¨äºå°†<strong class="km ir">å…¬é’¥</strong>ä»æ‚¨çš„ä¸»æœºå¤åˆ¶åˆ°æ–°åˆ›å»ºçš„è™šæ‹Ÿæœºã€‚</li><li id="007c" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><code class="fe ow ox oy oz b"><strong class="km ir">-u</strong></code>ç”¨äºæŒ‡å®š<strong class="km ir">ç”¨æˆ·æ•°æ®</strong>æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å°†ä½œä¸ºå‚æ•°ä¼ é€’ç»™åˆ›å»ºæˆ‘ä»¬ä¹‹å‰æåˆ°çš„cloud-init ISOæ–‡ä»¶çš„å‘½ä»¤(æŸ¥çœ‹è„šæœ¬çš„æºä»£ç ä»¥æ›´å¥½åœ°ç†è§£å®ƒçš„ç”¨æ³•)ã€‚é»˜è®¤ä¸º'<strong class="km ir">/æ•°æ®/ç”¨æˆ·æ•°æ®</strong>'ã€‚</li><li id="1cb5" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><code class="fe ow ox oy oz b"><strong class="km ir">-m</strong></code>ç”¨äºæŒ‡å®š<strong class="km ir">å…ƒæ•°æ®</strong>æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å°†ä½œä¸ºå‚æ•°ä¼ é€’ç»™åˆ›å»ºæˆ‘ä»¬ä¹‹å‰æåˆ°çš„cloud-init ISOæ–‡ä»¶çš„å‘½ä»¤(æŸ¥çœ‹è„šæœ¬çš„æºä»£ç ä»¥æ›´å¥½åœ°ç†è§£å®ƒçš„ç”¨æ³•)ã€‚é»˜è®¤ä¸º'<strong class="km ir">/æ•°æ®/å…ƒæ•°æ®</strong>'ã€‚</li><li id="3d92" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><code class="fe ow ox oy oz b"><strong class="km ir">-n</strong></code>ç”¨äºä¼ é€’é…ç½®æ–‡ä»¶ï¼Œcloud-initå°†ä½¿ç”¨è¯¥æ–‡ä»¶ä¸ºå®ä¾‹é…ç½®<strong class="km ir">ç½‘ç»œ</strong>ã€‚</li><li id="23b1" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><code class="fe ow ox oy oz b"><strong class="km ir">-i</strong></code>ç”¨äºä¼ é€’ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬çš„è„šæœ¬å°†ä½¿ç”¨è¯¥æ–‡ä»¶ä¿®æ”¹ç”±<strong class="km ir"> VirtualBox </strong>ç®¡ç†çš„<strong class="km ir">ç½‘ç»œæ¥å£</strong>ï¼Œè¯¥æ¥å£è¿æ¥åˆ°å°†ä»è¯¥æ˜ åƒåˆ›å»ºçš„å®ä¾‹ã€‚</li><li id="9836" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><code class="fe ow ox oy oz b"><strong class="km ir">-r</strong></code>ç”¨äºä¼ é€’ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬çš„è„šæœ¬å°†ä½¿ç”¨è¯¥æ–‡ä»¶æ¥é…ç½®<strong class="km ir">æ•°é‡çš„å¤„ç†å™¨å’Œ</strong>æ•°é‡çš„å†…å­˜ï¼Œè¿™äº›å†…å­˜ç”±<strong class="km ir"> VirtualBox </strong>åˆ†é…ç»™æˆ‘ä»¬çš„å®ä¾‹ã€‚</li><li id="3dc4" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><code class="fe ow ox oy oz b"><strong class="km ir">-o</strong></code>ç”¨äºä¼ é€’å°†åˆ†é…ç»™æˆ‘ä»¬å®ä¾‹çš„<strong class="km ir">ä¸»æœºå</strong>ã€‚è¿™ä¹Ÿå°†æ˜¯<strong class="km ir"> VirtualBox </strong>ç”¨æ¥å¼•ç”¨æˆ‘ä»¬çš„å®ä¾‹çš„åå­—ã€‚</li><li id="f8b7" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><code class="fe ow ox oy oz b"><strong class="km ir">-l</strong></code>ç”¨äºé€šçŸ¥æˆ‘ä»¬è¦ä½¿ç”¨å“ªä¸ªLinuxå‘è¡Œç‰ˆ(<strong class="km ir"> debian </strong>æˆ–<strong class="km ir"> ubuntu </strong>)é…ç½®æ–‡ä»¶(æ³¨æ„è¿™æ˜¯ç”¨æ¥æŒ‡å®š<a class="ae kc" href="https://github.com/mvallim/kubernetes-under-the-hood/blob/master/data" rel="noopener ugc nofollow" target="_blank">æ•°æ®</a>ä¸‹çš„å“ªä¸ªæ–‡ä»¶å¤¹è¢«å¼•ç”¨)ã€‚é»˜è®¤ä¸º'<strong class="km ir"> debian </strong>'ã€‚</li><li id="cd2a" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><code class="fe ow ox oy oz b"><strong class="km ir">-b</strong></code>ç”¨äºæŒ‡å®šåº”è¯¥ä½¿ç”¨å“ªä¸ª<strong class="km ir">åŸºç¡€å›¾åƒ</strong>ã€‚è¿™æ˜¯æˆ‘ä»¬æ‰§è¡Œ<a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/kubernetes-journey-up-and-running-out-of-the-cloud-linux-image-c51953e50d0e">ä¸Šä¸€ç¯‡æ–‡ç« </a>ä¸­çš„å®‰è£…æ­¥éª¤æ—¶ï¼Œåœ¨<strong class="km ir"> VirtualBox </strong>ä¸Šåˆ›å»ºçš„æ˜ åƒåç§°ã€‚</li><li id="d20f" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><code class="fe ow ox oy oz b"><strong class="km ir">-s</strong></code>ç”¨äºä¼ é€’ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬çš„è„šæœ¬å°†ä½¿ç”¨è¯¥æ–‡ä»¶åœ¨<strong class="km ir"> VirtualBox </strong>ä¸Šé…ç½®<strong class="km ir">è™šæ‹Ÿç£ç›˜</strong>ã€‚ä½ ä¼šæ³¨æ„åˆ°è¿™ä»…ç”¨äº<strong class="km ir"> Gluster </strong>é…ç½®æ­¥éª¤ã€‚</li><li id="8ed3" class="li lj iq km b kn lr kr ls kv lt kz lu ld lv lh ln lo lp lq bi translated"><code class="fe ow ox oy oz b"><strong class="km ir">-a</strong></code>æˆ‘ä»¬çš„å®ä¾‹<strong class="km ir">åœ¨åˆ›å»ºåæ˜¯å¦åº”è¯¥åˆå§‹åŒ–</strong>ã€‚é»˜è®¤ä¸º<strong class="km ir">çœŸ</strong>ã€‚</li></ul></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="84bc" class="pi nr iq bd ns pj pk pl nv pm pn po ny pp pq pr ob ps pt pu oe pv pw px oh py bi translated">ç½‘å…³é…ç½®</h1><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi qa"><img src="../Images/8e859470342d9da8000f1c63e5f35b6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*39MI1aOlsRJMYNBufmMSXQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">ç½‘å…³å›¾</figcaption></figure><blockquote class="ne nf ng"><p id="a021" class="kk kl nh km b kn ko kp kq kr ks kt ku nk kw kx ky nm la lb lc no le lf lg lh ij bi translated">åœ¨æˆ‘ä»¬çš„<a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/kubernetes-journey-up-and-running-out-of-the-cloud-network-5341831ed712">ç½‘ç»œ</a>æ–‡ç« ä¸­æœ‰å®Œæ•´çš„è§£é‡Šã€‚</p></blockquote><h2 id="0d0b" class="nq nr iq bd ns nt nu dn nv nw nx dp ny kv nz oa ob kz oc od oe ld of og oh oi bi translated"><strong class="ak">ç”¨æˆ·æ•°æ®TLï¼›åšå£«</strong></h2><p id="eb10" class="pw-post-body-paragraph kk kl iq km b kn oj kp kq kr ok kt ku kv ol kx ky kz om lb lc ld on lf lg lh ij bi translated">è¿™æ˜¯ä½¿ç”¨<code class="fe ow ox oy oz b"><strong class="km ir">-u</strong></code>æ ‡å¿—ä¼ é€’ç»™create-image.shè„šæœ¬çš„ç”¨æˆ·æ•°æ®æ–‡ä»¶ã€‚ä¸‹é¢çš„ç‰¹å®šæ–‡ä»¶æ˜¯ç”¨äºé…ç½®ç½‘å…³çš„ç”¨æˆ·æ•°æ®æ–‡ä»¶ã€‚æ‚¨å¯ä»¥åœ¨æˆ‘ä»¬çš„repoä¸­çš„<code class="fe ow ox oy oz b"><strong class="km ir">/data/{distribution}/{component}/user-data</strong></code>ä¸‹æ£€æŸ¥æ¯ä¸ªç»„ä»¶çš„é…ç½®ã€‚æ£€æŸ¥æ–‡ä»¶ä¸­çš„æ³¨é‡Šï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£æ¯ä¸ªéƒ¨åˆ†æ‰€ä»£è¡¨çš„å†…å®¹ã€‚</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="qb qc l"/></div></figure></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="e710" class="pi nr iq bd ns pj pk pl nv pm pn po ny pp pq pr ob ps pt pu oe pv pw px oh py bi translated">BusyBox</h1><p id="cf14" class="pw-post-body-paragraph kk kl iq km b kn oj kp kq kr ok kt ku kv ol kx ky kz om lb lc ld on lf lg lh ij bi translated">ç”±äºæˆ‘ä»¬åœ¨<strong class="km ir"> VirtualBox </strong>ç©ºé—´å†…åˆ›å»ºäº†ä¸€ä¸ªå®Œæ•´çš„ç‰¹å®šè™šæ‹ŸåŒ–ç½‘ç»œï¼Œè€Œæˆ‘ä»¬çš„ä¸»æœºåœ¨é»˜è®¤æƒ…å†µä¸‹æ— æ³•è®¿é—®è¯¥ç½‘ç»œï¼Œå› æ­¤æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª<strong class="km ir"> BusyBox </strong>å®ä¾‹ã€‚ä¸€ä¸ª<strong class="km ir"> BusyBox </strong>ï¼Œä¹Ÿç§°ä¸ºè·³è½¬æ¡†æˆ–å ¡å’ä¸»æœºï¼Œæ˜¯ä¸€ä¸ªå®ä¾‹ï¼Œå®ƒå°†é©»ç•™åœ¨æˆ‘ä»¬çš„éƒ¨ç½²çš„åŒä¸€ä¸ªç½‘ç»œä¸­ï¼Œå¹¶ä¸ºæˆ‘ä»¬æä¾›åˆ°å…¶ä»–å®ä¾‹çš„å•ä¸€è®¿é—®ç‚¹ã€‚è¿™ä¸ºæˆ‘ä»¬æä¾›äº†è¿æ¥åˆ°å¦ä¸€ä¸ªç½‘ç»œä¸­çš„å®ä¾‹çš„èƒ½åŠ›ï¼Œåªéœ€å¯¹æˆ‘ä»¬çš„ä¸»æœºè¿›è¡Œæœ€å°‘çš„é…ç½®æ›´æ”¹ã€‚</p><p id="32c2" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">é™¤äº†å……å½“æˆ‘ä»¬éƒ¨ç½²çš„è®¿é—®ç‚¹ä¹‹å¤–ï¼Œè¿™å°æœºå™¨ä¸Šè¿˜å®‰è£…äº†ç½‘ç»œè¯Šæ–­å·¥å…·å’Œkubectlï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦å¼„ä¹±æˆ‘ä»¬ä¸»æœºä¸Šçš„ä»»ä½•ç°æœ‰å®‰è£…ã€‚</p><h2 id="362a" class="nq nr iq bd ns nt nu dn nv nw nx dp ny kv nz oa ob kz oc od oe ld of og oh oi bi translated">ç”¨æˆ·æ•°æ®TLï¼›é€Ÿåº¦ä¸‰è§’å½¢å®šä½æ³•(dead reckoning)</h2><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="qb qc l"/></div></figure><h2 id="f70c" class="nq nr iq bd ns nt nu dn nv nw nx dp ny kv nz oa ob kz oc od oe ld of og oh oi bi translated">é€šçŸ¥ï¼›æ³¨æ„</h2><p id="d8b5" class="pw-post-body-paragraph kk kl iq km b kn oj kp kq kr ok kt ku kv ol kx ky kz om lb lc ld on lf lg lh ij bi translated">ä½ å¯èƒ½ä¼šæ³¨æ„åˆ°æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨<strong class="km ir"> SSH CAè¯ä¹¦</strong>åœ¨æˆ‘ä»¬çš„ç½‘ç»œå†…éƒ¨è¿›è¡Œå®‰å…¨é€šä¿¡ã€‚</p><p id="6cef" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">æ‚¨å¯èƒ½è¿˜ä¼šæ³¨æ„åˆ°ï¼Œè¿™äº›é”®åœ¨é…ç½®æ–‡ä»¶ä¸­æ˜¯ç¡¬ç¼–ç çš„ã€‚å½“æ‚¨è®¾ç½®å®ä¾‹æ—¶ï¼Œè¯·ç¡®ä¿æä¾›æ‚¨è‡ªå·±çš„å¯†é’¥ã€‚</p><p id="8c54" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">æ›´å¥½çš„è®¾ç½®æ–¹æ³•æ˜¯ä½¿ç”¨<strong class="km ir">æœ¨å¶</strong> + <strong class="km ir">ä¿é™©åº“</strong>æ¥æä¾›å’Œåˆ†å‘æˆ‘ä»¬çš„å¯†é’¥ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨è¿™äº›å·¥å…·æ­£ç¡®é…ç½®çš„è®¾ç½®å°†å…è®¸åŠ¨æ€åœ°æä¾›å’Œå¾ªç¯æˆ‘ä»¬çš„å¯†é’¥ï¼Œå¢åŠ æˆ‘ä»¬éƒ¨ç½²çš„å®‰å…¨æ€§ã€‚</p><p id="9033" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">è¿™ç§è®¾ç½®å®‰å…¨å¯†é’¥çš„é«˜çº§è®¾ç½®è¶…å‡ºäº†æœ¬ç³»åˆ—çš„èŒƒå›´ï¼Œä½†æ˜¯æˆ‘æ‰“ç®—åœ¨ç‰¹æ€§ä¸­å‘å¸ƒæ–°çš„æ–‡ç« ï¼Œå±•ç¤ºå¦‚ä½•åº”ç”¨è¿™ç§è®¾ç½®ã€‚æ•¬è¯·æœŸå¾…ï¼</p></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="f374" class="pi nr iq bd ns pj pk pl nv pm pn po ny pp pq pr ob ps pt pu oe pv pw px oh py bi translated">è¿è½¬</h1><h2 id="be8f" class="nq nr iq bd ns nt nu dn nv nw nx dp ny kv nz oa ob kz oc od oe ld of og oh oi bi translated">å…ˆå†³æ¡ä»¶(GNU/Linux Debian/Ubuntu)</h2><p id="df43" class="pw-post-body-paragraph kk kl iq km b kn oj kp kq kr ok kt ku kv ol kx ky kz om lb lc ld on lf lg lh ij bi translated">å‰ææ˜¯ä½ å·²ç»åœ¨æœ¬åœ°æœºå™¨ä¸Šæ­£ç¡®å®‰è£…äº†<strong class="km ir"> Virtualbox </strong>ã€‚</p><ul class=""><li id="8c5b" class="li lj iq km b kn ko kr ks kv lk kz ll ld lm lh ln lo lp lq bi translated"><strong class="km ir">åœ¨</strong> <code class="fe ow ox oy oz b">vboxusers</code> <strong class="km ir">ç¾¤</strong>ä¸Šæ·»åŠ æ‚¨çš„ç”¨æˆ·</li></ul><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="545b" class="nq nr iq oz b gy pe pf l pg ph">~$ sudo usermod -a -G vboxusers $USER</span></pre><ul class=""><li id="2341" class="li lj iq km b kn ko kr ks kv lk kz ll ld lm lh ln lo lp lq bi translated"><strong class="km ir">å®‰è£…</strong>T3ã€‘</li></ul><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="2b6d" class="nq nr iq oz b gy pe pf l pg ph">~$ sudo apt-get install python3-pip</span><span id="73c5" class="nq nr iq oz b gy qd pf l pg ph">~$ sudo pip3 install shyaml</span></pre><ul class=""><li id="30fb" class="li lj iq km b kn ko kr ks kv lk kz ll ld lm lh ln lo lp lq bi translated"><strong class="km ir">å®‰è£…</strong>T4ã€‘</li></ul><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="7ba0" class="nq nr iq oz b gy pe pf l pg ph">~$ sudo apt-get install genisoimage</span></pre><ul class=""><li id="e687" class="li lj iq km b kn ko kr ks kv lk kz ll ld lm lh ln lo lp lq bi translated"><strong class="km ir">å®‰è£…</strong>T5ã€‘</li></ul><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="943d" class="nq nr iq oz b gy pe pf l pg ph">~$ sudo apt-get install uuid-runtime</span></pre><ul class=""><li id="10da" class="li lj iq km b kn ko kr ks kv lk kz ll ld lm lh ln lo lp lq bi translated"><strong class="km ir">é…ç½®ä¸»æœºé€‚é…å™¨VirtualBox </strong></li></ul><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="5453" class="nq nr iq oz b gy pe pf l pg ph">~$ vboxmanage hostonlyif create</span><span id="6df1" class="nq nr iq oz b gy qd pf l pg ph">~$ vboxmanage hostonlyif ipconfig vboxnet0 --ip 192.168.254.1 --netmask 255.255.0.0</span></pre></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h2 id="0407" class="nq nr iq bd ns nt nu dn nv nw nx dp ny kv nz oa ob kz oc od oe ld of og oh oi bi translated"><strong class="ak">å…‹éš†å­˜å‚¨åº“</strong></h2><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="3cbd" class="nq nr iq oz b gy pe pf l pg ph">~$ git clone <a class="ae kc" href="mailto:git@github.com" rel="noopener ugc nofollow" target="_blank">git@github.com</a>:mvallim/kubernetes-under-the-hood.git</span><span id="a4e9" class="nq nr iq oz b gy qd pf l pg ph">Cloning into 'kubernetes-under-the-hood'...<br/>remote: Enumerating objects: 190, done.<br/>remote: Counting objects: 100% (190/190), done.<br/>remote: Compressing objects: 100% (141/141), done.<br/>remote: Total 2527 (delta 117), reused 86 (delta 45), pack-reused 2337<br/>Receiving objects: 100% (2527/2527), 47.89 MiB | 8.61 MiB/s, done.<br/>Resolving deltas: 100% (1662/1662), done.</span><span id="d4ee" class="nq nr iq oz b gy qd pf l pg ph">~$ cd kubernetes-under-the-hood</span></pre><h2 id="2441" class="nq nr iq bd ns nt nu dn nv nw nx dp ny kv nz oa ob kz oc od oe ld of og oh oi bi translated">åˆ›å»ºè™šæ‹Ÿæœº</h2><p id="99ec" class="pw-post-body-paragraph kk kl iq km b kn oj kp kq kr ok kt ku kv ol kx ky kz om lb lc ld on lf lg lh ij bi translated">ä¸ºäº†ä½¿ç”¨<code class="fe ow ox oy oz b">cloud-init</code>åˆå§‹åŒ–å’Œé…ç½®æˆ‘ä»¬çš„å®ä¾‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ªæˆ‘ä»¬å­˜å‚¨åº“çš„<a class="ae kc" href="https://github.com/mvallim/kubernetes-under-the-hood/blob/master/data" rel="noopener ugc nofollow" target="_blank"> data </a>ç›®å½•ä¸­çš„é…ç½®æ–‡ä»¶ç‰ˆæœ¬ã€‚</p><p id="dc61" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">æ³¨æ„:å¯¹äºæ¯ä¸€æ­¥ï¼Œæˆ‘ä»¬ä¼ é€’æ­£åœ¨é…ç½®çš„ç»„ä»¶çš„ç‰¹å®šé…ç½®æ–‡ä»¶(gateã€hapxã€glusç­‰ã€‚)</p><p id="0dec" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><strong class="km ir">åˆ›å»ºç½‘å…³</strong></p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="f883" class="nq nr iq oz b gy pe pf l pg ph">~/kubernetes-under-the-hood$ ./create-image.sh \<br/>    -k ~/.ssh/id_rsa.pub \<br/>    -u gate/user-data \<br/>    -n gate/network-config \<br/>    -i gate/post-config-interfaces \<br/>    -r gate/post-config-resources \<br/>    -o gate-node01 \<br/>    -l debian \<br/>    -b debian-base-image</span></pre><p id="71bf" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">å“åº”åº”è¯¥ç±»ä¼¼äºä»¥ä¸‹å†…å®¹:</p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="8316" class="nq nr iq oz b gy pe pf l pg ph">Total translation table size: 0<br/>Total rockridge attributes bytes: 417<br/>Total directory bytes: 0<br/>Path table size(bytes): 10<br/>Max brk space used 0 186 extents written (0 MB)<br/>0%...10%...20%...30%...40%...50%...60%...70%...80%...90%...100%<br/>Machine has been successfully cloned as "gate-node01"<br/>Waiting for VM "gate-node01" to power on...<br/>VM "gate-node01" has been successfully started.</span></pre><p id="61cc" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><strong class="km ir">åˆ›å»ºBusyBox </strong></p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="ddcd" class="nq nr iq oz b gy pe pf l pg ph">~/kubernetes-under-the-hood$ ./create-image.sh \<br/>    -k ~/.ssh/id_rsa.pub \<br/>    -u busybox/user-data \<br/>    -n busybox/network-config \<br/>    -i busybox/post-config-interfaces \<br/>    -r busybox/post-config-resources \<br/>    -o busybox \<br/>    -l debian \<br/>    -b debian-base-image</span></pre><p id="6b58" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">å“åº”åº”è¯¥ç±»ä¼¼äºä»¥ä¸‹å†…å®¹:</p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="eeda" class="nq nr iq oz b gy pe pf l pg ph">Total translation table size: 0<br/>Total rockridge attributes bytes: 417<br/>Total directory bytes: 0<br/>Path table size(bytes): 10<br/>Max brk space used 0 186 extents written (0 MB)<br/>0%...10%...20%...30%...40%...50%...60%...70%...80%...90%...100%<br/>Machine has been successfully cloned as "busybox"<br/>Waiting for VM "busybox" to power on...<br/>VM "busybox" has been successfully started.</span></pre><h2 id="7703" class="nq nr iq bd ns nt nu dn nv nw nx dp ny kv nz oa ob kz oc od oe ld of og oh oi bi translated">é…ç½®æ‚¨çš„æœ¬åœ°è·¯ç”±</h2><p id="eeb4" class="pw-post-body-paragraph kk kl iq km b kn oj kp kq kr ok kt ku kv ol kx ky kz om lb lc ld on lf lg lh ij bi translated">æ‚¨éœ€è¦åœ¨æœ¬åœ°æœºå™¨ä¸Šæ·»åŠ è·¯ç”±æ¥è®¿é—®<strong class="km ir"> Virtualbox </strong>çš„å†…éƒ¨ç½‘ç»œã€‚</p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="a1c8" class="nq nr iq oz b gy pe pf l pg ph"><strong class="oz ir"># BusyBox network<br/></strong>~$ sudo ip route add 192.168.4.32/27 via 192.168.4.62 dev vboxnet0</span></pre><h2 id="57c4" class="nq nr iq bd ns nt nu dn nv nw nx dp ny kv nz oa ob kz oc od oe ld of og oh oi bi translated">è®¿é—®BusyBox</h2><p id="50c8" class="pw-post-body-paragraph kk kl iq km b kn oj kp kq kr ok kt ku kv ol kx ky kz om lb lc ld on lf lg lh ij bi translated">æˆ‘ä»¬éœ€è¦è®©<strong class="km ir"> BusyBox </strong> IPé€šè¿‡<code class="fe ow ox oy oz b">ssh</code>è®¿é—®å®ƒ</p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="ed05" class="nq nr iq oz b gy pe pf l pg ph">~$ vboxmanage guestproperty get busybox "/VirtualBox/GuestInfo/Net/0/V4/IP"</span></pre><p id="fc94" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">å“åº”åº”è¯¥ç±»ä¼¼äºä»¥ä¸‹å†…å®¹:</p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="cb5e" class="nq nr iq oz b gy pe pf l pg ph">Value: 192.168.4.57</span></pre><p id="4ee9" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">ä½¿ç”¨è¿”å›å€¼æ¥è®¿é—®ã€‚</p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="8f9f" class="nq nr iq oz b gy pe pf l pg ph">~$<strong class="oz ir"> ssh debian@192.168.4.57</strong></span></pre><p id="2773" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">å“åº”åº”è¯¥ç±»ä¼¼äºä»¥ä¸‹å†…å®¹:</p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="d1c9" class="nq nr iq oz b gy pe pf l pg ph">Linux busybox 4.9.0-11-amd64 #1 SMP Debian 4.9.189-3+deb9u2 (2019-11-11) x86_64</span><span id="4704" class="nq nr iq oz b gy qd pf l pg ph">The programs included with the Debian GNU/Linux system are free software;<br/>the exact distribution terms for each program are described in the<br/>individual files in /usr/share/doc/*/copyright.</span><span id="3efb" class="nq nr iq oz b gy qd pf l pg ph">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br/>permitted by applicable law.</span></pre><p id="8e4d" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">è®©æˆ‘ä»¬ä½¿ç”¨<code class="fe ow ox oy oz b"><strong class="km ir">nslookup</strong></code>æ¥æ£€æŸ¥<strong class="km ir"> DNS </strong>é…ç½®</p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="b8b8" class="nq nr iq oz b gy pe pf l pg ph">debian@busybox:~$<strong class="oz ir"> nslookup gate-node01</strong></span></pre><p id="e009" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">å“åº”åº”è¯¥ç±»ä¼¼äºä»¥ä¸‹å†…å®¹:</p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="83cc" class="nq nr iq oz b gy pe pf l pg ph">Server:         192.168.4.1<br/>Address:        192.168.4.1#53</span><span id="d00b" class="nq nr iq oz b gy qd pf l pg ph">Name:   gate-node01.kube.demo<br/>Address: 192.168.254.254</span></pre><p id="7b9d" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">è®©æˆ‘ä»¬ä½¿ç”¨<code class="fe ow ox oy oz b"><strong class="km ir">curl</strong></code>æ£€æŸ¥è®¿é—®äº’è”ç½‘</p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="d14c" class="nq nr iq oz b gy pe pf l pg ph">debian@busybox:~$ <strong class="oz ir">curl -v google.com</strong></span></pre><p id="84b3" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">å“åº”åº”è¯¥ç±»ä¼¼äºä»¥ä¸‹å†…å®¹:</p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="0fca" class="nq nr iq oz b gy pe pf l pg ph">* Rebuilt URL to: google.com/<br/>*   Trying 172.217.29.142...<br/>* TCP_NODELAY set<br/>* Connected to google.com (172.217.29.142) port 80 (#0)<br/>&gt; GET / HTTP/1.1<br/>&gt; Host: google.com<br/>&gt; User-Agent: curl/7.52.1<br/>&gt; Accept: */*<br/>&gt; <br/>&lt; HTTP/1.1 301 Moved Permanently<br/>&lt; Location: <a class="ae kc" href="http://www.google.com/" rel="noopener ugc nofollow" target="_blank">http://www.google.com/</a><br/>&lt; Content-Type: text/html; charset=UTF-8<br/>&lt; Date: Sun, 24 Nov 2019 21:13:19 GMT<br/>&lt; Expires: Tue, 24 Dec 2019 21:13:19 GMT<br/>&lt; Cache-Control: public, max-age=2592000<br/>&lt; Server: gws<br/>&lt; Content-Length: 219<br/>&lt; X-XSS-Protection: 0<br/>&lt; X-Frame-Options: SAMEORIGIN<br/>&lt; <br/>&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv="content-type" content="text/html;charset=utf-8"&gt;<br/>&lt;TITLE&gt;301 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;<br/>&lt;H1&gt;301 Moved&lt;/H1&gt;<br/>The document has moved<br/>&lt;A HREF="<a class="ae kc" href="http://www.google.com/" rel="noopener ugc nofollow" target="_blank">http://www.google.com/</a>"&gt;here&lt;/A&gt;.<br/>&lt;/BODY&gt;&lt;/HTML&gt;<br/>* Curl_http_done: called premature == 0<br/>* Connection #0 to host google.com left intact</span></pre><p id="8af0" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">è®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹<code class="fe ow ox oy oz b"><strong class="km ir">kubectl</strong></code>çš„ç‰ˆæœ¬</p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="faa5" class="nq nr iq oz b gy pe pf l pg ph">debian@busybox:~$ <strong class="oz ir">kubectl version --client</strong></span></pre><p id="5fe7" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">å“åº”åº”è¯¥ç±»ä¼¼äºä»¥ä¸‹å†…å®¹:</p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="952a" class="nq nr iq oz b gy pe pf l pg ph">Client Version: version.Info{Major:"1", Minor:"15", GitVersion:"v1.15.6", GitCommit:"7015f71e75f670eb9e7ebd4b5749639d42e20079", GitTreeState:"clean", BuildDate:"2019-11-13T11:20:18Z", GoVersion:"go1.12.12", Compiler:"gc", Platform:"linux/amd64"}</span></pre><p id="1ff5" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">è®©æˆ‘ä»¬æ£€æŸ¥è®¿é—®<code class="fe ow ox oy oz b"><strong class="km ir">gate-node01</strong></code></p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="bd60" class="nq nr iq oz b gy pe pf l pg ph">debian@busybox:~$ <!-- -->ssh debian@gate-node01</span></pre><p id="9ff4" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">å“åº”åº”è¯¥ç±»ä¼¼äºä»¥ä¸‹å†…å®¹:</p><pre class="mp mq mr ms gt pa oz pb pc aw pd bi"><span id="e2e4" class="nq nr iq oz b gy pe pf l pg ph">Linux gate-node01 4.9.0-11-amd64 #1 SMP Debian 4.9.189-3+deb9u2 (2019-11-11) x86_64</span><span id="111e" class="nq nr iq oz b gy qd pf l pg ph">The programs included with the Debian GNU/Linux system are free software;<br/>the exact distribution terms for each program are described in the<br/>individual files in /usr/share/doc/*/copyright.</span><span id="4dc6" class="nq nr iq oz b gy qd pf l pg ph">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br/>permitted by applicable law.</span></pre></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><h1 id="f654" class="pi nr iq bd ns pj pk pl nv pm pn po ny pp pq pr ob ps pt pu oe pv pw px oh py bi translated">ç»“è®º</h1><p id="b81e" class="pw-post-body-paragraph kk kl iq km b kn oj kp kq kr ok kt ku kv ol kx ky kz om lb lc ld on lf lg lh ij bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å·²ç»å¼€å§‹æ‰§è¡Œå°†æ„æˆæˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆçš„ç»„ä»¶çš„å®é™…é…ç½®ã€‚æˆ‘ä»¬å·²ç»é…ç½®äº†æˆ‘ä»¬çš„<strong class="km ir">ç½‘å…³</strong>å®ä¾‹ä»¥åŠä¸€ä¸ª<strong class="km ir"> BusyBox </strong>å®ä¾‹ï¼Œè¿™å°†å…è®¸æˆ‘ä»¬è¿æ¥åˆ°ç»„æˆæˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆçš„æ‰€æœ‰å®ä¾‹ï¼Œè¿™äº›å®ä¾‹é©»ç•™åœ¨ä¸æˆ‘ä»¬çš„ä¸»æœºä¸åŒçš„ç½‘ç»œä¸­ã€‚</p><p id="d881" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†é…ç½®<strong class="km ir"> HAä»£ç†</strong>å®ä¾‹ã€‚æœ‰å…³å®ƒåœ¨æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆä¸­æ‰€æ‰®æ¼”è§’è‰²çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æˆ‘ä»¬çš„<a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/kubernetes-journey-up-and-running-out-of-the-cloud-technology-stack-9c472aafac4e">æŠ€æœ¯å †æ ˆæ–‡ç« </a>ã€‚</p><p id="6d43" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">å¦‚æœä½ è®¤ä¸ºè¿™æ˜¯æœ‰å¸®åŠ©çš„ï¼Œè¯·ç•™ä¸‹ä½ çš„ğŸ‘ä»¥åŠä¸‹é¢çš„åé¦ˆã€‚ä¸æ–­å®Œå–„è¿™ä¸ªç³»åˆ—çš„å†…å®¹éå¸¸é‡è¦ã€‚</p><p id="2d9b" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">æˆ‘å†æ¬¡å¼ºçƒˆæ¨èæ‚¨å…³æ³¨æˆ‘çš„Mediumï¼Œè¿™æ ·æ‚¨å°±ä¸ä¼šé”™è¿‡æœ¬ç³»åˆ—ä¸­å‘è¡¨çš„ä»»ä½•æ–°æ–‡ç« ã€‚å¦‚æœä½ é”™è¿‡äº†è¿™ä¸ªç³»åˆ—çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œå¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹<a class="ae kc" rel="noopener ugc nofollow" target="_blank" href="/kubernetes-journey-up-and-running-out-of-the-cloud-introduction-f04a811c92a5">ã€‚</a></p></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><p id="98c6" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">å›å¤´è§ï¼ï¼</p><p id="fb9e" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">å†è§</p></div></div>    
</body>
</html>