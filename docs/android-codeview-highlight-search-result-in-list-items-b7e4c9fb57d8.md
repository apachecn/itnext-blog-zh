# Android CodeView:åœ¨åˆ—è¡¨é¡¹ä¸­çªå‡ºæ˜¾ç¤ºæœç´¢ç»“æœ

> åŸæ–‡ï¼š<https://itnext.io/android-codeview-highlight-search-result-in-list-items-b7e4c9fb57d8?source=collection_archive---------1----------------------->

![](img/200b219edf01e6a9379556e5ae19eadb.png)

å¼€å‘è€…ä»¬å¥½ï¼Œåœ¨æˆ‘å‘è¡¨çš„å…³äºå¦‚ä½•ä½¿ç”¨ CodeView åˆ›å»ºè‡ªå·±çš„ä»£ç ç¼–è¾‘å™¨çš„å‰ä¸¤ç¯‡æ–‡ç« ä¸­ï¼Œä½ å¯ä»¥ä» [**è¿™é‡Œ**](/android-codeview-an-easy-way-to-create-code-editor-app-5d67c3534f84) é˜…è¯»ï¼Œå…³äºå¯ä»¥ä½¿ç”¨ CodeView å®ç°çš„è®¸å¤šåŠŸèƒ½ï¼Œä¾‹å¦‚çªå‡ºæ˜¾ç¤ºæ®µè½ä¸­çš„æ–‡æœ¬ï¼Œè¿˜å¯ä»¥çªå‡ºæ˜¾ç¤ºæ ‡ç­¾ã€ç”µå­é‚®ä»¶ã€URLï¼Œä½ å¯ä»¥ä» [**è¿™é‡Œ**](/android-codeview-the-easiest-way-to-highlight-patterns-53702e0e2164) é˜…è¯»ã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨ CodeView æ¥çªå‡ºæ˜¾ç¤ºåˆ—è¡¨é¡¹ä¸­çš„æœç´¢ç»“æœï¼Œä¾‹å¦‚ RecyclerViewã€GridView æˆ– ListView é¡¹ï¼Œå®ƒå…·æœ‰è®¸å¤šåŠŸèƒ½ï¼Œæˆ‘ä»¬çš„æœ€ç»ˆç»“æœå°†æ˜¯è¿™æ ·çš„ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å¼€å§‹ç¼–ç ã€‚

![](img/f73c5c591ad869eef86d1e77e7c69afa.png)

çªå‡ºæ˜¾ç¤ºæœç´¢ç»“æœ

CodeView ä½¿æ¯ä¸ªäººéƒ½å®¹æ˜“å®ç°çªå‡ºæ˜¾ç¤ºåŠŸèƒ½ï¼Œæˆ‘ä¼šç•™ä¸‹æ¥è®¾è®¡ä½ çš„åˆ—è¡¨é¡¹å’Œä½ çš„åº”ç”¨ç¨‹åºé¢œè‰²æ¥é€‰æ‹©ä½ å–œæ¬¢çš„ï¼Œæˆ‘ä»¬çš„å·¥ä½œå°†åœ¨é€‚é…å™¨å’Œ SearchView æœç´¢æŸ¥è¯¢æ›´æ–°æ—¶è¿›è¡Œã€‚

åœ¨æ‚¨çš„é€‚é…å™¨ä¸­ï¼Œæ‚¨éœ€è¦åˆ›å»ºåŒ…å«æœç´¢æ¨¡å¼çš„å…¨å±€å˜é‡ï¼Œå¦‚æœå®ƒç­‰äº nullï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¸éœ€è¦çªå‡ºæ˜¾ç¤ºä»»ä½•å†…å®¹ï¼Œä»¥åŠ Color å¯¹è±¡æ¥å­˜å‚¨çªå‡ºæ˜¾ç¤ºçš„å…³é”®å­—çš„é¢œè‰²ï¼Œæˆ‘ä»¬å°†ä½¿å…¶é»˜è®¤ä¸º *MAGENTA* ï¼Œæ‚¨å¯ä»¥åˆ›å»º setter æ–¹æ³•æ¥éšæ—¶æ›´æ”¹å®ƒï¼Œæˆ–è€…å–å†³äºæ‚¨çš„åº”ç”¨ç¨‹åºä¸»é¢˜ã€‚

```
private Pattern syntaxPattern;
private Color highlightColor = Color.*MAGENTA*;
```

æˆ‘ä»¬å°†åˆ›å»º setter æ–¹æ³•æ¥æ ¹æ®æœç´¢å…³é”®å­—æ›´æ–°å½“å‰æ¨¡å¼ã€‚

```
public void updateSyntaxPattern(Pattern pattern) {
    syntaxPattern = pattern;
    notifyDataSetChanged();
}
```

å½“ä½ ä¸ºæ¯ä¸ªæ¡ç›®è®¾ç½®æ–‡æœ¬æ—¶ï¼Œä¾èµ–äºä½ çš„é€‚é…å™¨ï¼Œä¾‹å¦‚åœ¨ getView æ–¹æ³•ä¸­çš„ ArrayAdapter å’Œåœ¨ä½ çš„ holder ä¸­çš„ RecyclerViewAdapter ç­‰ç­‰ã€‚

æˆ‘ä»¬å°†ç®€å•åœ°æ£€æŸ¥æˆ‘ä»¬çš„æ¨¡å¼æ˜¯å¦ä¸ä¸ºç©ºï¼Œå¹¶å°†å®ƒæ·»åŠ åˆ°å¸¦æœ‰é¢œè‰²çš„ CodeView å®ä¾‹ä¸­ï¼Œä½†æ˜¯è¯·è®°ä½ï¼Œæˆ‘ä»¬éœ€è¦æ¸…é™¤ä¸Šæ¬¡æœç´¢ä¸­çš„æ¨¡å¼ï¼Œå› æ­¤ä»£ç å°†å¦‚ä¸‹æ‰€ç¤ºã€‚

```
if(syntaxPattern != null) {
    codeView.resetSyntaxPatternList();
    codeView.addSyntaxPattern(syntaxPattern, highlightColor);
}
```

ç°åœ¨æˆ‘ä»¬åœ¨é€‚é…å™¨ä¸­å®Œæˆäº†ï¼Œè®©æˆ‘ä»¬è½¬åˆ° SearchViewï¼Œæ‚¨å¿…é¡»æœ‰ä¸¤ä¸ªæ–¹æ³•æ¥ä½¿ç”¨ onQueryTextSubmit å’Œ onQueryTextChangeï¼Œè¿™å–å†³äºæ‚¨å¸Œæœ›è§å…‰ç¬”ä½•æ—¶å·¥ä½œï¼Œæ‚¨å°†é€‰æ‹©å…¶ä¸­ä¸€ä¸ªï¼Œç„¶åé€šè¿‡ä½¿ç”¨é€‚é…å™¨ä¸­çš„ out helper æ–¹æ³•æ¥è®¾ç½®æ¨¡å¼ï¼Œå› æ­¤ä»£ç å°†å¦‚ä¸‹æ‰€ç¤ºï¼Œ

```
Pattern pattern = Pattern.*compile*(query);
adapter.updateSyntaxPattern(pattern);
```

å°±è¿™æ ·ï¼Œç°åœ¨æˆ‘ä»¬çš„åŠŸèƒ½å®Œæˆäº†ï¼Œä½ å¯ä»¥æ‰©å±•å®ƒå¹¶æ·»åŠ é¢å¤–çš„åŠŸèƒ½ï¼Œæ¯”å¦‚å¤šä¸ªè§å…‰ç¬”ï¼Œæˆ–è€…åœ¨è¿è¡Œæ—¶æ”¹å˜é¢œè‰²ä»¥æ”¯æŒå¤šä¸ªä¸»é¢˜â€¦ç­‰ç­‰ã€‚

å®ƒéå¸¸å®¹æ˜“ä½¿ç”¨ï¼Œæœ‰æ®å¯æŸ¥ï¼Œåœ¨ GitHub ä¸Šæœ‰å¾ˆå¤šä¾‹å­ä½ å¯ä»¥ä» GitHub é“¾æ¥ä¸­çŸ¥é“å¦‚ä½•ä¸‹è½½å’Œä½¿ç”¨:
[**https://github.com/amrdeveloper/codeview**](https://github.com/amrdeveloper/codeview)

æˆ‘å¸Œæœ›ä½ ä¼šå–œæ¬¢ç”¨ CodeView åˆ›å»ºä½ çš„ç¼–è¾‘å™¨ğŸ˜‹ã€‚

ä½ å¯ä»¥åœ¨:[**Github**](https://github.com/amrdeveloper)[**Linkedin**](https://www.linkedin.com/in/amrdeveloper/)[**Twitter**](https://twitter.com/amrdeveloper)ä¸Šæ‰¾åˆ°æˆ‘ã€‚

äº«å—ç¼–ç¨‹ğŸ˜‹ã€‚