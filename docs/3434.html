<html>
<head>
<title>How to access Kubernetes applications using Services</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä½¿ç”¨æœåŠ¡è®¿é—®Kubernetesåº”ç”¨ç¨‹åº</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/how-to-access-kubernetes-applications-using-services-c437a4c940ad?source=collection_archive---------0-----------------------#2019-12-16">https://itnext.io/how-to-access-kubernetes-applications-using-services-c437a4c940ad?source=collection_archive---------0-----------------------#2019-12-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="529d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ¬¢è¿ğŸ‘‹ ğŸ‘‹è¿™æ˜¯<a class="ae kl" href="https://medium.com/@abhishek1987/kubernetes-in-a-nutshell-blog-series-c3a97fce9445" rel="noopener">â€œKubernetes in theåšæœå£³â€</a>åšå®¢ç³»åˆ—çš„å¦ä¸€éƒ¨åˆ†ï¼Œå®ƒå…³æ³¨Kubernetesçš„â€œå¹¿åº¦â€å¹¶æ¶µç›–åŸºæœ¬ä¸»é¢˜ï¼Œå¦‚<a class="ae kl" href="https://dev.to/itnext/stateless-apps-in-kubernetes-beyond-pods-4p52" rel="noopener ugc nofollow" target="_blank">ç¼–æ’æ— çŠ¶æ€åº”ç”¨</a>ï¼Œå¦‚ä½•<a class="ae kl" href="https://dev.to/itnext/hands-on-guide-configure-your-kubernetes-apps-using-the-configmap-object-44gj" rel="noopener ugc nofollow" target="_blank">ä½¿ç”¨</a> <code class="fe km kn ko kp b"><a class="ae kl" href="https://dev.to/itnext/hands-on-guide-configure-your-kubernetes-apps-using-the-configmap-object-44gj" rel="noopener ugc nofollow" target="_blank">ConfigMap</a></code>é…ç½®Kubernetesåº”ç”¨ç­‰ã€‚</p><div class="kq kr gp gr ks kt"><a rel="noopener  ugc nofollow" target="_blank" href="/kubernetes-in-a-nutshell-blog-series-c3a97fce9445"><div class="ku ab fo"><div class="kv ab kw cl cj kx"><h2 class="bd ir gy z fp ky fr fs kz fu fw ip bi translated">â€œæœå£³ä¸­çš„åº“ä¼¯å†…ç‰¹â€â€”â€”åšå®¢ç³»åˆ—</h2><div class="la l"><h3 class="bd b gy z fp ky fr fs kz fu fw dk translated">æœ¬ç³»åˆ—å°†æ¶µç›–Kubernetesçš„â€œå¹¿åº¦â€å’Œæ ¸å¿ƒ/åŸºç¡€ä¸»é¢˜(è§ä¸‹ä¸€èŠ‚)ã€‚å®ƒä¼šâ€¦</h3></div><div class="lb l"><p class="bd b dl z fp ky fr fs kz fu fw dk translated">itnext.io</p></div></div></div></a></div><p id="d4aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†æ·±å…¥KubernetesæœåŠ¡ã€‚æ‚¨å°†äº†è§£åˆ°:</p><ul class=""><li id="d767" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated">Kuberneteså†…éƒ¨å’Œå¤–éƒ¨é€šä¿¡çš„æœåŠ¡ç±»å‹</li><li id="99f5" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">é›†ç¾¤å†…æœåŠ¡å‘ç°æŠ€æœ¯</li><li id="20ba" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">å¦‚ä½•è®¿é—®å¤–éƒ¨æœåŠ¡ç­‰ã€‚</li></ul><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/9b90c7b15d94c90c03c3fcfcc5bf6ffa.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*Ol7zhQlEVXgo5v4HLuWEWA.png"/></div></figure><p id="60aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸€å¦‚æ—¢å¾€çš„ç (è¿˜æœ‰<code class="fe km kn ko kp b">YAML</code>ï¼)åœ¨GitHub ä¸Š<a class="ae kl" href="https://github.com/abhirockzz/kubernetes-in-a-nutshell/blob/master/services" rel="noopener ugc nofollow" target="_blank">å¯ç”¨</a></p><blockquote class="ly lz ma"><p id="5589" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated"><em class="iq">å¾ˆé«˜å…´é€šè¿‡</em><a class="ae kl" href="https://twitter.com/abhi_tweeter" rel="noopener ugc nofollow" target="_blank"><em class="iq">Twitter</em></a><em class="iq">è·å¾—æ‚¨çš„åé¦ˆï¼Œæˆ–è€…å‘è¡¨è¯„è®ºğŸ™ğŸ»</em></p></blockquote></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><p id="27b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Kubernetes <code class="fe km kn ko kp b">Pod</code>æ˜¯çŸ­æš‚çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬ä¸ä¼šåœ¨é‡å¯æˆ–é‡æ–°è°ƒåº¦åä¿ç•™å…¶å±æ€§ã€‚è¿™é€‚ç”¨äºå®¹å™¨å­˜å‚¨(å·)ã€èº«ä»½(<code class="fe km kn ko kp b">Pod</code>åç§°)ï¼Œç”šè‡³IPåœ°å€ã€‚è¿™ç»™åº”ç”¨ç¨‹åºè®¿é—®å¸¦æ¥äº†æŒ‘æˆ˜ã€‚åƒ<code class="fe km kn ko kp b">Deployment</code>è¿™æ ·çš„é«˜å±‚æŠ½è±¡æ§åˆ¶å‡ ä¸ª<code class="fe km kn ko kp b">Pod</code>å¹¶å°†å®ƒä»¬è§†ä¸ºæ— çŠ¶æ€å®ä½“â€”â€”å®¢æˆ·ç«¯å¦‚ä½•è®¿é—®è¿™äº›<code class="fe km kn ko kp b">Pod</code>ç»„ï¼Ÿå®¢æˆ·éœ€è¦çŸ¥é“<code class="fe km kn ko kp b">Deployment</code>ä¸‹é¢æ¯ä¸ª<code class="fe km kn ko kp b">Pod</code>çš„åæ ‡å—ï¼Ÿå¦å¤–ï¼Œä½ ä¸èƒ½æŒ‡æœ›<code class="fe km kn ko kp b">Pod</code>åœ¨é‡å¯åè·å¾—ç›¸åŒçš„IPâ€”â€”å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºå¦‚ä½•ç»§ç»­è®¿é—®<code class="fe km kn ko kp b">Pod</code>ï¼Ÿ</p><p id="1cf7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿›å…¥KubernetesæœåŠ¡ï¼</p><h1 id="8b01" class="mm mn iq bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">KubernetesæœåŠ¡</h1><p id="8ba8" class="pw-post-body-paragraph jn jo iq jp b jq nk js jt ju nl jw jx jy nm ka kb kc nn ke kf kg no ki kj kk ij bi translated">ä¸€ä¸ª<code class="fe km kn ko kp b">Service</code>æ˜¯ä¸€ä¸ªæ›´é«˜çº§åˆ«çš„ç»„ä»¶ï¼Œå®ƒæä¾›å¯¹ä¸€ç»„<code class="fe km kn ko kp b">Pod</code>çš„è®¿é—®ã€‚å®ƒå°†å®¢æˆ·ç«¯åº”ç”¨ä»ä¸€ä¸ª<code class="fe km kn ko kp b">Deployment</code>(æˆ–ä¸€ç»„<code class="fe km kn ko kp b">Pod</code>çš„ç»†èŠ‚ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä»¥å®ç°å¯é¢„æµ‹å’Œç¨³å®šçš„è®¿é—®ã€‚</p><p id="e665" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Kuberneteså®šä¹‰äº†ä»¥ä¸‹ç±»å‹çš„æœåŠ¡:</p><ul class=""><li id="a34b" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated"><code class="fe km kn ko kp b">ClusterIP</code> â€”ä»…é€‚ç”¨äºKubernetesé›†ç¾¤å†…çš„è®¿é—®</li><li id="8db4" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated"><code class="fe km kn ko kp b">NodePort</code> â€”ä½¿ç”¨KubernetesèŠ‚ç‚¹æœ¬èº«çš„IPå’Œç«¯å£è¿›è¡Œè®¿é—®</li><li id="2dd7" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated"><code class="fe km kn ko kp b">LoadBalancer</code> â€”ä½¿ç”¨å¤–éƒ¨è´Ÿè½½å¹³è¡¡å™¨(é€šå¸¸æ˜¯ç‰¹å®šäºäº‘æä¾›å•†çš„)ï¼Œä¾‹å¦‚<a class="ae kl" href="https://docs.microsoft.com/azure/aks/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> AKS </a>ä¸­çš„<a class="ae kl" href="https://docs.microsoft.com/azure/load-balancer/load-balancer-overview?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Azureè´Ÿè½½å¹³è¡¡å™¨</a></li><li id="1102" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated"><code class="fe km kn ko kp b">ExternalName</code> â€”å°†<code class="fe km kn ko kp b">Service</code>æ˜ å°„åˆ°å¤–éƒ¨DNSåç§°</li></ul><p id="1041" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">äººä»¬å¯ä»¥å°†è®¿é—®æ¨¡å¼åˆ†ä¸ºä¸¤å¤§ç±»:</p><ul class=""><li id="500a" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated">ä»å¤–éƒ¨æ¥è¿‘</li><li id="7a20" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">å†…éƒ¨è®¿é—®</li></ul></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h1 id="10df" class="mm mn iq bd mo mp np mr ms mt nq mv mw mx nr mz na nb ns nd ne nf nt nh ni nj bi translated">ä»å¤–éƒ¨æ¥è¿‘</h1><p id="4341" class="pw-post-body-paragraph jn jo iq jp b jq nk js jt ju nl jw jx jy nm ka kb kc nn ke kf kg no ki kj kk ij bi translated">å¦‚æœæ‚¨å¸Œæœ›å¤–éƒ¨å®¢æˆ·ç«¯è®¿é—®Kubernetesé›†ç¾¤ä¸­çš„åº”ç”¨ç¨‹åºï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<code class="fe km kn ko kp b">NodePort</code>æˆ–<code class="fe km kn ko kp b">LoadBalancer</code>æœåŠ¡ã€‚</p><h2 id="2620" class="nu mn iq bd mo nv nw dn ms nx ny dp mw jy nz oa na kc ob oc ne kg od oe ni of bi translated">èŠ‚ç‚¹ç«¯å£</h2><p id="6e78" class="pw-post-body-paragraph jn jo iq jp b jq nk js jt ju nl jw jx jy nm ka kb kc nn ke kf kg no ki kj kk ij bi translated"><code class="fe km kn ko kp b">NodePort</code>å°±åƒå®ƒå¬èµ·æ¥çš„é‚£æ ·â€”â€”ä½¿å¾—ä½¿ç”¨èŠ‚ç‚¹çš„IP(åœ¨å…¶ä¸Šå·²ç»è°ƒåº¦äº†<code class="fe km kn ko kp b">Pod</code>)å’ŒKubernetesåˆ†é…çš„éšæœºç«¯å£è®¿é—®é›†ç¾¤å†…çš„åº”ç”¨æˆä¸ºå¯èƒ½ï¼Œä¾‹å¦‚ï¼Œå¯¹äºHTTPç«¯ç‚¹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<code class="fe km kn ko kp b">http://&lt;node_ip&gt;:&lt;port&gt;</code></p><p id="6a37" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­:</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="8729" class="nu mn iq kp b gy ok ol l om on">apiVersion: v1<br/>kind: Service<br/>metadata:<br/>  name: kin-nodeport-service<br/>spec:<br/>  type: NodePort<br/>  ports:<br/>    - port: 80<br/>      targetPort: 8080<br/>  selector:<br/>    app: kin-service-app</span></pre><p id="5129" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è™½ç„¶<code class="fe km kn ko kp b">NodePort</code>åœ¨æ¦‚å¿µä¸Šå¾ˆç®€å•ï¼Œä½†è¿™é‡Œæœ‰å‡ ç‚¹ä½ åº”è¯¥æ³¨æ„</p><ul class=""><li id="c9fd" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated">éšæœºç«¯å£åˆ†é…å—é™äºèŒƒå›´â€” <code class="fe km kn ko kp b">30000â€“32767</code></li><li id="db47" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">è¯¥ç«¯å£å¯¹äºé›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ç›¸åŒçš„</li><li id="a301" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">å¯ä»¥æŒ‡å®šä¸€ä¸ªé™æ€ç«¯å£å·ï¼Œä½†æ˜¯ç”±äºç«¯å£åˆ†é…ã€æ— æ•ˆç«¯å£ç­‰åŸå› ï¼Œ<code class="fe km kn ko kp b">Service</code>åˆ›å»ºå¯èƒ½ä¼šå¤±è´¥ã€‚</li></ul><h2 id="20af" class="nu mn iq bd mo nv nw dn ms nx ny dp mw jy nz oa na kc ob oc ne kg od oe ni of bi translated">è´Ÿè½½å¹³è¡¡å™¨</h2><p id="b004" class="pw-post-body-paragraph jn jo iq jp b jq nk js jt ju nl jw jx jy nm ka kb kc nn ke kf kg no ki kj kk ij bi translated">å½“åœ¨äº‘æä¾›å•†ä¸­è¿è¡Œæ—¶ï¼Œ<code class="fe km kn ko kp b">LoadBalancer</code>æœåŠ¡ç±»å‹è§¦å‘å¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨çš„ä¾›åº”ï¼Œè¯¥è´Ÿè½½å‡è¡¡å™¨åœ¨åå°ä¹‹é—´åˆ†é…æµé‡ã€‚</p><p id="a729" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºäº†çœ‹åˆ°è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬åœ¨<a class="ae kl" href="https://docs.microsoft.com/azure/aks/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Azure KubernetesæœåŠ¡</a>ä¸Šéƒ¨ç½²ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå¹¶ä½¿ç”¨<code class="fe km kn ko kp b">LoadBalancer</code>æœåŠ¡å…¬å¼€å®ƒã€‚</p><blockquote class="ly lz ma"><p id="5bee" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated"><em class="iq">ä½¿ç”¨åŸºäºå¤šèŠ‚ç‚¹(è‡³å°‘ä¸¤ä¸ª)äº‘çš„Kubernetesé›†ç¾¤å¯ä»¥å¾ˆå®¹æ˜“åœ°æ¼”ç¤ºè¿™ä¸€æ¦‚å¿µã€‚éšæ„ä½¿ç”¨ä»»ä½•å…¶ä»–äº‘æä¾›å•†(ä¾‹å¦‚</em> <code class="fe km kn ko kp b"><em class="iq">GKE</em></code> <em class="iq">æ¥å°è¯•è¿™ä¸ªåœºæ™¯)</em></p></blockquote><p id="764e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœä½ æƒ³ç”¨<a class="ae kl" href="https://azure.microsoft.com/" rel="noopener ugc nofollow" target="_blank"> Azure </a>è¯•è¯•è¿™ä¸ªï¼Œè¿™é‡Œæœ‰ä¸€äº›å…ˆå†³æ¡ä»¶ï¼Œä½ åº”è¯¥åœ¨é˜…è¯»æœ¬æ–‡æ•™ç¨‹ä¹‹å‰å®Œæˆ:</p><ul class=""><li id="b069" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated">è·å¾—ä¸€ä¸ª<a class="ae kl" href="https://docs.microsoft.com/azure/aks/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">å…è´¹çš„å¾®è½¯Azureè´¦æˆ·</a>ï¼</li><li id="ac15" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated"><a class="ae kl" href="https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest&amp;WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">å®‰è£…Azure CLIå·¥å…·</a></li><li id="c82b" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated"><a class="ae kl" href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" rel="noopener ugc nofollow" target="_blank">å®‰è£…</a> <code class="fe km kn ko kp b"><a class="ae kl" href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" rel="noopener ugc nofollow" target="_blank">kubectl</a></code>æ¥è®¿é—®æ‚¨çš„Kubernetesé›†ç¾¤</li><li id="7440" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated"><a class="ae kl" href="https://docs.microsoft.com/en-in/azure/aks/kubernetes-walkthrough" rel="noopener ugc nofollow" target="_blank">ä½¿ç”¨CLIåœ¨Azureä¸Šè®¾ç½®ä¸€ä¸ªåŒèŠ‚ç‚¹Kubernetesé›†ç¾¤</a></li></ul><p id="4b9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å®Œæˆé›†ç¾¤è®¾ç½®åï¼Œç¡®ä¿ä½¿ç”¨<code class="fe km kn ko kp b"><a class="ae kl" href="https://docs.microsoft.com/cli/azure/aks?view=azure-cli-latest&amp;WT.mc_id=medium-blog-abhishgu#az-aks-get-credentials" rel="noopener ugc nofollow" target="_blank">az aks get-credentials</a></code>å‘½ä»¤é…ç½®<code class="fe km kn ko kp b">kubectl</code>è¿æ¥åˆ°é›†ç¾¤â€”â€”è¿™ä¼šä¸‹è½½å‡­è¯å¹¶é…ç½®Kubernetes CLIæ¥ä½¿ç”¨å®ƒä»¬ã€‚</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="689d" class="nu mn iq kp b gy ok ol l om on">az aks get-credentials --name &lt;AKS-cluster-name&gt; --resource-group &lt;AKS-resource-group&gt;</span></pre><p id="6c6d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½ ç°åœ¨åº”è¯¥éƒ½å‡†å¤‡å¥½äº†ã€‚è®©æˆ‘ä»¬ä»åˆ›å»º<code class="fe km kn ko kp b">Service</code>ä»¥åŠç¤ºä¾‹åº”ç”¨ç¨‹åºå¼€å§‹ã€‚</p><p id="4e3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºäº†ç®€å•èµ·è§ï¼ŒYAMLæ–‡ä»¶ç›´æ¥ä»<a class="ae kl" href="https://github.com/abhirockzz/kubernetes-in-a-nutshell" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>ä¸­å¼•ç”¨ï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥ä¸‹è½½æ–‡ä»¶åˆ°ä½ çš„æœ¬åœ°æœºå™¨ä¸Šï¼Œä»¥åŒæ ·çš„æ–¹å¼ä½¿ç”¨å®ƒã€‚</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="5b68" class="nu mn iq kp b gy ok ol l om on">kubectl apply -f https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/services/loadbalancer/service.yaml</span><span id="a13b" class="nu mn iq kp b gy oo ol l om on">kubectl apply -f <a class="ae kl" href="https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/services/app/app.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/services/app/app.yaml</a></span></pre><blockquote class="ly lz ma"><p id="9f97" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated"><em class="iq"/><a class="ae kl" href="https://github.com/abhirockzz/kubernetes-in-a-nutshell/tree/master/services/app" rel="noopener ugc nofollow" target="_blank"><em class="iq">ç¤ºä¾‹åº”ç”¨</em> </a> <em class="iq">å…¶å®å¾ˆç®€å•</em> <a class="ae kl" href="https://golang.org/" rel="noopener ugc nofollow" target="_blank"> <em class="iq">èµ°</em> </a> <em class="iq">ç¨‹åº</em></p></blockquote><p id="8335" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç¡®è®¤<code class="fe km kn ko kp b">Service</code>å·²ç»åˆ›å»º</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="efa2" class="nu mn iq kp b gy ok ol l om on">kubectl get svc/kin-lb-service</span></pre><p id="588d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚¨åº”è¯¥ä¼šå¾—åˆ°ç±»ä¼¼ä¸‹é¢çš„å“åº”</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="04bb" class="nu mn iq kp b gy ok ol l om on">NAME             TYPE           CLUSTER-IP    <strong class="kp ir"> EXTERNAL-IP </strong>    PORT(S)        AGE<br/>kin-lb-service   LoadBalancer   10.0.149.217   <strong class="kp ir">&lt;pending&gt;</strong>        80:31789/TCP   1m</span></pre><p id="a042" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe km kn ko kp b">EXTERNAL-IP</code>çš„<code class="fe km kn ko kp b">pending</code>çŠ¶æ€æ˜¯æš‚æ—¶çš„â€”â€”è¿™æ˜¯å› ä¸ºAKSæ­£åœ¨å¹•åæä¾›ä¸€ä¸ª<a class="ae kl" href="https://docs.microsoft.com/azure/load-balancer/load-balancer-overview?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> Azureè´Ÿè½½å‡è¡¡å™¨</a>ã€‚</p><p id="4e74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸€æ®µæ—¶é—´åï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°<code class="fe km kn ko kp b">EXTERNAL-IP</code>å¡«å……äº†è´Ÿè½½å‡è¡¡å™¨çš„å…¬å…±IP</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="3c7f" class="nu mn iq kp b gy ok ol l om on">NAME             TYPE           CLUSTER-IP     EXTERNAL-IP     PORT(S)        AGE<br/>kin-lb-service   LoadBalancer   10.0.149.217   242.42.420.42   80:31789/TCP   2m</span></pre><p id="7bde" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ£€æŸ¥åº”ç”¨ç¨‹åºæ˜¯å¦ä¹Ÿå·²éƒ¨ç½²â€”â€”æ‚¨åº”è¯¥çœ‹åˆ°ä¸¤ä¸ª<code class="fe km kn ko kp b">Pod</code>å¤„äº<code class="fe km kn ko kp b">Running</code>çŠ¶æ€</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="326c" class="nu mn iq kp b gy ok ol l om on">kubectl get pod -l=app=kin-service-app</span><span id="2c82" class="nu mn iq kp b gy oo ol l om on">NAME                              READY   STATUS    RESTARTS   AGE<br/>kin-service-app-775f989dd-gr4jk   1/1     Running   0          5m<br/>kin-service-app-775f989dd-rmq6r   1/1     Running   0          5m</span></pre><p id="c7a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚¨å¯ä»¥ä½¿ç”¨è´Ÿè½½å¹³è¡¡å™¨IPè®¿é—®åº”ç”¨ç¨‹åºï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="00ee" class="nu mn iq kp b gy ok ol l om on">curl <a class="ae kl" href="http://242.42.420.42/" rel="noopener ugc nofollow" target="_blank">http://242.42.420.42/</a></span></pre><blockquote class="ly lz ma"><p id="b4b6" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated"><em class="iq">è¯·æ³¨æ„ï¼Œåœ¨æ‚¨çš„æƒ…å†µä¸‹ï¼ŒIPä¼šæœ‰æ‰€ä¸åŒã€‚å¦å¤–ï¼Œæ ¹æ®</em> <code class="fe km kn ko kp b"><em class="iq">Service</em></code> <em class="iq">æ¸…å•ä¸­çš„</em> <code class="fe km kn ko kp b"><em class="iq">spec.ports.port</em></code> <em class="iq">å±æ€§ï¼Œè´Ÿè½½å¹³è¡¡å™¨ç«¯å£ä¸º</em> <code class="fe km kn ko kp b"><em class="iq">80</em></code> <em class="iq">ã€‚</em></p></blockquote><p id="a48b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹å†…å®¹çš„å“åº”:</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="f951" class="nu mn iq kp b gy ok ol l om on">Hello from Pod IP 10.244.0.151 on Node aks-agentpool-37379363-0</span></pre><p id="1933" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ­¤è¾“å‡ºæ˜¾ç¤º:</p><ul class=""><li id="888c" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated"><code class="fe km kn ko kp b">Pod</code>çš„IPï¼Œä»¥åŠï¼Œ</li><li id="6b35" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">Podæ‰€åœ¨çš„<code class="fe km kn ko kp b">Node</code>çš„åç§°</li></ul><p id="2033" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœæ‚¨å†æ¬¡å°è¯•è®¿é—®åº”ç”¨ç¨‹åº(<code class="fe km kn ko kp b">curl http://242.42.420.42/</code>)ï¼Œæ‚¨å¾ˆå¯èƒ½ä¼šè¢«è´Ÿè½½å¹³è¡¡åˆ°å¦ä¸€ä¸ªå®ä¾‹<code class="fe km kn ko kp b">Pod</code>ï¼Œè¯¥å®ä¾‹å¯èƒ½ä½äºä¸åŒçš„<code class="fe km kn ko kp b">Node</code>ä¸Šï¼Œæ‚¨å¯èƒ½ä¼šçœ‹åˆ°å¦‚ä¸‹å“åº”:</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="5462" class="nu mn iq kp b gy ok ol l om on">Hello from Pod IP 10.244.1.139 on Node aks-agentpool-37379363-1</span></pre><blockquote class="ly lz ma"><p id="8e82" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated"><em class="iq">æ‚¨å¯ä»¥æ‰©å±•æ‚¨çš„åº”ç”¨ç¨‹åº(å‘å†…å’Œå‘å¤–æ‰©å±•),å¹¶ä½¿ç”¨è´Ÿè½½å¹³è¡¡å™¨IPç»§ç»­è®¿é—®å®ƒã€‚</em></p></blockquote><p id="c4d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœæ‚¨æƒ³ä½¿ç”¨CLIè·å–Azureè´Ÿè½½å¹³è¡¡å™¨çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤:</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="7d80" class="nu mn iq kp b gy ok ol l om on">export AZURE_RESOURCE_GROUP=[enter AKS resource group]<br/>export AKS_CLUSTER_NAME=[enter AKS cluster name]</span></pre><p id="9402" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½¿ç”¨<code class="fe km kn ko kp b"><a class="ae kl" href="https://docs.microsoft.com/cli/azure/aks?view=azure-cli-latest&amp;WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank">az aks show</a></code>å‘½ä»¤è·å–AKSé›†ç¾¤åŸºç¡€æ¶æ„èµ„æºç»„åç§°</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="fdfb" class="nu mn iq kp b gy ok ol l om on">INFRA_RG=$(az aks show --resource-group $AZURE_RESOURCE_GROUP --name $AKS_CLUSTER_NAME --query nodeResourceGroup -o tsv)</span></pre><p id="421d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç”¨å®ƒåˆ—å‡ºå¸¦æœ‰<code class="fe km kn ko kp b"><a class="ae kl" href="https://docs.microsoft.com/cli/azure/network/lb?view=azure-cli-latest&amp;WT.mc_id=medium-blog-abhishgu#az-network-lb-list" rel="noopener ugc nofollow" target="_blank">az network lb list</a></code>å‘½ä»¤çš„è´Ÿè½½å¹³è¡¡å™¨(æ‚¨å°†å¾—åˆ°ä¸€ä¸ªå¸¦æœ‰è´Ÿè½½å¹³è¡¡å™¨ä¿¡æ¯çš„JSONå“åº”)</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="207d" class="nu mn iq kp b gy ok ol l om on">az network lb list -g $INFRA_RG</span></pre></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h1 id="9c1c" class="mm mn iq bd mo mp np mr ms mt nq mv mw mx nr mz na nb ns nd ne nf nt nh ni nj bi translated">ä½¿ç”¨<code class="fe km kn ko kp b">ClusterIP</code>è¿›è¡Œå†…éƒ¨è®¿é—®</h1><p id="f687" class="pw-post-body-paragraph jn jo iq jp b jq nk js jt ju nl jw jx jy nm ka kb kc nn ke kf kg no ki kj kk ij bi translated"><code class="fe km kn ko kp b">ClusterIP</code>æœåŠ¡ç±»å‹å’Œå¯ä»¥åœ¨é›†ç¾¤å†…ä½¿ç”¨çš„é€šä¿¡â€”â€”åªéœ€åœ¨<code class="fe km kn ko kp b">spec.type</code>ä¸­æŒ‡å®š<code class="fe km kn ko kp b">ClusterIP</code>,å°±å¯ä»¥äº†ï¼</p><blockquote class="ly lz ma"><p id="b993" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated"><code class="fe km kn ko kp b"><em class="iq">ClusterIP</em></code> <em class="iq">æ˜¯é»˜è®¤çš„æœåŠ¡ç±»å‹</em></p></blockquote><p id="cae4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å³ä½¿å¯¹äºå…·æœ‰<code class="fe km kn ko kp b">ClusterIPService</code>ç±»å‹çš„é›†ç¾¤å†…é€šä¿¡ï¼Œä¹Ÿå¿…é¡»æœ‰ä¸€ç§æ–¹æ³•è®©åº”ç”¨<code class="fe km kn ko kp b">A</code>è°ƒç”¨åº”ç”¨<code class="fe km kn ko kp b">B</code>(é€šè¿‡<code class="fe km kn ko kp b">Service</code>)ã€‚é›†ç¾¤ä¸­çš„åº”ç”¨æœ‰ä¸¤ç§æœåŠ¡å‘ç°æ–¹å¼:</p><ul class=""><li id="df8c" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated">ç¯å¢ƒå˜é‡</li><li id="9172" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated"><code class="fe km kn ko kp b">DNS</code></li></ul><h2 id="4452" class="nu mn iq bd mo nv nw dn ms nx ny dp mw jy nz oa na kc ob oc ne kg od oe ni of bi translated">ç¯å¢ƒå˜é‡</h2><p id="b7b5" class="pw-post-body-paragraph jn jo iq jp b jq nk js jt ju nl jw jx jy nm ka kb kc nn ke kf kg no ki kj kk ij bi translated">æ¯ä¸ª<code class="fe km kn ko kp b">Pod</code>éƒ½æœ‰ä¸€ç»„ç‰¹å®šäº<code class="fe km kn ko kp b">Service</code>çš„ç¯å¢ƒå˜é‡ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼å¦‚ä¸‹åˆ›å»ºä¸€ä¸ª<code class="fe km kn ko kp b">ClusterIP</code>æœåŠ¡ï¼Œå¹¶ç¡®è®¤å®ƒå·²ç»è¢«åˆ›å»º</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="bad7" class="nu mn iq kp b gy ok ol l om on">kubectl apply -f https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/services/clusterip/service.yaml</span><span id="91d7" class="nu mn iq kp b gy oo ol l om on">kubectl get svc/kin-cip-service</span></pre><p id="ecee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿˜è®°å¾—æˆ‘ä»¬ä¸ºæ¢ç´¢<code class="fe km kn ko kp b">LoadBalancer</code> <code class="fe km kn ko kp b">Service</code>ç±»å‹è€Œéƒ¨ç½²çš„åº”ç”¨ç¨‹åºå—ï¼Ÿå¥½å§ï¼Œåˆ é™¤å¹¶é‡æ–°åˆ›å»ºå®ƒä¸€æ¬¡(æˆ‘ä¼šè§£é‡Šä¸ºä»€ä¹ˆè¿™æ ·åšï¼Œä¸€ä¼šå„¿)</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="74b7" class="nu mn iq kp b gy ok ol l om on">kubectl delete -f https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/services/app/app.yaml</span><span id="9817" class="nu mn iq kp b gy oo ol l om on">kubectl apply -f <a class="ae kl" href="https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/services/app/app.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/services/app/app.yaml</a></span></pre><p id="dad6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸€æ—¦appå¤„äº<code class="fe km kn ko kp b">Running</code>çŠ¶æ€(æ£€æŸ¥<code class="fe km kn ko kp b">kubectl get pod -l=app=kin-service-app</code>)ï¼Œ<code class="fe km kn ko kp b"><a class="ae kl" href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#exec" rel="noopener ugc nofollow" target="_blank">exec</a></code>(ç›´æ¥åœ¨<code class="fe km kn ko kp b">Pod</code>å†…éƒ¨æ‰§è¡Œå‘½ä»¤)è¿›å…¥<code class="fe km kn ko kp b">Pod</code>æ£€æŸ¥å…¶ç¯å¢ƒå˜é‡</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="501f" class="nu mn iq kp b gy ok ol l om on">kubectl exec &lt;enter-pod-name&gt; -- env | grep KIN_CIP</span></pre><p id="514f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚¨å°†çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„ç»“æœ:</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="aa6d" class="nu mn iq kp b gy ok ol l om on">KIN_CIP_SERVICE_PORT_9090_TCP_ADDR=10.0.44.29<br/>KIN_CIP_SERVICE_SERVICE_PORT=9090<br/>KIN_CIP_SERVICE_PORT_9090_TCP_PROTO=tcp<br/>KIN_CIP_SERVICE_PORT_9090_TCP=tcp://10.0.44.29:9090<br/>KIN_CIP_SERVICE_PORT=tcp://10.0.44.29:9090<br/>KIN_CIP_SERVICE_SERVICE_HOST=10.0.44.29<br/>KIN_CIP_SERVICE_PORT_9090_TCP_PORT=9090</span></pre><p id="2414" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ³¨æ„ç¯å¢ƒå˜é‡åç§°çš„æ ¼å¼äº†å—ï¼Ÿå…¶ä¸­åŒ…æ‹¬<code class="fe km kn ko kp b">ClusterIP</code> <code class="fe km kn ko kp b">Service</code>æœ¬èº«çš„åç§°(å³<code class="fe km kn ko kp b">kin-cip-service</code>)ï¼Œå°†<code class="fe km kn ko kp b">-</code>æ›¿æ¢ä¸º<code class="fe km kn ko kp b">_</code>ï¼Œå…¶ä½™ä¸ºå¤§å†™ã€‚è¿™æ˜¯ä¸€ç§é¢„å®šä¹‰çš„æ ¼å¼ï¼Œå¦‚æœæ‚¨çŸ¥é“æ”¯æŒå®ƒçš„<code class="fe km kn ko kp b">Service</code>çš„åç§°ï¼Œå®ƒå¯ä»¥ç”¨æ¥ä¸å¦ä¸€ä¸ªåº”ç”¨ç¨‹åºé€šä¿¡ã€‚</p><blockquote class="ly lz ma"><p id="c5a3" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated"><em class="iq">è¿™é‡Œæœ‰ä¸€ä¸ªè­¦å‘Š:åªæœ‰åœ¨</em> <code class="fe km kn ko kp b"><em class="iq">Service</em></code> <em class="iq">ä¹‹å‰åˆ›å»ºäº†</em> <code class="fe km kn ko kp b"><em class="iq">Pod</em></code> <em class="iq">æ—¶ï¼Œæ‰ä¼šå°†ç¯å¢ƒå˜é‡æ¤å…¥å…¶ä¸­ï¼è¿™å°±æ˜¯æˆ‘ä»¬å¿…é¡»é‡æ–°åˆ›å»ºåº”ç”¨ç¨‹åºæ¥æŸ¥çœ‹æ•ˆæœçš„åŸå› ã€‚</em></p></blockquote><p id="534d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è®©æˆ‘ä»¬ä½¿ç”¨ç¯å¢ƒå˜é‡ä»å¦ä¸€ä¸ª<code class="fe km kn ko kp b">Pod</code>è®¿é—®è¿™ä¸ªåº”ç”¨ç¨‹åºã€‚ç”¨<code class="fe km kn ko kp b">curl</code>å†è¿è¡Œä¸€æ¬¡<code class="fe km kn ko kp b">Pod</code></p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="4f42" class="nu mn iq kp b gy ok ol l om on">kubectl run --rm --generator=run-pod/v1 curl --image=radial/busyboxplus:curl -i --tty</span></pre><blockquote class="ly lz ma"><p id="a3de" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated"><em class="iq">ä½ åº”è¯¥å¾ˆå¿«å°±ä¼šçœ‹åˆ°ä¸€ä¸ªå‘½ä»¤æç¤ºç¬¦</em></p></blockquote><p id="657a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç¡®è®¤è¿™ä¸ª<code class="fe km kn ko kp b">Pod</code>ä¹Ÿæœ‰ç¯å¢ƒå˜é‡(ä½¿ç”¨<code class="fe km kn ko kp b">env | grep KIN_CIP</code>ï¼Œç„¶åä½¿ç”¨ç¯å¢ƒå˜é‡ç®€å•åœ°<code class="fe km kn ko kp b">curl</code>åº”ç”¨ç¨‹åºç«¯ç‚¹</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="8b47" class="nu mn iq kp b gy ok ol l om on">curl <a class="ae kl" rel="noopener ugc nofollow" target="_blank" href="/$KIN_CIP_SERVICE_SERVICE_HOST:$KIN_CIP_SERVICE_SERVICE_PORT">http://$KIN_CIP_SERVICE_SERVICE_HOST:$KIN_CIP_SERVICE_SERVICE_PORT</a></span></pre><p id="8ad6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä¸<code class="fe km kn ko kp b">LoadBalancer</code>ç¤ºä¾‹ç›¸åŒçš„å“åº”ï¼Œå³</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="e46e" class="nu mn iq kp b gy ok ol l om on">Hello from Pod IP 10.244.0.153 on Node aks-agentpool-37379363-0</span></pre><p id="ad73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¤šè¯•å‡ æ¬¡ï¼Œä»¥ç¡®è®¤è´Ÿè½½åœ¨å„ä¸ªåŠèˆ±ä¹‹é—´è¾¾åˆ°å¹³è¡¡ï¼å› æ­¤ï¼Œæˆ‘ä»¬åŸºäº<code class="fe km kn ko kp b">Service</code>åç§°å¯¼å‡ºç¯å¢ƒå˜é‡ï¼Œå³<code class="fe km kn ko kp b">kin-cip-service</code>è¢«è½¬æ¢ä¸º<code class="fe km kn ko kp b">KIN_CIP_SERVICE</code>ï¼Œå…¶ä½™éƒ¨åˆ†è¢«æ·»åŠ - <code class="fe km kn ko kp b">_SERVICE_HOST</code>å’Œ<code class="fe km kn ko kp b">_SERVICE_PORT</code>ï¼Œåˆ†åˆ«ç”¨äºä¸»æœºå’Œç«¯å£ã€‚</p><h2 id="4695" class="nu mn iq bd mo nv nw dn ms nx ny dp mw jy nz oa na kc ob oc ne kg od oe ni of bi translated">åŸŸåæœåŠ¡å™¨(Domain Name Server)</h2><p id="288f" class="pw-post-body-paragraph jn jo iq jp b jq nk js jt ju nl jw jx jy nm ka kb kc nn ke kf kg no ki kj kk ij bi translated">Kubernetesæœ‰ä¸€ä¸ªå†…ç½®çš„DNSæœåŠ¡å™¨(ä¾‹å¦‚<code class="fe km kn ko kp b">CoreDNS</code>)ï¼Œä¸ºæ¯ä¸ª<code class="fe km kn ko kp b">Service</code>ç»´æŠ¤DNSè®°å½•ã€‚å°±åƒç¯å¢ƒå˜é‡ä¸€æ ·ï¼ŒDNSæŠ€æœ¯æä¾›äº†ä¸€ä¸ªä¸€è‡´çš„å‘½åæ–¹æ¡ˆï¼ŒåŸºäºè¿™ä¸ªæ–¹æ¡ˆï¼Œå¦‚æœæ‚¨çŸ¥é“åº”ç”¨ç¨‹åºçš„<code class="fe km kn ko kp b">Service</code>åç§°(å¦‚æœéœ€è¦çš„è¯ï¼Œè¿˜æœ‰å…¶ä»–ä¿¡æ¯ï¼Œæ¯”å¦‚<code class="fe km kn ko kp b">namespace</code>)ï¼Œæ‚¨å°±å¯ä»¥è®¿é—®åº”ç”¨ç¨‹åºã€‚</p><blockquote class="ly lz ma"><p id="dc7e" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated"><em class="iq">å¥½çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™ç§æŠ€æœ¯ä¸åƒç¯å¢ƒå˜é‡</em>é‚£æ ·ä¾èµ–äº <code class="fe km kn ko kp b"><em class="iq">Service</em></code> <em class="iq">å’Œ</em> <code class="fe km kn ko kp b"><em class="iq">Pod</em></code> <em class="iq">çš„åˆ›å»ºé¡ºåº</em></p></blockquote><p id="828d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½ å¯ä»¥é©¬ä¸Šè¯•è¯•:</p><p id="8ecf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å†æ¬¡è¿è¡Œ<code class="fe km kn ko kp b">curl</code> <code class="fe km kn ko kp b">Pod</code></p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="32c6" class="nu mn iq kp b gy ok ol l om on">kubectl run --rm --generator=run-pod/v1 curl --image=radial/busyboxplus:curl -i --tty</span></pre><p id="8b38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¦è®¿é—®åº”ç”¨ç¨‹åº:</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="bdf8" class="nu mn iq kp b gy ok ol l om on">curl <a class="ae kl" href="http://kin-cip-service.default.svc.cluster.local:9090" rel="noopener ugc nofollow" target="_blank">http://kin-cip-service.default.svc.cluster.local:9090</a></span></pre><p id="a114" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸€åˆ‡éƒ½åº”è¯¥ä»¥åŒæ ·çš„æ–¹å¼å·¥ä½œï¼FQDNæ ¼å¼ä¸º<code class="fe km kn ko kp b">&lt;service-name&gt;.&lt;namespace&gt;.&lt;cluster-domain-suffix&gt;</code>ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒæ˜ å°„åˆ°:</p><ul class=""><li id="1cb2" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated"><code class="fe km kn ko kp b">service-name</code> - <code class="fe km kn ko kp b">kin-cip-service</code></li><li id="3a1d" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated"><code class="fe km kn ko kp b">namespace</code> - <code class="fe km kn ko kp b">default</code></li><li id="47f0" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated"><code class="fe km kn ko kp b">cluster-domain-suffix</code> - <code class="fe km kn ko kp b">svc.cluster.local</code></li></ul><blockquote class="ly lz ma"><p id="3c0d" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated"><em class="iq">å¯¹äºåŒä¸€ä¸ª</em> <code class="fe km kn ko kp b"><em class="iq">namespace</em></code> <em class="iq">ä¸­çš„åº”ç”¨ç¨‹åºï¼Œä½ å®é™…ä¸Šå¯ä»¥è·³è¿‡å¤§éƒ¨åˆ†ï¼Œåªä½¿ç”¨æœåŠ¡åï¼</em></p></blockquote></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h1 id="05fd" class="mm mn iq bd mo mp np mr ms mt nq mv mw mx nr mz na nb ns nd ne nf nt nh ni nj bi translated">æ˜ å°„å¤–éƒ¨æœåŠ¡</h1><p id="df9d" class="pw-post-body-paragraph jn jo iq jp b jq nk js jt ju nl jw jx jy nm ka kb kc nn ke kf kg no ki kj kk ij bi translated">æœ‰äº›æƒ…å†µä¸‹ï¼Œæ‚¨éœ€è¦ä»Kubernetesé›†ç¾¤å†…éƒ¨çš„åº”ç”¨ç¨‹åºå¼•ç”¨å¤–éƒ¨æœåŠ¡ã€‚ä½ å¯ä»¥ç”¨å‡ ç§æ–¹æ³•æ¥åšåˆ°è¿™ä¸€ç‚¹</p><ul class=""><li id="e6ff" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated">ä»¥é™æ€æ–¹å¼ä½¿ç”¨<code class="fe km kn ko kp b">Endpoints</code>èµ„æº</li><li id="660d" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">ä½¿ç”¨<code class="fe km kn ko kp b">ExternalName</code>æœåŠ¡ç±»å‹</li></ul><h2 id="f3aa" class="nu mn iq bd mo nv nw dn ms nx ny dp mw jy nz oa na kc ob oc ne kg od oe ni of bi translated">é™æ€<code class="fe km kn ko kp b">Endpoints</code></h2><p id="948a" class="pw-post-body-paragraph jn jo iq jp b jq nk js jt ju nl jw jx jy nm ka kb kc nn ke kf kg no ki kj kk ij bi translated">è¿™æ˜¯æ­ç¤ºKubernetesä¸ºæ‚¨åˆ›å»ºçš„æ¯ä¸€ä¸ª<code class="fe km kn ko kp b">Service</code>åˆ›å»ºä¸€ä¸ª<code class="fe km kn ko kp b">Endpoints</code>èµ„æºçš„å¥½æ—¶æœº(å¦‚æœæ‚¨ä½¿ç”¨ä¸€ä¸ª<code class="fe km kn ko kp b">selector</code>ï¼Œè¿™æ˜¯é™¤äº†å°‘æ•°åœºæ™¯ä¹‹å¤–çš„å¤§å¤šæ•°æƒ…å†µ)ã€‚è¿™ä¸ª<code class="fe km kn ko kp b">Endpoints</code>å¯¹è±¡å®é™…ä¸Šæ•è·äº†åå°<code class="fe km kn ko kp b">Pod</code>çš„IPã€‚ä½ å¯ä»¥ä½¿ç”¨<code class="fe km kn ko kp b">kubectl get endpoints</code>æŸ¥çœ‹ç°æœ‰çš„IPã€‚</p><p id="7f92" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœæ‚¨æƒ³è¦è®¿é—®å¤–éƒ¨æœåŠ¡ï¼Œæ‚¨éœ€è¦:</p><ul class=""><li id="5db4" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated">åˆ›å»ºä¸€ä¸ªæ²¡æœ‰ä»»ä½•<code class="fe km kn ko kp b">selector</code>çš„<code class="fe km kn ko kp b">Service</code>â€”â€”Kubernetesä¸ä¼šåˆ›å»ºä¸€ä¸ª<code class="fe km kn ko kp b">Endpoints</code>å¯¹è±¡</li><li id="dc4e" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">æ‰‹åŠ¨åˆ›å»ºä¸æ‚¨çš„<code class="fe km kn ko kp b">Service</code>(åŒå)å’Œæ‚¨æƒ³è¦è®¿é—®çš„æœåŠ¡çš„IP/portå¯¹åº”çš„<code class="fe km kn ko kp b">Endpoints</code>èµ„æºã€‚</li></ul><p id="8117" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™ç»™äº†ä½ åŒæ ·çš„å¥½å¤„ï¼Œå³ä½ å¯ä»¥ä¿æŒ<code class="fe km kn ko kp b">Service</code>ä¸å˜ï¼Œå¹¶åœ¨éœ€è¦æ—¶åœ¨åå°æ›´æ–°å®é™…å®ä½“ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¿™ç§æŠ€æœ¯æŠ½è±¡å¯¹å…¬å…±HTTPç«¯ç‚¹<code class="fe km kn ko kp b">http://demo.nats.io:8222/</code>çš„è®¿é—®ã€‚</p><p id="7764" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é¦–å…ˆåˆ›å»º<code class="fe km kn ko kp b">Service</code></p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="8fb8" class="nu mn iq kp b gy ok ol l om on">kubectl apply -f <a class="ae kl" href="https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/services/external/static/service.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/services/external/static/service.yaml</a></span></pre><p id="0e3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™é‡Œæ˜¯<code class="fe km kn ko kp b">Service</code>çš„æ ·å­ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬å°†<code class="fe km kn ko kp b">port</code> <code class="fe km kn ko kp b">8080</code>æ˜ å°„åˆ°æˆ‘ä»¬æƒ³è¦è®¿é—®çš„å®é™…(ç›®æ ‡)ç«¯å£<code class="fe km kn ko kp b">8222</code></p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="6b99" class="nu mn iq kp b gy ok ol l om on">kind: Service<br/>apiVersion: v1<br/>metadata:<br/>  name: demo-nats-public-service<br/>spec:<br/>  type: ClusterIP<br/>  ports:<br/>    - port: 8080<br/>      targetPort: 8222</span></pre><p id="fc20" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è®©æˆ‘ä»¬çœ‹çœ‹<code class="fe km kn ko kp b">Endpoints</code>èµ„æºã€‚</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="1bee" class="nu mn iq kp b gy ok ol l om on">kind: Endpoints<br/>apiVersion: v1<br/>metadata:<br/>  name: demo-nats-public-service<br/>subsets:<br/>  - addresses:<br/>      - ip: 107.170.221.32<br/>    ports:<br/>      - port: 8222</span></pre><p id="c9b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¯·æ³¨æ„ä»¥ä¸‹äº‹é¡¹:</p><ul class=""><li id="f0f3" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated">èµ„æºåç§°(<code class="fe km kn ko kp b">demo-nats-public-service</code>)ä¸<code class="fe km kn ko kp b">Service</code>ç›¸åŒ</li><li id="7c38" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">æˆ‘ä»¬å·²ç»ä½¿ç”¨äº†<code class="fe km kn ko kp b">subsets</code>å±æ€§æ¥æŒ‡å®š<code class="fe km kn ko kp b">ip</code>å’Œ<code class="fe km kn ko kp b">port</code>(æˆ‘ä»¬é€šè¿‡ç®€å•åœ°ä½¿ç”¨<code class="fe km kn ko kp b">ping demo.nats.io</code>æ‰¾åˆ°äº†æ”¯æŒ<code class="fe km kn ko kp b">demo.nats.io</code>çš„<code class="fe km kn ko kp b">ip</code></li></ul><p id="0cb7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½¿ç”¨ä»¥ä¸‹æ–¹å¼åˆ›å»º:</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="a788" class="nu mn iq kp b gy ok ol l om on">kubectl apply -f <a class="ae kl" href="https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/services/external/static/endpoints.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/services/external/static/endpoints.yaml</a></span></pre><p id="e102" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å°±æ˜¯è¿™æ ·ï¼è®©æˆ‘ä»¬çœ‹çœ‹è¿™æ˜¯å¦æœ‰æ•ˆã€‚åªéœ€è¿è¡Œä¸€ä¸ª<code class="fe km kn ko kp b">curl</code> <code class="fe km kn ko kp b">Pod</code></p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="0c37" class="nu mn iq kp b gy ok ol l om on">kubectl run --rm --generator=run-pod/v1 curl --image=radial/busyboxplus:curl -i --tty</span></pre><p id="54bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨çš„åªæ˜¯æˆ‘ä»¬çš„<code class="fe km kn ko kp b">Service</code>çš„åç§°ï¼Œå³<code class="fe km kn ko kp b">demo-nats-public-service</code>(ä»¥åŠç«¯å£<code class="fe km kn ko kp b">8080</code>)ï¼Œå®ƒå°†å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="a6ec" class="nu mn iq kp b gy ok ol l om on">curl <a class="ae kl" href="http://demo-nats-public-service:8080" rel="noopener ugc nofollow" target="_blank">http://demo-nats-public-service:8080</a></span></pre><p id="84e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä»¥ä¸‹å“åº”(è¿™ä¸æ‚¨æµè§ˆåˆ°<code class="fe km kn ko kp b"><a class="ae kl" href="http://demo.nats.io:8222)" rel="noopener ugc nofollow" target="_blank">http://demo.nats.io:8222</a></code> <a class="ae kl" href="http://demo.nats.io:8222)" rel="noopener ugc nofollow" target="_blank"> ) </a></p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="6ddf" class="nu mn iq kp b gy ok ol l om on">&lt;html lang="en"&gt;<br/>   &lt;head&gt;<br/>    &lt;link rel="shortcut icon" href="http://nats.io/img/favicon.ico"&gt;<br/>    &lt;style type="text/css"&gt;<br/>      body { font-family: "Century Gothic", CenturyGothic, AppleGothic, sans-serif; font-size: 22; }<br/>      a { margin-left: 32px; }<br/>    &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;img src="http://nats.io/img/logo.png" alt="NATS"&gt;<br/>    &lt;br/&gt;<br/>	&lt;a href=/varz&gt;varz&lt;/a&gt;&lt;br/&gt;<br/>	&lt;a href=/connz&gt;connz&lt;/a&gt;&lt;br/&gt;<br/>	&lt;a href=/routez&gt;routez&lt;/a&gt;&lt;br/&gt;<br/>	&lt;a href=/gatewayz&gt;gatewayz&lt;/a&gt;&lt;br/&gt;<br/>	&lt;a href=/leafz&gt;leafz&lt;/a&gt;&lt;br/&gt;<br/>	&lt;a href=/subsz&gt;subsz&lt;/a&gt;&lt;br/&gt;<br/>    &lt;br/&gt;<br/>    &lt;a href=https://docs.nats.io/nats-server/configuration/monitoring.html&gt;help&lt;/a&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h2 id="aba9" class="nu mn iq bd mo nv nw dn ms nx ny dp mw jy nz oa na kc ob oc ne kg od oe ni of bi translated"><code class="fe km kn ko kp b">ExternalName service</code></h2><p id="76ae" class="pw-post-body-paragraph jn jo iq jp b jq nk js jt ju nl jw jx jy nm ka kb kc nn ke kf kg no ki kj kk ij bi translated"><code class="fe km kn ko kp b">ExternalName</code>æ˜¯å¦ä¸€ç§<code class="fe km kn ko kp b">Service</code>ç±»å‹ï¼Œå¯ç”¨äºå°†<code class="fe km kn ko kp b">Service</code>æ˜ å°„åˆ°DNSåç§°ã€‚è¯·æ³¨æ„ï¼Œè¿™æ˜¯ä¸€ä¸ªDNSåç§°ï¼Œè€Œä¸æ˜¯ä¸Šè¿°ç­–ç•¥ä¸­çš„IP/ç«¯å£ç»„åˆ(ä½¿ç”¨æ‰‹åŠ¨åˆ›å»ºçš„<code class="fe km kn ko kp b">Endpoints</code>)ã€‚</p><p id="b155" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨<code class="fe km kn ko kp b">Serivce</code>æ¸…å•ä¸­:</p><ul class=""><li id="03c8" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated">ä¸åŒ…æ‹¬ä¸€ä¸ª<code class="fe km kn ko kp b">selector</code></li><li id="141d" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">ä½¿ç”¨<code class="fe km kn ko kp b">externalName</code>å±æ€§æŒ‡å®šDNSåç§°ï¼Œä¾‹å¦‚<code class="fe km kn ko kp b">test.example.com</code></li><li id="7ea7" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">ä¸å…è®¸ä½¿ç”¨IPåœ°å€</li></ul><p id="5334" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­:</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="9048" class="nu mn iq kp b gy ok ol l om on">apiVersion: v1<br/>kind: Service<br/>metadata:<br/>  name: demo-nats-public-service2<br/>spec:<br/>  type: ExternalName<br/>  externalName: demo.nats.io</span></pre><p id="d509" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€ä¸ªåä¸º<code class="fe km kn ko kp b">demo-nats-public-service2</code>çš„<code class="fe km kn ko kp b">Service</code>ï¼Œå®ƒä½¿ç”¨<code class="fe km kn ko kp b">spec.type</code>å³<code class="fe km kn ko kp b">ExternalName</code>æ˜ å°„åˆ°DNSåç§°<code class="fe km kn ko kp b">demo.nats.io</code>ã€‚</p><p id="b409" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å…¶å·¥ä½œæ–¹å¼ç›¸åŒï¼Œå³æ‚¨éœ€è¦ä½¿ç”¨<code class="fe km kn ko kp b">Service</code>åç§°æ¥è®¿é—®å¤–éƒ¨å®ä½“ã€‚å”¯ä¸€çš„åŒºåˆ«(ä¸æ‰‹åŠ¨<code class="fe km kn ko kp b">Endpoints</code>æ–¹æ³•ç›¸æ¯”)æ˜¯æ‚¨è¿˜éœ€è¦çŸ¥é“ç«¯å£ã€‚è¦å°è¯•è¿™ç§æ–¹æ³•:</p><p id="85d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åˆ›å»º<code class="fe km kn ko kp b">Service</code></p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="7d62" class="nu mn iq kp b gy ok ol l om on">kubectl apply -f <a class="ae kl" href="https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/services/external/external-name/service.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/services/external/external-name/service.yaml</a></span></pre><p id="ee1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åªéœ€è¿è¡Œä¸€ä¸ª<code class="fe km kn ko kp b">curl</code> <code class="fe km kn ko kp b">Pod</code></p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="af9e" class="nu mn iq kp b gy ok ol l om on">kubectl run --rm --generator=run-pod/v1 curl --image=radial/busyboxplus:curl -i --tty</span></pre><p id="f240" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨çš„åªæ˜¯æˆ‘ä»¬çš„<code class="fe km kn ko kp b">Service</code>çš„åç§°ï¼Œå³<code class="fe km kn ko kp b">demo-nats-public-service2</code>(ä»¥åŠç«¯å£<code class="fe km kn ko kp b">8222</code>)</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="dcb1" class="nu mn iq kp b gy ok ol l om on">curl <a class="ae kl" href="http://demo-nats-public-service2:8222" rel="noopener ugc nofollow" target="_blank">http://demo-nats-public-service2:8222</a></span></pre><p id="a21f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä¸ä¸Šä¸€ä¸ªåœºæ™¯ç›¸åŒçš„å“åº”</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h1 id="25e7" class="mm mn iq bd mo mp np mr ms mt nq mv mw mx nr mz na nb ns nd ne nf nt nh ni nj bi translated"><code class="fe km kn ko kp b">Headless</code>æœåŠ¡</h1><p id="b3a3" class="pw-post-body-paragraph jn jo iq jp b jq nk js jt ju nl jw jx jy nm ka kb kc nn ke kf kg no ki kj kk ij bi translated">æ‚¨å¯ä»¥ä½¿ç”¨<code class="fe km kn ko kp b">LoadBalancer</code>ã€<code class="fe km kn ko kp b">NodePort</code>å’Œ<code class="fe km kn ko kp b">ClusterIP</code>æœåŠ¡ç±»å‹åœ¨ä¸€ç»„<code class="fe km kn ko kp b">Pod</code>ä¹‹é—´å®ç°è´Ÿè½½å¹³è¡¡ã€‚A <code class="fe km kn ko kp b">Headless</code> <code class="fe km kn ko kp b">Service</code>å…è®¸è®¿é—®å•ä¸ª<code class="fe km kn ko kp b">Pod</code>sâ€”â€”è¿™ç§æƒ…å†µä¸‹ä¸æ¶‰åŠä»£ç†ã€‚è¿™åœ¨è®¸å¤šæƒ…å†µä¸‹éƒ½å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚</p><ul class=""><li id="f2ee" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated">è€ƒè™‘ä¸€ä¸ªå¯¹ç­‰ç³»ç»Ÿï¼Œå…¶ä¸­å„ä¸ªå®ä¾‹(pod)éœ€è¦ç›¸äº’è®¿é—®ã€‚</li><li id="c951" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">ä¸€ç§ä¸»ä»å¼æœåŠ¡ï¼Œå…¶ä¸­ä»å®ä¾‹éœ€è¦çŸ¥é“ä¸»Pod</li></ul><p id="fdeb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºäº†åˆ›å»ºä¸€ä¸ª<code class="fe km kn ko kp b">Headless</code> <code class="fe km kn ko kp b">Service</code>ï¼Œæ‚¨éœ€è¦æ˜ç¡®æŒ‡å®š<code class="fe km kn ko kp b">None</code>ä½œä¸º<code class="fe km kn ko kp b">.spec.clusterIP</code>çš„å€¼ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­:</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="b373" class="nu mn iq kp b gy ok ol l om on">apiVersion: v1<br/>kind: Service<br/>metadata:<br/>  name: kin-hl-service<br/>spec:<br/>  clusterIP: None<br/>  ports:<br/>    - port: 9090<br/>      targetPort: 8080<br/>  selector:<br/>    app: kin-service-app</span></pre><p id="93d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸å…¶ä»–ç±»å‹ç›¸æ¯”ï¼Œæ‚¨ä½¿ç”¨æ— å¤´æœåŠ¡çš„æ–¹å¼æ˜¯ä¸åŒçš„ã€‚é’ˆå¯¹æœåŠ¡(ä¾‹å¦‚<code class="fe km kn ko kp b">&lt;service-name&gt;.&lt;namespace&gt;.svc.cliuster.local</code>)çš„DNSæŸ¥æ‰¾è¿”å›å¯¹åº”äºä¸åŒ<code class="fe km kn ko kp b">Pods</code>çš„å¤šä¸ªIP(ä¸å…¶ä»–æœåŠ¡ç±»å‹æƒ…å†µä¸‹çš„å•ä¸ªè™šæ‹ŸIPç›¸æ¯”)ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹å®é™…æƒ…å†µ</p><p id="883f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åˆ›å»º<code class="fe km kn ko kp b">Service</code></p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="fe25" class="nu mn iq kp b gy ok ol l om on">kubectl apply -f <a class="ae kl" href="https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/services/headless/service.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/abhirockzz/kubernetes-in-a-nutshell/master/services/headless/service.yaml</a></span></pre><p id="4994" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿è¡Œ<code class="fe km kn ko kp b">curl</code> <code class="fe km kn ko kp b">Pod</code></p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="a3e3" class="nu mn iq kp b gy ok ol l om on">kubectl run --rm --generator=run-pod/v1 curl --image=radial/busyboxplus:curl -i --tty</span></pre><p id="2343" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ£€æŸ¥è¡¬å«<code class="fe km kn ko kp b">Pod</code> IPs</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="10f7" class="nu mn iq kp b gy ok ol l om on">nslookup kin-hl-service.default.svc.cluster.local</span></pre><p id="b8c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚¨å°†å¾—åˆ°ç±»ä¼¼ä¸‹é¢çš„å“åº”</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="c127" class="nu mn iq kp b gy ok ol l om on">[ root@curl:/ ]$ nslookup kin-hl-service<br/>Server:    10.0.0.10<br/>Address 1: 10.0.0.10 kube-dns.kube-system.svc.cluster.local</span><span id="4333" class="nu mn iq kp b gy oo ol l om on">Name:      kin-hl-service<br/>Address 1: 10.244.0.153 10-244-0-153.kin-hl-service.default.svc.cluster.local<br/>Address 2: 10.244.1.141 10-244-1-141.kin-hl-service.default.svc.cluster.local</span></pre><p id="cb14" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe km kn ko kp b">10-244-0-153.kin-hl-service.default.svc.cluster.local</code>å’Œ<code class="fe km kn ko kp b">10.244.1.141 10-244-1-141.kin-hl-service.default.svc.cluster.local</code>å¯¹åº”äºä¸ªäºº<code class="fe km kn ko kp b">Pod</code>çš„åæ ‡â€”â€”è¿™åœ¨ä¼ ç»Ÿçš„<code class="fe km kn ko kp b">Service</code>ç±»å‹ä¸­æ˜¯ä¸å¯èƒ½çš„ã€‚æ‚¨ç°åœ¨å¯ä»¥ä½¿ç”¨å®ƒæ¥è®¿é—®ç‰¹å®šçš„<code class="fe km kn ko kp b">Pod</code>,ä¾‹å¦‚</p><pre class="lr ls lt lu gt og kp oh oi aw oj bi"><span id="c60b" class="nu mn iq kp b gy ok ol l om on">curl http://10-244-0-153.kin-hl-service.default.svc.cluster.local:8080</span><span id="1a5e" class="nu mn iq kp b gy oo ol l om on">//response<br/>Hello from Pod IP 10.244.0.153 on Node aks-agentpool-37379363-0</span><span id="dfc4" class="nu mn iq kp b gy oo ol l om on">curl http://10-244-1-141.kin-hl-service.default.svc.cluster.local:8080</span><span id="5782" class="nu mn iq kp b gy oo ol l om on">//response<br/>Hello from Pod IP 10.244.1.141 on Node aks-agentpool-37379363-1</span></pre></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h1 id="d175" class="mm mn iq bd mo mp np mr ms mt nq mv mw mx nr mz na nb ns nd ne nf nt nh ni nj bi translated">è¿›å…¥</h1><p id="f726" class="pw-post-body-paragraph jn jo iq jp b jq nk js jt ju nl jw jx jy nm ka kb kc nn ke kf kg no ki kj kk ij bi translated">æˆ‘ä»¬ç¡®å®è®¨è®ºäº†Kubernetes <code class="fe km kn ko kp b">Service</code>çš„åŸºç¡€çŸ¥è¯†ï¼Œä½†æ˜¯æˆ‘ç¡®å®æƒ³å¼ºè°ƒä¸€ä¸‹<code class="fe km kn ko kp b">Ingress</code>ï¼Œå®ƒå®Œå…¨å€¼å¾—ä¸€ä¸ªå•ç‹¬çš„å¸–å­ã€‚<code class="fe km kn ko kp b">Ingress</code>ä¸æ˜¯<code class="fe km kn ko kp b">Service</code>ç±»å‹(å¦‚<code class="fe km kn ko kp b">ClusterIP</code>ç­‰ã€‚)â€”â€”æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ª<code class="fe km kn ko kp b">Service</code>ä¹‹ä¸Šçš„æŠ½è±¡ã€‚å°±åƒ<code class="fe km kn ko kp b">Service</code>çš„å‰ç«¯ä¸€å †<code class="fe km kn ko kp b">Pod</code>ä¸€æ ·ï¼Œä¸€ä¸ª<code class="fe km kn ko kp b">Ingress</code>å¯ä»¥è¢«é…ç½®ä¸ºä¸å‡ ä¸ªåå°<code class="fe km kn ko kp b">Service</code>ä¸€èµ·å·¥ä½œï¼Œå¹¶æŒ‰ç…§ä½ å¯ä»¥å®šä¹‰çš„è§„åˆ™è½¬å‘è¯·æ±‚ã€‚</p><p id="62ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç”±<code class="fe km kn ko kp b">Ingress</code>æä¾›çš„æ™ºèƒ½å®é™…ä¸Šæ˜¯ä»¥<code class="fe km kn ko kp b">Ingress</code>æ§åˆ¶å™¨çš„å½¢å¼å®ç°çš„ã€‚ä¾‹å¦‚ï¼Œ<a class="ae kl" href="https://kubernetes.io/docs/tasks/access-application-cluster/ingress-minikube/" rel="noopener ugc nofollow" target="_blank"> Minikubeè‡ªå¸¦åŸºäºNGINXçš„å…¥å£æ§åˆ¶å™¨</a>ã€‚æ§åˆ¶å™¨è´Ÿè´£åœ¨è¯„ä¼°<code class="fe km kn ko kp b">Ingress</code>è§„åˆ™åï¼Œæä¾›å¯¹é€‚å½“æ”¯æŒ<code class="fe km kn ko kp b">Service</code>çš„è®¿é—®ã€‚</p><p id="c313" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™å°±æ˜¯â€œæœå£³ä¸­çš„åº“ä¼¯å†…ç‰¹â€ç³»åˆ—çš„è¿™ä¸€éƒ¨åˆ†ã€‚æ•¬è¯·å…³æ³¨æ›´å¤šå†…å®¹ï¼</p><blockquote class="ly lz ma"><p id="84d3" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated"><em class="iq">å‹æƒ…æç¤ºå¦‚æœæœ‰å…´è¶£å­¦ä¹ Kuberneteså’ŒContainersä½¿ç”¨</em> <a class="ae kl" href="https://azure.microsoft.com/services/kubernetes-service/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> Azure </em> </a> <em class="iq">ï¼åªéœ€</em> <a class="ae kl" href="https://azure.microsoft.com/en-us/free/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> <em class="iq">åˆ›å»ºä¸€ä¸ª</em> <strong class="jp ir"> <em class="iq">å…è´¹</em> </strong> <em class="iq">è´¦å·</em> </a> <em class="iq">å°±å¯ä»¥äº†ï¼ä¸€ä¸ªå¥½çš„èµ·ç‚¹æ˜¯ä½¿ç”¨æ–‡æ¡£ä¸­çš„</em> <a class="ae kl" href="https://docs.microsoft.com/azure/aks/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> <em class="iq">å¿«é€Ÿå…¥é—¨ã€æ•™ç¨‹å’Œä»£ç ç¤ºä¾‹</em> </a> <em class="iq">æ¥ç†Ÿæ‚‰è¯¥æœåŠ¡ã€‚æˆ‘ä¹Ÿå¼ºçƒˆæ¨èæŸ¥çœ‹ä¸€ä¸‹</em> <a class="ae kl" href="https://azure.microsoft.com/resources/kubernetes-learning-path/?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> 50å¤©Kuberneteså­¦ä¹ è·¯å¾„</em> </a> <em class="iq">ã€‚é«˜çº§ç”¨æˆ·å¯èƒ½å¸Œæœ›å‚è€ƒ</em> <a class="ae kl" href="https://docs.microsoft.com/azure/aks/best-practices?WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> Kubernetesæœ€ä½³å®è·µ</em> </a> <em class="iq">æˆ–è§‚çœ‹ä¸€äº›</em> <a class="ae kl" href="https://azure.microsoft.com/resources/videos/index/?services=kubernetes-service&amp;WT.mc_id=medium-blog-abhishgu" rel="noopener ugc nofollow" target="_blank"> <em class="iq">è§†é¢‘</em> </a> <em class="iq">ä»¥äº†è§£æ¼”ç¤ºã€ä¸»è¦åŠŸèƒ½å’ŒæŠ€æœ¯ä¼šè®®ã€‚</em></p></blockquote><p id="ebb7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘çœŸçš„å¸Œæœ›ä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œå¹¶ä»ä¸­å­¦åˆ°äº†ä¸€äº›ä¸œè¥¿ğŸ™Œå¦‚æœä½ åšäº†ï¼Œè¯·å–œæ¬¢å¹¶è·Ÿéšï¼</p></div></div>    
</body>
</html>