<html>
<head>
<title>How to Elastic SIEM (part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•å¼¹æ€§åŒ–SIEM(ç¬¬1éƒ¨åˆ†)</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/how-to-elastic-siem-part-1-a39167b8bd23?source=collection_archive---------0-----------------------#2020-08-20">https://itnext.io/how-to-elastic-siem-part-1-a39167b8bd23?source=collection_archive---------0-----------------------#2020-08-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/752446798823daca02178a622b2bb8c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8UJZFqg7Gsu7w0d4.png"/></div></div></figure><div class=""/><p id="ff22" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ITç¯å¢ƒå˜å¾—è¶Šæ¥è¶Šå¤§ï¼Œè¶Šæ¥è¶Šåˆ†æ•£ï¼Œè¶Šæ¥è¶Šéš¾ä»¥ç®¡ç†ã€‚å¿…é¡»ä¿æŠ¤å’Œç›‘æ§æ‰€æœ‰ç³»ç»Ÿç»„ä»¶å…å—ç½‘ç»œå¨èƒã€‚æ‚¨éœ€è¦ä¸€ä¸ªèƒ½å¤Ÿå­˜å‚¨å’Œåˆ†ææ—¥å¿—ã€æŒ‡æ ‡å’Œäº‹ä»¶çš„å¯æ‰©å±•å¹³å°ã€‚SIEMè§£å†³æ–¹æ¡ˆå¯èƒ½ä¼šè€—è´¹å¤§é‡èµ„é‡‘ã€‚åœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£å¼¹æ€§å †æ ˆä¸­çš„å…è´¹è§£å†³æ–¹æ¡ˆï¼Œå³å¼¹æ€§SIEMã€‚</p><h1 id="f29a" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">æˆ‘ä»¬å°†ä½¿ç”¨ä»€ä¹ˆï¼Ÿ</h1><p id="512d" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">Elastic Stackæ˜¯ä¸€ç»„ç»„ä»¶:Elasticsearchã€Kibanaã€Logstashå’ŒBeatsã€‚å…³äºæœ¬æ•…äº‹ä¸­æ‰€ç”¨å†…å®¹çš„ç®€è¦ä¿¡æ¯:</p><ul class=""><li id="f1c1" class="mc md je kd b ke kf ki kj km me kq mf ku mg ky mh mi mj mk bi translated">å¼¹æ€§æœç´¢â€”æ–‡æ¡£æ•°æ®åº“/æœç´¢å¼•æ“</li><li id="cf92" class="mc md je kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated">kibanaâ€”â€”ç”¨äºå¼¹æ€§æœç´¢çš„æ•°æ®å¯è§†åŒ–ä»ªè¡¨æ¿</li><li id="3522" class="mc md je kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated">Filebeat â€”è½»é‡çº§æ—¥å¿—æ”¶é›†å™¨(<a class="ae mq" href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-modules.html" rel="noopener ugc nofollow" target="_blank">å¯ç”¨æ¨¡å—</a>)</li><li id="7ccf" class="mc md je kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated">Packetbeat â€”è½»é‡çº§ç½‘ç»œåè®®æ”¶é›†å™¨(<a class="ae mq" href="https://www.elastic.co/guide/en/beats/packetbeat/current/configuration-protocols.html" rel="noopener ugc nofollow" target="_blank">åŠæ›´å¤š</a>)</li><li id="db20" class="mc md je kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated">audibeatâ€”â€”ä¸ä½¿ç”¨auditdçš„è½»é‡çº§å®‰å…¨äº‹ä»¶æ”¶é›†å™¨</li><li id="dd84" class="mc md je kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated">winlogbeatâ€”â€”ä¸€ä¸ªæ¥è‡ªWindowsç³»ç»Ÿçš„è½»é‡çº§äº‹ä»¶æ”¶é›†å™¨ã€‚</li></ul><h1 id="464b" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">ç¯å¢ƒ</h1><p id="dfdb" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">æˆ‘åœ¨Azure cloudä¸Šåˆ›å»ºäº†3ä¸ªè™šæ‹Ÿæœº:</p><ul class=""><li id="e8b1" class="mc md je kd b ke kf ki kj km me kq mf ku mg ky mh mi mj mk bi translated">ELKâ€”Ubuntu 20.04â€”elastic search+Kibana</li><li id="f433" class="mc md je kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated">Ubuntu 1â€”Ubuntu 20â€“04â€”æ–‡ä»¶èŠ‚æ‹ã€æ•°æ®åŒ…èŠ‚æ‹ã€å®¡è®¡èŠ‚æ‹</li><li id="f671" class="mc md je kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated">Win10 â€” Windows 10 â€” Auditbeatã€Packetbeatã€Winlogbeat</li></ul><h1 id="6b87" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">Elasticsearch + Kibanaå®‰è£…</h1><p id="455a" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">æˆ‘ä»¬å°†æ”¾ç½®ä¸€ä¸ªç®€å•çš„å•èŠ‚ç‚¹é›†ç¾¤ã€‚åœ¨è¿™é‡Œä½ å¯ä»¥ä¸‹è½½<a class="ae mq" href="https://www.elastic.co/downloads/elasticsearch" rel="noopener ugc nofollow" target="_blank"> Elasticsearch </a>å’Œ<a class="ae mq" href="https://www.elastic.co/downloads/kibana" rel="noopener ugc nofollow" target="_blank"> Kibana </a> debæ–‡ä»¶ã€‚</p><p id="0292" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å®‰è£…:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="f757" class="na la je mw b gy nb nc l nd ne">sudo<!-- --> <!-- -->dpkg -i file_name.deb</span></pre><p id="59af" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å¼¹æ€§æœç´¢é…ç½®ä½äº<code class="fe nf ng nh mw b">/etc/elasticsearch/elasticsearch.yml</code>ä¸­ã€‚å€¼å¾—æ”¹å˜çš„æ˜¯:</p><ul class=""><li id="ad3f" class="mc md je kd b ke kf ki kj km me kq mf ku mg ky mh mi mj mk bi translated"><code class="fe nf ng nh mw b">network.host: 0.0.0.0</code> #æˆ–æœºå™¨çš„IP/ä¸»æœºï¼Œä»¥ä¾¿ä»å¤–éƒ¨å¯ä»¥çœ‹åˆ°ES</li><li id="7f21" class="mc md je kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated"><code class="fe nf ng nh mw b">discovery.type: single-node</code></li></ul><p id="8c2f" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Kibanaé…ç½®ä½äº/etc/kiban/kiban/ymlä¸­ã€‚å€¼å¾—æ”¹å˜çš„æ˜¯:</p><ul class=""><li id="eea0" class="mc md je kd b ke kf ki kj km me kq mf ku mg ky mh mi mj mk bi translated"><code class="fe nf ng nh mw b">server.host: â€œ0.0.0.0â€</code></li></ul><p id="9299" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ç°åœ¨ä½ å¯ä»¥å¯åŠ¨æœåŠ¡äº†ã€‚</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="9fb6" class="na la je mw b gy nb nc l nd ne">sudo systemctl enable elasticsearch<br/>sudo systemctl enable kibana<br/>sudo systemctl start elasticsearch<br/>sudo systemctl start kibana</span></pre><p id="b286" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œä½ åº”è¯¥å¯ä»¥ä½¿ç”¨curlå¹¶ä»ESå¾—åˆ°ç­”æ¡ˆã€‚</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="ca37" class="na la je mw b gy nb nc l nd ne">root@ELK:/home/azureuser# curl localhost:9200<br/>{<br/>  "name" : "ELK",<br/>  "cluster_name" : "hey."<br/>  "cluster_uid" : "u6FDeHNsTmWJcnf-jYUH7Q",<br/>  "version" : {<br/>    "number" : "7.8.1",<br/>    "build_flavor" "default."<br/>    "build_type" : "deb."<br/>    "build_hash" : "b5ca9c58fb664ca8bf9e4057fc229b3396bf3a89",<br/>    "build_date" : "2020-07-21T16:40:44.668009Z",<br/>    "build_snapshot" : false,<br/>    "lucene_version" : "8.5.1."<br/>    "minimum_wire_compatibility_version" : "6.8.0",<br/>    "minimum_index_compatibility_version" : "6.0.0-beta1".<br/>  },<br/>  "tagline" : "You Know, for Search"<br/>}</span></pre><p id="9b3a" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å¦ä¸€æ–¹é¢ï¼Œä½¿ç”¨webæµè§ˆå™¨å¯ä»¥åœ¨ç«¯å£5601è®¿é—®Kibanaã€‚</p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ni"><img src="../Images/c6d44d23d800e2da95dfa8c91eb0f4f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qpfXhgKjzCfmVFzA.png"/></div></div></figure><h1 id="dc97" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">ä»Ubuntuæ·»åŠ æ—¥å¿—</h1><h2 id="5a5d" class="na la je bd lb nj nk dn lf nl nm dp lj km nn no ln kq np nq lr ku nr ns lv nt bi translated">Filebeat =&gt; syslog</h2><p id="cc30" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">Filebeat debæ–‡ä»¶å¯ä»¥ä»è¿™é‡Œä¸‹è½½ã€‚å®‰è£…:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="3ea0" class="na la je mw b gy nb nc l nd ne">dpkg -i package_name.deb</span></pre><p id="4575" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Filebeatconfigurationä½äº<code class="fe nf ng nh mw b">/etc/filebeat/filebeat.yml</code>ã€‚</p><ul class=""><li id="0c0e" class="mc md je kd b ke kf ki kj km me kq mf ku mg ky mh mi mj mk bi translated"><code class="fe nf ng nh mw b">filebeat.config.modules.reload.enabled: true </code> #æˆ‘ä»¬ä¸å¸Œæœ›æ¯æ¬¡æ›´æ¢æ¨¡å—æ—¶éƒ½é‡å¯æœåŠ¡</li><li id="9408" class="mc md je kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated"><code class="fe nf ng nh mw b">setup.kibana.host: â€œ10.0.0.4:5601â€</code> #æˆ‘ä»¬çš„åŸºå·´çº³</li><li id="bf4e" class="mc md je kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated">o <code class="fe nf ng nh mw b">utput.elasticsearch.hosts: [â€œ10.0.0.4:9200â€]</code> #æˆ‘ä»¬çš„å¼¹æ€§æœç´¢èŠ‚ç‚¹</li><li id="8f52" class="mc md je kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated"><code class="fe nf ng nh mw b">monitoring.enabled: true </code> #æˆ‘ä»¬æƒ³åœ¨Elasticsearch/Kibanaä¸­ç›‘æ§èŠ‚æ‹</li></ul><p id="0879" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ä¸€æ—¦æˆ‘ä»¬è¿™æ ·åšäº†ï¼Œä½ éœ€è¦é…ç½®Filebeatå’ŒElasticsearchã€‚Filebeatå°†æ·»åŠ ILMã€æ¨¡æ¿å’Œä»ªè¡¨ç›˜ã€‚</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="a069" class="na la je mw b gy nb nc l nd ne">filebeat setup</span></pre><p id="3cee" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å‡è®¾æˆ‘ä»¬æƒ³ä»è™šæ‹Ÿæœºæ”¶é›†ç³»ç»Ÿæ—¥å¿—ã€‚è¦æ˜¾ç¤ºå¯ç”¨æ¨¡å—å¹¶æ¿€æ´»ç³»ç»Ÿæ—¥å¿—ï¼Œæ‚¨å¿…é¡»:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="c1dd" class="na la je mw b gy nb nc l nd ne">filebeat modules list<br/>filebeat modules enable system</span></pre><p id="4140" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ç³»ç»Ÿæ¨¡å—é…ç½®è§<code class="fe nf ng nh mw b"><em class="nu">/etc/filebeat/modules.d/system.yml</em></code>ã€‚å¦‚æœæ‚¨æ²¡æœ‰æ›´æ”¹é»˜è®¤è·¯å¾„ï¼Œåªéœ€å°†<em class="nu">è®¾ç½®ä¸ºenabled: true </em>ã€‚</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="65d9" class="na la je mw b gy nb nc l nd ne"># Module: system<br/># Docs: <a class="ae mq" href="https://www.elastic.co/guide/en/beats/filebeat/7.8/filebeat-module-system.html" rel="noopener ugc nofollow" target="_blank">https://www.elastic.co/guide/en/beats/filebeat/7.8/filebeat-module-system.html</a><br/> <br/>- module: system<br/>  # Syslog<br/>  syslog:<br/>    enabled: true<br/> <br/>    # Set custom paths for the log files. If left empty,<br/>    # Filebeat will choose the paths depending on your OS.<br/>    #var.paths:<br/> <br/>  # Authorization logs<br/>  auth:<br/>    enabled: true<br/> <br/>    # Set custom paths for the log files. If left empty,<br/>    # Filebeat will choose the paths depending on your OS.<br/>    #var.paths:</span></pre><p id="ac61" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ç°åœ¨åªéœ€æ‰“å¼€FilebeatæœåŠ¡</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="8b24" class="na la je mw b gy nb nc l nd ne">sudo<!-- --> <!-- -->systemctl enable<!-- --> <!-- -->filebeat<br/>sudo<!-- --> <!-- -->systemctl start filebeat</span></pre><h2 id="f124" class="na la je bd lb nj nk dn lf nl nm dp lj km nn no ln kq np nq lr ku nr ns lv nt bi translated">å®¡è®¡èŠ‚æ‹</h2><p id="a36e" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">å°±åƒFilebeatä¸€æ ·ã€‚Debæ–‡ä»¶å¯ä»¥åœ¨<a class="ae mq" href="https://www.elastic.co/downloads/beats/auditbeat" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>ä¸‹è½½ã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯é…ç½®æ–‡ä»¶è·¯å¾„(<code class="fe nf ng nh mw b">/etc/autidbeat/auditbeat.yml</code>)ã€‚</p><p id="a605" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">è¿™ä¸ªèŠ‚æ‹æ²¡æœ‰æ¨¡å—ã€‚æ‚¨å°†åœ¨ä¸»é…ç½®ymlæ–‡ä»¶ä¸­æ‰¾åˆ°æ‰€æœ‰çš„å¯èƒ½æ€§ã€‚è®°å¾—ä½¿ç”¨â€œauditbeatè®¾ç½®â€å¹¶æ‰“å¼€è¯¥æœåŠ¡ã€‚</p><h2 id="f993" class="na la je bd lb nj nk dn lf nl nm dp lj km nn no ln kq np nq lr ku nr ns lv nt bi translated">åŒ…è£…æ¯</h2><p id="567d" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">å°±åƒFilebeatä¸€æ ·ã€‚Debæ–‡ä»¶å¯ä»¥åœ¨<a class="ae mq" href="https://www.elastic.co/downloads/beats/packetbeat" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>ä¸‹è½½ã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯é…ç½®æ–‡ä»¶è·¯å¾„(<code class="fe nf ng nh mw b">/etc/packetbeat/packetbeat.yml</code>)ã€‚</p><p id="5bf1" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">è¿™ä¸ªèŠ‚æ‹æ²¡æœ‰æ¨¡å—ã€‚æ‚¨å°†åœ¨ä¸»é…ç½®ymlæ–‡ä»¶ä¸­æ‰¾åˆ°æ‰€æœ‰çš„å¯èƒ½æ€§ã€‚è®°å¾—ä½¿ç”¨â€œpacketbeat setupâ€å¹¶å¯ç”¨è¯¥æœåŠ¡ã€‚</p><h1 id="2201" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">æ·»åŠ Windows 10æ—¥å¿—</h1><h2 id="5d8c" class="na la je bd lb nj nk dn lf nl nm dp lj km nn no ln kq np nq lr ku nr ns lv nt bi translated">Winlogbeat</h2><p id="00a2" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">ä½ ä¼šåœ¨è¿™é‡Œæ‰¾åˆ°å®‰è£…æ–‡ä»¶<a class="ae mq" href="https://www.elastic.co/downloads/beats/winlogbeat" rel="noopener ugc nofollow" target="_blank"/>ã€‚æˆ‘ç”¨çš„æ˜¯MSI 64xã€‚</p><p id="866e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">é…ç½®æ–‡ä»¶å¯ä»¥åœ¨<code class="fe nf ng nh mw b"><em class="nu">C:\ProgramData\Elastic\Beats\winlogbeat</em></code> <em class="nu">ä¸­æ‰¾åˆ°ã€‚</em>å’Œä¹‹å‰çš„Beatsä¸€æ ·ï¼Œä½ å¿…é¡»æ”¹å˜Kibanaå’ŒElasticsearchçš„åœ°å€ã€‚</p><p id="d939" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Beatsé…ç½®æ˜¯Powershellä¸­çš„ä»¥ä¸‹å‘½ä»¤:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="8782" class="na la je mw b gy nb nc l nd ne">winlogbeat.cmd setup</span></pre><p id="510b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">æˆ‘ä»¬åƒè¿™æ ·æ‰“å¼€WinlogBeat:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="e81f" class="na la je mw b gy nb nc l nd ne">Start-Service winlogbeat</span></pre><h1 id="61f6" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">åŸºå·´çº³çš„SIEMæ¨¡å—</h1><p id="286b" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">å¦‚æœç´¢å¼•(filebeat-*ã€packetbeat-*ã€auditbeat-*)åŒ…å«ç¬¦åˆECSçš„æ•°æ®ï¼Œåˆ™SIEMæ¨¡å—å¯ç”¨ã€‚ECSå®šä¹‰äº†åœ¨Elasticsearchä¸­å­˜å‚¨äº‹ä»¶æ•°æ®æ—¶ä½¿ç”¨çš„ä¸€ç»„é€šç”¨å­—æ®µï¼Œå¦‚æ—¥å¿—å’ŒæŒ‡æ ‡ã€‚Elasticsearchæˆ–ä»»ä½•NoSQLæ•°æ®åº“æ²¡æœ‰æ¨¡å¼æ˜¯ä¸æ­£ç¡®çš„ã€‚ğŸ˜‰</p><p id="9fcf" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å¦‚æœæ‚¨éœ€è¦æ¥è‡ªæŸä¸ªåº”ç”¨ç¨‹åº/ç³»ç»Ÿçš„æ—¥å¿—ï¼Œè€Œè¯¥åº”ç”¨ç¨‹åº/ç³»ç»Ÿåœ¨æŸä¸ªbeatsä¸­ä¸èƒ½ä½œä¸ºæ¨¡å—ä½¿ç”¨ï¼Œé‚£ä¹ˆæ‚¨éœ€è¦æä¾›è¿™äº›æ—¥å¿—ï¼Œå¹¶å°†å®ƒä»¬å¤„ç†æˆç¬¦åˆECSçš„æ˜ å°„ã€‚æ‚¨å¯ä»¥ä½¿ç”¨Filebeatå’ŒLogstashæ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p><p id="9992" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">æ‚¨å¯ä»¥åœ¨å·¦ä¾§çš„å®‰å…¨é€‰é¡¹å¡ä¸­æ‰¾åˆ°SIEMæ¨¡å—ã€‚</p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/93b096883f2ef74705bbc98105efc25d.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/0*DSdIRhX21wERr1qF.png"/></div></figure><p id="0b4e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">åœ¨overviewé€‰é¡¹å¡ä¸­ï¼Œæ‚¨å·²ç»å¯ä»¥çœ‹åˆ°ä»è™šæ‹Ÿæœºæ”¶é›†çš„æ—¥å¿—çš„æ•ˆæœã€‚</p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nw"><img src="../Images/135d5d789e4fa38290144aa81e76657e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Q1itLfjWqa0bEPqf.png"/></div></div></figure><p id="b429" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ç½‘ç»œé€‰é¡¹å¡åŒ…å«æºIPså’Œç›®æ ‡IPsæ•°æ®ä»¥åŠå¸¦æœ‰åœ°å€åœ°ç†ä½ç½®çš„åœ°å›¾ã€‚</p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nx"><img src="../Images/0ed3b613dda6dfb3c92e6c43347cfd46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TbxkXogsxp9WQexE.png"/></div></div></figure><p id="21ec" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å®‰è£…beatsèŠ±äº†ä¸€æ®µæ—¶é—´ï¼Œåœ¨Kibanaå‘¨å›´çœ‹äº†çœ‹ã€‚ä½ çŸ¥é“å—ï¼Ÿ<strong class="kd jf">å·²ç»æœ‰20æ¬¡ä½¿ç”¨SSHé€šè¿‡æœºå™¨ç™»å½•çš„å°è¯•</strong>ã€‚</p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nx"><img src="../Images/1dc77ef0474d7c6779e0233709cee896.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Z5g1v6iEsfVkaJjk.png"/></div></div></figure><p id="cd36" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å°è¯•æ¬¡æ•°ã€ç”¨æˆ·å’ŒIPåœ°å€ã€‚</p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ny"><img src="../Images/a130ef3d237dc01af9182357ea697332.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QSmDK74kyklqrTxO.png"/></div></div></figure><h1 id="3818" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">æ—¶é—´è¡¨</h1><p id="9b06" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">æˆ‘ä»¬æ¥è°ƒæŸ¥ä¸€ä¸‹ï¼</p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nz"><img src="../Images/6d6d1bc092f1cf9819d390d905f280cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:398/format:webp/0*Uoy3Aso-rZaeU76J.png"/></div></div></figure><p id="4ff1" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">æ—¶é—´çº¿æ˜¯ä¸€ä¸ªè¿½è¸ªå’Œè°ƒæŸ¥å¨èƒçš„å·¥ä½œç©ºé—´ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ æ–°çš„è¿‡æ»¤å™¨ï¼Œå¹¶è·å¾—æ›´è¯¦ç»†çš„è§†å›¾ã€‚ä¸‹é¢æ‚¨å¯ä»¥çœ‹åˆ°ç»™å®šIPçš„ç½‘ç»œæµç›¸å…³è®°å½•(æ•°æ®åŒ…èŠ‚æ‹)å’Œæ—¥å¿—è®°å½•é”™è¯¯(å®¡è®¡èŠ‚æ‹)ã€‚å¦‚æ‚¨æ‰€è§ï¼Œæ”»å‡»è€…ä½¿ç”¨äº†è®¸å¤šç«¯å£ã€‚</p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oa"><img src="../Images/7e004c07843d757d71c840679f1c7d7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XuhrD3L-LnHKNN8D.png"/></div></div></figure><p id="fe47" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">æˆ‘ä»¬å¯ä»¥ä¿å­˜æ—¶é—´è¡¨ï¼Œå¹¶å°†è§‚å¯Ÿç»“æœä½œä¸ºæ³¨é‡Šæ·»åŠ åˆ°æ¡ˆä¾‹ä¸­ã€‚</p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ob"><img src="../Images/8592674c3beb6298a0901ff00c2910bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fv_yRaLyj_-eRQEn.png"/></div></div></figure><h2 id="1b8d" class="na la je bd lb nj nk dn lf nl nm dp lj km nn no ln kq np nq lr ku nr ns lv nt bi translated">è¿‡æ»¤</h2><p id="1e30" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">ä½ ä¸åº”è¯¥ç›²ç›®ç›¸ä¿¡ä»ªè¡¨ç›˜ã€‚ä¸¤å°æœºå™¨113æ¬¡ç™»å½•ï¼Ÿè‚¯å®šæœ‰äººæ¥ç®¡äº†æœºå™¨ğŸ™ˆã€‚</p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/627c1bcaeeeb8dff5a33e3c45aaee7be.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/0*WhCTnm-4-DWG7MSe.png"/></div></figure><p id="df22" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ç³»ç»Ÿç”¨æˆ·(ä¸ä»…ä»…æ˜¯)æ··æ·†äº†è¿™ç§æƒ…å†µã€‚è®©æˆ‘ä»¬ç”¨è¿‡æ»¤å™¨æŠŠä»–æ’é™¤åœ¨æœç´¢ä¹‹å¤–ã€‚</p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi od"><img src="../Images/9b4105691f9ce86732b8f88c21b56ca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Nm7dqLHx9ZsIeB01.png"/></div></div></figure><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oe"><img src="../Images/b5c486fbb990814ca93f75d84d4199df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Mtln2orACsNVacrp.png"/></div></div></figure><h1 id="44f1" class="kz la je bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">åœ¨ä¸‹ä¸€é›†é‡Œ</h1><p id="6f02" class="pw-post-body-paragraph kb kc je kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">åœ¨è¿™ä¸ªæ•…äº‹ä¸­ï¼ŒSIEMæ¨¡å—å‡ ä¹æ²¡æœ‰è¢«æåŠã€‚åœ¨æœ¬ç³»åˆ—çš„ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæ‚¨å°†äº†è§£å¦‚ä½•ä¿æŠ¤æ‚¨çš„é›†ç¾¤å¹¶è§£é”æ£€æµ‹é€‰é¡¹å¡ã€‚</p><p id="6afe" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ç¼–è¾‘:<a class="ae mq" href="https://medium.com/@zorteran/how-to-elastic-siem-part-2-bf0940f745e5" rel="noopener">è¿™é‡Œæ˜¯</a></p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi od"><img src="../Images/5e2a42ec364e6af5fa122bdb276d887d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*k3uSKx91pQNdlFI2.png"/></div></div></figure></div></div>    
</body>
</html>