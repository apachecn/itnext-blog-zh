# äº†è§£ Dart ä¸­çš„åå°„å’Œæ³¨é‡Š

> åŸæ–‡ï¼š<https://itnext.io/understanding-reflection-and-annotations-in-dart-f1e28efdb064?source=collection_archive---------1----------------------->

## ç¼–å†™å¤æ‚è½¯ä»¶çš„æ›´ç®€æ´çš„æ–¹æ³•

![](img/c3e8a46435a1989da76fc2dc56a5ce34.png)

åœ¨è¿™ä¸ªè§†é¢‘ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨åå°„çš„ä¸»é¢˜ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒæ¥ç¼–å†™æ›´å¹²å‡€çš„è½¯ä»¶ã€‚åå°„å…è®¸æˆ‘ä»¬åœ¨è¿è¡Œæ—¶æ£€æŸ¥å’Œä¿®æ”¹ç¨‹åºçš„ç»“æ„å’Œè¡Œä¸ºã€‚æˆ‘ä»¬å°†ä½¿ç”¨ **dart:mirrors** åº“ï¼Œå®ƒåŒ…å«äº†å®ç°è¿™ä¸€ç‚¹çš„å¸®åŠ©ç±»å’Œå‡½æ•°ã€‚æœ€åï¼Œæˆ‘ä»¬å°†çœ‹ä¸€ä¸ªå¸¦æœ‰**æ³¨é‡Š**çš„å¸¸è§ç”¨ä¾‹ã€‚

# å¸¦åå°„çš„åŸºæœ¬ç¤ºä¾‹

åˆ›å»ºä¸€ä¸ª`main.dart`æ–‡ä»¶ï¼Œå¹¶ä»å¯¼å…¥æˆ‘ä»¬çš„ **dart:mirrors** ä¾èµ–é¡¹å¼€å§‹ã€‚åœ¨æˆ‘ä»¬å®ç°æˆ‘ä»¬çš„åå°„é€»è¾‘ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ä¹Ÿç”¨æˆ‘ä»¬å¸Œæœ›è°ƒç”¨çš„æ–¹æ³•å®šä¹‰ä¸€ä¸ªç±»:

```
**import 'dart:mirrors';****main**() { 
  **// TODO: Implement Reflection logic** 
} // Our example class to reflect on 
class **Endpoint** { 
  handle() => print('Request received'); 
}
```

ä¸ºäº†åæ˜ ç±»å‹å’Œå¯¹è±¡ï¼Œæˆ‘ä»¬æœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥ä½¿ç”¨:

1.  `**reflect()**`:åæ˜ ä¸€ä¸ªç±»çš„å®ä¾‹
2.  `**reflectClass()**`:åæ˜ åœ¨ä¸€ä¸ªç±»å£°æ˜ä¸Š
3.  `**reflectType()**`åæ˜ ä½œä¸ºå‚æ•°ä¼ å…¥çš„ç±»å‹

åœ¨æˆ‘ä»¬çš„ç”¨ä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ã€‚è®©æˆ‘ä»¬å®ä¾‹åŒ–`Endpoint`å¹¶é€šè¿‡åå°„è°ƒç”¨å¥æŸ„æ–¹æ³•:

```
main() { 
  var reflectedClass = **reflect**(Endpoint());   // Invoke the handle() method    
  reflectedClass.**invoke**(Symbol('**handle**'), []); 
}
```

ç„¶åè®©æˆ‘ä»¬è¿è¡Œè¿™ä¸ªæ–‡ä»¶:

```
**$** dart /path/to/main.dart
```

åå°„å®ä¾‹ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå…¬å¼€`invoke()`æ–¹æ³•çš„`InstanceMirror`ã€‚æˆ‘ä»¬å®ä¾‹çš„æˆå‘˜è¢«æè¿°ä¸º`Symbol`ç±»å‹ã€‚ä¸Šé¢çš„ä¾‹å­é€šè¿‡ä¼ é€’å®ƒçš„`Symbol` ic åå’Œä¸€ä¸ªä½ç½®å‚æ•°æ•°ç»„(å¦‚æœæŒ‡å®šäº†çš„è¯)æ¥è°ƒç”¨ handle æ–¹æ³•ã€‚

ä¸ºäº†ä¼ é€’å‚æ•°ï¼Œè®©æˆ‘ä»¬ä¿®æ”¹`handle()`æ–¹æ³•çš„ç­¾å:

```
handle(**String a**) => print('Request received **$a**');
```

å¹¶å°†å®ƒä¼ é€’ç»™è°ƒç”¨:

```
reflectedClass.**invoke**(Symbol('handle'), [**'argument 1'**]); 
// => Request received argument 1
```

æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨æ–‡å­—å½¢å¼çš„`handle()`ç¬¦å·:

```
reflectedClass.invoke(**#handle**, ['argument 1']);
```

å¦‚æœæ–¹æ³•åä½œä¸ºä¸€ä¸ªæ“ä½œçš„å€¼è¢«æ¥æ”¶æˆ–è€…ä½œä¸ºç”¨æˆ·è¾“å…¥è¢«æä¾›ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥ä½¿ç”¨`Symbol('methodName')`æ–¹æ³•ã€‚*ç†æƒ³åœ°å½“ä½ * ***ä¸*** *é¢„å…ˆçŸ¥é“è¯¥è°ƒç”¨çš„æ–¹æ³•ã€‚*

æŸ¥çœ‹ä¸Šé¢è§†é¢‘ä¸­çš„å®Œæ•´æ•™ç¨‹ã€‚

â†’ [**è·å–æºä»£ç **](https://gist.github.com/graphicbeacon/9fb6c6a951168d6a31d9b2cc442bcbe2)

# è¿›ä¸€æ­¥é˜…è¯»

*   [**é•–:é•œåƒ**åº“æ–‡æ¡£](https://api.dart.dev/stable/2.4.0/dart-mirrors/dart-mirrors-library.html)
*   [Dart å’Œ MongoDB æ•™ç¨‹#1:ä½¿ç”¨ mongo_dart åŒ…](https://creativebracket.com/dart-and-mongodb-tutorial-1)

# æœ€åä¸€ä»¶äº‹â€¦

éå¸¸æ„Ÿè°¢æˆ‘æ”¶åˆ°çš„è¶Šæ¥è¶Šå¤šçš„å…´è¶£ã€æ”¯æŒå’Œåé¦ˆï¼

æœ‰é‰´äºæ­¤ï¼Œæˆ‘ä»Šå¤©æ¨å‡ºäº† [**å®˜æ–¹å•†åŸ**](https://bit.ly/creativebracketmerch) ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æœºä¼šæˆä¸ºè¿åŠ¨çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¿æŒç«ç„°ğŸ”¥çœŸå®çš„è¿™å°†æ¨åŠ¨é«˜è´¨é‡å†…å®¹çš„ç”Ÿäº§ï¼Œæ¶µç›–çš„ä¸»é¢˜å°†è¶…è¶Šâ€œhello worldâ€åº”ç”¨ã€‚

æˆ‘è¿˜åœ¨ YouTube é¢‘é“ä¸Šç‚¹å‡»äº† 800 å¤šä¸ªè®¢æˆ·ã€‚ [**ç‚¹å‡»è®¢é˜…å¹¶å“é“ƒé€šçŸ¥**](https://youtube.com/CreativeBracket) å¦‚æœä½ è¿˜æ²¡æœ‰ã€‚æˆ‘è®¡åˆ’å¾ˆå¿«åšä¸€ä¸ªå…³äºä»£ç ç”Ÿæˆçš„ç³»åˆ—æ–‡ç« ã€‚

**å–œæ¬¢ã€åˆ†äº«å¹¶å…³æ³¨**æˆ‘ï¼Œäº†è§£ Dart çš„æ›´å¤šå†…å®¹ã€‚*è°¢è°¢ã€‚*

*åŸè½½äº*[*creativebracket.com*](https://creativebracket.com/understanding-reflection-and-annotations-in-dart/)*ã€‚*