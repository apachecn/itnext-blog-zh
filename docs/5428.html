<html>
<head>
<title>Firebase Storage â€” Uploading and Downloading files &amp; Multi File Picker in Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Firebaseå­˜å‚¨â€”åœ¨Flutterä¸­ä¸Šä¼ å’Œä¸‹è½½æ–‡ä»¶å’Œå¤šæ–‡ä»¶é€‰æ‹©å™¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/firebase-storage-uploading-and-downloading-files-multi-file-picker-in-flutter-7360a90c68a7?source=collection_archive---------0-----------------------#2021-03-03">https://itnext.io/firebase-storage-uploading-and-downloading-files-multi-file-picker-in-flutter-7360a90c68a7?source=collection_archive---------0-----------------------#2021-03-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="aba0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™ä¸ªæ¼”ç¤ºå±•ç¤ºäº†å¦‚ä½•ä¸Šä¼ æ–‡ä»¶åˆ°firebaseå­˜å‚¨ã€‚åœ¨æœ¬æ¬¡æ¼”ç¤ºä¸­ï¼Œæˆ‘ä»¬å°†åªä¸Šä¼ å›¾åƒåˆ°firebaseå­˜å‚¨ã€‚</p><p id="15de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">è®©æˆ‘ä»¬å¼€å§‹â€¦â€¦</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/bbf69a795a45ae69ef3808df75546011.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UMNE7pHaQm8Til8j79EIZQ.png"/></div></div></figure><h1 id="fb1e" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">è§‚çœ‹è§†é¢‘æ•™ç¨‹</strong></h1><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lv lw l"/></div></figure><h1 id="303a" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">æ·»åŠ ä¾èµ–å…³ç³»</strong></h1><p id="9b20" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬éœ€è¦ä¸‰ä¸ªæ’ä»¶</p><p id="c53f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> #1å¤šæ–‡ä»¶æ‹¾å–å™¨</strong></p><p id="7dfb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™ä¸ªæ’ä»¶å¸®åŠ©æˆ‘ä»¬ä»æ–‡ä»¶æµè§ˆå™¨æˆ–å›¾åº“ä¸­é€‰æ‹©å¤šä¸ªå›¾åƒã€‚</p><p id="f62b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mc">æ–‡ä»¶æŒ‘é€‰è€…:^2.1.6 </em></p><p id="fb55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> #2 HttpåŒ…</strong></p><p id="b880" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mc"> http: ^0.12.2 </em></p><p id="8b0f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> #3ç‡ƒæ–™åº“</strong></p><p id="9999" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mc">ç‡ƒæ–™åº“_å‚¨å­˜åœ°:^7.0.0 </em></p><h1 id="856a" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">æ·»åŠ ä¸‹æ‹‰èœå•</strong></h1><p id="e5eb" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">è®©æˆ‘ä»¬åœ¨UIä¸­æ·»åŠ ä¸€ä¸ªä¸‹æ‹‰èœå•æ¥é€‰æ‹©å¤šä¸ªæ–‡ä»¶ç±»å‹ã€‚</p><p id="166c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ­£åœ¨æ·»åŠ éŸ³é¢‘ï¼Œè§†é¢‘ï¼Œå›¾åƒå’Œå…¶ä»–ã€‚</p><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="e951" class="mi ky iq me b gy mj mk l ml mm">dropDown() {<br/>    return DropdownButton(<br/>      hint: new Text('Select'),<br/>      value: _pickType,<br/>      items: &lt;DropdownMenuItem&gt;[<br/>        new DropdownMenuItem(<br/>          child: new Text('Audio'),<br/>          value: FileType.AUDIO,<br/>        ),<br/>        new DropdownMenuItem(<br/>          child: new Text('Image'),<br/>          value: FileType.IMAGE,<br/>        ),<br/>        new DropdownMenuItem(<br/>          child: new Text('Video'),<br/>          value: FileType.VIDEO,<br/>        ),<br/>        new DropdownMenuItem(<br/>          child: new Text('Any'),<br/>          value: FileType.ANY,<br/>        ),<br/>      ],<br/>      onChanged: (value) =&gt; setState(() {<br/>            _pickType = value;<br/>          }),<br/>    );<br/>}</span></pre><h1 id="889d" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">æ‰“å¼€æ–‡ä»¶æµè§ˆå™¨</strong></h1><p id="55ae" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">è®©æˆ‘ä»¬æ‰“å¼€è®¾å¤‡çš„æ–‡ä»¶æµè§ˆå™¨å¹¶è·å–æ–‡ä»¶ã€‚</p><p id="5923" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mc">ç¡®ä¿åœ¨iOSä¸­æ·»åŠ å›¾åº“æƒé™ï¼Œåœ¨Androidä¸­æ·»åŠ å­˜å‚¨è®¿é—®æƒé™ã€‚</em></p><p id="5995" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">å®‰å“</strong>:</p><p id="841f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å°†ä¸‹é¢çš„ä»£ç æ”¾åœ¨Androidé¡¹ç›®ä¸­åº”ç”¨ç¨‹åºæ ‡è®°ä¹‹å¤–çš„AndroidManifest.xmlä¸­ã€‚</p><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="b55f" class="mi ky iq me b gy mj mk l ml mm">&lt;uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" /&gt;</span></pre><p id="2a0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">iOS :</p><p id="0c10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‰“å¼€iOSé¡¹ç›®info.plistæ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹æ¡ç›®ã€‚</p><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="f216" class="mi ky iq me b gy mj mk l ml mm">Limited Photos</span><span id="659c" class="mi ky iq me b gy mn mk l ml mm">&lt;key&gt;PHPhotoLibraryPreventAutomaticLimitedAccessAlert&lt;/key&gt;<br/>&lt;true/&gt;<br/>Camera</span><span id="2392" class="mi ky iq me b gy mn mk l ml mm">&lt;key&gt;NSCameraUsageDescription&lt;/key&gt;<br/>&lt;string&gt;$(PRODUCT_NAME) camera description.&lt;/string&gt;<br/>Photos</span><span id="ee28" class="mi ky iq me b gy mn mk l ml mm">&lt;key&gt;NSPhotoLibraryUsageDescription&lt;/key&gt;<br/>&lt;string&gt;$(PRODUCT_NAME)photos description.&lt;/string&gt;</span></pre><p id="3333" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸‹é¢çš„ä»£ç å°†æ‰“å¼€æ–‡ä»¶èµ„æºç®¡ç†å™¨ã€‚</p><p id="91b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬è¿˜å°†æ£€æŸ¥ç£ç›˜æ˜¯å¦å·²æŒ‚è½½ã€‚</p><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="c36b" class="mi ky iq me b gy mj mk l ml mm">// Necessary variables <br/> <br/>String _path;<br/>Map&lt;String, String&gt; _paths;<br/>String _extension;<br/>FileType _pickType;<br/>bool _multiPick = false;<br/>GlobalKey&lt;ScaffoldState&gt; _scaffoldKey = GlobalKey();<br/>List&lt;StorageUploadTask&gt; _tasks = &lt;StorageUploadTask&gt;[];<br/> <br/>void openFileExplorer() async {<br/>    try {<br/>      _path = null;<br/>      if (_multiPick) {<br/>        _paths = await FilePicker.getMultiFilePath(<br/>            type: _pickType, fileExtension: _extension);<br/>      } else {<br/>        _path = await FilePicker.getFilePath(<br/>            type: _pickType, fileExtension: _extension);<br/>      }<br/>    } on PlatformException catch (e) {<br/>      print("Unsupported operation" + e.toString());<br/>    }<br/>    if (!mounted) return;<br/>}</span></pre><h1 id="5682" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">ä¸Šä¼ æ–‡ä»¶åˆ°Firebase </strong></h1><p id="291d" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">è¿™é‡Œæˆ‘ä»¬æœ‰uploadToFirebaseæ–¹æ³•ï¼Œå®ƒéå†æ–‡ä»¶æ•°ç»„å¹¶å°†æ¯ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°Firebaseæ§åˆ¶å°ã€‚</p><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="f4c9" class="mi ky iq me b gy mj mk l ml mm">uploadToFirebase() {<br/>    if (_multiPick) {<br/>        _paths.forEach((fileName, filePath) =&gt; {upload(fileName, filePath)});<br/>    } else {<br/>        String fileName = _path.split('/').last;<br/>        String filePath = _path;<br/>        upload(fileName, filePath);<br/>    }<br/>}<br/> <br/>upload(fileName, filePath) {<br/>    _extension = fileName.toString().split('.').last;<br/>    StorageReference storageRef =<br/>        FirebaseStorage.instance.ref().child(fileName);<br/>    final StorageUploadTask uploadTask = storageRef.putFile(<br/>        File(filePath),<br/>        StorageMetadata(<br/>        contentType: '$_pickType/$_extension',<br/>        ),<br/>    );<br/>    setState(() {<br/>        _tasks.add(uploadTask);<br/>    });<br/>}</span></pre><h1 id="db7e" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">ä»Firebaseä¸‹è½½æ–‡ä»¶</strong></h1><p id="c6cb" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">ä¸‹é¢çš„ä»£ç å°†å€ŸåŠ©'<em class="mc"> StorageReference </em>'ä»firebaseå­˜å‚¨å™¨ä¸‹è½½æ–‡ä»¶ã€‚æˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œå¹¶å°†ä¸‹è½½çš„å­—èŠ‚å†™å…¥è¯¥æ–‡ä»¶ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†åœ¨SnackBarä¸­æ˜¾ç¤ºå›¾åƒã€‚</p><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="a66f" class="mi ky iq me b gy mj mk l ml mm">Future&lt;void&gt; downloadFile(StorageReference ref) async {<br/>    final String url = await ref.getDownloadURL();<br/>    final http.Response downloadData = await http.get(url);<br/>    final Directory systemTempDir = Directory.systemTemp;<br/>    final File tempFile = File('${systemTempDir.path}/tmp.jpg');<br/>    if (tempFile.existsSync()) {<br/>      await tempFile.delete();<br/>    }<br/>    await tempFile.create();<br/>    final StorageFileDownloadTask task = ref.writeToFile(tempFile);<br/>    final int byteCount = (await task.future).totalByteCount;<br/>    var bodyBytes = downloadData.bodyBytes;<br/>    final String name = await ref.getName();<br/>    final String path = await ref.getPath();<br/>    print(<br/>      'Success!\nDownloaded $name \nUrl: $url'<br/>      '\npath: $path \nBytes Count :: $byteCount',<br/>    );<br/>    _scaffoldKey.currentState.showSnackBar(<br/>      SnackBar(<br/>        backgroundColor: Colors.white,<br/>        content: Image.memory(<br/>          bodyBytes,<br/>          fit: BoxFit.fill,<br/>        ),<br/>      ),<br/>    );<br/>}</span></pre><p id="ee1e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å°±æ˜¯è¿™æ ·ã€‚</p><p id="1322" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="mc">è¿™é‡Œæ˜¯å®Œæ•´çš„ä»£ç ã€‚</em> </strong></p><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="fe5d" class="mi ky iq me b gy mj mk l ml mm">import 'package:flutter/material.dart';<br/>import 'dart:io';<br/>import 'package:firebase_storage/firebase_storage.dart';<br/>import 'package:file_picker/file_picker.dart';<br/> <br/>import 'package:flutter/services.dart';<br/>import 'package:http/http.dart' as http;<br/> <br/>class UploadMultipleImageDemo extends StatefulWidget {<br/>  UploadMultipleImageDemo() : super();<br/> <br/>  final String title = 'Firebase Storage';<br/> <br/>  <a class="ae mo" href="http://twitter.com/override" rel="noopener ugc nofollow" target="_blank">@override</a><br/>  UploadMultipleImageDemoState createState() =&gt; UploadMultipleImageDemoState();<br/>}<br/> <br/>class UploadMultipleImageDemoState extends State&lt;UploadMultipleImageDemo&gt; {<br/>  //<br/>  String _path;<br/>  Map&lt;String, String&gt; _paths;<br/>  String _extension;<br/>  FileType _pickType;<br/>  bool _multiPick = false;<br/>  GlobalKey&lt;ScaffoldState&gt; _scaffoldKey = GlobalKey();<br/>  List&lt;StorageUploadTask&gt; _tasks = &lt;StorageUploadTask&gt;[];<br/> <br/>  void openFileExplorer() async {<br/>    try {<br/>      _path = null;<br/>      if (_multiPick) {<br/>        _paths = await FilePicker.getMultiFilePath(<br/>            type: _pickType, fileExtension: _extension);<br/>      } else {<br/>        _path = await FilePicker.getFilePath(<br/>            type: _pickType, fileExtension: _extension);<br/>      }<br/>      uploadToFirebase();<br/>    } on PlatformException catch (e) {<br/>      print("Unsupported operation" + e.toString());<br/>    }<br/>    if (!mounted) return;<br/>  }<br/> <br/>  uploadToFirebase() {<br/>    if (_multiPick) {<br/>      _paths.forEach((fileName, filePath) =&gt; {upload(fileName, filePath)});<br/>    } else {<br/>      String fileName = _path.split('/').last;<br/>      String filePath = _path;<br/>      upload(fileName, filePath);<br/>    }<br/>  }<br/> <br/>  upload(fileName, filePath) {<br/>    _extension = fileName.toString().split('.').last;<br/>    StorageReference storageRef =<br/>        FirebaseStorage.instance.ref().child(fileName);<br/>    final StorageUploadTask uploadTask = storageRef.putFile(<br/>      File(filePath),<br/>      StorageMetadata(<br/>        contentType: '$_pickType/$_extension',<br/>      ),<br/>    );<br/>    setState(() {<br/>      _tasks.add(uploadTask);<br/>    });<br/>  }<br/> <br/>  dropDown() {<br/>    return DropdownButton(<br/>      hint: new Text('Select'),<br/>      value: _pickType,<br/>      items: &lt;DropdownMenuItem&gt;[<br/>        new DropdownMenuItem(<br/>          child: new Text('Audio'),<br/>          value: FileType.AUDIO,<br/>        ),<br/>        new DropdownMenuItem(<br/>          child: new Text('Image'),<br/>          value: FileType.IMAGE,<br/>        ),<br/>        new DropdownMenuItem(<br/>          child: new Text('Video'),<br/>          value: FileType.VIDEO,<br/>        ),<br/>        new DropdownMenuItem(<br/>          child: new Text('Any'),<br/>          value: FileType.ANY,<br/>        ),<br/>      ],<br/>      onChanged: (value) =&gt; setState(() {<br/>            _pickType = value;<br/>          }),<br/>    );<br/>  }<br/> <br/>  String _bytesTransferred(StorageTaskSnapshot snapshot) {<br/>    return '${snapshot.bytesTransferred}/${snapshot.totalByteCount}';<br/>  }<br/> <br/>  <a class="ae mo" href="http://twitter.com/override" rel="noopener ugc nofollow" target="_blank">@override</a><br/>  Widget build(BuildContext context) {<br/>    final List&lt;Widget&gt; children = &lt;Widget&gt;[];<br/>    _tasks.forEach((StorageUploadTask task) {<br/>      final Widget tile = UploadTaskListTile(<br/>        task: task,<br/>        onDismissed: () =&gt; setState(() =&gt; _tasks.remove(task)),<br/>        onDownload: () =&gt; downloadFile(task.lastSnapshot.ref),<br/>      );<br/>      children.add(tile);<br/>    });<br/> <br/>    return new MaterialApp(<br/>      home: new Scaffold(<br/>        key: _scaffoldKey,<br/>        appBar: new AppBar(<br/>          title: Text(widget.title),<br/>        ),<br/>        body: new Container(<br/>          padding: EdgeInsets.all(20.0),<br/>          child: Column(<br/>            crossAxisAlignment: CrossAxisAlignment.start,<br/>            mainAxisAlignment: MainAxisAlignment.start,<br/>            children: &lt;Widget&gt;[<br/>              dropDown(),<br/>              SwitchListTile.adaptive(<br/>                title: Text('Pick multiple files', textAlign: TextAlign.left),<br/>                onChanged: (bool value) =&gt; setState(() =&gt; _multiPick = value),<br/>                value: _multiPick,<br/>              ),<br/>              OutlineButton(<br/>                onPressed: () =&gt; openFileExplorer(),<br/>                child: new Text("Open file picker"),<br/>              ),<br/>              SizedBox(<br/>                height: 20.0,<br/>              ),<br/>              Flexible(<br/>                child: ListView(<br/>                  children: children,<br/>                ),<br/>              ),<br/>            ],<br/>          ),<br/>        ),<br/>      ),<br/>    );<br/>  }<br/> <br/>  Future&lt;void&gt; downloadFile(StorageReference ref) async {<br/>    final String url = await ref.getDownloadURL();<br/>    final http.Response downloadData = await http.get(url);<br/>    final Directory systemTempDir = Directory.systemTemp;<br/>    final File tempFile = File('${systemTempDir.path}/tmp.jpg');<br/>    if (tempFile.existsSync()) {<br/>      await tempFile.delete();<br/>    }<br/>    await tempFile.create();<br/>    final StorageFileDownloadTask task = ref.writeToFile(tempFile);<br/>    final int byteCount = (await task.future).totalByteCount;<br/>    var bodyBytes = downloadData.bodyBytes;<br/>    final String name = await ref.getName();<br/>    final String path = await ref.getPath();<br/>    print(<br/>      'Success!\nDownloaded $name \nUrl: $url'<br/>      '\npath: $path \nBytes Count :: $byteCount',<br/>    );<br/>    _scaffoldKey.currentState.showSnackBar(<br/>      SnackBar(<br/>        backgroundColor: Colors.white,<br/>        content: Image.memory(<br/>          bodyBytes,<br/>          fit: BoxFit.fill,<br/>        ),<br/>      ),<br/>    );<br/>  }<br/>}<br/> <br/>class UploadTaskListTile extends StatelessWidget {<br/>  const UploadTaskListTile(<br/>      {Key key, this.task, this.onDismissed, this.onDownload})<br/>      : super(key: key);<br/> <br/>  final StorageUploadTask task;<br/>  final VoidCallback onDismissed;<br/>  final VoidCallback onDownload;<br/> <br/>  String get status {<br/>    String result;<br/>    if (task.isComplete) {<br/>      if (task.isSuccessful) {<br/>        result = 'Complete';<br/>      } else if (task.isCanceled) {<br/>        result = 'Canceled';<br/>      } else {<br/>        result = 'Failed ERROR: ${task.lastSnapshot.error}';<br/>      }<br/>    } else if (task.isInProgress) {<br/>      result = 'Uploading';<br/>    } else if (task.isPaused) {<br/>      result = 'Paused';<br/>    }<br/>    return result;<br/>  }<br/> <br/>  String _bytesTransferred(StorageTaskSnapshot snapshot) {<br/>    return '${snapshot.bytesTransferred}/${snapshot.totalByteCount}';<br/>  }<br/> <br/>  <a class="ae mo" href="http://twitter.com/override" rel="noopener ugc nofollow" target="_blank">@override</a><br/>  Widget build(BuildContext context) {<br/>    return StreamBuilder&lt;StorageTaskEvent&gt;(<br/>      stream: task.events,<br/>      builder: (BuildContext context,<br/>          AsyncSnapshot&lt;StorageTaskEvent&gt; asyncSnapshot) {<br/>        Widget subtitle;<br/>        if (asyncSnapshot.hasData) {<br/>          final StorageTaskEvent event = asyncSnapshot.data;<br/>          final StorageTaskSnapshot snapshot = event.snapshot;<br/>          subtitle = Text('$status: ${_bytesTransferred(snapshot)} bytes sent');<br/>        } else {<br/>          subtitle = const Text('Starting...');<br/>        }<br/>        return Dismissible(<br/>          key: Key(task.hashCode.toString()),<br/>          onDismissed: (_) =&gt; onDismissed(),<br/>          child: ListTile(<br/>            title: Text('Upload Task #${task.hashCode}'),<br/>            subtitle: subtitle,<br/>            trailing: Row(<br/>              mainAxisSize: MainAxisSize.min,<br/>              children: &lt;Widget&gt;[<br/>                Offstage(<br/>                  offstage: !task.isInProgress,<br/>                  child: IconButton(<br/>                    icon: const Icon(Icons.pause),<br/>                    onPressed: () =&gt; task.pause(),<br/>                  ),<br/>                ),<br/>                Offstage(<br/>                  offstage: !task.isPaused,<br/>                  child: IconButton(<br/>                    icon: const Icon(Icons.file_upload),<br/>                    onPressed: () =&gt; task.resume(),<br/>                  ),<br/>                ),<br/>                Offstage(<br/>                  offstage: task.isComplete,<br/>                  child: IconButton(<br/>                    icon: const Icon(Icons.cancel),<br/>                    onPressed: () =&gt; task.cancel(),<br/>                  ),<br/>                ),<br/>                Offstage(<br/>                  offstage: !(task.isComplete &amp;&amp; task.isSuccessful),<br/>                  child: IconButton(<br/>                    icon: const Icon(Icons.file_download),<br/>                    onPressed: onDownload,<br/>                  ),<br/>                ),<br/>              ],<br/>            ),<br/>          ),<br/>        );<br/>      },<br/>    );<br/>  }<br/>}</span></pre><p id="a433" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¯·åœ¨æœ¬æ–‡ä¸‹æ–¹ç•™ä¸‹æ‚¨çš„å®è´µæ„è§ã€‚</p><p id="6ef7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœä½ è§‰å¾—è¿™ä¸ªæœ‰ç”¨ï¼Œè¯·ç‚¹å‡»â€œé¼“æŒâ€ã€‚</p><div class="mp mq gp gr mr ms"><a href="https://www.buymeacoffee.com/vipinvijayan" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">Vipin Vijayan</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">å˜¿ğŸ‘‹æˆ‘åˆšåˆšåœ¨è¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ªé¡µé¢ã€‚ä½ ç°åœ¨å¯ä»¥ç»™æˆ‘ä¹°æ¯å’–å•¡äº†ï¼</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">www.buymeacoffee.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng kv ms"/></div></div></a></div></div></div>    
</body>
</html>