<html>
<head>
<title>Build a modern Android chat app with Kotlin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨Kotlinæ„å»ºä¸€ä¸ªç°ä»£AndroidèŠå¤©åº”ç”¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/build-a-modern-android-chat-app-with-kotlin-8af05bbeafaa?source=collection_archive---------5-----------------------#2019-05-07">https://itnext.io/build-a-modern-android-chat-app-with-kotlin-8af05bbeafaa?source=collection_archive---------5-----------------------#2019-05-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="130b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¬è¯´è¿‡â€œæ²Ÿé€šæ˜¯å…³é”®â€è¿™å¥è¯å—ï¼Ÿ</p><p id="9a7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">äº¤æµåœ¨è§£å†³ä¸–ç•Œé—®é¢˜ä¸­èµ·ç€é‡è¦çš„ä½œç”¨ã€‚æ¯å¤©ï¼Œæˆ‘ä»¬éƒ½åœ¨åŠªåŠ›å¯»æ‰¾æ›´å¿«æˆ–æ›´å¥½çš„äº¤æµæ–¹å¼ã€‚è®©æˆ‘ä»¬è§‰å¾—å½¼æ­¤æ›´äº²è¿‘ã€‚å‘å…¨ä¸–ç•Œå‘é€ä¿¡æ¯ã€‚è‡´åŠ›äºè¿™äº›è§£å†³æ–¹æ¡ˆçš„å…¬å¸ä¹‹ä¸€æ˜¯<strong class="jp ir"> CometChat </strong></p><p id="02a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">CometChatæ˜¯ä¸€ä¸ªå¹³å°ï¼Œå¯ä»¥å¸®åŠ©æ‚¨å¿«é€Ÿå°†è¯­éŸ³ã€è§†é¢‘å’ŒçŸ­ä¿¡åŠŸèƒ½é›†æˆåˆ°æ‚¨çš„ç½‘ç»œå’Œç§»åŠ¨åº”ç”¨ç¨‹åºä¸­ã€‚</p><p id="e16b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªç”±CometChatæ”¯æŒçš„ç®€å•AndroidèŠå¤©åº”ç”¨ç¨‹åº:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/8c76cec6cf5d384165a67afd36de31c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*MR94ZNLN6NQkK17u.gif"/></div></figure><p id="53e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘é¼“åŠ±ä½ ç»§ç»­å­¦ä¹ ï¼Œä½†æ˜¯å¦‚æœä½ æƒ³ç›´æ¥è·³åˆ°ä»£ç ï¼Œä½ å¯ä»¥åœ¨GitHubä¸Šæ‰¾åˆ°è¿™ä¸ªåº”ç”¨ç¨‹åºçš„å®Œæ•´ä»£ç ã€‚</p><h1 id="952f" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">åˆ›å»ºä¸€ä¸ªAndroid Studioé¡¹ç›®</h1><p id="7fee" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">å¯åŠ¨ä¸€ä¸ªæ–°çš„Android Studioé¡¹ç›®å¹¶é€‰æ‹©<strong class="jp ir">ç©ºæ´»åŠ¨</strong>:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi lx"><img src="../Images/87ae39a38f8f41ba2b2ba7ded07bc181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ibLQHW0Pvj9FwAzG.png"/></div></div></figure><p id="0114" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºæ‚¨çš„åº”ç”¨ç¨‹åºè¾“å…¥ä¸€ä¸ªåç§°ï¼Œæˆ‘å°†æˆ‘çš„åº”ç”¨ç¨‹åºå‘½åä¸ºâ€œCometChat â€,å¹¶ä¿ç•™<strong class="jp ir">è¯¥é¡¹ç›®å°†æ”¯æŒå³æ—¶åº”ç”¨ç¨‹åº</strong>å’Œ<strong class="jp ir">ä½¿ç”¨AndroidXå·¥ä»¶</strong>æœªé€‰ä¸­:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi lx"><img src="../Images/6225cd92625dffc8cb993710029eeb8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eSywgH1GHOxWATNV.png"/></div></div></figure><h1 id="24ab" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­è®¾ç½®CometChat</h1><p id="698a" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">è®©æˆ‘ä»¬å…ˆå®‰è£…CometChat Pro SDKï¼Œä»¥ä¾¿æˆ‘ä»¬ä½¿ç”¨å®ƒçš„æœåŠ¡ã€‚</p><p id="272f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.æ‰“å¼€æ‚¨çš„<code class="fe mc md me mf b">build.gradle</code>æ–‡ä»¶å¹¶æ·»åŠ è¿™äº›URL:</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="01ea" class="mk kv iq mf b gy ml mm l mn mo">allprojects {<br/>    repositories {<br/>        google()<br/>        jcenter()<br/>        maven {<br/>            url "https://dl.bintray.com/cometchat/pro"<br/>        }<br/>        maven {<br/>            url "https://github.com/jitsi/jitsi-maven-repository/raw/master/releases"<br/>        }<br/>    }<br/>}</span></pre><p id="b818" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºäº†ä¸‹è½½CometChat SDKï¼Œæˆ‘ä»¬å¿…é¡»é¦–å…ˆæ·»åŠ è¿™äº›å­˜å‚¨åº“ã€‚</p><p id="a88f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.åœ¨åŒä¸€ä¸ª<code class="fe mc md me mf b">build.gradle</code>æ–‡ä»¶ä¸­ï¼Œå°†è¿™äº›è¡Œæ·»åŠ åˆ°<code class="fe mc md me mf b">android</code>å—ä¸­</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="ace2" class="mk kv iq mf b gy ml mm l mn mo">android {<br/>    compileSdkVersion 28<br/>    defaultConfig {<br/>        ...<br/>    }<br/>    compileOptions {<br/>        sourceCompatibility JavaVersion.VERSION_1_8<br/>        targetCompatibility JavaVersion.VERSION_1_8<br/>    }<br/>    buildTypes {<br/>        ...<br/>    }<br/>}</span></pre><p id="b25c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">CometChat SDKä½¿ç”¨Java 8è¯­è¨€ç‰¹æ€§ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»é…ç½®æˆ‘ä»¬çš„é¡¹ç›®æ¥å¯ç”¨å®ƒã€‚</p><p id="cf39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.åŒæ ·åœ¨build.gradleæ–‡ä»¶ä¸­ï¼Œå°†è¿™äº›è¡Œæ·»åŠ åˆ°<code class="fe mc md me mf b">dependencies</code>å—ä¸­</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="90ef" class="mk kv iq mf b gy ml mm l mn mo">dependencies {<br/>    implementation fileTree(dir: 'libs', include: ['*.jar'])<br/>    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlin_version"</span><span id="6fc3" class="mk kv iq mf b gy mp mm l mn mo">    // Support<br/>    implementation 'com.android.support:appcompat-v7:28.0.0'<br/>    implementation 'com.android.support:design:28.0.0'<br/>    implementation 'com.android.support.constraint:constraint-layout:1.1.3'<br/>    implementation 'com.android.support:recyclerview-v7:28.0.0'</span><span id="3c95" class="mk kv iq mf b gy mp mm l mn mo">    // CometChat<br/>    implementation 'com.cometchat:pro-android-chat-sdk:1.0.+'</span><span id="7f21" class="mk kv iq mf b gy mp mm l mn mo">    // Test<br/>    testImplementation 'junit:junit:4.12'<br/>    androidTestImplementation 'com.android.support.test:runner:1.0.2'<br/>    androidTestImplementation 'com.android.support.test.espresso:espresso-core:3.0.2'<br/>}</span></pre><p id="3f32" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.ç‚¹å‡»å³ä¸Šè§’çš„<strong class="jp ir">ç«‹å³åŒæ­¥</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mq"><img src="../Images/f244e3cec3720ed1628da6f45fc3fe21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EqBnkCNkMDIfDCrR.png"/></div></div></figure><h1 id="82e7" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">æŠŠç”¨æˆ·ç•Œé¢çš„ä¸œè¥¿å»æ‰</h1><p id="dcfe" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»å®‰è£…äº†ä¾èµ–é¡¹ï¼Œè®©æˆ‘ä»¬æå‰å®šä¹‰ä¸€äº›ä¸UIç›¸å…³çš„å€¼ã€‚</p><p id="cc86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.æ‰“å¼€åº”ç”¨ç¨‹åº/èµ„æº/å€¼</p><p id="b860" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.æ›´æ¢<code class="fe mc md me mf b">color.xml</code>:</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="1b5b" class="mk kv iq mf b gy ml mm l mn mo">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;resources&gt;<br/>    &lt;color name="colorPrimary"&gt;#673AB7&lt;/color&gt;<br/>    &lt;color name="colorPrimaryDark"&gt;#512DA8&lt;/color&gt;<br/>    &lt;color name="colorAccent"&gt;#E040FB&lt;/color&gt;<br/>    &lt;color name="gray"&gt;#DDDDDD&lt;/color&gt;<br/>&lt;/resources&gt;</span></pre><p id="c25a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™æ˜¯æˆ‘ä»¬ä¸ºåº”ç”¨ç¨‹åºè®¾ç½®é¢œè‰²çš„åœ°æ–¹ã€‚å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥æŠŠå®ƒå®šåˆ¶æˆä½ æƒ³è¦çš„ä»»ä½•é¢œè‰²ã€‚è¦è·å¾—çµæ„Ÿï¼Œè¯·æŸ¥çœ‹<a class="ae kt" href="https://www.materialpalette.com/" rel="noopener ugc nofollow" target="_blank">æè´¨è°ƒè‰²æ¿ã€‚</a></p><p id="decc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.ç¼–è¾‘<code class="fe mc md me mf b">styles.xml</code>:</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="87a0" class="mk kv iq mf b gy ml mm l mn mo">&lt;resources&gt;<br/>    &lt;!-- Base application theme. --&gt;<br/>    &lt;style name="AppTheme" parent="Theme.MaterialComponents.Light.DarkActionBar"&gt;<br/>        &lt;!-- Customize your theme here. --&gt;<br/>        &lt;item name="colorPrimary"&gt;@color/colorPrimary&lt;/item&gt;<br/>        &lt;item name="colorPrimaryDark"&gt;@color/colorPrimaryDark&lt;/item&gt;<br/>        &lt;item name="colorAccent"&gt;@color/colorAccent&lt;/item&gt;<br/>    &lt;/style&gt;</span><span id="6165" class="mk kv iq mf b gy mp mm l mn mo">&lt;/resources&gt;</span></pre><p id="69a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ›¿æ¢æ‚¨çš„<code class="fe mc md me mf b">parent</code>ä¸»é¢˜ï¼Œä½¿ç”¨æˆ‘ä»¬åœ¨åº”ç”¨ç¨‹åºä¸­è®¾ç½®CometChatæ—¶ä½¿ç”¨<code class="fe mc md me mf b">implementation 'com.android.support:design:28.0.0</code>å¯¼å…¥çš„ææ–™è®¾è®¡ä¸»é¢˜ã€‚</p><p id="d4c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.ç¼–è¾‘<strong class="jp ir"> strings.xml </strong></p><p id="5c23" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚¨çš„<code class="fe mc md me mf b">strings.xml</code>æ–‡ä»¶å°†åŒ…å«æ‚¨çš„CometChatåº”ç”¨IDå’ŒAPIå¯†é’¥ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­åˆ›å»º:</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="aeeb" class="mk kv iq mf b gy ml mm l mn mo">&lt;resources&gt;<br/>    &lt;string name="app_name"&gt;CometChatPro&lt;/string&gt;<br/>    &lt;string name="username"&gt;Username&lt;/string&gt;<br/>    &lt;string name="join_chat"&gt;Join Chat&lt;/string&gt;<br/>    &lt;string name="send"&gt;Send&lt;/string&gt;<br/>    &lt;string name="enter_message"&gt;Enter messageâ€¦&lt;/string&gt;<br/>    &lt;string name="appID"&gt;YOUR_APP_ID_HERE&lt;/string&gt;<br/>    &lt;string name="apiKey"&gt;YOUR_API_KEY_HERE&lt;/string&gt;<br/>&lt;/resources&gt;</span></pre><p id="deae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åŒæ ·ï¼Œç°åœ¨ä¸è¦æ‹…å¿ƒä½ çš„APP_ID_HEREå’Œä½ çš„API_KEY_HER  Eã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€æ­¥ä¸­æ”¹å˜è¿™ä¸€ç‚¹ã€‚</p><h1 id="f0e9" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">åˆ›å»ºå¹¶è®¾ç½®ä¸€ä¸ªCometChat Proå¸æˆ·</h1><p id="627c" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">1.å¦‚æœæ‚¨è¿˜æ²¡æœ‰ï¼Œè¯·<a class="ae kt" href="http://app.cometchat.com/#/login" rel="noopener ugc nofollow" target="_blank">åˆ›å»ºä¸€ä¸ªCometChatå¸æˆ·</a></p><p id="b61a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.æ³¨å†Œå¹¶ç™»å½•åï¼Œå‰å¾€æ‚¨çš„<a class="ae kt" href="https://app.cometchat.com/#/login" rel="noopener ugc nofollow" target="_blank">ä»ªè¡¨ç›˜</a></p><p id="6ef6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.åˆ›å»ºä¸€ä¸ªåä¸ºâ€œCometChatProâ€çš„æ–°åº”ç”¨ç¨‹åº</p><p id="0508" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.åˆ›å»ºAPIå¯†é’¥:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi kl"><img src="../Images/10fe260a1cbdebe119680b1ecdafc2ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*XKiSCJuoK68EK6ra.gif"/></div></div></figure><p id="3ec1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.è¿”å›åˆ°æ‚¨çš„<code class="fe mc md me mf b">strings.xml</code>ï¼Œç²˜è´´æ‚¨çš„åº”ç”¨IDå’ŒAPIå¯†é’¥</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="501d" class="mk kv iq mf b gy ml mm l mn mo">&lt;resources&gt;<br/>    ...<br/>    &lt;string name="appID"&gt;2179fddc591bf&lt;/string&gt;<br/>    &lt;string name="apiKey"&gt;6cb3aa84e2c066ed8bb34d3a58b3d6904d829b6e&lt;/string&gt;<br/>&lt;/resources&gt;</span></pre><p id="75e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»å®Œæˆäº†æ‰€æœ‰è¿™äº›è®¾ç½®ï¼Œè®©æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹æ˜¯å¦å¯ä»¥å¯åŠ¨åˆ°CometChat Pro APIçš„è¿æ¥ã€‚</p><h1 id="6c03" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­åˆå§‹åŒ–CometChat</h1><p id="f761" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªAPIå¯†é’¥ï¼Œè®©æˆ‘ä»¬åˆå§‹åŒ–åº”ç”¨ç¨‹åºä¸­çš„CometChat SDKï¼Œä»¥ä¾¿ä¸CometChatæœåŠ¡å™¨å»ºç«‹è¿æ¥ã€‚</p><p id="07ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.åœ¨<code class="fe mc md me mf b">cometchat/cometchatpro</code>ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º<code class="fe mc md me mf b">App.kt</code>çš„æ–°ç±»ï¼Œå¹¶ç²˜è´´ä»¥ä¸‹ä»£ç :</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="1d36" class="mk kv iq mf b gy ml mm l mn mo">import android.support.v7.widget.RecyclerView<br/>import android.view.LayoutInflater<br/>import android.view.View<br/>import android.view.ViewGroup<br/>import android.widget.TextView<br/>import com.cometchat.pro.models.BaseMessage<br/>import com.cometchat.pro.models.TextMessage</span><span id="9417" class="mk kv iq mf b gy mp mm l mn mo">class MessagesAdapter(private val uid: String,<br/>                      private var messages: MutableList&lt;BaseMessage&gt;)  : RecyclerView.Adapter&lt;MessagesAdapter.MessageViewHolder&gt;() {</span><span id="3a65" class="mk kv iq mf b gy mp mm l mn mo">    companion object {<br/>        private const val SENT = 0<br/>        private const val RECEIVED = 1<br/>    }</span><span id="97e9" class="mk kv iq mf b gy mp mm l mn mo">    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): MessageViewHolder {<br/>        val view = when (viewType) {<br/>            SENT -&gt; {<br/>                LayoutInflater.from(parent.context).inflate(R.layout.item_sent, parent, false)<br/>            }<br/>            else -&gt; {<br/>                LayoutInflater.from(parent.context).inflate(R.layout.item_received, parent, false)<br/>            }<br/>        }<br/>        return MessageViewHolder(view)<br/>    }</span><span id="d4db" class="mk kv iq mf b gy mp mm l mn mo">    override fun getItemCount() = messages.size</span><span id="1426" class="mk kv iq mf b gy mp mm l mn mo">    override fun onBindViewHolder(holder: MessageViewHolder, position: Int) {<br/>        holder.bind(messages[position])<br/>    }</span><span id="b6e4" class="mk kv iq mf b gy mp mm l mn mo">    override fun getItemViewType(position: Int): Int {<br/>        return if (messages[position].sender?.uid!!.contentEquals(uid)) {<br/>            SENT<br/>        } else {<br/>            RECEIVED<br/>        }<br/>    }</span><span id="15bf" class="mk kv iq mf b gy mp mm l mn mo">    fun updateMessages(messages: List&lt;BaseMessage&gt;) {<br/>        this.messages = messages.toMutableList()<br/>        notifyDataSetChanged()<br/>    }</span><span id="29cf" class="mk kv iq mf b gy mp mm l mn mo">    fun appendMessage(message: BaseMessage) {<br/>        this.messages.add(message)<br/>        notifyItemInserted(this.messages.size - 1)<br/>    }</span><span id="0698" class="mk kv iq mf b gy mp mm l mn mo">    inner class MessageViewHolder(itemView: View) : RecyclerView.ViewHolder(itemView) {</span><span id="e733" class="mk kv iq mf b gy mp mm l mn mo">        private val messageText: TextView = itemView.findViewById(R.id.message_text)</span><span id="2708" class="mk kv iq mf b gy mp mm l mn mo">        fun bind(message: BaseMessage) {<br/>            if (message is TextMessage) {<br/>                messageText.text = message.text<br/>            }<br/>        }<br/>    }<br/>}</span></pre><p id="24fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.æ‰“å¼€<code class="fe mc md me mf b">AndroidManifest.xml</code>å¹¶æ·»åŠ æˆ‘ä»¬æ–°åˆ›å»ºçš„åº”ç”¨ç¨‹åºç±»:</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="09bf" class="mk kv iq mf b gy ml mm l mn mo">&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"<br/>          package="com.cometchat.cometchatpro"&gt;<br/>    &lt;application<br/>            android:name=".App"<br/>            android:allowBackup="true"<br/>            android:icon="@mipmap/ic_launcher"<br/>            android:label="@string/app_name"<br/>            android:roundIcon="@mipmap/ic_launcher_round"<br/>            android:supportsRtl="true"<br/>            android:theme="@style/AppTheme"&gt;<br/>        ...<br/>    &lt;/application&gt;<br/>&lt;/manifest&gt;</span></pre><p id="ce26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨æ¨¡æ‹Ÿå™¨æˆ–æ‚¨è‡ªå·±çš„è®¾å¤‡ä¸Šè¿è¡Œåº”ç”¨ç¨‹åºã€‚æ£€æŸ¥æ—¥å¿—ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°æ–‡æœ¬â€œåˆå§‹åŒ–å®Œæˆ:åˆå§‹åŒ–æˆåŠŸâ€:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mr"><img src="../Images/de177f56e3c88bd5d5af58a094da0b0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uL6GJkLjLKWj8pQa.png"/></div></div></figure><p id="0f95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ—¢ç„¶æˆ‘ä»¬å·²ç»ä¸CometChat ProæœåŠ¡å»ºç«‹äº†è”ç³»ï¼Œæ˜¯æ—¶å€™è®©æˆ‘ä»¬ä¸å®ƒäº’åŠ¨äº†ã€‚</p><p id="fa96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨æ¯ä¸€ä¸ªèŠå¤©åº”ç”¨ç¨‹åºä¸­ï¼Œéƒ½æœ‰ç”¨æˆ·å‚ä¸å…¶ä¸­å¹¶ç›¸äº’äº¤æµã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªç™»å½•å±å¹•æ¥éªŒè¯æˆ‘ä»¬çš„ç”¨æˆ·ã€‚</p><h1 id="9dcb" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">åˆ›å»ºæˆ‘ä»¬çš„èº«ä»½éªŒè¯ç”¨æˆ·ç•Œé¢</h1><p id="469e" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">å¯¹äºåº”ç”¨ç¨‹åºçš„æ¯ä¸ªç”¨æˆ·ï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªCometChatç”¨æˆ·ã€‚æ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªç”¨æˆ·åå’Œä¸€ä¸ªå”¯ä¸€çš„ID (UID)ã€‚æˆ–è€…ï¼Œæ‚¨å¯ä»¥å°†å…¶ä»–å…ƒæ•°æ®(å¦‚ä¸ªäººèµ„æ–™å›¾ç‰‡)ä¸ç”¨æˆ·ç›¸å…³è”ï¼Œä½†è¿™ä¸æ˜¯æˆ‘ä»¬åœ¨æ­¤è®¨è®ºçš„å†…å®¹ã€‚ä½ å¯ä»¥åœ¨<a class="ae kt" href="https://prodocs.cometchat.com/docs/concepts#section-users" rel="noopener ugc nofollow" target="_blank">å®˜æ–¹æ–‡æ¡£</a>ä¸­é˜…è¯»æ›´å¤šå…³äºCometChatç”¨æˆ·çš„ä¿¡æ¯ã€‚</p><p id="e15b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½¿ç”¨<a class="ae kt" href="https://prodocs.cometchat.com/reference#createuser" rel="noopener ugc nofollow" target="_blank"> CreateUser API </a>å¯ä»¥ç”¨ä»£ç åˆ›å»ºCometChatç”¨æˆ·ã€‚ç„¶è€Œï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†é€šè¿‡CometChatä»ªè¡¨æ¿æ¥åˆ›å»ºç”¨æˆ·ã€‚</p><p id="79b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å› ä¸ºæˆ‘ä»¬å°†æ‰‹åŠ¨åˆ›å»ºç”¨æˆ·ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†åªä½¿ç”¨ç”¨æˆ·çš„UIDç™»å½•ã€‚æˆ‘ä»¬å°†ä¸ºæˆ‘ä»¬çš„UIDåˆ›å»ºä¸€ä¸ªæ–‡æœ¬å­—æ®µï¼Œå¹¶åˆ›å»ºä¸€ä¸ªç”¨äºç™»å½•çš„æŒ‰é’®ã€‚</p><p id="be88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.åœ¨res/layoutæ–‡ä»¶å¤¹ä¸‹ï¼Œæ‰“å¼€<code class="fe mc md me mf b">activity_main.xml</code>ï¼Œç²˜è´´ä»¥ä¸‹ä»£ç :</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="2f20" class="mk kv iq mf b gy ml mm l mn mo">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;android.support.constraint.ConstraintLayout <br/>    xmlns:android="http://schemas.android.com/apk/res/android"<br/>    xmlns:app="http://schemas.android.com/apk/res-auto"<br/>    android:layout_width="match_parent"<br/>    android:layout_height="match_parent"&gt;</span><span id="a120" class="mk kv iq mf b gy mp mm l mn mo">    &lt;EditText<br/>        android:id="@+id/username"<br/>        android:layout_width="0dp"<br/>        android:layout_height="wrap_content"<br/>        android:layout_marginStart="24dp"<br/>        android:layout_marginTop="8dp"<br/>        android:layout_marginEnd="24dp"<br/>        android:layout_marginBottom="8dp"<br/>        android:hint="@string/username"<br/>        app:layout_constraintBottom_toBottomOf="parent"<br/>        app:layout_constraintEnd_toEndOf="parent"<br/>        app:layout_constraintStart_toStartOf="parent"<br/>        app:layout_constraintTop_toTopOf="parent" /&gt;</span><span id="8c8e" class="mk kv iq mf b gy mp mm l mn mo">    &lt;Button<br/>        android:id="@+id/join_chat"<br/>        android:layout_width="128dp"<br/>        android:layout_height="wrap_content"<br/>        android:layout_marginTop="8dp"<br/>        android:text="@string/join_chat"<br/>        app:layout_constraintEnd_toEndOf="@+id/username"<br/>        app:layout_constraintStart_toStartOf="@+id/username"<br/>        app:layout_constraintTop_toBottomOf="@+id/username" /&gt;<br/>&lt;/android.support.constraint.ConstraintLayout&gt;</span></pre><p id="029f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.è¿è¡Œåº”ç”¨ç¨‹åºï¼Œä½ åº”è¯¥æœ‰ç±»ä¼¼è¿™æ ·çš„ä¸œè¥¿</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/16dc48c13776e25d13909f85b628c6e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Pty8jGIGIwQe1V_F.png"/></div></figure><h1 id="6c7d" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">å®ç°æˆ‘ä»¬çš„éªŒè¯ç </h1><p id="52a0" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">åœ¨æ‚¨åˆ›å»ºäº†ç”¨äºèº«ä»½éªŒè¯çš„UIä¹‹åï¼Œè®©æˆ‘ä»¬é€šè¿‡ä½¿ç”¨CometChatæœåŠ¡å™¨è¿›è¡Œèº«ä»½éªŒè¯æ¥æ·»åŠ ç™»å½•åŠŸèƒ½ã€‚</p><p id="06ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.æ‰“å¼€æ‚¨çš„<code class="fe mc md me mf b">MainActivity.class</code>ï¼Œç²˜è´´ä»¥ä¸‹ä»£ç :</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="57f0" class="mk kv iq mf b gy ml mm l mn mo">class MainActivity : AppCompatActivity() {</span><span id="1564" class="mk kv iq mf b gy mp mm l mn mo">    private lateinit var join: Button<br/>    private lateinit var username: EditText</span><span id="77ed" class="mk kv iq mf b gy mp mm l mn mo">    override fun onCreate(savedInstanceState: Bundle?) {<br/>        super.onCreate(savedInstanceState)<br/>        setContentView(R.layout.activity_main)</span><span id="56c6" class="mk kv iq mf b gy mp mm l mn mo">        username = findViewById(R.id.username)</span><span id="3ea7" class="mk kv iq mf b gy mp mm l mn mo">        join = findViewById(R.id.join_chat)<br/>        join.setOnClickListener {<br/>            disableAuthField()<br/>            login()<br/>        }<br/>    }</span><span id="0960" class="mk kv iq mf b gy mp mm l mn mo">    private fun disableAuthField() {<br/>        join.isEnabled = false<br/>        username.isEnabled = false<br/>    }</span><span id="8ccf" class="mk kv iq mf b gy mp mm l mn mo">    private fun login() {<br/>        CometChat.login(username.text.toString(), getString(R.string.apiKey), object : CometChat.CallbackListener() {<br/>            override fun onSuccess(user: User) {<br/>                username.setText("")<br/>                enableAuthField()<br/>                Toast.makeText(this@MainActivity, "Login successful", Toast.LENGTH_SHORT).show()<br/>            }</span><span id="b92b" class="mk kv iq mf b gy mp mm l mn mo">            override fun onError(e: CometChatException) {<br/>                Toast.makeText(this@MainActivity, "Error or username doesn't exist.", Toast.LENGTH_SHORT).show()<br/>                enableAuthField()<br/>            }<br/>        })<br/>    }</span><span id="fd3d" class="mk kv iq mf b gy mp mm l mn mo">    private fun enableAuthField() {<br/>        join.isEnabled = true<br/>        username.isEnabled = true<br/>    }<br/>}</span></pre><p id="3739" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½†æ˜¯ç­‰ç­‰ï¼æ‚¨å¯èƒ½ä¼šé—®è‡ªå·±â€œæˆ‘å¦‚ä½•åˆ›å»ºç”¨æˆ·ï¼Ÿâ€ã€‚ä¸ºäº†ä½¿æœ¬æ•™ç¨‹ç®€å•ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<a class="ae kt" href="https://app.cometchat.com/#/apps" rel="noopener ugc nofollow" target="_blank">ä»ªè¡¨æ¿</a>åˆ›å»ºä¸€ä¸ªç”¨æˆ·ã€‚å¯¹äºå®é™…çš„ç”Ÿäº§åº”ç”¨ç¨‹åºï¼Œæ‚¨åº”è¯¥ä½¿ç”¨<a class="ae kt" href="https://prodocs.cometchat.com/reference#createuser" rel="noopener ugc nofollow" target="_blank"> CreateUser API </a>æ¥åˆ›å»ºç”¨æˆ·ã€‚</p><h1 id="e66d" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">åˆ›å»ºç”¨æˆ·</h1><p id="4d84" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">è½¬åˆ°æ‚¨çš„<a class="ae kt" href="https://app.cometchat.com/#/apps" rel="noopener ugc nofollow" target="_blank">ä»ªè¡¨ç›˜</a>å¹¶ç‚¹å‡»CometChatProåº”ç”¨ç¨‹åºä¸‹æ–¹çš„<strong class="jp ir">æ¢ç´¢</strong>æŒ‰é’®</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/2659853871b5f9e431bee4aec1b707f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*cZIpISt9Nu-q5jsY.gif"/></div></figure><p id="93b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æ‚¨æ‰€è§ï¼ŒCometChatæä¾›äº†ä¸€ç»„ç°æœ‰çš„ç¤ºä¾‹ç”¨æˆ·ã€‚æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªï¼Œä½†æ˜¯åˆ›å»ºç”¨æˆ·ä¹Ÿéå¸¸ç®€å•ã€‚</p><p id="bd1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è®°ä¸‹æ‚¨åˆšåˆšåˆ›å»ºçš„ç”¨æˆ·çš„UIDï¼Œå› ä¸ºæˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥ç™»å½•æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚</p><h1 id="3087" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">ç™»å½•CometChat</h1><p id="9a21" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">ä½¿ç”¨æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„ç”¨æˆ·çš„UIDâ€œuser 1â€ã€‚</p><p id="cec8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.è¿è¡Œåº”ç”¨ç¨‹åº</p><p id="aa13" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.åœ¨ç”¨æˆ·åè¾“å…¥ä¸­ï¼Œè¾“å…¥â€œç”¨æˆ·1â€</p><p id="0bd4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.ç‚¹å‡»<strong class="jp ir">ç™»å½•</strong>ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªæç¤ºâ€œç™»å½•æˆåŠŸâ€çš„æç¤º</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/dc859fbe4b871661ee983357d2888599.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/0*uxqf4QZrZNXiLuSn.png"/></div></figure><p id="b4ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥ç™»å½•äº†ï¼Œè®©æˆ‘ä»¬è¿›å…¥æœ¬æ•™ç¨‹æœ€ç²¾å½©çš„éƒ¨åˆ†ï¼Œå¼€å‘èŠå¤©åŠŸèƒ½ï¼</p><p id="83fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨CometChatå®æ—¶å‘é€ã€è·å–å’Œç›‘å¬æ¶ˆæ¯ã€‚ğŸ˜</p><h1 id="83a9" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">ä½¿ç”¨CometChatç¾¤ç»„åˆ›å»ºèŠå¤©å®¤</h1><p id="f91d" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">å®ƒæœ‰å¾ˆå¤šåå­—â€”â€”å¯¹è¯ã€èŠå¤©å®¤æˆ–ç¾¤ç»„ã€‚é‡è¦çš„æ˜¯ï¼Œå¯¹äºç”¨æˆ·æ¥è¯´ï¼Œè¦ç›¸äº’äº¤æµï¼Œä»–ä»¬å¿…é¡»æœ‰ç›¸äº’ä¼ é€’ä¿¡æ¯çš„æ–¹æ³•ã€‚</p><p id="559e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™å°±æ˜¯CometChatç»„çš„ç”¨æ­¦ä¹‹åœ°ã€‚æŠŠç¾¤ç»„æƒ³è±¡æˆä¸€ä¸ªèŠå¤©å®¤ï¼Œè®©ç”¨æˆ·å‘é€ä»–ä»¬çš„ä¿¡æ¯ï¼Œä¹Ÿè®©ç¾¤ç»„ä¸­çš„å…¶ä»–äººæ¥æ”¶ä¿¡æ¯ã€‚</p><p id="2649" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å‡ºäºæœ¬æ•™ç¨‹çš„ç›®çš„ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨CometChatä»ªè¡¨æ¿è¿›è¡Œåˆ†ç»„ã€‚å¦‚æœæ‚¨æ„¿æ„ï¼Œä¹Ÿå¯ä»¥ç”¨ä»£ç åŠ¨æ€åˆ›å»ºä¸€ä¸ªç»„ã€‚æ›´å¤šä¿¡æ¯è¯·ç‚¹å‡»ã€‚</p><p id="20f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.åœ¨ä¾§è¾¹æ ä¸­ï¼Œç‚¹å‡»<strong class="jp ir">ç¾¤ç»„</strong>:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/dda494681b980ae45a282c54985f0d5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/0*r9N0hd0z37SemBNG.png"/></div></figure><p id="c653" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.CometChatä¸ºæ‚¨æä¾›äº†ä¸€ä¸ªåä¸ºâ€œè¶…ç¾¤â€çš„æ ·æœ¬ç¾¤ã€‚åˆ›å»ºè‡ªå·±çš„ç¾¤ä¹Ÿå¾ˆå®¹æ˜“ã€‚</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi lx"><img src="../Images/1fec30d870410d3097343d894ef307f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QkZTHS-3WPRagCFt.png"/></div></div></figure><p id="7b0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.ç‚¹å‡»<strong class="jp ir">åˆ›å»ºç¾¤ç»„</strong></p><p id="bff2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.è¾“å…¥<strong class="jp ir"> GUIDã€åç§°å’Œç±»å‹</strong></p><p id="851a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.å•å‡»<strong class="jp ir">åˆ›å»ºç»„</strong>å¹¶è®°ä¸‹GUIDï¼Œå› ä¸ºæˆ‘ä»¬å°†åœ¨åé¢çš„æ­¥éª¤ä¸­ä½¿ç”¨å®ƒ</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mu"><img src="../Images/51ac7004280225d04621fd1f08aa9334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*t4vuUpAXk6gpKEa1.png"/></div></div></figure><h1 id="efcc" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">åˆ›å»ºæˆ‘ä»¬çš„æ¶ˆæ¯å±å¹•ç”¨æˆ·ç•Œé¢</h1><p id="f8d6" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªç»„ï¼Œæˆ‘ä»¬å°†åˆ›å»ºå‘é€å’Œæ˜¾ç¤ºèŠå¤©æ¶ˆæ¯çš„UIã€‚</p><p id="798e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.åœ¨<code class="fe mc md me mf b">cometchat/cometchatpro</code>ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º<code class="fe mc md me mf b">MessagesActivity</code>çš„æ–°çš„ç©ºæ´»åŠ¨</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mv"><img src="../Images/b8e6246cc93f2c0a1d6a4c04cea824bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*x-h3sufISDsocg2_.png"/></div></div></figure><p id="9725" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.æ‰“å¼€æ‚¨çš„<code class="fe mc md me mf b">activity_messages.xml</code>å¸ƒå±€å¹¶ç²˜è´´ä»¥ä¸‹ä»£ç :</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="d297" class="mk kv iq mf b gy ml mm l mn mo">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;android.support.constraint.ConstraintLayout<br/>    xmlns:android="http://schemas.android.com/apk/res/android"<br/>    xmlns:app="http://schemas.android.com/apk/res-auto"<br/>    android:layout_width="match_parent"<br/>    android:layout_height="match_parent"&gt;</span><span id="661c" class="mk kv iq mf b gy mp mm l mn mo">    &lt;android.support.v7.widget.RecyclerView<br/>        android:id="@+id/messages"<br/>        android:layout_width="0dp"<br/>        android:layout_height="0dp"<br/>        android:layout_marginStart="8dp"<br/>        android:layout_marginTop="8dp"<br/>        android:layout_marginEnd="8dp"<br/>        android:layout_marginBottom="8dp"<br/>        app:layout_constraintBottom_toTopOf="@+id/enter_message"<br/>        app:layout_constraintEnd_toEndOf="parent"<br/>        app:layout_constraintStart_toStartOf="parent"<br/>        app:layout_constraintTop_toTopOf="parent" /&gt;</span><span id="3e0a" class="mk kv iq mf b gy mp mm l mn mo">    &lt;EditText<br/>        android:id="@+id/enter_message"<br/>        android:layout_width="0dp"<br/>        android:layout_height="wrap_content"<br/>        android:layout_marginStart="8dp"<br/>        android:layout_marginEnd="8dp"<br/>        android:layout_marginBottom="8dp"<br/>        android:hint="@string/enter_message"<br/>        app:layout_constraintBottom_toBottomOf="parent"<br/>        app:layout_constraintEnd_toStartOf="@+id/send_message"<br/>        app:layout_constraintHorizontal_bias="0.5"<br/>        app:layout_constraintStart_toStartOf="parent" /&gt;</span><span id="4c02" class="mk kv iq mf b gy mp mm l mn mo">    &lt;Button<br/>        android:id="@+id/send_message"<br/>        android:layout_width="wrap_content"<br/>        android:layout_height="wrap_content"<br/>        android:layout_marginEnd="8dp"<br/>        android:text="@string/send"<br/>        app:layout_constraintBottom_toBottomOf="@+id/enter_message"<br/>        app:layout_constraintEnd_toEndOf="parent"<br/>        app:layout_constraintHorizontal_bias="0.5"<br/>        app:layout_constraintStart_toEndOf="@+id/enter_message"<br/>        app:layout_constraintTop_toTopOf="@+id/enter_message" /&gt;</span><span id="0ed6" class="mk kv iq mf b gy mp mm l mn mo">&lt;/android.support.constraint.ConstraintLayout&gt;</span></pre><p id="eb6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.å¦‚æœç™»å½•æˆåŠŸï¼Œæ‰“å¼€æ‚¨çš„<code class="fe mc md me mf b">MainActivity.class</code>å¹¶å¯åŠ¨æˆ‘ä»¬çš„<code class="fe mc md me mf b">MessagesActivity</code></p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="b1f0" class="mk kv iq mf b gy ml mm l mn mo">private fun login() {<br/>  CometChat.login(username.text.toString(), getString(R.string.apiKey), object : CometChat.CallbackListener() {<br/>    override fun onSuccess(user: User) {<br/>      username.setText("")<br/>      enableAuthField()<br/>      val intent = Intent(this@MainActivity, MessagesActivity::class.java)<br/>      startActivity(intent)<br/>    }<br/>    ...<br/>  })<br/>}</span></pre><p id="aa2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿è¡Œåº”ç”¨ç¨‹åºï¼Œå½“æˆ‘ä»¬ä»¥â€œç”¨æˆ·1â€çš„èº«ä»½ç™»å½•æ—¶ï¼Œå®ƒåº”è¯¥ä¼šå¯åŠ¨æˆ‘ä»¬çš„<code class="fe mc md me mf b">MessagesActivity</code></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/a1eead10666bda2462a99a8ebb59294e.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/0*1fLbh5aa5-Pk8UUm.gif"/></div></figure><h1 id="7ea0" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">å‘é€æ¶ˆæ¯</h1><p id="7cb8" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">åœ¨CometChatä¸­ï¼Œæœ‰ä¸¤ç§æ¶ˆæ¯:<a class="ae kt" href="https://prodocs.cometchat.com/docs/android-appendix#section-textmessage" rel="noopener ugc nofollow" target="_blank"> TextMessage </a>å’Œ<a class="ae kt" href="https://prodocs.cometchat.com/docs/android-appendix#section-mediamessage" rel="noopener ugc nofollow" target="_blank"> MediaMessage </a>ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†åªå…³æ³¨æ–‡æœ¬æ¶ˆæ¯ã€‚</p><p id="2340" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.åœ¨res/drawableæ–‡ä»¶å¤¹ä¸‹ï¼Œåˆ›å»ºä¸¤ä¸ªæ–°çš„drawable:</p><p id="b1ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mc md me mf b">item_received_background.xml</code>:</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="0a41" class="mk kv iq mf b gy ml mm l mn mo">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>    &lt;shape xmlns:android="http://schemas.android.com/apk/res/android"&gt;<br/>        &lt;solid android:color="@color/gray" /&gt;<br/>        &lt;corners android:radius="4dp" /&gt;<br/>    &lt;/shape&gt;</span></pre><p id="221d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mc md me mf b">item_sent_background.xml</code>:</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="207b" class="mk kv iq mf b gy ml mm l mn mo">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;shape xmlns:android="http://schemas.android.com/apk/res/android"&gt;<br/>    &lt;solid android:color="@color/colorPrimary" /&gt;<br/>    &lt;corners android:radius="4dp" /&gt;<br/>&lt;/shape&gt;</span></pre><p id="3f5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.åœ¨res/layoutæ–‡ä»¶å¤¹ä¸‹ï¼Œåˆ›å»ºä¸¤ä¸ªæ–°å¸ƒå±€:</p><p id="0ec0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mc md me mf b">item_received.xml</code>:</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="801a" class="mk kv iq mf b gy ml mm l mn mo">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>    &lt;LinearLayout<br/>        xmlns:android="http://schemas.android.com/apk/res/android"<br/>        android:layout_width="match_parent"<br/>        android:layout_height="wrap_content"<br/>        android:orientation="vertical"&gt;<br/>        &lt;TextView<br/>            android:id="@+id/message_text"<br/>            android:layout_width="wrap_content"<br/>            android:layout_height="wrap_content"<br/>            android:layout_margin="8dp"<br/>            android:background="@drawable/item_received_background"<br/>            android:gravity="center"<br/>            android:padding="8dp" /&gt;<br/>    &lt;/LinearLayout&gt;</span></pre><p id="777a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mc md me mf b">item_sent.xml</code>:</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="e6c3" class="mk kv iq mf b gy ml mm l mn mo">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;LinearLayout<br/>    xmlns:android="http://schemas.android.com/apk/res/android"<br/>    android:layout_width="match_parent"<br/>    android:layout_height="wrap_content"<br/>    android:orientation="vertical"&gt;<br/>    &lt;TextView<br/>        android:id="@+id/message_text"<br/>        android:layout_width="wrap_content"<br/>        android:layout_height="wrap_content"<br/>        android:layout_gravity="end"<br/>        android:layout_margin="8dp"<br/>        android:background="@drawable/item_sent_background"<br/>        android:gravity="center"<br/>        android:padding="8dp"<br/>        android:textColor="@android:color/white" /&gt;<br/>&lt;/LinearLayout&gt;</span></pre><p id="9700" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.åˆ›å»ºä¸€ä¸ªæ–°ç±»â€” <code class="fe mc md me mf b">MessagesAdapter</code>å¹¶ç²˜è´´ä»¥ä¸‹ä»£ç :</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="630d" class="mk kv iq mf b gy ml mm l mn mo">import android.support.v7.widget.RecyclerView<br/>import android.view.LayoutInflater<br/>import android.view.View<br/>import android.view.ViewGroup<br/>import android.widget.TextView<br/>import com.cometchat.pro.models.BaseMessage<br/>import com.cometchat.pro.models.TextMessage</span><span id="54c5" class="mk kv iq mf b gy mp mm l mn mo">class MessagesAdapter(private val uid: String,<br/>                      private var messages: MutableList&lt;BaseMessage&gt;)  : RecyclerView.Adapter&lt;MessagesAdapter.MessageViewHolder&gt;() {</span><span id="33ca" class="mk kv iq mf b gy mp mm l mn mo">    companion object {<br/>        private const val SENT = 0<br/>        private const val RECEIVED = 1<br/>    }</span><span id="2faa" class="mk kv iq mf b gy mp mm l mn mo">    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): MessageViewHolder {<br/>        val view = when (viewType) {<br/>            SENT -&gt; {<br/>                LayoutInflater.from(parent.context).inflate(R.layout.item_sent, parent, false)<br/>            }<br/>            else -&gt; {<br/>                LayoutInflater.from(parent.context).inflate(R.layout.item_received, parent, false)<br/>            }<br/>        }<br/>        return MessageViewHolder(view)<br/>    }</span><span id="f47f" class="mk kv iq mf b gy mp mm l mn mo">    override fun getItemCount() = messages.size</span><span id="9135" class="mk kv iq mf b gy mp mm l mn mo">    override fun onBindViewHolder(holder: MessageViewHolder, position: Int) {<br/>        holder.bind(messages[position])<br/>    }</span><span id="aefa" class="mk kv iq mf b gy mp mm l mn mo">    override fun getItemViewType(position: Int): Int {<br/>        return if (messages[position].sender?.uid!!.contentEquals(uid)) {<br/>            SENT<br/>        } else {<br/>            RECEIVED<br/>        }<br/>    }</span><span id="3d93" class="mk kv iq mf b gy mp mm l mn mo">    fun updateMessages(messages: List&lt;BaseMessage&gt;) {<br/>        this.messages = messages.toMutableList()<br/>        notifyDataSetChanged()<br/>    }</span><span id="b2f9" class="mk kv iq mf b gy mp mm l mn mo">    fun appendMessage(message: BaseMessage) {<br/>        this.messages.add(message)<br/>        notifyItemInserted(this.messages.size - 1)<br/>    }</span><span id="7033" class="mk kv iq mf b gy mp mm l mn mo">    inner class MessageViewHolder(itemView: View) : RecyclerView.ViewHolder(itemView) {</span><span id="3cc4" class="mk kv iq mf b gy mp mm l mn mo">        private val messageText: TextView = itemView.findViewById(R.id.message_text)</span><span id="b611" class="mk kv iq mf b gy mp mm l mn mo">        fun bind(message: BaseMessage) {<br/>            if (message is TextMessage) {<br/>                messageText.text = message.text<br/>            }<br/>        }<br/>    }<br/>}</span></pre><p id="f5c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.æ‰“å¼€ä½ çš„<code class="fe mc md me mf b">MessagesActivity.class</code>ï¼Œç²˜è´´ä»¥ä¸‹ä»£ç ã€‚ç¡®ä¿å°†<code class="fe mc md me mf b">roomID</code>å­—æ®µè®¾ç½®ä¸ºâ€œandroidroom â€,è¿™æ˜¯æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„:</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="984e" class="mk kv iq mf b gy ml mm l mn mo">import android.os.Bundle<br/>import android.support.v7.app.AppCompatActivity<br/>import android.support.v7.widget.LinearLayoutManager<br/>import android.support.v7.widget.RecyclerView<br/>import android.util.Log<br/>import android.widget.Button<br/>import android.widget.EditText<br/>import com.cometchat.pro.constants.CometChatConstants<br/>import com.cometchat.pro.core.CometChat<br/>import com.cometchat.pro.exceptions.CometChatException<br/>import com.cometchat.pro.models.TextMessage</span><span id="c6ff" class="mk kv iq mf b gy mp mm l mn mo">class MessagesActivity : AppCompatActivity() {</span><span id="c21c" class="mk kv iq mf b gy mp mm l mn mo">    private lateinit var enterMessage: EditText<br/>    private lateinit var send: Button<br/>    private lateinit var messagesList: RecyclerView<br/>    private lateinit var messagesAdapter: MessagesAdapter</span><span id="4c23" class="mk kv iq mf b gy mp mm l mn mo">    private val roomID = "androidroom"</span><span id="6d67" class="mk kv iq mf b gy mp mm l mn mo">    override fun onCreate(savedInstanceState: Bundle?) {<br/>        super.onCreate(savedInstanceState)<br/>        setContentView(R.layout.activity_messages)</span><span id="627b" class="mk kv iq mf b gy mp mm l mn mo">        enterMessage = findViewById(R.id.enter_message)<br/>        send = findViewById(R.id.send_message)</span><span id="f0f4" class="mk kv iq mf b gy mp mm l mn mo">        messagesList = findViewById(R.id.messages)<br/>        val layoutMgr = LinearLayoutManager(this)<br/>        layoutMgr.stackFromEnd = true<br/>        messagesList.layoutManager = layoutMgr</span><span id="5bc1" class="mk kv iq mf b gy mp mm l mn mo">        messagesAdapter = MessagesAdapter(CometChat.getLoggedInUser().uid, mutableListOf())<br/>        messagesList.adapter = messagesAdapter</span><span id="9560" class="mk kv iq mf b gy mp mm l mn mo">        send.setOnClickListener {<br/>            sendMessage()<br/>        }<br/>        <br/>        joinGroup()<br/>    }</span><span id="0d52" class="mk kv iq mf b gy mp mm l mn mo">    private fun joinGroup() {<br/>        CometChat.joinGroup(<br/>            roomID,<br/>            CometChatConstants.GROUP_TYPE_PUBLIC,<br/>            "",<br/>            object : CometChat.CallbackListener&lt;String&gt;() {<br/>                override fun onSuccess(successMessage: String) {<br/>                    Log.d("CometChat", "Group join successful")<br/>                }</span><span id="9c8b" class="mk kv iq mf b gy mp mm l mn mo">                override fun onError(e: CometChatException) {<br/>                    e.code?.let {<br/>                        // For now, we'll just keep on attempting to join the group<br/>                        // because persistence is out of the scope for this tutorial<br/>                        if (it.contentEquals("ERR_ALREADY_JOINED")) {<br/>                            Log.d("CometChat", "Already joined the group")<br/>                        }<br/>                    }<br/>                }<br/>            })<br/>    }</span><span id="2db0" class="mk kv iq mf b gy mp mm l mn mo">    private fun sendMessage() {<br/>        val textMessage = TextMessage(<br/>            roomID,<br/>            enterMessage.text.toString(),<br/>            CometChatConstants.MESSAGE_TYPE_TEXT,<br/>            CometChatConstants.RECEIVER_TYPE_GROUP<br/>        )</span><span id="0c6c" class="mk kv iq mf b gy mp mm l mn mo">        CometChat.sendMessage(textMessage, object : CometChat.CallbackListener&lt;TextMessage&gt;() {<br/>            override fun onSuccess(message: TextMessage) {<br/>                enterMessage.setText("")<br/>                messagesAdapter.appendMessage(message)<br/>                scrollToBottom()<br/>            }</span><span id="52c0" class="mk kv iq mf b gy mp mm l mn mo">            override fun onError(e: CometChatException) {<br/>                Log.d("CometChat", "Message send failed: ${e.message}")<br/>            }<br/>        })<br/>    }</span><span id="ddce" class="mk kv iq mf b gy mp mm l mn mo">    private fun scrollToBottom() {<br/>        messagesList.scrollToPosition(messagesAdapter.itemCount - 1)<br/>    }<br/>}</span></pre><p id="b36f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ³¨æ„<code class="fe mc md me mf b">joinGroup()</code>åŠŸèƒ½ã€‚</p><p id="9a94" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å¿…é¡»å…ˆåŠ å…¥ç¾¤ï¼Œç„¶åæ‰èƒ½å‘ç¾¤å‘é€æ¶ˆæ¯ã€‚æš‚æ—¶å¿½ç•¥<code class="fe mc md me mf b">onError(â€¦)</code>éƒ¨åˆ†ï¼Œå› ä¸ºæˆ‘ä»¬å°†å°è¯•ç»§ç»­åŠ å…¥è¯¥ç»„ï¼Œå› ä¸ºæŒä¹…æ€§ç°åœ¨è¶…å‡ºäº†æˆ‘ä»¬çš„èŒƒå›´ã€‚</p><p id="b136" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.è¿è¡Œåº”ç”¨ç¨‹åºå¹¶å°è¯•å‘é€æ¶ˆæ¯ã€‚ä½ åº”è¯¥æœ‰è¿™æ ·çš„ä¸œè¥¿ã€‚</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/ee8d59cca8ac36b6b56168aa45173b1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/0*AvQTjyFIL6iJeayC.gif"/></div></figure><p id="5115" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¾ˆæ£’å§ï¼Ÿï¼ğŸ˜‰</p><p id="55e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ã€‚å¦‚æœä½ æŠŠappæ€äº†ï¼Œé‡æ–°ç™»å½•ï¼Œå±å¹•æ˜¯ç©ºçš„ã€‚æˆ‘ä»¬çš„ä¿¡æ¯å»äº†å“ªé‡Œï¼Ÿç»§ç»­ä¸‹ä¸€æ­¥ï¼Œæ‰¾å‡ºç­”æ¡ˆ</p><h1 id="cd27" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">è·å–ä»¥å‰çš„æ¶ˆæ¯</h1><p id="4f9d" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">åœ¨ä¸Šä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå‘é€æ¶ˆæ¯ï¼Œä½†å½“æˆ‘ä»¬å†æ¬¡æ‰“å¼€åº”ç”¨ç¨‹åºæ—¶ï¼Œå±å¹•æ˜¯ç©ºçš„ã€‚</p><p id="fcd9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸è¦æ‹…å¿ƒï¼Œæˆ‘ä»¬çš„æ¶ˆæ¯çœŸçš„å‘é€äº†ï¼Œå®ƒå­˜å‚¨åœ¨CometChatä¸­ã€‚æˆ‘ä»¬åªéœ€è¦ä¸€ç§æ–¹æ³•æ¥è·å–åœ¨ç»„ä¸­å‘é€çš„æ¶ˆæ¯ã€‚</p><p id="7981" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.æ‰“å¼€<code class="fe mc md me mf b">MessagesActivity.class</code>å¹¶æ·»åŠ <code class="fe mc md me mf b">fetchMessages()</code>åŠŸèƒ½</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="57cd" class="mk kv iq mf b gy ml mm l mn mo">class MessagesActivity : AppCompatActivity() {<br/>    ...<br/>    override fun onCreate(savedInstanceState: Bundle?) {<br/>        ...<br/>    }</span><span id="b244" class="mk kv iq mf b gy mp mm l mn mo">    private fun joinGroup() {<br/>        CometChat.joinGroup(<br/>            roomID,<br/>            CometChatConstants.GROUP_TYPE_PUBLIC,<br/>            "",<br/>            object : CometChat.CallbackListener&lt;String&gt;() {<br/>                override fun onSuccess(successMessage: String) {<br/>                    fetchMessages()<br/>                }</span><span id="2850" class="mk kv iq mf b gy mp mm l mn mo">                override fun onError(e: CometChatException) {<br/>                    e.code?.let {<br/>                        // For now, we'll just keep on attempting to join the group<br/>                        // because persistence is out of the scope for this tutorial<br/>                        if (it.contentEquals("ERR_ALREADY_JOINED")) {<br/>                            fetchMessages()<br/>                        }<br/>                    }<br/>                }<br/>            })<br/>    }</span><span id="b654" class="mk kv iq mf b gy mp mm l mn mo">    private fun fetchMessages() {<br/>        val messagesRequest = MessagesRequest.MessagesRequestBuilder()<br/>            .setGUID(roomID)<br/>            .setLimit(30)<br/>            .build()</span><span id="d654" class="mk kv iq mf b gy mp mm l mn mo">        messagesRequest.fetchPrevious(object : CometChat.CallbackListener&lt;List&lt;BaseMessage&gt;&gt;() {<br/>            override fun onSuccess(messages: List&lt;BaseMessage&gt;) {<br/>                messagesAdapter.updateMessages(messages.filter { it is TextMessage })<br/>                scrollToBottom()<br/>            }</span><span id="3b9e" class="mk kv iq mf b gy mp mm l mn mo">            override fun onError(e: CometChatException) {<br/>                Log.d("CometChat", "Fetch messages failed: ${e.message}")<br/>            }<br/>        })<br/>    }<br/>    ...<br/>}</span></pre><p id="ccb4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.è¿è¡Œåº”ç”¨ç¨‹åºï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°æ‚¨ä¸ä¹…å‰å‘é€çš„æ¶ˆæ¯ğŸ‰</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/20ae0c8fcd6d65de69ab5c31148bfa23.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/0*c67OjwQCl0v_TzCq.gif"/></div></figure><p id="4c0c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘çŸ¥é“ä½ åœ¨æƒ³ä»€ä¹ˆã€‚</p><p id="b5f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">â€œè€å…„ï¼Œæˆ‘çŸ¥é“æˆ‘ç°åœ¨å¯ä»¥å‘é€æ¶ˆæ¯å¹¶æŸ¥çœ‹æˆ‘çš„æ¶ˆæ¯äº†ã€‚ä½†è‡ªè¨€è‡ªè¯­ä¼šæœ‰ç‚¹å¥‡æ€ªï¼Œå¯¹å§ï¼Ÿâ€</p><p id="424b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸è¦æ‹…å¿ƒï¼ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•å®æ—¶æ¥æ”¶æ¥è‡ªå…¶ä»–çœŸå®äººç‰©çš„ä¿¡æ¯ï¼</p><h1 id="223b" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">å®æ—¶æ¥æ”¶æ¶ˆæ¯ï¼</h1><p id="5348" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">1.ä¿®æ”¹æˆ‘ä»¬çš„<code class="fe mc md me mf b">MessagesActivity.class</code>ä»¥æ”¶å¬æ–°æ¶ˆæ¯:</p><pre class="km kn ko kp gt mg mf mh mi aw mj bi"><span id="2c0f" class="mk kv iq mf b gy ml mm l mn mo">class MessagesActivity : AppCompatActivity() {<br/>    ...<br/>    private val listenerID = "MESSAGES_LISTENER"</span><span id="34f8" class="mk kv iq mf b gy mp mm l mn mo">    override fun onCreate(savedInstanceState: Bundle?) {<br/>        ...<br/>    }</span><span id="aae8" class="mk kv iq mf b gy mp mm l mn mo">    override fun onResume() {<br/>        super.onResume()<br/>        CometChat.addMessageListener(listenerID, object : CometChat.MessageListener() {<br/>            override fun onTextMessageReceived(message: TextMessage) {<br/>                messagesAdapter.appendMessage(message)<br/>                scrollToBottom()<br/>            }<br/>        })<br/>    }</span><span id="fb15" class="mk kv iq mf b gy mp mm l mn mo">    override fun onPause() {<br/>        super.onPause()<br/>        CometChat.removeMessageListener(listenerID)<br/>    }<br/>    ...<br/>}</span></pre><p id="9222" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å°±è¿™æ ·ï¼Ÿï¼æ˜¯çš„ï¼Œåœ¨CometChatä¸­å®æ—¶æ¥æ”¶å…¶ä»–ç”¨æˆ·çš„æ¶ˆæ¯å°±æ˜¯è¿™ä¹ˆç®€å•ã€‚</p><p id="15f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.åœ¨ä¸¤ä¸ªæ¨¡æ‹Ÿå™¨æˆ–è®¾å¤‡ä¸­è¿è¡Œåº”ç”¨ç¨‹åºã€‚ä»¥â€œç”¨æˆ·1â€çš„èº«ä»½ç™»å½•ç¬¬ä¸€ä¸ªï¼Œä»¥â€œè¶…çº§è‹±é›„1â€çš„èº«ä»½ç™»å½•å¦ä¸€ä¸ªCometChatæä¾›çš„ç¤ºä¾‹ç”¨æˆ·ä¹‹ä¸€ã€‚è¿™æ˜¯ä½ åº”è¯¥çœ‹åˆ°çš„:</p><p id="65bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ­å–œğŸ‰ï¼æ‚¨åˆšåˆšåˆ›å»ºäº†æ‚¨çš„ç¬¬ä¸€ä¸ªAndroidèŠå¤©åº”ç”¨ç¨‹åºï¼ç»™è‡ªå·±ä¸€ä¸ªé¼“åŠ±ã€‚å¥–åŠ±è‡ªå·±ã€‚ä¸ä½ çš„æœ‹å‹åˆ†äº«ï¼Œå¦‚æœä½ æœ‰æ—¶é—´ï¼Œä¹Ÿæ•™ä»–ä»¬å¦‚ä½•åšä¸€ä¸ªã€‚</p><p id="6841" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœä½ å·²ç»åšåˆ°è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬æƒ³è¯´éå¸¸æ„Ÿè°¢ä½ èŠ±æ—¶é—´çœŸæ­£å®Œæˆæ•™ç¨‹ã€‚</p><p id="ae2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å¸Œæœ›ä½ å­¦åˆ°äº†ä¸€äº›ä¸œè¥¿ï¼Œè‡³å°‘å¯¹ä½ ä½œä¸ºAndroidå¼€å‘è€…çš„æ—…ç¨‹æœ‰æ‰€å½±å“ã€‚</p><h1 id="aa68" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">æ¥ä¸‹æ¥å»å“ªé‡Œï¼Ÿ</h1><p id="6281" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">æœ¬æ•™ç¨‹åªæ˜¯ä½ å¯ä»¥ç”¨CometChatåšçš„äº‹æƒ…çš„å†°å±±ä¸€è§’ã€‚ä¸ºäº†æé«˜ä½ çš„æˆç»©ï¼Œè¿™é‡Œæœ‰ä¸€äº›èµ„æºå¯ä»¥å¸®åŠ©ä½ :</p><p id="2725" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kt" href="https://prodocs.cometchat.com/docs/android-quick-start" rel="noopener ugc nofollow" target="_blank"> CometChat Pro Androidæ–‡æ¡£</a></p><p id="87bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¹Ÿå¯ä»¥æŸ¥çœ‹å…¶ä»–å¹³å°çš„CometChat Proã€‚</p><p id="ada4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kt" href="https://prodocs.cometchat.com/docs/ios-quick-start" rel="noopener ugc nofollow" target="_blank"> CometChat Pro iOSæ–‡æ¡£</a></p><p id="e5bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kt" href="https://prodocs.cometchat.com/docs/js-quick-start" rel="noopener ugc nofollow" target="_blank"> CometChat Pro Javascriptæ–‡æ¡£</a></p></div></div>    
</body>
</html>