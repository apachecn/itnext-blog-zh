# è®©æˆ‘ä»¬ä½¿ç”¨ Python æ„å»ºä¸€ä¸ªå®æ—¶æ¯”ç‰¹å¸ä»·æ ¼é€šçŸ¥é¡¹ç›®

> åŸæ–‡ï¼š<https://itnext.io/lets-build-a-real-time-bitcoin-price-notification-project-using-python-daaa7391f71b?source=collection_archive---------0----------------------->

![](img/c82315c28618ee3a6b4e96d5673b032a.png)

ç…§ç‰‡ç”±[å¾·ç±³ç‰¹é‡ŒÂ·å¾·ç±³å¾·ç§‘](https://unsplash.com/@wildbook?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)åœ¨ [Unsplash](https://unsplash.com/s/photos/bitcoin?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) æ‹æ‘„

å¤§å®¶å¥½ï¼Œæˆ‘çŸ¥é“æˆ‘å·²ç»æœ‰ä¸€æ®µæ—¶é—´æ²¡å‘ä¸œè¥¿äº†â€¦ä½†äº‹å®æ˜¯æˆ‘åˆå¸¦ç€å¦ä¸€ä¸ªä»¤äººå…´å¥‹çš„ python é¡¹ç›®å›æ¥äº†ï¼

è¿™ç¯‡æ–‡ç« æœ€åˆå‘è¡¨åœ¨æˆ‘çš„åšå®¢ä¸Šï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°â€”â€”[https://thecodingpie.com/](https://thecodingpie.com/post/lets-build-a-real-time-bitcoin-price-notification-python-project/)

ä½ å¯ä»¥ä»æˆ‘çš„ GitHub repo è·å¾—è¿™ä¸ªé¡¹ç›®çš„å®Œæ•´ä»£ç â€”[https://github.com/the-coding-pie/bitcoin_price_tracker](https://github.com/the-coding-pie/bitcoin_price_tracker)

å¦‚ä»Šï¼ŒåŠ å¯†è´§å¸æ˜¯çƒ­é—¨è¯é¢˜ï¼Œæœ€é‡è¦çš„æ˜¯â€œæ¯”ç‰¹å¸â€ã€‚ä½†é—®é¢˜æ˜¯æ¯”ç‰¹å¸çš„ä»·æ ¼æ³¢åŠ¨å¾ˆå¤§ï¼Œä½ æ°¸è¿œä¸ä¼šçœŸæ­£çŸ¥é“å®ƒæœ€ç»ˆä¼šåœ¨å“ªé‡Œã€‚å¾ˆéš¾è·Ÿè¸ªä¸æ–­å˜åŒ–çš„ BTC ä»·æ ¼ï¼Œä¸æ˜¯å—ï¼Ÿ

å› æ­¤ï¼Œä¸å…¶ä¸æ–­åœ°åœ¨å„ç§ç½‘ç«™ä¸ŠæŸ¥è¯¢æœ€æ–°ä»·æ ¼ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸è®© Python æ¥ä¸ºæˆ‘ä»¬åšè¿™é¡¹å·¥ä½œå‘¢ï¼Ÿï¼

åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ª python è„šæœ¬æ¥è·Ÿè¸ªæœ€æ–°çš„æ¯”ç‰¹å¸ä»·æ ¼ã€‚å®ƒä¼šæ¯ 30 åˆ†é’Ÿç»™ä½ å‘ä¸€æ¡ç”µæŠ¥ä¿¡æ¯(ä½ å¯ä»¥è°ƒæ•´)ï¼Œå‘Šè¯‰ä½ æœ€æ–°çš„ 6 ä¸ªæ¯”ç‰¹å¸ä»·æ ¼(ä½ ä¹Ÿå¯ä»¥è°ƒæ•´)ã€‚æ‚¨å¯ä»¥è®¾ç½®ä¸€ä¸ªæœ€å°çš„`threshold`å€¼ï¼Œè¿™æ ·å¦‚æœ BTC ä»·æ ¼ä½äºè¯¥é˜ˆå€¼ï¼Œé‚£ä¹ˆè„šæœ¬å°†ç«‹å³å‘é€ä¸€æ¡æ˜¾ç¤ºä»·æ ¼çš„è­¦å‘Šæ¶ˆæ¯ã€‚

å¬èµ·æ¥å¾ˆé…·ï¼Œå¯¹å§ï¼Ÿ

# è¦æ±‚

è¦åˆ¶ä½œè¿™ä¸ªè„šæœ¬ï¼Œæ‚¨éœ€è¦ä»¥ä¸‹ä¸œè¥¿:

*   ä¸€ä¸ª[coinmarketcap.com](https://pro.coinmarketcap.com/)API å¯†é’¥ã€‚å› ä¸ºæˆ‘ä»¬è¦åˆ©ç”¨ä»–ä»¬çš„ API æ¥è·å–æœ€æ–°çš„æ¯”ç‰¹å¸ä»·æ ¼ã€‚
*   telegram åº”ç”¨ç¨‹åºï¼Œä»¥åŠæ‚¨çš„å¸æˆ·çš„`chat_id`ã€‚
*   ç„¶åæ˜¯ä¸€ä¸ª[ç”µæŠ¥æœºå™¨äºº](https://core.telegram.org/bots)å’Œå®ƒçš„`token`é’¥åŒ™ã€‚æ²¡æœ‰ botï¼Œæ‚¨å°†æ— æ³•å‘é€ç¼–ç¨‹æ¶ˆæ¯ã€‚ç®€è€Œè¨€ä¹‹ï¼Œ**å¦‚æœä½ æƒ³ä»æˆ‘ä»¬çš„ python è„šæœ¬å‘ä½ çš„ç”µæŠ¥è´¦æˆ·å‘é€ä»·æ ¼é€šçŸ¥ï¼Œé‚£ä¹ˆä½ éœ€è¦ä¸€ä¸ªç”µæŠ¥æœºå™¨äººã€‚**
*   æœ€åæ˜¯ Python3ï¼Œä»¥åŠæ‚¨é€‰æ‹©çš„æ–‡æœ¬ç¼–è¾‘å™¨ã€‚

æˆ‘çŸ¥é“ä½ ä»¬ä¸­çš„å¤§å¤šæ•°äººå¯èƒ½æ²¡æœ‰å‰ä¸‰æ ·ä¸œè¥¿ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘æŠŠè¿™ä¸ªæ•™ç¨‹åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†æ¥ç®€åŒ–ç”Ÿæ´»:

1.  è·å– Coinmarketcap API å¯†é’¥
2.  ç”µæŠ¥æœºå™¨äººå’Œä½ çš„èŠå¤© ID
3.  å°†æ‰€æœ‰ä¸œè¥¿ç»„è£…åœ¨ä¸€èµ·

äº‹ä¸å®œè¿Ÿï¼Œæˆ‘ä»¬å¼€å§‹å§ã€‚

# 1).è·å– Coinmarketcap API å¯†é’¥

Coinmarketcap.com ä¸å†ä¸ºåŒ¿åç”¨æˆ·æä¾›åŠ å¯†è´§å¸æ•°æ®ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ª`API key`æ¥ä½¿ç”¨ä»–ä»¬çš„æœåŠ¡ã€‚å¦‚æœä½ åœ¨ä»–ä»¬çš„ç½‘ç«™ä¸Šæ²¡æœ‰è´¦æˆ·ï¼Œé‚£ä¹ˆå…ˆæ³¨å†Œ[æˆ–ç™»å½•](https://coinmarketcap.com/api/)ã€‚

å½“æ‚¨è¿™æ ·åšæ—¶ï¼Œæ‚¨å°†è¢«å¸¦åˆ°æ‚¨çš„å¸æˆ·æ§åˆ¶é¢æ¿ï¼Œçœ‹èµ·æ¥åƒè¿™æ ·:

![](img/b6919efc8dab8719c4d91fa1eef0eda1.png)

æˆ‘çš„ä»ªè¡¨æ¿

å¦‚ä½ æ‰€è§ï¼Œåœ¨ä½¿ç”¨ä»–ä»¬çš„ API å’Œä»–ä»¬çš„**åŸºæœ¬è®¡åˆ’**æ—¶æœ‰ä¸€ä¸ªé™åˆ¶ã€‚ä½†æ˜¯ä¸€å¤©çš„è¯·æ±‚å¯¹æˆ‘ä»¬æ¥è¯´å¤ªå¤šäº†ï¼å¦‚æœä½ æƒ³ä½¿ç”¨ä»–ä»¬çš„ä»˜è´¹è®¡åˆ’ï¼Œè¯·éšæ„ã€‚

è®°ä½ï¼Œæˆ‘ä»¬åˆ›å»ºè¿™ä¸ªå¸æˆ·æ˜¯ä¸ºäº†è·å¾— Coinmarketcap `API Key`ã€‚ç°åœ¨ï¼Œæ‚¨å¯ä»¥é€šè¿‡å•å‡»é‚£ä¸ª**å¤åˆ¶å¯†é’¥**æŒ‰é’®æ¥è·å¾—å®ƒï¼Œå½“æ‚¨å°†é¼ æ ‡æ‚¬åœåœ¨é‚£ä¸ª **API å¯†é’¥**æ¡†ä¸Šæ—¶ï¼Œè¯¥æŒ‰é’®ä¼šå¼¹å‡ºã€‚

å¤ªæ£’äº†ï¼Œç°åœ¨æˆ‘ä»¬æœ‰äº†è‡ªå·±çš„è´§å¸å¸‚åœºåŸºé‡‘`API Key`ã€‚æŠŠè¿™ä¸€é¡µåšæˆä¹¦ç­¾ï¼Œå› ä¸ºæˆ‘ä»¬ä»¥åä¼šç”¨åˆ°å®ƒã€‚

# 2).ç”µæŠ¥æœºå™¨äººå’Œä½ çš„èŠå¤© ID

åœ¨ç»§ç»­æ­¤æ­¥éª¤ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„æ‰‹æœº/ç”µè„‘ä¸Šå®‰è£…äº† Telegram åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”æ‚¨å·²ç»åˆ›å»ºäº†ä¸€ä¸ªå¸æˆ·ã€‚

ç°åœ¨è°ˆè°ˆé€»è¾‘ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œè¦å‘é€ä¸€æ¡**æ¶ˆæ¯**ï¼Œåº”è¯¥æœ‰ä¸¤ä¸ªå®ä½“ï¼Œ**å‘é€æ–¹**å’Œ**æ¥æ”¶æ–¹**ã€‚è¿™é‡Œçš„**å‘é€è€…**æ˜¯æˆ‘ä»¬å°†è¦åˆ›å»ºçš„æœºå™¨äººï¼Œè€Œ**æ¥æ”¶è€…**æ˜¯**ä½ **æˆ–è€…ï¼Œç¡®åˆ‡åœ°è¯´ï¼Œæ˜¯ä½ çš„`chat_id`ã€‚

çœ‹ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ éœ€è¦è‡ªå·±çš„ç”µæŠ¥`bot`å’Œ T5ã€‚

äº‹å®ä¸Šï¼Œç”µæŠ¥æœºå™¨äººå¤ªæ£’äº†ã€‚ä½ å¯ä»¥ä»ä»–ä»¬çš„å®˜æ–¹æ–‡ä»¶ä¸­äº†è§£æ›´å¤šå…³äºç”µæŠ¥æœºå™¨äººæœ‰å¤šæ£’çš„ä¿¡æ¯ã€‚

# ä½†æ˜¯æˆ‘å¦‚ä½•åˆ›å»ºä¸€ä¸ªæœºå™¨äººå‘¢ï¼Ÿ

åªéœ€ä¸[æœºå™¨äººçˆ¶äº²](https://core.telegram.org/bots#3-how-do-i-create-a-bot)äº¤è°ˆï¼Œå¹¶éµå¾ªå‡ ä¸ªç®€å•çš„æ­¥éª¤ï¼

![](img/036d46dab024c322b66b7633218d2866.png)

æœºå™¨äººçˆ¶äº²æœºå™¨äºº

æœºå™¨äººçˆ¶äº²æ˜¯ç»Ÿæ²»ä»–ä»¬æ‰€æœ‰äººçš„æœºå™¨äººã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥åˆ›å»ºæ–°çš„æœºå™¨äººå¸æˆ·å’Œç®¡ç†ä½ ç°æœ‰çš„æœºå™¨äººã€‚

ç°åœ¨è®©æˆ‘ä»¬åˆ¶ä½œè‡ªå·±çš„æœºå™¨äºº:

*   é¦–å…ˆåœ¨ç”µæŠ¥ app ä¸­æœç´¢ **BotFather** ã€‚ä½ ä¼šçœ‹åˆ°æœºå™¨äººçˆ¶äº²æ—è¾¹æœ‰ä¸€ä¸ªè“è‰²çš„éªŒè¯å‹¾ã€‚
*   ç‚¹å‡»è¿™ä¸ªæœºå™¨äººï¼Œè¾“å…¥æ¶ˆæ¯/å‘½ä»¤`**/newbot**`å¹¶å‘é€å‡ºå»ã€‚`**/newbot**`å‘½ä»¤ç”¨äºåˆ›å»ºæ–°çš„æœºå™¨äººã€‚æ¯å½“ä½ å‘ä¸€ä¸ªæœºå™¨äººè¾“å…¥å‘½ä»¤æ—¶ï¼Œä½ éƒ½åº”è¯¥åœ¨å‘½ä»¤å‰ä½¿ç”¨**æ­£æ–œæ ** ( **/** )ã€‚
*   ç°åœ¨æœºå™¨äººçˆ¸çˆ¸ä¼šè¦æ±‚ä½ æä¾›ä¸€ä¸ª**åå­—**å’Œä¸€ä¸ª**ç”¨æˆ·å**ï¼Œè¯·æä¾›ã€‚
*   ç„¶åï¼Œå®ƒä¼šå‘æ‚¨å‘é€ä¸€æ¡ç¥è´ºæ¶ˆæ¯ï¼Œå…¶ä¸­åŒ…å«æŒ‡å‘æ‚¨çš„æœºå™¨äººçš„é“¾æ¥å’Œæ‚¨çš„æœºå™¨äººçš„æˆæƒä»¤ç‰Œã€‚
*   ç°åœ¨è®©æˆ‘ä»¬**æ¿€æ´»ä½ çš„æœºå™¨äºº**ã€‚ä¸ºæ­¤ï¼Œç‚¹å‡»**æœºå™¨äººçˆ¶äº²**ç»™ä½ çš„æœºå™¨äººçš„**é“¾æ¥:**

![](img/06b64ad5d4466776dd5f2712179c2f2e.png)

æˆ‘çš„æœºå™¨äººçš„é“¾æ¥ã€‚ä½ çš„çœ‹èµ·æ¥ä¼šåƒé‚£æ ·ï¼Œä½†æ˜¯æœ‰ä½ çš„æœºå™¨äººçš„åå­—

*   ç‚¹å‡»é‚£ä¸ªé“¾æ¥ï¼Œå‘é€ä¸€ä¸ª`**/start**`å‘½ä»¤æ¥æ¿€æ´»å®ƒã€‚

å°±è¿™æ ·ï¼Œæ‚¨å·²ç»åˆ›å»ºäº†è‡ªå·±çš„ bot å¹¶æˆåŠŸæ¿€æ´»äº†å®ƒï¼

æ‚¨ä¸ºæ‚¨çš„æœºå™¨äººè·å¾—çš„**ä»¤ç‰Œ**æ˜¯ä¸€ä¸ªç±»ä¼¼äº`110201543:AAHdqTcvCH1vGWJxfSeofSAs0K5PALDsaw`çš„å­—ç¬¦ä¸²ã€‚éœ€è¦è¿™ä¸ª**ä»¤ç‰Œ**æ¥æˆæƒæœºå™¨äººå¹¶å‘[æœºå™¨äºº API](https://core.telegram.org/bots/api) å‘é€è¯·æ±‚ã€‚ä¿æŒä½ çš„ä»¤ç‰Œå®‰å…¨ï¼Œå¹¶å®‰å…¨åœ°å­˜å‚¨å®ƒï¼Œå®ƒå¯ä»¥è¢«ä»»ä½•äººç”¨æ¥æ§åˆ¶ä½ çš„æœºå™¨äººğŸ˜±ã€‚

å‰å®³ï¼ç°åœ¨ä½ æœ‰äº†ä½ çš„æœºå™¨äººï¼Œé‡è¦çš„æ˜¯å®ƒçš„**ä»¤ç‰Œ**å¯†é’¥ã€‚ç•™ç€ä»¥åç”¨ã€‚

# è·å–æ‚¨çš„èŠå¤© id

ä¸‹ä¸€æ­¥æ˜¯è·å¾—ä½ çš„ç”µæŠ¥`chat_id`ã€‚ä½ å¯ä»¥é€šè¿‡ä¸€ä¸ªåä¸º' **IDBot** 'çš„ç°æˆæœºå™¨äººè½»æ¾å®ç°:

*   åœ¨ç”µæŠ¥åº”ç”¨ä¸­æœç´¢â€œ **IDBot** â€ã€‚å®ƒçš„å›¾æ ‡å¦‚ä¸‹æ‰€ç¤º:

![](img/4f49f658003989ebb1540976494704b3.png)

IDBot çš„å›¾æ ‡

*   ç°åœ¨ç‚¹å‡»è¿™ä¸ªæœºå™¨äººï¼Œè¾“å…¥ä¸€æ¡å’Œè¿™ä¸ª`**/getid**`ä¸€æ¨¡ä¸€æ ·çš„æ¶ˆæ¯ã€‚è¿™ä¸ª`**/getid**` å‘½ä»¤ä¼šå¾—åˆ°ä½ çš„`chat_id`ã€‚

åˆç‰›é€¼äº†ï¼ç°åœ¨ä½ æœ‰äº†ä½ çš„`chat_id`ï¼ŒæŠŠå®ƒä¿å­˜åœ¨æŸä¸ªåœ°æ–¹ï¼Œå› ä¸ºæˆ‘ä»¬ä»¥åä¼šéœ€è¦å®ƒã€‚

# 3).å°†æ‰€æœ‰ä¸œè¥¿ç»„è£…åœ¨ä¸€èµ·

ç¡®ä¿ä½ å·²ç»å®‰è£…äº† **Python3.4+** å’Œ **pip3** ã€‚

# åˆå§‹è®¾ç½®

åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å»ºç«‹ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè™šæ‹Ÿç¯å¢ƒï¼Œå’Œæ‰€æœ‰çš„ä¸œè¥¿ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç»ƒä¹ ï¼

*   é¦–å…ˆï¼Œåœ¨ä½ ç”µè„‘çš„ä»»ä½•åœ°æ–¹åˆ›å»ºä¸€ä¸ªåä¸º **bitcoin_tracker** çš„æ–‡ä»¶å¤¹ã€‚
*   ç„¶å**åœ¨ visual studio ä»£ç é‡Œé¢æ‰“å¼€**(æˆ‘ç”¨çš„æ˜¯ vs ä»£ç ä½œä¸ºæˆ‘çš„æ–‡æœ¬ç¼–è¾‘å™¨)ã€‚
*   ç°åœ¨è®©æˆ‘ä»¬**ä½¿ç”¨ **venv** åˆ›å»º**ä¸€ä¸ªæ–°çš„è™šæ‹Ÿç¯å¢ƒï¼Œç„¶å**æ¿€æ´»**å®ƒã€‚ä¸ºæ­¤:
*   åœ¨ä½ çš„æ–‡æœ¬ç¼–è¾‘å™¨ä¸­ï¼Œæ‰“å¼€**ç»ˆç«¯>æ–°ç»ˆç«¯**æˆ–è€…ä½ å¯ä»¥ä½¿ç”¨**å‘½ä»¤è¡Œ**(å¦‚æœä½ åœ¨ windows ä¸Š)æˆ–è€… **bash/zsh** ç»ˆç«¯(åœ¨ Linux/Mac ä¸Š)ã€‚
*   ç„¶åç¡®ä¿ä½ åœ¨**æ¯”ç‰¹å¸è¿½è¸ªå™¨**ç›®å½•ä¸­ï¼Œæˆ–è€…è¯· **cd** è¿›å…¥è¯¥ç›®å½•ï¼Œå¹¶ä»é‚£é‡Œåœ¨**ç»ˆç«¯**ä¸­é”®å…¥ä»¥ä¸‹å‘½ä»¤:

```
python3 -m venv venv
```

è¿™ä¸ªå‘½ä»¤å°†ä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º **venv** çš„è™šæ‹Ÿç¯å¢ƒã€‚

*   è¦æ¿€æ´»å®ƒï¼Œå¦‚æœæ‚¨åœ¨**çª—å£**ä¸Šï¼Œè¯·é”®å…¥ä»¥ä¸‹å†…å®¹:

```
venv\Scripts\activate.bat
```

*   å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ Linux/Mac ç³»ç»Ÿï¼Œè¯·é”®å…¥ä»¥ä¸‹å†…å®¹:

```
source venv/bin/activate
```

ç°åœ¨ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹:

![](img/457f11a3deffdada0889c2a4ad3a706f.png)

è¿™ä¸ªå‰ç¼€æ„å‘³ç€æ‚¨å·²ç»æˆåŠŸæ¿€æ´»äº†è™šæ‹Ÿç¯å¢ƒ

*   æœ€åï¼Œç›´æ¥åœ¨ **bitcoin_tracker** æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºâ€œ **tracker.py** çš„æ–°æ–‡ä»¶ã€‚

ç°åœ¨ï¼Œæ‚¨åº”è¯¥æœ‰ä¸€ä¸ªç±»ä¼¼å¦‚ä¸‹çš„æ–‡ä»¶ç»“æ„:

![](img/ead4460ed1c2f16db0251bf3370a8b3b.png)

**æ³¨æ„**:å¦‚æœä½ ä»ç„¶å¯¹å¦‚ä½•å»ºç«‹ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒæ„Ÿåˆ°å›°æƒ‘ï¼Œé‚£ä¹ˆè¯·é˜…è¯»è¿™ç¯‡[å¿«é€ŸæŒ‡å—](https://thecodingpie.com/post/a-quick-guide-on-how-to-setup-a-python-virtual-environment-windows-linux-mac/)ã€‚

æˆ‘ä»¬å¿…é¡»ä»è¿™ä¸ªè„šæœ¬å‘å‡ºä¸€äº› HTTP è¯·æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåä¸º **requests** çš„ python æ¨¡å—ï¼Œæˆ‘ä»¬æ¥å®‰è£…å®ƒã€‚

åœ¨**ç»ˆç«¯**ä¸­é”®å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œä»¥**å®‰è£…**è¯·æ±‚æ¨¡å—:

```
pip install requests
```

å°±è¿™æ ·ï¼Œç°åœ¨æ˜¯å†™å®é™…è„šæœ¬çš„æ—¶å€™äº†ï¼

# è®©æˆ‘ä»¬å¼€å§‹å§â€¦

æ‰“å¼€ **tracker.py** æ–‡ä»¶å¹¶é”®å…¥:

```
import requests
import time# global variables
api_key = 'your_coinmarketcap_api_key'
bot_token = 'your_telegram_bot_token'
chat_id = 'your_telegram_account_chat_id_here'
threshold = 30000
time_interval = 5 * 60 # in seconds
```

*   åœ¨è¿™é‡Œï¼Œåœ¨æœ€é¡¶ç«¯ï¼Œæˆ‘ä»¬æ­£åœ¨å¯¼å…¥æ‰€éœ€çš„æ¨¡å—ã€‚æˆ‘ä»¬éœ€è¦`requests`æ¨¡å—å‘ Coinmarketcap API å’Œ telegram ç«¯ç‚¹å‘å‡º HTTP è¯·æ±‚ã€‚
*   æˆ‘ä»¬éœ€è¦`time`æ¨¡å—æ¥å»¶è¿Ÿæˆ‘ä»¬çš„ä»£ç (ä½¿ç”¨`sleep()`å‡½æ•°)ã€‚
*   ç„¶åæˆ‘ä»¬è®¾ç½®ä¸€äº›å…¨å±€å˜é‡:
*   `api_key`= ' put _ your _ coin market cap _ API _ key _ here _ which _ we _ first _ obtain '
*   `bot_token`= ' put _ your _ own _ telegram _ bot _ token '
*   `chat_id` = 'put_your_telegram_chat_id '
*   `threshold` =æ”¾æ¯”ç‰¹å¸ä»·æ ¼çš„æœ€ä½é—¨æ§›
*   `time_interval` =ç§’ã€‚è¿™é‡Œæˆ‘ç”¨äº† 5 åˆ†é’Ÿã€‚è¿™æ„å‘³ç€ï¼Œæˆ‘çš„è„šæœ¬å°†æ¯ 5 åˆ†é’Ÿå‘å‡ºä¸€ä¸ª API è¯·æ±‚ï¼Œå¹¶å°†ä»·æ ¼å­˜å‚¨åœ¨ä¸€ä¸ª python åˆ—è¡¨ä¸­ã€‚è¯·è®°ä½ï¼Œä½ æ¯å¤©åªèƒ½æå‡º 333 ä¸ªå…è´¹è¯·æ±‚ã€‚

ç°åœ¨è®©æˆ‘ä»¬åˆ¶ä½œä¸¤ä¸ªå‡½æ•°:

*   ä¸€ä¸ªåä¸º`get_btc_price()`çš„å°†è·å–æœ€æ–°çš„åŠ å¯†è´§å¸ä»·æ ¼ï¼Œä»ä¸­æå–æ¯”ç‰¹å¸ä»·æ ¼ï¼Œç„¶å`return`å®ƒã€‚
*   å¦ä¸€ä¸ªåä¸º`send_message(chat_id, msg)`ï¼Œæ¥å—æˆ‘ä»¬è¦å‘é€çš„`chat_id`å’Œ`msg`ã€‚è¯¥åŠŸèƒ½å°†åˆ©ç”¨ç”µæŠ¥ HTTPS ç«¯ç‚¹å‘æˆ‘ä»¬çš„ç”µæŠ¥è´¦æˆ·å‘é€æ¶ˆæ¯ã€‚

é”®å…¥ä»¥ä¸‹å†…å®¹:

```
def get_btc_price():
    url = '[https://pro-api.coinmarketcap.com/v1/cryptocurrency/listings/latest'](https://pro-api.coinmarketcap.com/v1/cryptocurrency/listings/latest')
    headers = {
        'Accepts': 'application/json',
        'X-CMC_PRO_API_KEY': api_key
    }

    # make a request to the coinmarketcap api
    response = requests.get(url, headers=headers)
    response_json = response.json()# extract the bitcoin price from the json data
    btc_price = response_json['data'][0]
    return btc_price['quote']['USD']['price']
```

*   å‚è§ï¼Œ`â€˜https://pro-api.coinmarketcap.com/v1/cryptocurrency/listings/latest'`æ˜¯è·å–æœ€æ–°åŠ å¯†è´§å¸ä»·æ ¼çš„ API ç«¯ç‚¹ã€‚
*   è®°ä½ä½ å¿…é¡»å‘é€ä½ çš„`api_key`ã€‚æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼ä¹‹ä¸€æä¾›:

1.  é¦–é€‰æ–¹æ³•:é€šè¿‡åä¸º`X-CMC_PRO_API_KEY`çš„è‡ªå®šä¹‰æ ‡é¢˜ã€‚æˆ‘ä»¬ä½¿ç”¨è¿™ç§æ–¹æ³•æ˜¯å› ä¸ºè¿™æ˜¯é¦–é€‰æ–¹æ³•ã€‚
2.  æ–¹ä¾¿çš„æ–¹æ³•:é€šè¿‡ä¸€ä¸ªåä¸º`CMC_PRO_API_KEY`çš„æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°

*   åœ¨æ¥ä¸‹æ¥çš„å‡ è¡Œä¸­ï¼Œæˆ‘ä»¬å‘å‡º GET è¯·æ±‚å¹¶å°†æ•°æ®è½¬æ¢æˆ`json()`æ ¼å¼ã€‚
*   æˆ‘ä»¬ç›®å‰æŒæ¡çš„æ•°æ®åŒ…å«äº†å¤§é‡ä¿¡æ¯ã€‚ä½†æ˜¯æˆ‘ä»¬åªéœ€è¦æ¯”ç‰¹å¸çš„ä»·æ ¼ã€‚è¿™å°±æ˜¯æˆ‘ä»¬åœ¨æœ€åä¸¤è¡Œæ‰€åšçš„ã€‚

API è¿”å›çš„æ•°æ®åœ¨ç»“æ„ä¸Šå¯èƒ½ä¼šä¸æ—¶å˜åŒ–ã€‚å¦‚æœä¸Šé¢çš„ä»£ç æ²¡æœ‰å¾—åˆ°æ¯”ç‰¹å¸ä»·æ ¼ï¼Œé‚£ä¹ˆé€šè¿‡æ‰“å°å˜é‡`response_json`ä¸­çš„å€¼å¹¶æ®æ­¤æ›´æ”¹æœ€åä¸¤è¡Œï¼Œå°è¯•æ‰¾åˆ°æ¯”ç‰¹å¸ä»·æ ¼åœ¨å“ªé‡Œã€‚

ç°åœ¨å¦‚æœæˆ‘ä»¬è°ƒç”¨ä¸Šé¢çš„å‡½æ•°ï¼Œå®ƒä¼š`return`æœ€æ–°çš„æ¯”ç‰¹å¸ä»·æ ¼ï¼

å¤ªæ£’äº†ï¼Œç°åœ¨è®©æˆ‘ä»¬æ„å»º`send_message()`å‡½æ•°:

```
# fn to send_message through telegram
def send_message(chat_id, msg):
    url = f"[https://api.telegram.org/bot{bot_token}/sendMessage?chat_id={chat_id}&text={msg](https://api.telegram.org/bot{bot_token}/sendMessage?chat_id={chat_id}&text={msg)}"# send the msg
    requests.get(url)
```

*   çœ‹ï¼Œä½ åœ¨ä¸Šé¢çœ‹åˆ°çš„`url`æ˜¯æˆ‘ä»¬å¿…é¡»ç”¨æ¥ä»æˆ‘ä»¬çš„æœºå™¨äººå‘æˆ‘ä»¬çš„ç”µæŠ¥å¸æˆ·å‘é€ç”µæŠ¥æ¶ˆæ¯çš„ç«¯ç‚¹ã€‚è¿™é‡Œæˆ‘ä½¿ç”¨äº† [f å­—ç¬¦ä¸²](https://realpython.com/python-f-strings/)ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥æŠŠæˆ‘æƒ³å‘é€çš„`bot_token`ã€`chat_id`å’Œ`msg`è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚
*   ç„¶åæˆ‘ä»¬å‘`url`å‘å‡º GET è¯·æ±‚ï¼Œå¦‚æœæˆ‘ä»¬è¿™æ ·åšäº†ï¼Œä½ å°†åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­æ”¶åˆ°ä¸€æ¡æ¥è‡ªä½ çš„æœºå™¨äººçš„æ¶ˆæ¯ã€‚

ä¸‹ä¸€ä¸ªéš¾é¢˜æ˜¯æŒ‰ç…§æˆ‘ä»¬å¸Œæœ›çš„æ–¹å¼ä½¿ç”¨ä¸Šé¢çš„å‡½æ•°ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª`main()`å‡½æ•°ï¼Œå®ƒå°†è°ƒç”¨ä¸Šè¿°ä¸¤ä¸ªå‡½æ•°:

```
# main fn
def main():
    price_list = []# infinite loop
    while True:
        price = get_btc_price()
        price_list.append(price)# if the price falls below threshold, send an immediate msg
        if price < threshold:
            send_message(chat_id=chat_id, msg=f'BTC Price Drop Alert: {price}')# send last 6 btc price
        if len(price_list) >= 6:
            send_message(chat_id=chat_id, msg=price_list)
            # empty the price_list
            price_list = []# fetch the price for every dash minutes
        time.sleep(time_interval)# fancy way to activate the main() function
if __name__ == '__main__':
    main()
```

*   æˆ‘ä»¬æ­£åœ¨è¿è¡Œä¸€ä¸ªæ— é™å¾ªç¯ï¼Œå®ƒå°†åœ¨ 5 åˆ†é’Ÿ`time_interval`è¿è¡Œã€‚
*   å¯¹äºæ¯ä¸ª`time_interval`ï¼Œæˆ‘ä»¬å°†è°ƒç”¨`get_btc_price()`å‡½æ•°å¹¶å°†ç»“æœå­˜å‚¨åœ¨`price_list`å˜é‡ä¸­ã€‚ä¸€æ—¦å®ƒçš„é•¿åº¦å˜æˆ`>= 6`ï¼Œæˆ‘ä»¬ç”¨æœ€å 6 ä¸ªæ¯”ç‰¹å¸ä»·æ ¼è°ƒç”¨`send_message()`å‡½æ•°ï¼Œç„¶åæ¸…ç©º`price_list`ã€‚
*   å¦‚æœ BTC ä»·æ ¼çªç„¶è·Œç ´`threshold`å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šç«‹å³å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œå‘ŠçŸ¥æœ€æ–°çš„æ¯”ç‰¹å¸ä»·æ ¼ã€‚

å°±è¿™æ ·ï¼Œæˆ‘ä»¬å®Œæˆäº†æˆ‘ä»¬çš„ python è„šæœ¬ï¼å¦‚æœä½ ä¸ç†è§£æœ€å 2 å¥â€œèŠ±é‡Œèƒ¡å“¨â€çš„å°è¯ï¼Œé‚£ä¹ˆå¯¹ä½ æ¥è¯´è¿™æ˜¯ä¸€ä¸ªå°ç»ƒä¹ ã€‚è°·æ­Œé‚£ä¸€è¡Œï¼Œå¹¶æ‰¾å‡ºæˆ‘åœ¨é‚£é‡Œè¯•å›¾åšä»€ä¹ˆï¼

# è®©æˆ‘ä»¬è¿è¡Œå®ƒâ€¦

ç°åœ¨è®©æˆ‘ä»¬è¿è¡Œæˆ‘ä»¬çš„è„šæœ¬ã€‚åœ¨**ç»ˆç«¯**ä¸­ï¼Œè¾“å…¥:

```
python tracker.py
```

å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œé‚£ä¹ˆä½ æ¯ 30 åˆ†é’Ÿå°±ä¼šæ”¶åˆ°ä¸€æ¡ä¿¡æ¯ï¼

å°è¯•è°ƒæ•´`time_limit`å’Œ`threshold`å€¼ä»¥è·å¾—å³æ—¶æ¶ˆæ¯ã€‚ä½†æ˜¯è¦æ—¶åˆ»è®°ä½å…è´¹ API çš„é™åˆ¶ï¼æ‚¨å¯ä»¥åœ¨ä»»ä½•æœåŠ¡å™¨ä¸Šåœ¨çº¿éƒ¨ç½²å®ƒï¼Œå¹¶è·å¾—å®æ—¶é€šçŸ¥ã€‚

# å®Œå…¨ç 

è¿™æ˜¯å®Œæ•´çš„ä»£ç ã€‚å¦‚æœäº‹æƒ…æ²¡æœ‰æŒ‰é¢„æœŸçš„é‚£æ ·è¿è¡Œï¼Œç”¨è¿™ä¸ªæ¥äº¤å‰æ£€æŸ¥ä½ çš„ä»£ç ã€‚

```
import requests
import time# global variables
api_key = 'your_coinmarketcap_api_key'
bot_token = 'your_telegram_bot_token'
chat_id = 'your_telegram_account_chat_id_here'
threshold = 30000
time_interval = 5 * 60 # in secondsdef get_btc_price():
    url = '[https://pro-api.coinmarketcap.com/v1/cryptocurrency/listings/latest'](https://pro-api.coinmarketcap.com/v1/cryptocurrency/listings/latest')
    headers = {
        'Accepts': 'application/json',
        'X-CMC_PRO_API_KEY': api_key
    }

    # make a request to the coinmarketcap api
    response = requests.get(url, headers=headers)
    response_json = response.json()# extract the bitcoin price from the json data
    btc_price = response_json['data'][0]
    return btc_price['quote']['USD']['price']# fn to send_message through telegram
def send_message(chat_id, msg):
    url = f"[https://api.telegram.org/bot{bot_token}/sendMessage?chat_id={chat_id}&text={msg](https://api.telegram.org/bot{bot_token}/sendMessage?chat_id={chat_id}&text={msg)}"# send the msg
    requests.get(url)# main fn
def main():
    price_list = []# infinite loop
    while True:
        price = get_btc_price()
        price_list.append(price)# if the price falls below threshold, send an immediate msg
        if price < threshold:
            send_message(chat_id=chat_id, msg=f'BTC Price Drop Alert: {price}')# send last 6 btc price
        if len(price_list) >= 6:
            send_message(chat_id=chat_id, msg=price_list)
            # empty the price_list
            price_list = []# fetch the price for every dash minutes
        time.sleep(time_interval)# fancy way to activate the main() function
if __name__ == '__main__':
    main()
```

# åŒ…æ‰

æˆ‘å¸Œæœ›ä½ å–œæ¬¢è¿™ä¸ªæ•™ç¨‹ã€‚å¦‚æœä½ æœ‰ä»»ä½•ç–‘é—®ï¼Œè¯·åœ¨ä¸‹é¢è¯„è®ºã€‚è°¢è°¢ä½ ï¼ŒğŸ¥°.