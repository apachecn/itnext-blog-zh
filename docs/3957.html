<html>
<head>
<title>Testing a Virtual List component with Cypress and Storybook</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨Cypresså’ŒStorybookæµ‹è¯•è™šæ‹Ÿåˆ—è¡¨ç»„ä»¶</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/testing-a-virtual-list-component-with-cypress-and-storybook-494dc2d1d26b?source=collection_archive---------2-----------------------#2020-04-01">https://itnext.io/testing-a-virtual-list-component-with-cypress-and-storybook-494dc2d1d26b?source=collection_archive---------2-----------------------#2020-04-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c19c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ¥è‡ªé›†æˆå·¥å…·çš„æŒ‘æˆ˜ã€é›†æˆçš„å½“å‰çŠ¶æ€ä»¥åŠæ­£ç¡®æµ‹è¯•å‘ˆç°ç»„ä»¶çš„ä¸€äº›æœ€ä½³å®è·µã€‚</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/4e3889edb3d9accfe584e2a2f549ddc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oyLjaXq5UXMLZ0upJl5r0Q.jpeg"/></div></div></figure><p id="afaf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘æ­£åœ¨GitHubä¸Šåšä¸€ä¸ªå¤§çš„<a class="ae kx" href="https://github.com/NoriSte/ui-testing-best-practices?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> UIæµ‹è¯•æœ€ä½³å®è·µ</a>é¡¹ç›®ï¼Œæˆ‘åˆ†äº«è¿™ä¸ªå¸–å­æ¥ä¼ æ’­å®ƒå¹¶æœ‰ç›´æ¥çš„åé¦ˆã€‚</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><p id="6f42" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="lf">æ›´æ–°</em> </strong> <em class="lf">:åœ¨è¿™ä¸ªå®éªŒæ–¹æ³•ä¹‹åï¼Œçœ‹çœ‹æˆ‘çš„â€œ</em> <a class="ae kx" href="https://medium.com/@NoriSte/unit-testing-react-components-with-cypress-4d4cf8cd59a0" rel="noopener"> <em class="lf">å•å…ƒæµ‹è¯•ç”¨Cypressçš„Reactç»„ä»¶</em> </a> <em class="lf">â€çš„æ–‡ç« ï¼Œåœ¨Cypress 4.5.0ç‰ˆæœ¬ä¸­äº‹æƒ…å¾—åˆ°äº†ç®€åŒ–å’Œæ›´æœ‰æ•ˆçš„å¤„ç†ï¼</em></p><p id="8a78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="lf">æ›´æ–°2</em></strong><em class="lf">:</em><a class="ae kx" href="https://docs.cypress.io/guides/component-testing/introduction#What-is-Component-Testing" rel="noopener ugc nofollow" target="_blank"><em class="lf">æŸæ ‘7å‡ºå¸¦å…¨æ–°ç»„ä»¶æµ‹è¯•</em> </a> <em class="lf">æ”¯æŒï¼Œçœ‹çœ‹å§ï¼å…¶ä»–æ¿€åŠ¨äººå¿ƒçš„æ¶ˆæ¯æ­£åœ¨è·¯ä¸Šæ„Ÿè°¢</em> <a class="ae kx" href="https://twitter.com/NoriSte/status/1378204109841571840" rel="noopener ugc nofollow" target="_blank"> <em class="lf">æ•…äº‹ä¹¦6.2ç‰ˆ</em> </a> <em class="lf">ï¼</em></p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h2 id="5ed1" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">TLï¼›é€Ÿåº¦ä¸‰è§’å½¢å®šä½æ³•(dead reckoning)</h2><ul class=""><li id="ee7c" class="lz ma iq jp b jq mb ju mc jy md kc me kg mf kk mg mh mi mj bi translated">æ æ†<a class="ae kx" href="https://github.com/NicholasBoll/cypress-storybook" rel="noopener ugc nofollow" target="_blank">æŸæ ‘æ•…äº‹ä¹¦</a>å…è®¸æŸæ ‘åœ¨æ•…äº‹ä¹‹é—´å¿«é€Ÿåˆ‡æ¢</li><li id="cfdb" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">è¿™äº›æ•…äº‹åº”è¯¥æš´éœ²ä¸€äº›å…¨å±€å˜é‡ï¼Œå…è®¸Cypressæ–­è¨€æ•°æ®</li><li id="5168" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">å°½å¯èƒ½åŠ å¿«æµ‹è¯•é€Ÿåº¦ï¼Œç”±äºCypressçš„æ—¶é’Ÿæ§åˆ¶ï¼Œç¤ºä¾‹ä¸­çš„æƒ¯æ€§æ»šåŠ¨ä¸ä¼šè¢«ç­‰å¾…</li><li id="b5c4" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">æƒ³ä¸€æƒ³ï¼Œå¦‚æœæ‚¨æƒ³è¦æµ‹è¯•å‘ˆç°çš„ç»„ä»¶ã€æ•…äº‹ä»£ç ï¼Œæˆ–è€…ä¸¤è€…éƒ½è¦æµ‹è¯•</li><li id="62f2" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">å·¥å…·å°†æ›´åŠ é›†æˆï¼Œç»„ä»¶æµ‹è¯•æ˜¯å½“å‰çš„çƒ­é—¨è¯é¢˜</li></ul></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h2 id="5b2b" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">ä¸ºä»€ä¹ˆè¦éš”ç¦»æµ‹è¯•å…ƒä»¶ï¼Ÿ</h2><p id="d078" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">ç»„ä»¶æ˜¯ä½ çš„åº”ç”¨ç¨‹åºçš„æ„å»ºæ¨¡å—ï¼ŒStorybookå…è®¸ä½ å•ç‹¬æ„å»ºå®ƒä»¬ï¼Œ<strong class="jp ir">æ£€æŸ¥</strong>å®ƒä»¬æ˜¯å¦æ­£å¸¸å·¥ä½œï¼Œå®ƒä»¬æ˜¯å¦ä¸å›¾å½¢å¸ƒå±€ä¸€è‡´ï¼Œæ˜¯å¦ä¸å›¢é˜Ÿçš„å…¶ä»–æˆå‘˜å…±äº«ï¼Œç­‰ç­‰ã€‚Storybookä¸»è¦æ‰§è¡Œä¸¤ç§ç»„ä»¶æ£€æŸ¥:</p><ul class=""><li id="aa87" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">è§†è§‰æµ‹è¯•:ä½¿ç”¨<a class="ae kx" href="https://percy.io/" rel="noopener ugc nofollow" target="_blank"> Percy </a>æˆ–<a class="ae kx" href="https://applitools.com/" rel="noopener ugc nofollow" target="_blank"> Applitools </a>è¿è¡Œï¼Œè¿™ä¸¤ä¸ªå·¥å…·éƒ½å¯ä»¥å¾ˆå®¹æ˜“åœ°ä¸Storybooké›†æˆåœ¨ä¸€èµ·ï¼Œä»¥è‡ªåŠ¨åŒ–è¿™ç§æ£€æŸ¥</li><li id="788a" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">åŠŸèƒ½æµ‹è¯•:åœ¨ç»„ä»¶æ•…äº‹ä¸­æ‰‹å·¥æ‰§è¡Œï¼Œä¸ºä»€ä¹ˆä¸å°†å®ƒä»¬è‡ªåŠ¨åŒ–å‘¢ï¼Ÿè¿™ç¯‡æ–‡ç« è°ˆåˆ°äº†è¿™ä¸€ç‚¹ï¼</li></ul><h2 id="4ca9" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">ç»„ä»¶æµ‹è¯•å·¥å…·</h2><p id="4f2f" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">å½“å‰çš„å‰ç«¯æµ‹è¯•è¶‹åŠ¿æœ‰ä¸¤ä¸ªèµ¢å®¶:<a class="ae kx" href="https://testing-library.com" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> DOMæµ‹è¯•åº“</strong> </a>å’Œ<a class="ae kx" href="https://www.cypress.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">æŸæ ‘</strong> </a>ã€‚å®ƒä»¬æ˜¯ä¸¤ç§å®Œå…¨ä¸åŒçš„å·¥å…·ï¼Œä½†åœ¨æŸäº›æ–¹é¢å®ƒä»¬æœ‰æ‰€é‡å ã€‚DOMæµ‹è¯•åº“æ˜ç¡®åœ°æµ‹è¯•ç»„ä»¶(é€šè¿‡åƒ<a class="ae kx" href="https://jestjs.io/" rel="noopener ugc nofollow" target="_blank"> Jest </a>è¿™æ ·çš„ç¬¬ä¸‰æ–¹æµ‹è¯•è¿è¡Œå™¨)æ˜¯æ­£ç¡®å’Œå¿«é€Ÿçš„æ–¹å¼ï¼Œè¿™æ˜¯éå¸¸å¥½çš„ã€‚Cypressä»¥ä¸€ç§ç®€å•å¯é çš„æ–¹å¼å®ç°äº†æµè§ˆå™¨çš„è‡ªåŠ¨åŒ–ã€‚</p><p id="1453" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºä»€ä¹ˆå®ƒä»¬ä¼šé‡å ï¼Ÿå› ä¸ºä»æŠ€æœ¯ä¸Šæ¥è¯´ï¼Œä½ å¯ä»¥é€šè¿‡DOMæµ‹è¯•åº“æµ‹è¯•æ•´ä¸ªåº”ç”¨ç¨‹åºï¼Œä¹Ÿå¯ä»¥ç”¨Cypressæµ‹è¯•å•ä¸ªç»„ä»¶ã€‚</p><p id="d213" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½¿ç”¨<strong class="jp ir"> DOMæµ‹è¯•åº“</strong>æµ‹è¯•æ•´ä¸ªåº”ç”¨ç¨‹åº:</p><ul class=""><li id="753e" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">åˆ©:å®ƒæ­£åœ¨ç‡ƒçƒ§<strong class="jp ir">å¿«</strong></li><li id="2c1a" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">ç¼ºç‚¹:å®ƒå‘ˆç°HTMLï¼Œä½†æ˜¯HTMLä¸æ˜¯ç”±çœŸæ­£çš„æµè§ˆå™¨å‘ˆç°çš„ï¼Œæ‰€ä»¥<strong class="jp ir">CSSéƒ¨åˆ†ä¸èµ·ä½œç”¨</strong></li><li id="cb9b" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">ç¼ºç‚¹:é˜…è¯»ä¸€ä¸ªå·¨å¤§çš„HTMLè€Œä¸æ˜¯åœ¨æµè§ˆå™¨ä¸­é˜…è¯»ç»“æœå¾ˆéº»çƒ¦</li><li id="cac4" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">ç¼ºç‚¹:ç¬¬ä¸‰æ–¹ç»„ä»¶ä¸èƒ½å®Œå…¨ä¸<a class="ae kx" href="https://github.com/jsdom/jsdom" rel="noopener ugc nofollow" target="_blank"> jsdom </a>ç¯å¢ƒå…¼å®¹ï¼Œæˆ–è€…åœ¨domæµ‹è¯•åº“æ¸²æŸ“æ—¶ä¸èƒ½æŒ‰é¢„æœŸå·¥ä½œ</li></ul><p id="4102" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½¿ç”¨<strong class="jp ir">æŸæ ‘</strong>æµ‹è¯•ç»„ä»¶:</p><ul class=""><li id="7044" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">åˆ©:å®ƒè‡ªåŠ¨åŒ–äº†ä¸€ä¸ªçœŸæ­£çš„æµè§ˆå™¨ï¼Œç»„ä»¶åœ¨ä»–ä»¬å°†è¦ä½¿ç”¨çš„ç›¸åŒç¯å¢ƒä¸­è¢«æµ‹è¯•</li><li id="fcab" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">åˆ©:ä½ å¯ä»¥ç”¨ç”¨æˆ·å°†è¦çœ‹åˆ°/æ¶ˆè´¹ç»„ä»¶çš„æ–¹å¼æ¥æµ‹è¯•ç»„ä»¶</li><li id="0268" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">æ•™æˆ:ä½ å¯ä»¥æ£€æŸ¥ä¸€ä¸‹ä½ çš„æ•…äº‹ä¹¦æ˜¯å¦ä¹Ÿå¾ˆå¥½ç”¨ã€‚ä½ çš„æ•…äº‹çš„ä»£ç å¯èƒ½è¢«çªƒå¬ï¼Œæ‰€ä»¥æ‹¥æœ‰ä¸€äº›å·¥ä½œç»„ä»¶å¹¶ä¸èƒ½ä¿è¯ä½ æœ‰ä¸€æœ¬å·¥ä½œæ•…äº‹ä¹¦ã€‚å›¢é˜Ÿçš„å…¶ä»–æˆå‘˜å¯ä»¥ä¾èµ–Storybookä½œä¸ºå›¢é˜Ÿ/å…¬å¸çš„ç»„ä»¶åº“ã€‚</li><li id="534d" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">ç¼ºç‚¹:å®ƒéœ€è¦ä¸€ä¸ªè¿è¡Œçš„ä¸»æœº/ç½‘ç«™ï¼Œå…è®¸ä½ ä¸ç»„ä»¶æœ¬èº«è¿›è¡Œäº¤äº’(å°±åƒæ•…äº‹ä¹¦ä¸€æ ·)</li><li id="83fb" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">ç¼ºç‚¹:æµ‹è¯•æ•°ç™¾ä¸ªç»„ä»¶å¯èƒ½ä¼šå¾ˆæ…¢</li></ul><p id="c768" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¯·æ³¨æ„:å¯¹äºCypressï¼Œæœ‰ä¸€ä¸ª<a class="ae kx" href="https://testing-library.com/docs/cypress-testing-library/intro" rel="noopener ugc nofollow" target="_blank"> Cypressæµ‹è¯•åº“</a>æ’ä»¶ï¼Œå…è®¸æ‚¨åˆ©ç”¨ç›¸åŒçš„<em class="lf"> findByText </em>ã€<em class="lf"> findByPlaceholderTextã€findByTestId </em>ç­‰ã€‚DOMæµ‹è¯•åº“çš„APIã€‚æˆ‘å–œæ¬¢å®ƒï¼Œæˆ‘æ€»æ˜¯ä½¿ç”¨å®ƒï¼Œä½†ä»–ä»¬åœ¨æŸæ ‘é‡Œé¢å·¥ä½œï¼Œè€Œä¸æ˜¯åœ¨å…¶ä»–æµ‹è¯•è·‘æ­¥è€…èº«ä¸Š</p><h2 id="818f" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">æ—¶ä¸‹çƒ­é—¨è¯é¢˜</h2><p id="656b" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">ç”¨Cypresså’ŒStorybookè¿›è¡Œç»„ä»¶æµ‹è¯•æ˜¯å½“å‰çš„ä¸€ä¸ªçƒ­é—¨è¯é¢˜ï¼Œè¿™é‡Œæœ‰ä¸€äº›è¯æ˜:</p><ul class=""><li id="6439" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">çœ‹çœ‹æ•…äº‹ä¹¦é‡Œçš„è¿™æ¡æ¨æ–‡</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mv"><img src="../Images/f4d043cbc05132c6d77da5905edd57f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nVf6ruvdwgm2yHvwxY-Yjg.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk translated">æ•…äº‹ä¹¦å’Œèµ›æ™®æ‹‰æ–¯ä¼šæ›´èåˆå—ï¼Ÿå¤§æ¦‚â€¦</figcaption></figure><ul class=""><li id="513f" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">çœ‹çœ‹<a class="na nb ep" href="https://medium.com/u/111a108c5d58?source=post_page-----494dc2d1d26b--------------------------------" rel="noopener" target="_blank">è‰¾è¨å…‹Â·æ›¼</a>çš„æ–‡ç« ã€Š<a class="ae kx" href="https://blog.nrwl.io/ui-testing-with-storybook-and-nx-4b86975224c" rel="noopener ugc nofollow" target="_blank"> Nx 8.8:ç°åœ¨ä½ å¯ä»¥ç”¨æ•…äº‹ä¹¦å’ŒæŸæ ‘</a>ç¼–å†™UIæµ‹è¯•ã€‹</li><li id="09e7" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">å¯¹äºCypressï¼Œæœ‰ä¸€ä¸ª<a class="ae kx" href="https://github.com/bahmutov/cypress-react-unit-test" rel="noopener ugc nofollow" target="_blank"> cypress-react-unit-test </a>åº“ï¼Œå®ƒå…è®¸ä½ åœ¨æ²¡æœ‰è¿è¡Œç½‘ç«™çš„æƒ…å†µä¸‹æµ‹è¯•ç»„ä»¶ã€‚æˆ‘åœ¨è¿™é‡Œç©äº†ä¸€ä¸‹<a class="ae kx" href="https://github.com/NoriSte/react-crypto-compare" rel="noopener ugc nofollow" target="_blank"/>ä½†æ˜¯ï¼Œå°½ç®¡æœ‰<a class="ae kx" href="https://github.com/bahmutov" rel="noopener ugc nofollow" target="_blank"> Gleb </a>å’Œ<a class="ae kx" href="https://github.com/dmtrKovalenko" rel="noopener ugc nofollow" target="_blank"> Dmitry </a>æƒŠäººçš„å·¥ä½œ(â¤ï¸)ï¼Œå®ƒè¿˜æ²¡æœ‰å‡†å¤‡å¥½æˆä¸ºä½ çš„ç”Ÿäº§æµ‹è¯•çš„åŸºç¡€ã€‚ä½†æ˜¯è¯·ç»§ç»­å…³æ³¨ï¼Œäº‹æƒ…å¯èƒ½ä¼šå¾ˆå¿«æ”¹å˜ï¼çœ‹çœ‹<a class="ae kx" href="https://twitter.com/bahmutov/status/1240385030461034502" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ªGlebçš„æ¨æ–‡</a></li><li id="6ff5" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">åˆ©ç”¨è‡ªåŠ¨åŒ–æµè§ˆå™¨æ¥æµ‹è¯•æ•…äº‹ä¹¦ç»„ä»¶çš„æƒ³æ³•åœ¨æˆ‘è„‘æµ·ä¸­å·²ç»å­˜åœ¨å¾ˆé•¿æ—¶é—´äº†â€¦ä½†æ˜¯ç¬¬ä¸€ä¸ªå‘æˆ‘å±•ç¤ºçœŸå®æ¡ˆä¾‹çš„æ˜¯<a class="ae kx" href="https://github.com/MakhBeth" rel="noopener ugc nofollow" target="_blank"> Davide Di Pumpo </a>å’Œä»–çš„TestCafÃ¨+Storybook automationğŸ‘</li><li id="ef76" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">Dmitriy Tishinåˆ©ç”¨Storybookå°±åƒä¸€ä¸ªâ€œç»„ä»¶æš´éœ²è€…â€ä»æ•…äº‹ä¸­åˆ†ç¦»ç»„ä»¶æµ‹è¯•ï¼Œçœ‹çœ‹ä»–çš„â€œ<a class="ae kx" rel="noopener ugc nofollow" target="_blank" href="/cypress-storybook-keeping-test-scenario-data-and-component-rendering-in-one-place-c57b23cc1640"> Cypress + Storybookâ€ã€‚å°†æµ‹è¯•åœºæ™¯ã€æ•°æ®å’Œç»„ä»¶å‘ˆç°æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹</a>æ–‡ç« </li></ul><h1 id="0e10" class="nc lh iq bd li nd ne nf ll ng nh ni lo nj nk nl lr nm nn no lu np nq nr lx ns bi translated">ä¸€ä¸ªçœŸå®çš„ä¾‹å­:è™šæ‹Ÿåˆ—è¡¨</h1><p id="c2ff" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">æœ€è¿‘ï¼Œæˆ‘å¼€å‘äº†ä¸€ä¸ªVirtualListç»„ä»¶ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥æ£€æŸ¥Storybookå’ŒCypresså¦‚ä½•ååŒå·¥ä½œã€‚VirtualListæ˜¯ä¸€ä¸ªåªå‘ˆç°å¯è§é¡¹ç›®çš„åˆ—è¡¨ï¼Œä»¥ä¿è¯æœ€é«˜çš„æ€§èƒ½ã€‚çœ‹ä¸€çœ‹<a class="ae kx" href="https://bvaughn.github.io/react-virtualized/#/components/List" rel="noopener ugc nofollow" target="_blank"> Reactè™šæ‹ŸåŒ–</a>æ¥äº†è§£å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚é™¤äº†è™šæ‹ŸåŒ–ï¼Œæˆ‘çš„è™šæ‹Ÿåˆ—è¡¨ç®¡ç†é¡¹ç›®ç‚¹å‡»å’Œé¡¹ç›®å¤šé€‰ã€‚</p><p id="4f0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é™¤äº†è®¸å¤šå•å…ƒæµ‹è¯•ä¹‹å¤–ï¼Œæˆ‘æƒ³è¿è¡Œä¸€äº›ç»„ä»¶æµ‹è¯•ï¼Œä½†æ˜¯å¦‚ä¸Šæ‰€è¿°ï¼Œç¬¬ä¸‰æ–¹åº“(æ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨çš„:<a class="ae kx" href="https://www.npmjs.com/package/react-smooth-scrollbar" rel="noopener ugc nofollow" target="_blank"> React Smooth Scrollbar </a>)ä¸èƒ½å¾ˆå¥½åœ°ä¸<a class="ae kx" href="https://testing-library.com/docs/react-testing-library/intro" rel="noopener ugc nofollow" target="_blank"> Reactæµ‹è¯•åº“</a>(DOMæµ‹è¯•åº“çš„Reactç‰ˆæœ¬)ä¸€èµ·å·¥ä½œï¼Œæ‰€ä»¥Cypressæ˜¯å”¯ä¸€çš„é€‰æ‹©ã€‚</p><h1 id="319a" class="nc lh iq bd li nd ne nf ll ng nh ni lo nj nk nl lr nm nn no lu np nq nr lx ns bi translated">æµ‹è¯•æŒ‘æˆ˜</h1><p id="f521" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">ä½¿ç”¨Cypressæµ‹è¯•Storybookä¸­çš„ç»„ä»¶ï¼Œè€Œä¸æ˜¯è¿è¡Œæ ‡å‡†çš„E2Eæµ‹è¯•ï¼Œæœ€å¤§çš„æŒ‘æˆ˜æ˜¯ä»€ä¹ˆï¼Ÿä¸ä½¿ç”¨<a class="ae kx" href="https://testing-library.com/docs/react-testing-library/intro" rel="noopener ugc nofollow" target="_blank"> Reactæµ‹è¯•åº“</a>(DOMæµ‹è¯•åº“çš„Reactç‰ˆæœ¬)çš„æ ‡å‡†ç»„ä»¶æµ‹è¯•ç›¸æ¯”ï¼Œæœ‰ä»€ä¹ˆæŒ‘æˆ˜ï¼Ÿ</p><h2 id="a7a8" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">æ•°æ®æºæ§ä»¶</h2><p id="3f20" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">ä½¿ç”¨Cypressï¼Œæˆ‘ä»¬ä¹ æƒ¯äºåŠ è½½æ•´ä¸ªåº”ç”¨ç¨‹åºï¼Œé€šè¿‡é™æ€fixtures(åœ¨<a class="ae kx" href="https://medium.com/@NoriSte/component-vs-ui-integration-vs-e2e-tests-f02b575339dc" rel="noopener"> UIé›†æˆæµ‹è¯•</a>çš„æƒ…å†µä¸‹)æ§åˆ¶æ•°æ®ï¼Œæˆ–è€…è¯»å–/æˆªå–åç«¯æ•°æ®(åœ¨<a class="ae kx" href="https://medium.com/@NoriSte/component-vs-ui-integration-vs-e2e-tests-f02b575339dc" rel="noopener"> E2Eæµ‹è¯•</a>çš„æƒ…å†µä¸‹)ï¼Œå¹¶ä½¿ç”¨è¿™äº›æ•°æ®æ¥æ–­è¨€UIæ­£å¸¸å·¥ä½œã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ§åˆ¶ï¼Œæˆ–è€…è‡³å°‘çŸ¥é“ï¼ŒUIå°†è¦ä½¿ç”¨çš„æ•°æ®ã€‚<strong class="jp ir">ä¸çŸ¥é“æ•°æ®å°±æ„å‘³ç€æ²¡æœ‰æ–­è¨€</strong>ã€‚<br/>ä½†æ˜¯åœ¨(æ— çŠ¶æ€)ç»„ä»¶æ•…äº‹ä¸­ï¼Œæ•°æ®æ˜¯ç”±è¡¨ç¤ºæ•…äº‹çš„ç»„ä»¶ç›´æ¥ä¼ é€’ç»™ç»„ä»¶ï¼Œå¹¶å‘ˆç°ç»„ä»¶çš„ã€‚ä¸ºäº†äº†è§£æ•°æ®å¹¶å¯¹æ•…äº‹ç»„ä»¶æ˜¾ç¤ºçš„å†…å®¹åšå‡ºæ­£ç¡®çš„æ–­è¨€ï¼Œ<strong class="jp ir">æ•°æ®éœ€è¦ç”±æ•…äº‹å…¬å¼€ï¼Œå¹¶ç”±Cypress </strong>è¯»å–ã€‚</p><p id="4eb0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¯·æ³¨æ„:å¦‚æœCypressæµ‹è¯•åœ¨æ•…äº‹ç»„ä»¶çš„åŒä¸€ä¸ªå­˜å‚¨åº“ä¸­ï¼Œæ‚¨å¯ä»¥ä»æ•…äº‹æ–‡ä»¶ä¸­å¯¼å…¥æ•°æ®ï¼Œä½†æ˜¯ä¸‹é¢æ˜¾ç¤ºçš„ä¾‹å­æ¥è‡ªä¸åœ¨æ•…äº‹çš„åŒä¸€ä¸ªå­˜å‚¨åº“ä¸­çš„æµ‹è¯•ã€‚</p><h2 id="08ec" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">éšè—å†…å®¹</h2><p id="57c0" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">è™šæ‹Ÿåˆ—è¡¨ä»DOMä¸­åˆ é™¤ä¸å¯è§çš„ç»„ä»¶ã€‚è¿™å¯¹æµ‹è¯•æ„å‘³ç€ä»€ä¹ˆï¼Ÿæˆ‘ä»¬ä¸èƒ½æŒ‡æœ›æ‰€æœ‰çš„å…ƒç´ éƒ½å­˜åœ¨äºHTMLä¸­ã€‚Reactæµ‹è¯•åº“å’ŒCypresséƒ½ä¸èƒ½å®Œå…¨ç†è§£è™šæ‹Ÿåˆ—è¡¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå› ä¸ºä¸€æ—¦ä½ éœ€è¦æ–­è¨€ä¸€ä¸ªå¯è§åŒºåŸŸä¹‹å¤–çš„é¡¹ç›®çš„å­˜åœ¨ï¼Œä½ å°±ä¸èƒ½åˆ©ç”¨é€šå¸¸çš„<em class="lf">cy . contains</em>/<em class="lf">findByTextç­‰ã€‚</em>æ•ˆç”¨:å› ä¸ºç‰©å“æ ¹æœ¬ä¸å­˜åœ¨ã€‚</p><p id="9cba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">VirtualListæ˜¯ä¸€ä¸ªå—æ§ç»„ä»¶ï¼Œå› æ­¤å®ƒé€šçŸ¥çˆ¶ç»„ä»¶å“ªäº›æ˜¯å‘ˆç°çš„é¡¹ç›®ï¼Œå“ªäº›æ˜¯é€‰æ‹©çš„é¡¹ç›®ã€‚åœ¨æ ‡å‡†çš„<a class="ae kx" href="https://medium.com/@NoriSte/component-vs-ui-integration-vs-e2e-tests-f02b575339dc" rel="noopener">ç»„ä»¶æµ‹è¯•</a>ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ–­è¨€ä¸Šä¸‹ä¼ é€’ç»™VirtualListç»„ä»¶çš„é“å…·ï¼Œæ•…äº‹ç›´æ¥æ§åˆ¶è¿™äº›é“å…·ï¼Œä½†æ˜¯ï¼ŒåŒæ ·ï¼ŒCypresséœ€è¦è¯»å–è¿™äº›æ•°æ®ï¼Œæ‰€ä»¥æ•…äº‹å¿…é¡»å…¬å¼€å®ƒã€‚</p><h2 id="c1d8" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">æˆ‘ä»¬æ˜¯åœ¨æµ‹è¯•æ•…äº‹è¿˜æ˜¯ç»„ä»¶ï¼Ÿ</h2><p id="d57f" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">å·®åˆ«å¯èƒ½å¾ˆå¾®å¦™ã€‚å› ä¸ºVirtualListæ˜¯ä¸€ä¸ªå—æ§ç»„ä»¶ï¼Œæ‰€ä»¥storyç»„ä»¶æ§åˆ¶å®ƒã€‚æ•…äº‹ç»„ä»¶å†…éƒ¨çš„æ§åˆ¶é€»è¾‘æ˜¯è¦æµ‹è¯•çš„ä¸œè¥¿çš„ä¸€éƒ¨åˆ†ï¼Ÿæ§åˆ¶éƒ¨ä»¶å’Œè¢«æ§åˆ¶éƒ¨ä»¶æ˜¯å¯åˆ†ç¦»çš„å—ï¼Ÿå¤§æ¦‚ä¸ä¼šã€‚</p><p id="32e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸€ä¸ªæ ‡å‡†æµ‹è¯•æœ‰ä¸¤ä¸ªå‚ä¸è€…â€”â€”æµ‹è¯•è¿è¡Œè€…å’Œå—æ§ç»„ä»¶â€”â€”è€Œä½¿ç”¨å¸¦æœ‰Storybookçš„Cypressæœ‰ä¸‰ä¸ªå‚ä¸è€…â€”â€”æµ‹è¯•è¿è¡Œè€…ã€æ•…äº‹å’Œå—æ§ç»„ä»¶ã€‚å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªç»„ä»¶æµ‹è¯•æ§åˆ¶äº†ç»„ä»¶ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥è®¿é—®å›è°ƒæ•°æ®ï¼ŒCypresséœ€è¦storyçš„ç»„ä»¶æ‰èƒ½æ­£å¸¸å·¥ä½œã€‚</p><h2 id="1920" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">æ»šåŠ¨å’Œå‘ˆç°é¡¹ç›®æ§ä»¶</h2><p id="cb15" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">VirtualListç»„ä»¶åˆ©ç”¨äº†ä¸€ä¸ªæƒ¯æ€§æ»šåŠ¨æ¡ï¼Œå¹¶ä¸”ç”±äºstoryæ·»åŠ äº†æ•°åƒä¸ªè¦å‘ˆç°çš„é¡¹ç›®æ¥å……åˆ†å±•ç¤ºVirtualListçš„æ½œåŠ›ï¼Œå› æ­¤å®ƒåªæœ‰ä¸€ä¸ªå¾ˆå°çš„æ»šåŠ¨æ¡å¥æŸ„ã€‚æ»šåŠ¨è™šæ‹Ÿåˆ—è¡¨å¯èƒ½ä¼šå¯¼è‡´æµ‹è¯•å’Œä¸‹ä¸€ä¸ªæµ‹è¯•ä¹‹é—´å‘ˆç°çš„é¡¹ç›®ç•¥æœ‰ä¸åŒã€‚æ‰€ä»¥æˆ‘æƒ³å½“ç„¶åœ°è®¤ä¸ºï¼Œä¸€æ—¦åˆ—è¡¨æ»šåŠ¨ï¼Œæˆ‘ä»¬æ— æ³•é¢„å…ˆçŸ¥é“å“ªäº›æ¡ç›®å°†è¢«å‘ˆç°(ä¾‹å¦‚ä»ç¬¬100åˆ°ç¬¬110æˆ–ä»ç¬¬101åˆ°ç¬¬111)ã€‚</p><p id="3347" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºæˆ‘è®¨åŒåŸºäºè„†å¼±å‡è®¾çš„è„†å¼±æµ‹è¯•ã€‚æµ‹è¯•ä¸åº”è¯¥è¢«è®¾è®¡æˆæŠµæŠ—æ¯ä¸€ä¸ªå¯èƒ½çš„å˜åŒ–ï¼Œä½†æ˜¯å®ƒä»¬å¿…é¡»è¶³å¤Ÿå¥å£®ä»¥ç»å—ä½å°çš„å˜åŒ–ã€‚å¯¹äºVirtualListæµ‹è¯•ï¼Œè¿™æ„å‘³ç€ä¸€æ—¦æ»šåŠ¨ï¼Œå‘ˆç°çš„é¡¹ç›®å°†ç›´æ¥ä»HTMLé¡¹ç›®ä¸­æ£€ç´¢ã€‚æˆ‘ä»¬ç¨åå°†æ·±åŒ–å®ƒã€‚</p><h1 id="a413" class="nc lh iq bd li nd ne nf ll ng nh ni lo nj nk nl lr nm nn no lu np nq nr lx ns bi translated">è¯·è¯´å¯†ç </h1><p id="ad70" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">æˆ‘ä»¬è¦ç¼–å†™çš„ç¬¬ä¸€ä¸ªæµ‹è¯•éœ€è¦æ£€æŸ¥åˆ—è¡¨æ˜¯å¦æ”¶åˆ°äº†10000ä¸ªæ¡ç›®ï¼Œæ˜¯å¦åªå‘ˆç°äº†å…¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚è¿™æ˜¯è™šæ‹Ÿåˆ—è¡¨çš„åŸºæœ¬ç‰¹æ€§ã€‚</p><p id="3bb3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é¦–å…ˆï¼ŒRenderItemç»„ä»¶ï¼Œå®ƒåªæ˜¯äº¤æ›¿ä½¿ç”¨é¢œè‰²æ¥ç›´è§‚åœ°æ ‡è¯†è¡Œ</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="a659" class="lg lh iq nu b gy ny nz l oa ob">// every `item` is an { id: string, name: string}</span><span id="ef63" class="lg lh iq nu b gy oc nz l oa ob">const getItemText = item =&gt; `id: ${item.id} - ${item.name}`</span><span id="f5f1" class="lg lh iq nu b gy oc nz l oa ob">const RenderItem = ({ item }) =&gt; {<br/>  return (<br/>    &lt;div<br/>      style={{<br/>        height: '30px',<br/>        backgroundColor: parseInt(item.id) % 2 ? '#FAFAFA' : '#EEE',<br/>      }}<br/>    &gt;<br/>      {getItemText(item)}<br/>    &lt;/div&gt;<br/>  )<br/>}</span></pre><p id="6bb3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬è¦ç ”ç©¶çš„åŸå§‹æ•…äº‹å¦‚ä¸‹</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="f2c8" class="lg lh iq nu b gy ny nz l oa ob">// `getStoryItems` allows to create a high amount of items, it's used by every story</span><span id="bf06" class="lg lh iq nu b gy oc nz l oa ob">export const With10000Items = () =&gt; {<br/>  return (<br/>    &lt;&gt;<br/>      &lt;h4&gt;The scroll must be fluid&lt;/h4&gt;<br/>      &lt;VirtualList<br/>        items={getStoryItems({ amount: 10000 })}<br/>        getItemHeights={() =&gt; 30}<br/>        RenderItem={RenderItem}<br/>        listHeight={300}<br/>      /&gt;<br/>    &lt;/&gt;<br/>  )<br/>}<br/>With10000Items.story = {<br/>  name: 'With 10000 items',<br/>}</span></pre><p id="f124" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬éœ€è¦æ”¹ç¼–è¿™ä¸ªæ•…äº‹ï¼Œåœ¨å…¨çƒèŒƒå›´å†…æ›å…‰:</p><ul class=""><li id="c43c" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated"><code class="fe od oe of nu b">items</code>æ•°ç»„:Cypressæµ‹è¯•éœ€è¦çŸ¥é“ç”¨æ¥å¡«å……åˆ—è¡¨çš„æ•°æ®</li><li id="5849" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated"><code class="fe od oe of nu b">getItemText</code>å‡½æ•°:å› æ­¤Cypressæµ‹è¯•é¿å…äº†å…³å¿ƒå¦‚ä½•ä»ä¸€ä¸ªé¡¹ç›®ä¸­è·å¾—å‘ˆç°çš„æ–‡æœ¬ã€‚Cypresséœ€è¦å°†é¡¹ç›®è½¬æ¢ä¸ºæ–‡æœ¬æ¥ä»æ–‡æœ¬ä¸­æ£€ç´¢æ¸²æŸ“é¡¹ç›®ï¼Œé¿å…ä½¿ç”¨<code class="fe od oe of nu b">data-test</code>å±æ€§</li><li id="2f11" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">å¯è§é¡¹çš„æ•°é‡:Cypressæµ‹è¯•éœ€è¦æ–­è¨€å“ªäº›é¡¹è¢«å‘ˆç°ï¼Œå“ªäº›é¡¹æ²¡æœ‰è¢«å‘ˆç°</li></ul><p id="c776" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸‹é¢æ˜¯æ›´æ–°åçš„æ•…äº‹ï¼Œå®ƒé€šè¿‡ä¸€ä¸ªå…¨å±€<code class="fe od oe of nu b">storyData</code>å˜é‡æ¥å…¬å¼€å˜é‡ï¼Œè¿™ä¸ªå˜é‡å°†è¢«Cypressæµ‹è¯•æ”¶é›†å’Œä½¿ç”¨:</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="1b76" class="lg lh iq nu b gy ny nz l oa ob">export const With10000Items = () =&gt; {<br/>  const itemHeight = 30<br/>  const listHeight = 300<br/>  const items = React.useMemo(<br/>    () =&gt; getStoryItems({ amount: 10000 }),<br/>    [],<br/>  )<br/>  <br/>  // exposing data for Cypress<br/>  React.useEffect(() =&gt; {<br/>    // global is `window`<br/>    global.storyData = {<br/>      items,<br/>      visibleItemsAmount: Math.ceil(listHeight / itemHeight),<br/>      getItemText,<br/>    }<br/>  }, [items])</span><span id="9e51" class="lg lh iq nu b gy oc nz l oa ob">return (<br/>    &lt;&gt;<br/>      &lt;h4&gt;The scroll must be fluid&lt;/h4&gt;<br/>      &lt;VirtualList<br/>        items={items}<br/>        getItemHeights={() =&gt; itemHeight}<br/>        RenderItem={RenderItem}<br/>        listHeight={listHeight}<br/>      /&gt;<br/>    &lt;/&gt;<br/>  )<br/>}<br/>With10000Items.story = {<br/>  name: 'With 10000 items',<br/>}</span></pre><h2 id="db32" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">æŸæ ‘è¯•éªŒ</h2><p id="a474" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">æµ‹è¯•å°†ä¼š:</p><ul class=""><li id="6294" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">è®¿é—®æ•…äº‹ä¹¦é¡µé¢</li><li id="d6f7" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">æ”¶é›†æš´éœ²çš„æ•°æ®</li><li id="faa8" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">æ£€æŸ¥æ¸²æŸ“çš„é¡¹ç›®</li></ul><p id="accf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å‰ä¸¤ç‚¹çš„ä»£ç </p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="25f3" class="lg lh iq nu b gy ny nz l oa ob">it('When the component receives 10000 items, then only the minimum number of items are rendered', () =&gt; {<br/>  cy.visit('/iframe.html?id=virtuallist--with-10000-items')</span><span id="a264" class="lg lh iq nu b gy oc nz l oa ob">  cy.window()<br/>    .its('storyData')<br/>    .should(storyData =&gt; {<br/>      // the story must expose some variables<br/>      expect(storyData.items).to.be.to.have.length(10000)<br/>      expect(storyData.visibleItemsAmount).to.be.greaterThan(0)<br/>      expect(storyData.getItemText).to.be.a('function')<br/>    })<br/>    .then(() =&gt; {<br/>      // the test code<br/>    })<br/>})</span></pre><p id="0a0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºä»€ä¹ˆå¯¹æ›å…‰çš„<code class="fe od oe of nu b">storyData</code>æ–­è¨€ï¼Ÿå› ä¸ºä¸€ä¸ªé”™è¯¯çš„<code class="fe od oe of nu b">storyData</code>ä¼šè®©æµ‹è¯•å¤±è´¥ï¼Œå¦‚æœä¸€ä¸ªæµ‹è¯•å¤±è´¥äº†ï¼Œå®ƒä¸€å®šä¼šç›´æ¥æŠŠæˆ‘ä»¬æ¨å‘é—®é¢˜ã€‚å¦‚æœç»„ä»¶æ¸²æŸ“ç”±äºé”™è¯¯çš„<code class="fe od oe of nu b">storyData</code>è€Œå¤±è´¥ï¼Œæˆ‘ä»¬çš„æµ‹è¯•æ ¹æœ¬å°±ä¸åº”è¯¥è¿è¡Œã€‚è¿™å¯è¢«è§†ä¸º<strong class="jp ir">ä¸æ•°æ®ç›¸å…³çš„å†’çƒŸæµ‹è¯•</strong>ã€‚</p><p id="39fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨ï¼Œæµ‹è¯•ç¼ºå°‘çš„éƒ¨åˆ†:æ£€æŸ¥å“ªäº›é¡¹ç›®è¢«æ¸²æŸ“ï¼Œå“ªäº›æ²¡æœ‰</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="11a4" class="lg lh iq nu b gy ny nz l oa ob">it('When the component receives 10000 items, then only the minimum number of items are rendered', () =&gt; {<br/>  cy.visit('/iframe.html?id=virtuallist--with-10000-items')</span><span id="f879" class="lg lh iq nu b gy oc nz l oa ob">cy.window()<br/>    .its('storyData')<br/>    .should(storyData =&gt; {<br/>      // the story must expose some variables<br/>      expect(storyData.items).to.be.to.have.length(10000)<br/>      expect(storyData.visibleItemsAmount).to.be.greaterThan(0)<br/>      expect(storyData.getItemText).to.be.a('function')<br/>    })<br/>    .then(({ visibleItemsAmount, getItemText, items }) =&gt; {<br/>      // items visibility check<br/>      const visibleItems = items.slice(0, visibleItemsAmount - 1)<br/>      visibleItems.forEach(item =&gt; {<br/>        cy.findByText(getItemText(item)).should('be.visible')<br/>      })</span><span id="a75a" class="lg lh iq nu b gy oc nz l oa ob">      // first not-rendered item check<br/>      cy.findByText(getItemText(items[visibleItemsAmount]))<br/>        .should('not.exist')<br/>    })<br/>})</span></pre><ul class=""><li id="6458" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">æˆ‘ä»¬ä½¿ç”¨æš´éœ²çš„<code class="fe od oe of nu b">visibleItemsAmount</code>å˜é‡æ¥æ£€ç´¢å‘ˆç°çš„é¡¹ç›®</li></ul><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="0c3d" class="lg lh iq nu b gy ny nz l oa ob">const visibleItems = items.slice(0, visibleItemsAmount - 1)</span></pre><ul class=""><li id="334d" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">æˆ‘ä»¬ä½¿ç”¨å…¬å¼€çš„<code class="fe od oe of nu b">getItemText</code>å‡½æ•°ä»é¡µé¢ä¸­æ£€ç´¢æ¯ä¸€é¡¹</li></ul><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="b470" class="lg lh iq nu b gy ny nz l oa ob">cy.findByText(getItemText(item))</span></pre><ul class=""><li id="ae7d" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">æˆ‘ä»¬æ–­è¨€æ‰€æœ‰é¢„æœŸå¯è§çš„é¡¹ç›®</li></ul><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="1a0e" class="lg lh iq nu b gy ny nz l oa ob">cy.findByText(getItemText(item)).should('be.visible')</span></pre><ul class=""><li id="a475" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">æˆ‘ä»¬æ–­è¨€é¡µé¢ä¸­ä¸å­˜åœ¨ä¸‹ä¸€é¡¹</li></ul><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="798b" class="lg lh iq nu b gy ny nz l oa ob">cy.findByText(getItemText(items[visibleItemsAmount]))<br/>  .should('not.exist')</span></pre><p id="50a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¯·æ³¨æ„<code class="fe od oe of nu b">cy.findByText</code> Cypresså‘½ä»¤æ¥è‡ªâ€¦ <a class="ae kx" href="https://testing-library.com/docs/cypress-testing-library/intro" rel="noopener ugc nofollow" target="_blank"> Cypressæµ‹è¯•åº“</a>ğŸ˜Šè¿™æ˜¯æˆ‘æœ€å–œæ¬¢çš„ä»é¡µé¢ä¸­æ£€ç´¢å…ƒç´ çš„æ–¹æ³•ï¼Œå› ä¸ºå®ƒåƒç”¨æˆ·ä¸€æ ·:ä»æ–‡æœ¬å†…å®¹ä¸­è¯»å–/æ£€ç´¢å…ƒç´ ã€‚æˆ‘ç”¨å®ƒæ¥ä»£æ›¿<code class="fe od oe of nu b">cy.contains</code>ï¼Œä½†å®ƒä»¬åšçš„æ˜¯åŒæ ·çš„äº‹æƒ…ã€‚</p><p id="e832" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™æ˜¯ç»“æœ:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi og"><img src="../Images/874f2a87227d6788318d7d5117540b3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48QqeCsFnky5obJKZ0on1w.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk translated">ç¬¬ä¸€ä¸ªæµ‹è¯•çš„ç»“æœ:åŠ è½½çš„æ•…äº‹å’Œæ‰€æœ‰æ–­è¨€çš„ç»“æœã€‚</figcaption></figure><p id="9fe2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™ä¸ªæµ‹è¯•è¶³ä»¥æ£€æŸ¥è™šæ‹Ÿåˆ—è¡¨åªå‘ˆç°æœ€å°‘æ•°é‡çš„é¡¹ç›®ã€‚</p><p id="1acb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ€åˆï¼Œæˆ‘è¯•å›¾æ£€æŸ¥è™šæ‹Ÿåˆ—è¡¨æ»šåŠ¨æ—¶æµè§ˆå™¨æ˜¯å¦ä»¥60 FPSçš„é€Ÿåº¦è¿è¡Œã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸º<strong class="jp ir">UIæµ‹è¯•å¿…é¡»æ£€æŸ¥ç”¨æˆ·çœ‹åˆ°äº†ä»€ä¹ˆï¼Œä½¿ç”¨ä¸ç”¨æˆ·ç›¸åŒçš„UI</strong>ã€‚ä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œè™šæ‹Ÿåˆ—è¡¨çš„å”¯ä¸€ç›®æ ‡æ˜¯å®ƒå¿…é¡»æµç•…åœ°è¿è¡Œï¼Œä¸ç®¡åˆ—è¡¨ä¸­æœ‰å¤šå°‘é¡¹ã€‚ä½†æ˜¯å¯é åœ°æµ‹é‡FPSæ˜¯å›°éš¾çš„ï¼Œå› ä¸ºæµ‹é‡ä¼šå—åˆ°ä»¥ä¸‹å› ç´ çš„å½±å“:</p><ul class=""><li id="b9e3" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">ä½ ä½¿ç”¨çš„Cypresså‘½ä»¤:æ¯ä¸ªCypressçš„åŠ¨ä½œéƒ½ä¼šé™ä½æµè§ˆå™¨çš„é€Ÿåº¦</li><li id="c7c4" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">æœºå™¨(æˆ–Dockeræ˜ åƒ)å¯ç”¨äºè¿è¡Œæµ‹è¯•çš„èµ„æºæ•°é‡</li></ul><p id="2ae0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å› ä¸ºä¸å¯èƒ½æœ‰å¯é çš„è®¡æ•°â€”ä¸€äº›åˆå§‹å€¼å°†è¢«ä¸¢å¼ƒï¼Œç­‰ç­‰ã€‚â€”æˆ‘ç§»åŠ¨ä»¥æ£€æŸ¥æ¸²æŸ“é¡¹ç›®çš„æ•°é‡ï¼Œä»…æ­¤è€Œå·²ã€‚å¦‚æœæˆ‘èƒ½ç¡®å®š10000ä¸ªæ¡ç›®ä¸­åªæœ‰10ä¸ªè¢«æ¸²æŸ“ï¼Œæˆ‘å°±èƒ½ç¡®å®šè¿™ä¸ªåˆ—è¡¨è¿è¡Œæµç•…ã€‚æ›´ä¸€èˆ¬çš„:è®°ä½<strong class="jp ir">ä¸€ä¸ªè„†å¼±çš„æµ‹è¯•æ¯”ä¸€ä¸ªç¼ºå¤±çš„æµ‹è¯•æ›´ç³Ÿç³•</strong>ã€‚</p><h1 id="9086" class="nc lh iq bd li nd ne nf ll ng nh ni lo nj nk nl lr nm nn no lu np nq nr lx ns bi translated">ç¬¬äºŒä¸ªæµ‹è¯•:æ»šåŠ¨</h1><p id="38c2" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">é¦–å…ˆ:VirtualListç»„ä»¶åˆ©ç”¨äº†<a class="ae kx" href="https://idiotwu.github.io/smooth-scrollbar/" rel="noopener ugc nofollow" target="_blank">å¹³æ»‘æ»šåŠ¨æ¡</a>ï¼Œå¹³æ»‘æ»šåŠ¨æ¡æœ‰è‡ªå·±çš„æµ‹è¯•ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†æ£€æŸ¥æˆ‘ä»¬çš„VirtualListç»„ä»¶å¦‚ä½•å¯¹æ»šåŠ¨åšå‡ºååº”ï¼Œä½†æˆ‘ä»¬è®¤ä¸ºå¹³æ»‘æ»šåŠ¨æ¡æ˜¯ç†æ‰€å½“ç„¶çš„ã€‚å½“ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“æ—¶ï¼Œä½ ä¸éœ€è¦æµ‹è¯•åº“æ˜¯å¦å·¥ä½œã€‚åº“<strong class="jp ir">åº”è¯¥æœ‰è‡ªå·±çš„æµ‹è¯•</strong>ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±æ¢åº“ï¼æ°¸è¿œä¸è¦ä¸ºç¬¬ä¸‰æ–¹åº“ç¼–å†™æµ‹è¯•ã€‚</p><p id="97ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ»šåŠ¨æµ‹è¯•å°†:</p><ul class=""><li id="bcba" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">è§¦å‘æ»šåŠ¨</li><li id="5cf1" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">ç­‰åˆ°æ»šåŠ¨ç»“æŸ</li><li id="f720" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">æ£€æŸ¥æ¸²æŸ“çš„é¡¹ç›®</li></ul><p id="ea0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å› æ­¤ï¼Œè§¦å‘æ»šåŠ¨çš„æµ‹è¯•ä»£ç å¦‚ä¸‹</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="c3ba" class="lg lh iq nu b gy ny nz l oa ob">// triggers the wheel event<br/>cy.findByTestId('VirtualList').trigger('wheel', {<br/>  deltaX: 0,<br/>  deltaY: 1000,<br/>})</span></pre><p id="694b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ³¨æ„ï¼ŒVirtusListç»„ä»¶åº”è¯¥å‘ˆç°ä¸€ä¸ªå¸¦æœ‰<code class="fe od oe of nu b">data-test="VirtualList"</code>å±æ€§çš„DOMå…ƒç´ ã€‚å…¶ä½™çš„ç”±Cypressç®¡ç†ï¼Œ<code class="fe od oe of nu b">trigger</code>æ˜¯å¯¹<a class="ae kx" href="https://api.jquery.com/trigger/" rel="noopener ugc nofollow" target="_blank"> jQueryè§¦å‘å™¨API </a>çš„ç›´æ¥æ˜ å°„(Cypressåˆ©ç”¨jQueryå°½å¯èƒ½ç¼©çŸ­æµ‹è¯•ä»£ç )ã€‚å†è¯´ä¸€æ¬¡:æŸæ ‘åœ¨å½“åœ°ç›¸å½“äº<code class="fe od oe of nu b">cy.findByTestId('VirtualList')</code>çš„æ˜¯<code class="fe od oe of nu b">cy.get('[data-testid=VirtualList]')</code>ã€‚</p><p id="65c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¯¹äºâ€œç­‰åˆ°æ»šåŠ¨ç»“æŸâ€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨<a class="ae kx" href="https://github.com/NoriSte/cypress-wait-until" rel="noopener ugc nofollow" target="_blank"> Cypress waitUntil </a>æ’ä»¶ã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬åº”è¯¥ä½¿ç”¨waitUntilæ’ä»¶è€Œä¸æ˜¯ç­‰å¾…ä¸€æ®µå›ºå®šçš„æ—¶é—´åœ¨<a class="ae kx" href="https://medium.com/@NoriSte/await-do-not-sleep-your-e2e-tests-df67e051b409" rel="noopener"> Awaitï¼Œdo not make your E2Eæµ‹è¯•ç¡çœ </a>ä¸€æ–‡ä¸­æœ‰è¯¦ç»†çš„è§£é‡Šã€‚<br/>å®šåˆ¶ç­‰å¾…çš„ä»£ç æ˜¯</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="9ecf" class="lg lh iq nu b gy ny nz l oa ob">// waits until the scrollbar handle stops<br/>let scrollbarHandleY = Number.NEGATIVE_INFINITY<br/>cy.get('.scrollbar-thumb-y')<br/>  .waitUntil(<br/>    $scrollbarHandle =&gt; {<br/>      const [newY, previousY] = [<br/>        $scrollbarHandle.offset().top,<br/>        scrollbarHandleY,<br/>      ]<br/>      scrollbarHandleY = newY<br/>      return previousY === newY<br/>    },<br/>    {<br/>      customMessage: 'The inertial scroll ends',<br/>    },<br/>  )</span></pre><p id="5ff0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‰€ä»¥æˆ‘ä»¬ç¡®ä¿¡æµ‹è¯•ä¼šç­‰å¾…é€‚å½“çš„æ—¶é—´ã€‚</p><h2 id="b511" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">æ£€æŸ¥æ¸²æŸ“çš„é¡¹ç›®</h2><p id="bb05" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæ„æ€æ˜¯:</p><ul class=""><li id="16dd" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">æŸ¥æ‰¾ç¬¬ä¸€ä¸ªæ¸²æŸ“é¡¹ç›®</li><li id="08a7" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">æ£€æŸ¥ç¬¬ä¸€ä¸ªå‘ˆç°çš„é¡¹ç›®ä¸æ˜¯ç¬¬ä¸€ä¸ªã€‚è™šæ‹Ÿåˆ—è¡¨å¼€å§‹å‘ˆç°0åˆ°10ä¸ªé¡¹ç›®ã€‚ä¸€æ—¦æ»šåŠ¨ï¼Œå®ƒå¿…é¡»å‘ˆç°ç¬¬xåˆ°ç¬¬x+10é¡¹ã€‚æˆ‘ä»¬ä¸çŸ¥é“Xçš„å€¼ï¼Œæˆ‘ä»¬ä¹Ÿä¸å…³å¿ƒè¿™ä¸ªï¼Œå¦åˆ™ï¼Œæˆ‘ä»¬å°†æŠŠæµ‹è¯•ä¸å‘ˆç°çš„é¡¹ç›®è”ç³»èµ·æ¥ã€‚å¦‚æœç¬¬ä¸€ä¸ªæ¸²æŸ“çš„é¡¹ç›®æ˜¯ç¬¬60ä¸ªæˆ–ç¬¬61ä¸ªå¹¶ä¸é‡è¦ã€‚æ£€æŸ¥å‡†ç¡®å‘ˆç°çš„é¡¹ç›®è¶…å‡ºäº†è¿™ä¸ªé€šç”¨æ»šåŠ¨æµ‹è¯•çš„èŒƒå›´ã€‚æµ‹è¯•ç¨³å®šæ€§æ„Ÿè°¢æˆ‘ä»¬ã€‚</li><li id="ad92" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">ä¸€æ—¦æ£€ç´¢åˆ°ç¬¬ä¸€ä¸ªå‘ˆç°çš„é¡¹ç›®ï¼Œæˆ‘ä»¬æ£€æŸ¥æ¥ä¸‹æ¥çš„åä¸ªé¡¹ç›®æ˜¯å¦éƒ½è¢«å‘ˆç°äº†</li></ul><p id="1fdf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å°†ä»”ç»†æ£€æŸ¥æ¯ä¸€ä¸ªæ­¥éª¤ï¼Œæµ‹è¯•çš„æœ€ç»ˆä»£ç å¦‚ä¸‹(è¯·ç»§ç»­æŸ¥çœ‹å¯è¯»æ€§æ›´å¥½çš„ç‰ˆæœ¬)</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="135d" class="lg lh iq nu b gy ny nz l oa ob">it('When the component is scrolled, then the rendered items are not the first ones', () =&gt; {<br/>  cy.visit('/iframe.html?id=virtuallist--with-10000-items')</span><span id="e643" class="lg lh iq nu b gy oc nz l oa ob">  cy.window()<br/>    .its('storyData')<br/>    .should(storyData =&gt; {<br/>      // the story must expose some variables<br/>      expect(storyData.items).to.be.to.have.length(10000)<br/>      expect(storyData.visibleItemsAmount).to.be.greaterThan(0)<br/>      expect(storyData.getItemText).to.be.a('function')<br/>    })<br/>    .then(({ visibleItemsAmount, getItemText, items }) =&gt; {<br/>      // triggers the wheel event<br/>      cy.findByTestId('VirtualList').trigger('wheel', {<br/>        deltaX: 0,<br/>        deltaY: 1000,<br/>      })</span><span id="6b94" class="lg lh iq nu b gy oc nz l oa ob">      // waits until the scrollbar handle stops<br/>      let scrollbarHandleY = Number.NEGATIVE_INFINITY<br/>      cy.get('.scrollbar-thumb-y')<br/>        .waitUntil(<br/>          $scrollbarHandle =&gt; {<br/>            const [newY, previousY] = [<br/>              $scrollbarHandle.offset().top,<br/>              scrollbarHandleY,<br/>            ]<br/>            scrollbarHandleY = newY<br/>            return previousY === newY<br/>          },<br/>          {<br/>            customMessage: 'The inertial scroll ends',<br/>          },<br/>        )<br/>        // (manually) looks for the first rendered element<br/>        .then(() =&gt;<br/>          items.findIndex(<br/>            item =&gt; !!Cypress.$(`*:contains("${getItemText(item)}")`).length,<br/>          ),<br/>        )<br/>        // checks that the rendered items are not the initially rendered ones<br/>        .should('be.greaterThan', 10)<br/>        // checks the rendered items<br/>        .then(firstVisibleItemIndex =&gt; {<br/>          const visibleItems = items.slice(<br/>            firstVisibleItemIndex,<br/>            firstVisibleItemIndex + visibleItemsAmount - 1,<br/>          )<br/>          visibleItems.forEach(item =&gt;<br/>            cy.findByText(getItemText(item)).should('be.visible'),<br/>          )<br/>        })<br/>    })<br/>})</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oh"><img src="../Images/86625799bb0f2a3a37b62374a768ed12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D3v4NTubPVrbaVEsCMeuVQ.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk translated">ç”±äºMediumä¸ç®¡ç†ä»£ç æ ¼å¼çš„æ–¹å¼å’Œä½¿ç”¨GitHub Gistsæ˜¯ä¸å®é™…çš„ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª<a class="ae kx" href="https://carbon.now.sh/" rel="noopener ugc nofollow" target="_blank"> Carbon </a>ç‰ˆæœ¬çš„ç›¸åŒä»£ç ã€‚</figcaption></figure><p id="b354" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é€æ­¥:æ£€ç´¢ç¬¬ä¸€ä¸ªå‘ˆç°é¡¹ç›®çš„ä»£ç æ˜¯</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="917c" class="lg lh iq nu b gy ny nz l oa ob">items.findIndex(<br/>  item =&gt; !!Cypress.$(`*:contains("${getItemText(item)}")`).length,<br/>)</span></pre><p id="9d5a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºä»€ä¹ˆä¸åˆ©ç”¨<code class="fe od oe of nu b">cy.findByText</code>å‘½ä»¤æ¥æ£€ç´¢å®ƒå‘¢ï¼Ÿå› ä¸ºåœ¨Cypressä¸­ï¼Œæ¯ä¸ª<code class="fe od oe of nu b">cy.get</code>å‘½ä»¤(è¿™æ˜¯<code class="fe od oe of nu b">cy.findByText</code>å‘½ä»¤çš„æ ¸å¿ƒ)éƒ½æœ‰å†…ç½®æ–­è¨€ï¼Œ<a class="ae kx" href="https://docs.cypress.io/api/commands/get.html#Assertions" rel="noopener ugc nofollow" target="_blank">åœ¨å®˜æ–¹æ–‡æ¡£ä¸­æ£€æŸ¥å®ƒä»¬</a>ã€‚å®è´¨ä¸Šï¼Œå¦‚æœé¡µé¢ä¸Šä¸å­˜åœ¨è¯¥å…ƒç´ ï¼Œ<code class="fe od oe of nu b">cy.get</code>ä¼šä½¿æµ‹è¯•å¤±è´¥ã€‚ä½†æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦éå†æœªæ¸²æŸ“çš„é¡¹ç›®ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ¸²æŸ“çš„é¡¹ç›®ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥æ‰‹åŠ¨è¿›è¡Œã€‚<code class="fe od oe of nu b">Cypress.$</code>æ˜¯jQueryçš„ä¸€ä¸ªå…¨å±€å®ä¾‹ï¼Œä¸€ä¸ªjQueryç‰ˆæœ¬çš„<code class="fe od oe of nu b">cy.findByText("XXX")</code>æ˜¯<code class="fe od oe of nu b">Cypress.$(`*:contains("XXX")`)</code>å¹¶ä¸”ï¼ŒjQueryç‰ˆæœ¬çš„</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="df32" class="lg lh iq nu b gy ny nz l oa ob">cy.findByText("XXX").should("exist")</span></pre><p id="b049" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ˜¯</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="2119" class="lg lh iq nu b gy ny nz l oa ob">!!Cypress.$(`*:contains("XXX")`).length</span></pre><p id="858e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œå¦‚æœå…ƒç´ ä¸å­˜åœ¨ï¼Œå®ƒä¸ä¼šå¤±è´¥ã€‚å¦‚å‰æ‰€è¿°:æˆ‘ä¹ æƒ¯äºåˆ©ç”¨<code class="fe od oe of nu b">cy.getByText</code>ï¼Œä½†åŸç”Ÿ<code class="fe od oe of nu b">cy.contains</code>åšåŒæ ·çš„äº‹æƒ…ï¼</p><p id="3436" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸€æ—¦æ‰¾åˆ°ç¬¬ä¸€ä¸ªå‘ˆç°é¡¹ç›®çš„ç´¢å¼•ï¼Œæˆ‘ä»¬åªéœ€è¦æ£€æŸ¥æ¥ä¸‹æ¥çš„å‘ˆç°é¡¹ç›®ã€‚</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="39bb" class="lg lh iq nu b gy ny nz l oa ob">.then(() =&gt;<br/>  items.findIndex(<br/>    item =&gt; !!Cypress.$(`*:contains("${getItemText(item)}")`).length,<br/>  )<br/>)<br/>// checks that the rendered items are not the initially rendered ones<br/>.should('be.greaterThan', 10)<br/>// checks the rendered items<br/>.then(firstVisibleItemIndex =&gt; {<br/>  const visibleItems = items.slice(<br/>    firstVisibleItemIndex,<br/>    firstVisibleItemIndex + visibleItemsAmount - 1,<br/>  )<br/>  visibleItems.forEach(item =&gt;<br/>    cy.findByText(getItemText(item)).should('be.visible'),<br/>  )<br/>})</span></pre><p id="1e47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™æ˜¯æµ‹è¯•çš„å½•éŸ³</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="919d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä¸å…³å¿ƒæœ€ååŠå¯è§çš„é¡¹ç›®ã€‚æµ‹è¯•çš„èŒƒå›´æ˜¯æ£€æŸ¥å‘ˆç°çš„é¡¹ç›®ä¸æ˜¯ç¬¬ä¸€ä¸ªï¼Œå¹¶ä¸”è‡³å°‘å‘ˆç°äº†10ä¸ªé¡¹ç›®ï¼Œç¬¬11ä¸ªé¡¹ç›®ä¸éœ€è¦æ£€æŸ¥ã€‚</p><p id="2ce1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å¯ä»¥å°†æµ‹è¯•çš„æ»šåŠ¨éƒ¨åˆ†è½¬ç§»åˆ°ä¸€ä¸ªç‹¬ç«‹çš„å·¥å…·ä¸­ï¼Œç±»ä¼¼äº</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="b69f" class="lg lh iq nu b gy ny nz l oa ob">const scrollVirtualList = ($list, deltaY = 1000) =&gt; {<br/>  cy.wrap($list)<br/>    .trigger('wheel', {<br/>      deltaX: 0,<br/>      deltaY,<br/>    })<br/>    .within(() =&gt; {<br/>      // waits for the inertial scroll end<br/>      let scrollbarY = Number.NEGATIVE_INFINITY<br/>      getScrollbar().waitUntil(<br/>        $scrollbar =&gt; {<br/>          const newY = $scrollbar.offset().top<br/>          const previousY = scrollbarY<br/>          scrollbarY = newY<br/>          return previousY === newY<br/>        },<br/>        {<br/>          customMessage: 'The inertial scroll end',<br/>        },<br/>      )<br/>    })<br/>}</span></pre><p id="d0fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å¯ä»¥ç”¨åŒæ ·çš„æ–¹æ³•æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ¸²æŸ“çš„é¡¹ç›®</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="5d96" class="lg lh iq nu b gy ny nz l oa ob">const getFirstRenderedItemIndex = (items, getItemText) =&gt; {<br/>  return items.findIndex(<br/>    item =&gt; !!Cypress.$(`*:contains("${getItemText(item)}")`).length,<br/>  )<br/>}</span></pre><p id="aad0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æµ‹è¯•çš„å¯è¯»æ€§å¾—ç›Šäºè¿™ç§åˆ†ç¦»ï¼Œè¯·çœ‹ä¸€ä¸‹</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="ef90" class="lg lh iq nu b gy ny nz l oa ob">it('When the component is scrolled, then the rendered items are not the first ones', () =&gt; {<br/>  cy.visit('/iframe.html?id=virtuallist--with-10000-items')</span><span id="9b84" class="lg lh iq nu b gy oc nz l oa ob">cy.window()<br/>    .its('storyData')<br/>    .should(storyData =&gt; {<br/>      // the story must expose some variables<br/>      expect(storyData.items).to.be.to.have.length(10000)<br/>      expect(storyData.visibleItemsAmount).to.be.greaterThan(0)<br/>      expect(storyData.getItemText).to.be.a('function')<br/>    })<br/>    .then(({ visibleItemsAmount, getItemText, items }) =&gt; {<br/>      cy.findByTestId('VirtualList')<br/>        // we leverage the new `scrollVirtualList` function<br/>        .then(scrollVirtualList)<br/>        .then(() =&gt; getFirstRenderedItemIndex(items, getItemText))<br/>        .should('be.greaterThan', 10)<br/>        .then(firstVisibleItemIndex =&gt; {<br/>          const visibleItems = items.slice(<br/>            firstVisibleItemIndex,<br/>            firstVisibleItemIndex + visibleItemsAmount - 1,<br/>          )<br/>          visibleItems.forEach(item =&gt;<br/>            cy.findByText(getItemText(item)).should('be.visible'),<br/>          )<br/>        })<br/>    })<br/>})</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi oh"><img src="../Images/a760d942531e545d6b093b71b156dfe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WjRKt1oLT2zd6QY4shX_dg.png"/></div></div></figure><h1 id="f94a" class="nc lh iq bd li nd ne nf ll ng nh ni lo nj nk nl lr nm nn no lu np nq nr lx ns bi translated">ç¬¬ä¸‰é¡¹æµ‹è¯•:é€‰æ‹©</h1><p id="abe3" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">VirtualListç»„ä»¶é€šè¿‡æŒ‰é”®ä¿®é¥°ç¬¦æ”¯æŒé€‰æ‹©å’Œ<strong class="jp ir">å¤šé¡¹é€‰æ‹©ã€‚æˆ‘ä»¬åªéœ€è¦å•å‡»é¡¹ç›®ï¼Œå•å‡»å¸¦æœ‰æŒ‰é”®ä¿®é¥°ç¬¦çš„é¡¹ç›®ï¼Œå¹¶æ£€æŸ¥å“ªäº›æ˜¯é€‰ä¸­çš„é¡¹ç›®ã€‚æ˜¯ä»€ä¹ˆè®©è¿™äº›æ“ä½œå˜å¾—å›°éš¾ï¼Ÿ</strong></p><ul class=""><li id="609a" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">é¦–å…ˆ:â€œé€‰ä¸­â€æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œä¸€ä¸ªé€‰ä¸­çš„é¡¹ç›®æ˜¯ä¸€ä¸ªâ€œçªå‡ºæ˜¾ç¤ºâ€çš„é¡¹ç›®ï¼Œä½†æ£€æŸ¥å…ƒç´ çš„æ ·å¼æ˜¯è–„å¼±çš„ã€‚æˆ‘ä»¬å¯ä»¥ç»™ç»„ä»¶æ·»åŠ ä¸€ä¸ª<code class="fe od oe of nu b">data-selected</code>å±æ€§â€¦</li><li id="1b75" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">â€¦ä½†æ˜¯æœ‰ä¸€ä¸ªç»“æ„é—®é¢˜:è¿™äº›é¡¹ç›®æ ¹æœ¬æ— æ³•å‘ˆç°ï¼å¦‚æœæˆ‘ä»¬å•å‡»ç¬¬ä¸€ä¸ªé¡¹ç›®(ä»ç¬¬1ä¸ªåˆ°ç¬¬10ä¸ªé¡¹ç›®)ï¼Œç„¶åæˆ‘ä»¬æ»šåŠ¨å¤§çº¦20ä¸ªé¡¹ç›®(ä»ç¬¬21ä¸ªåˆ°ç¬¬30ä¸ªé¡¹ç›®)ï¼Œæˆ‘ä»¬å•å‡»ä¸­é—´çš„é¡¹ç›®(ç¬¬25ä¸ªé¡¹ç›®)å¹¶æŒ‰SHIFTï¼Œé€‰æ‹©çš„é¡¹ç›®åº”è¯¥æ˜¯ä»ç¬¬1ä¸ªåˆ°ç¬¬25ä¸ªï¼Œä½†æ˜¯å‰20ä¸ªæ²¡æœ‰è¢«æ¸²æŸ“ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½é€šè¿‡æ¸²æŸ“çš„é¡¹ç›®æ¥æ£€ç´¢é€‰æ‹©çš„é¡¹ç›®ã€‚åŒæ ·ï¼Œ<strong class="jp ir">æˆ‘ä»¬å°†ä½¿ç”¨æ•…äº‹</strong>æ‰€æ­ç¤ºçš„å˜é‡</li></ul><p id="fec4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™æ˜¯æ•…äº‹çš„ä»£ç </p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="680b" class="lg lh iq nu b gy ny nz l oa ob">export const WithSelectionManagement = () =&gt; {<br/>  const items = getStoryItems({ amount: 10000 })</span><span id="ef0b" class="lg lh iq nu b gy oc nz l oa ob">const [selectedItems, setSelectedItems] = React.useState(<br/>    [],<br/>  )</span><span id="106a" class="lg lh iq nu b gy oc nz l oa ob">const handleSelect = React.useCallback(<br/>    ({ newSelectedIds }) =&gt; setSelectedItems(newSelectedIds),<br/>    [setSelectedItems],<br/>  )<br/>  <br/>  // exposing data for Cypress<br/>  React.useEffect(() =&gt; {<br/>    global.storyData = {<br/>      items,<br/>      getItemText,<br/>      selectedItems,<br/>    }<br/>  }, [items, selectedItems])</span><span id="0e5e" class="lg lh iq nu b gy oc nz l oa ob">  return (<br/>    &lt;&gt;<br/>      &lt;h4&gt;<br/>        The buttons must be clickable, the CTRL/CMD, ALT, SHIFT                  <br/>        keyboard modifiers must work<br/>      &lt;/h4&gt;<br/>      &lt;VirtualList<br/>        items={items}<br/>        selectedItemIds={selectedItems}<br/>        getItemHeights={() =&gt; 30}<br/>        RenderItem={createSelectableRenderItem({ height: 30 })}<br/>        listHeight={300}<br/>        onSelect={handleSelect}<br/>      /&gt;<br/>    &lt;/&gt;<br/>  )<br/>}</span></pre><p id="d7cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å› ä¸ºVirtualListç»„ä»¶æ˜¯å—æ§çš„ï¼Œæ‰€ä»¥å®ƒå‘ä¸Šä¼ é€’æ‰€é€‰é¡¹çš„åˆ—è¡¨â€”â€”<code class="fe od oe of nu b">selectedItems</code>æ•°ç»„ã€‚çˆ¶ç»„ä»¶â€”â€”storyâ€”â€”å…¬å¼€Cypressçš„æ•°ç»„ï¼Œä»¥å…è®¸æ–­è¨€é€‰å®šçš„é¡¹ç›®ã€‚<br/>è¯·æ³¨æ„:å¸¦æœ‰ç‚¹å‡»ç®¡ç†çš„ç»„ä»¶åˆ›å»ºå·²è¢«ç§»è‡³ä¸“ç”¨çš„é«˜é˜¶åŠŸèƒ½:<code class="fe od oe of nu b">createSelectableRenderdItem</code>ã€‚</p><p id="5289" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é€‰æ‹©å•ä¸ªé¡¹ç›®çš„æµ‹è¯•å¦‚ä¸‹</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="0ff1" class="lg lh iq nu b gy ny nz l oa ob">it('When the items are clicked, then they are selected', () =&gt; {<br/>  cy.visit('/iframe.html?id=virtuallist--with-selection-management')</span><span id="f372" class="lg lh iq nu b gy oc nz l oa ob">  cy.window()<br/>    .its('storyData')<br/>    .should(storyData =&gt; {<br/>      // the story must expose some variables<br/>      expect(storyData.items).to.be.to.have.length.of.at.least(3)<br/>      expect(storyData.getItemText).to.be.a('function')<br/>      expect(storyData.selectedItems).to.be.an('array')<br/>    })<br/>    .then(({ getItemText, items }) =&gt; {<br/>      cy.findByText(getItemText(items[0]))<br/>        .click()<br/>        .window()<br/>        .its('storyData.selectedItems')<br/>        .should('eql', [items[0].id])</span><span id="baef" class="lg lh iq nu b gy oc nz l oa ob">      cy.findByText(getItemText(items[1]))<br/>        .click()<br/>        .window()<br/>        .its('storyData.selectedItems')<br/>        .should('eql', [items[1].id])<br/>    })<br/>})</span></pre><p id="942f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‰€æœ‰çš„æ–­è¨€éƒ½åœ¨æš´éœ²çš„<code class="fe od oe of nu b">selectedItems</code>æ•°ç»„æœ¬èº«ä¸Šã€‚æˆ‘ä»¬ä¸æ£€æŸ¥æ¸²æŸ“çš„é¡¹ç›®æ˜¯å¦é«˜äº®æ˜¾ç¤º(é«˜äº®æ˜¾ç¤ºé¡¹ç›®æ˜¯ç”±æ•…äº‹åˆ›å»ºçš„ç»„ä»¶è´Ÿè´£çš„)ï¼Œè€Œåªæ£€æŸ¥VirtualListç»„ä»¶æ˜¯å¦æ­£ç¡®åœ°ç®¡ç†é¡¹ç›®ç‚¹å‡»ã€‚</p><p id="d50c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe od oe of nu b">selectedItems</code>æ•°ç»„ä¸æ˜¯åœ¨å¼€å§‹æ—¶è¯»å–ï¼Œè€Œæ˜¯åœ¨æ¯æ¬¡ç‚¹å‡»åè¯»å–ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦æ£€æŸ¥çš„æ€»æ˜¯æ›´æ–°çš„æ•°ç»„ï¼Œè€Œä¸æ˜¯å¯¹åˆå§‹æ•°ç»„çš„å¼•ç”¨(<code class="fe od oe of nu b">React.useState</code>è¿”å›<code class="fe od oe of nu b">selectedItems</code>ï¼Œæ‰€ä»¥æ¯æ¬¡é€‰æ‹©æ›´æ–°åå®ƒéƒ½æ˜¯æ–°çš„)ã€‚</p><h2 id="a949" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">å¤šé€‰æ–­è¨€</h2><p id="34a1" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">ä¸‹ä¸€æ­¥æ˜¯æ£€æŸ¥VirtualListç»„ä»¶æ˜¯å¦æ­£ç¡®åœ°ç®¡ç†äº†å…ƒé”®çš„ä½¿ç”¨ã€‚åœ¨æŒ‰ä¸‹metaé”®çš„åŒæ—¶å•å‡»å¦ä¸€ä¸ªé¡¹ç›®åº”è¯¥ä¼šäº§ç”Ÿä¸¤ä¸ªé€‰å®šçš„é¡¹ç›®ã€‚</p><p id="f6d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å¦‚ä½•ä¿æŒå…ƒé”®ä¸æŸæ ‘æŒ‰ä¸‹ï¼Ÿè¿™æ˜¯å…¬æ­£çš„</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="04b4" class="lg lh iq nu b gy ny nz l oa ob">cy.get('body')<br/>  // keeping pressed the meta (CMD) key<br/>  .type('{meta}', { release: false })</span><span id="412d" class="lg lh iq nu b gy oc nz l oa ob">// ...your test code...</span><span id="bd43" class="lg lh iq nu b gy oc nz l oa ob">cy.get('body')<br/>  // releasing the meta (CMD) key<br/>  .type('{meta}', { release: true })</span></pre><p id="519e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ·»åŠ é¡¹clickå°†å¯¼è‡´</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="ae6e" class="lg lh iq nu b gy ny nz l oa ob">cy.get('body')<br/>  // keeping pressed the meta (CMD) key<br/>  .type('{meta}', { release: false })<br/>  .findByText(getItemText(items[2]))<br/>  .click()<br/>  .window()<br/>  .its('storyData.selectedItems')<br/>  .should('eql', [items[1].id, items[2].id])<br/>  .get('body')<br/>  // releasing the meta (CMD) key<br/>  .type('{meta}', { release: true })</span><span id="9c04" class="lg lh iq nu b gy oc nz l oa ob">  cy.get('body')<br/>      .type('{shift}', { release: false })<br/>      .findByText(getItemText(firstRenderedItem))<br/>      .click()<br/>      .window()<br/>      .its('storyData.selectedItems')<br/>      .should('eql', expectedSelectedItemIds)<br/>      .get('body')<br/>      .type('{shift}', { release: true })<br/>  })</span></pre><p id="7f71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™æ˜¯ç»“æœçš„æˆªå›¾</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi og"><img src="../Images/9bd64d885e4f35a878b1efa923efdf8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qM1lpjVFqwjMqffo0A8yFA.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk translated">æµ‹è¯•çš„ç¬¬ä¸€ä¸ªç»“æœ:åŠ è½½çš„æ•…äº‹å’Œæ‰€æœ‰æ–­è¨€çš„ç»“æœã€‚</figcaption></figure><h2 id="2890" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">æ»šåŠ¨å’Œé€‰æ‹©</h2><p id="0c63" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">ç”±äºæœ‰äº†<code class="fe od oe of nu b">scrollVirtualList</code>å·¥å…·ï¼Œæ»šåŠ¨åˆ—è¡¨å˜å¾—å¾ˆå®¹æ˜“ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªå‘ˆç°çš„é¡¹ç›®æ˜¯ç”±<code class="fe od oe of nu b">getFirstRenderedItemIndex</code>å·¥å…·å®Œæˆçš„ï¼Œæˆ‘ä»¬çŸ¥é“å¦‚ä½•ä¿æŒä¸€ä¸ªé”®è¢«æŒ‰ä¸‹â€¦å› æ­¤ï¼Œæµ‹è¯•æ»šåŠ¨å’Œç”¨Shiftä¿®é¥°ç¬¦å•å‡»(è¿™æ„å‘³ç€ä»ä¸Šä¸€ä¸ªè¢«å•å‡»çš„å…ƒç´ å’Œæœ€åä¸€ä¸ªå…ƒç´ ä¸­é€‰æ‹©æ‰€æœ‰å†…å®¹)åº”è¯¥åªæ˜¯è®¡ç®—æ‰€æœ‰(é¢„æœŸ)è¢«é€‰æ‹©çš„é¡¹ç›®çš„é—®é¢˜ã€‚ä¸‹ä¸€æ®µä»£ç åªåšè¿™äº›ï¼Œç»§ç»­æµ‹è¯•å®Œæ•´çš„ä»£ç </p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="3f5a" class="lg lh iq nu b gy ny nz l oa ob">cy.findAllByTestId('VirtualList')<br/>  // scrolls the list<br/>  .then(scrollVirtualList)<br/>  .then(() =&gt; {<br/>    // identifies the first rendered item (unknown in advance)<br/>    const firstRenderedItemIndex = getFirstRenderedItemIndex(<br/>      items,<br/>      getItemText,<br/>    )<br/>    const firstRenderedItem = items[firstRenderedItemIndex]</span><span id="6926" class="lg lh iq nu b gy oc nz l oa ob">    // the tests is going to click on the first rendered item<br/>    // keeping the SHIFT key pressed. All the items up to the first<br/>    // rendered one should be selected<br/>    const expectedSelectedItemIds = items<br/>      .slice(0, firstRenderedItemIndex + 1)<br/>      .map(item =&gt; item.id)</span><span id="6397" class="lg lh iq nu b gy oc nz l oa ob">    cy.get('body')<br/>      .type('{shift}', { release: false })<br/>      .findByText(getItemText(firstRenderedItem))<br/>      .click()<br/>      .window()<br/>      .its('storyData.selectedItems')<br/>      .should('eql', expectedSelectedItemIds)<br/>      .get('body')<br/>      .type('{shift}', { release: true })<br/>  })</span></pre><p id="4af5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æµ‹è¯•çš„å®Œæ•´ä»£ç ï¼Œæ£€æŸ¥æ¯ä¸€ä¸ªæŒ‰é”®ä¿®é¥°ç¬¦ï¼Œå¾ˆé•¿ï¼Œä½†æ˜¯ç›¸å½“é‡å¤</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="31b8" class="lg lh iq nu b gy ny nz l oa ob">it('When the items are clicked, then they are selected', () =&gt; {<br/>  cy.visit('/iframe.html?id=virtuallist--with-selection-management')</span><span id="2968" class="lg lh iq nu b gy oc nz l oa ob">  cy.window()<br/>    .its('storyData')<br/>    .should(storyData =&gt; {<br/>      // the story must expose some variables<br/>      expect(storyData.items).to.be.to.have.length.of.at.least(3)<br/>      expect(storyData.getItemText).to.be.a('function')<br/>      expect(storyData.selectedItems).to.be.an('array')<br/>    })<br/>    .then(({ getItemText, items }) =&gt; {<br/>      // first item click<br/>      cy.findByText(getItemText(items[0]))<br/>        .click()<br/>        .window()<br/>        .its('storyData.selectedItems')<br/>        .should('eql', [items[0].id])</span><span id="4ae8" class="lg lh iq nu b gy oc nz l oa ob">      // second item click<br/>      cy.findByText(getItemText(items[1]))<br/>        .click()<br/>        .window()<br/>        .its('storyData.selectedItems')<br/>        .should('eql', [items[1].id])</span><span id="fab1" class="lg lh iq nu b gy oc nz l oa ob">      // third item click with Meta modifier<br/>      cy.get('body')<br/>        .type('{meta}', { release: false })<br/>        .findByText(getItemText(items[2]))<br/>        .click()<br/>        .window()<br/>        .its('storyData.selectedItems')<br/>        .should('eql', [items[1].id, items[2].id])<br/>        .get('body')<br/>        .type('{meta}', { release: true })</span><span id="4c0c" class="lg lh iq nu b gy oc nz l oa ob">      // first item click with Shift modifier<br/>      cy.get('body')<br/>        .type('{shift}', { release: false })<br/>        .findByText(getItemText(items[0]))<br/>        .click()<br/>        .window()<br/>        .its('storyData.selectedItems')<br/>        .should('eql', [items[2].id, items[1].id, items[0].id])<br/>        .get('body')<br/>        .type('{shift}', { release: true })</span><span id="3dd3" class="lg lh iq nu b gy oc nz l oa ob">      // second item click with Alt modifier<br/>      cy.get('body')<br/>        .type('{alt}', { release: false })<br/>        .findByText(getItemText(items[1]))<br/>        .click()<br/>        .window()<br/>        .its('storyData.selectedItems')<br/>        .should('eql', [items[2].id, items[0].id])<br/>        .get('body')<br/>        .type('{alt}', { release: true })</span><span id="b9cf" class="lg lh iq nu b gy oc nz l oa ob">      // scrolling<br/>      cy.findAllByTestId('VirtualList')<br/>        .then(scrollVirtualList)<br/>        .then(() =&gt; {<br/>          const firstRenderedItemIndex = getFirstRenderedItemIndex(<br/>            items,<br/>            getItemText,<br/>          )<br/>          const firstRenderedItem = items[firstRenderedItemIndex]<br/>          const expectedSelectedItemIds = items<br/>            .slice(0, firstRenderedItemIndex + 1)<br/>            .map(item =&gt; item.id)</span><span id="32c4" class="lg lh iq nu b gy oc nz l oa ob">          // x-th item click with Shift modifier<br/>          cy.get('body')<br/>            .type('{shift}', { release: false })<br/>            .findByText(getItemText(firstRenderedItem))<br/>            .click()<br/>            .window()<br/>            .its('storyData.selectedItems')<br/>            .should('eql', expectedSelectedItemIds)<br/>            .get('body')<br/>            .type('{shift}', { release: true })<br/>        })<br/>    })<br/>})</span></pre><p id="0558" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æµ‹è¯•ç»“æœå¦‚ä¸‹</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ok oj l"/></div></figure><p id="9cf6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œå·¦è¾¹çš„å‘½ä»¤æ—¥å¿—æ²¡æœ‰æ¸…æ¥šåœ°è¯´æ˜å‘ç”Ÿäº†ä»€ä¹ˆã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ ä¸€äº›<code class="fe od oe of nu b">cy.log</code>è°ƒç”¨æ¥æé«˜æµ‹è¯•çš„å£è¯­æ°´å¹³ï¼Œæˆ–è€…æ›´å¥½åœ°åˆ©ç”¨<a class="ae kx" href="https://medium.com/slido-dev-blog/cypress-tips-3-improve-your-error-screenshots-in-cypress-b3675968a190" rel="noopener"> Filipçš„è§£å†³æ–¹æ¡ˆ</a>æ¥å……åˆ†åˆ©ç”¨Cypressæ—¥å¿—è®°å½•ã€‚</p><h1 id="9ae3" class="nc lh iq bd li nd ne nf ll ng nh ni lo nj nk nl lr nm nn no lu np nq nr lx ns bi translated">æœ€ä½³åŒ–</h1><p id="9aff" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">æµ‹è¯•è¶Šå¿«è¶Šå¥½ã€‚æˆ‘æœ€åˆçš„æµ‹è¯•å¥—ä»¶èŠ±äº†å°†è¿‘16ç§’æ‰å®Œå…¨è¿è¡Œã€‚ä¸‹é¢æ˜¯å½•éŸ³(è¯·æ³¨æ„ï¼Œè¿™æ˜¯ç¬¬ä¸€ä¸ªæµ‹è¯•å¥—ä»¶ï¼Œæµ‹è¯•é€Ÿåº¦ä¸º60 FPS)</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="4435" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ‰ä¸¤ä¸ªä¸»è¦çš„æ”¹è¿›é¢†åŸŸ:</p><ul class=""><li id="5fe0" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">æ›´å¿«åœ°åœ¨æ•…äº‹ä¹‹é—´åˆ‡æ¢(è€Œä¸æ˜¯åœ¨æµ‹è¯•ä¹‹é—´é‡æ–°åŠ è½½é¡µé¢)</li><li id="9bc5" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">åŠ é€Ÿæ»šåŠ¨è¿«ä½¿æµè§ˆå™¨æ—¶é’Ÿä¸æŸæ ‘</li></ul><h2 id="f383" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">æ›´å¿«åœ°åœ¨æ•…äº‹ä¹‹é—´åˆ‡æ¢</h2><p id="9acc" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">æ„Ÿè°¢Nicholas Bollå’Œä»–çš„<a class="ae kx" href="https://github.com/NicholasBoll/cypress-storybook" rel="noopener ugc nofollow" target="_blank"> cypress-storybook </a>æ’ä»¶ï¼Œå®ƒåˆ©ç”¨storybook APIsåŠ è½½æƒ³è¦çš„æ•…äº‹ï¼Œè€Œæ— éœ€é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ã€‚</p><p id="f1a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨å†™çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯:</p><ul class=""><li id="c9f8" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">å°†<code class="fe od oe of nu b">import 'cypress-storybook/react'</code>æ·»åŠ åˆ°æ•…äº‹ä¹¦é…ç½®ä¸­</li><li id="60ac" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">å°†<code class="fe od oe of nu b">import 'cypress-storybook/cypress'</code>æ·»åŠ åˆ°Cypressçš„support/index.jsæ–‡ä»¶</li><li id="1b14" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">å‘æµ‹è¯•æ–‡ä»¶æ·»åŠ ä¸€ä¸ª<code class="fe od oe of nu b">before</code>é’©å­</li></ul><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="13ee" class="lg lh iq nu b gy ny nz l oa ob">before(() =&gt; {<br/>  // Visit the storybook iframe page once per file<br/>  cy.visitStorybook()<br/>})</span></pre><ul class=""><li id="fd08" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">é€šè¿‡<code class="fe od oe of nu b">cy.loadStory('VirtualList', 'With 10000 items')</code>åŠ è½½æ•…äº‹ï¼Œè€Œä¸æ˜¯ä½¿ç”¨<code class="fe od oe of nu b">cy.visit</code></li><li id="8f84" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">æ›´æ–°æš´éœ²çš„å˜é‡ï¼Œåœ¨è§†é¢‘ä¹‹åè§£é‡Š</li></ul><p id="36ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™æ ·åšï¼Œé¡µé¢ä¸ä¼šåœ¨æ¯æ¬¡æµ‹è¯•æ—¶éƒ½é‡æ–°åŠ è½½ï¼Œæ•´ä¸ªå¥—ä»¶èŠ‚çœäº†3ç§’é’Ÿï¼Œè¯·çœ‹</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="d8b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦é€šè¿‡æ•…äº‹æ¥æ›´æ–°å˜é‡ï¼Ÿå—¯ï¼Œå¦‚æœé¡µé¢æ²¡æœ‰é‡æ–°åŠ è½½ï¼Œæˆ‘ä»¬å°±ä¸èƒ½ç¡®å®šæš´éœ²çš„å˜é‡æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œç‰¹åˆ«æ˜¯å› ä¸ºå‡ ä¹æ¯ä¸ªæ•…äº‹éƒ½æš´éœ²äº†ä¸€ä¸ª<code class="fe od oe of nu b">items</code>å˜é‡ï¼Œä½†æ˜¯å˜é‡çš„å†…å®¹æ˜¯ä¸åŒçš„ã€‚</p><p id="49f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å¦‚ä½•åŒºåˆ†æ•…äº‹æš´éœ²çš„å˜é‡ï¼Ÿå—¯ï¼ŒæŠŠæ•…äº‹çš„åå­—ä¹Ÿæ›å…‰äº†ï¼</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="1e66" class="lg lh iq nu b gy ny nz l oa ob">React.useEffect(() =&gt; {<br/>  global.storyData = {<br/>    // the name of the story is exposed too<br/>    storyName: 'With 10000 items',<br/>    items,<br/>    visibleItemsAmount: Math.ceil(listHeight / itemHeight),<br/>    getItemText,<br/>  }<br/>}, [items])</span></pre><p id="2be3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™æ ·ï¼Œæ¯ä¸ªæµ‹è¯•éƒ½å¯ä»¥æ£€æŸ¥ç­‰å¾…çš„åå­—</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="b2af" class="lg lh iq nu b gy ny nz l oa ob">it('When the component receives 10000 items, then only the minimum number of items are rendered', () =&gt; {<br/>  const story = 'With 10000 items'<br/>  cy.loadStory('VirtualList', story)</span><span id="8361" class="lg lh iq nu b gy oc nz l oa ob">  cy.window()<br/>    .its('storyData')<br/>    .should(storyData =&gt; {<br/>      <br/>      // caring about the story name<br/>      expect(storyData.storyName).to.eq(story)</span><span id="6db1" class="lg lh iq nu b gy oc nz l oa ob">      expect(storyData.items).to.be.to.have.length(10000)<br/>      expect(storyData.visibleItemsAmount).to.be.greaterThan(0)<br/>      expect(storyData.getItemText).to.be.a('function')<br/>    })<br/>    .then(({ visibleItemsAmount, getItemText, items }) =&gt; {<br/>      // ... test code...<br/>    })<br/>})</span></pre><p id="578d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åˆ©ç”¨<a class="ae kx" href="https://docs.cypress.io/guides/core-concepts/retry-ability.html" rel="noopener ugc nofollow" target="_blank"> Cypressé‡è¯•èƒ½åŠ›</a>ç­‰å¾…ç›´åˆ°æ‰€æœ‰æ–­è¨€é€šè¿‡ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿å…¬å¼€çš„å˜é‡æ˜¯æ­£ç¡®çš„ã€‚</p><p id="651b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸æœ€åˆçš„16ç§’ç›¸æ¯”ï¼Œ13ç§’å¬èµ·æ¥ä¸åƒæ˜¯ä¸€ä¸ªå·¨å¤§çš„è¿›æ­¥â€¦ä½†å®ƒæ˜¯ï¼å› ä¸ºå¦‚æœæˆ‘ä»¬æµ‹è¯•ä¸€ä¸ªæ²¡æœ‰æƒ¯æ€§æ»šåŠ¨çš„ç»„ä»¶(ä¾‹å¦‚ä¸€ä¸ªè¡¨å•)ï¼Œå¢ç›Šä¸ä¼šä»16 "åˆ°13 "ï¼Œè€Œå¯èƒ½ä»9 "åˆ°6 "ç§’ï¼ç›¸ä¿¡æˆ‘ï¼Œ<strong class="jp ir">æ°¸è¿œä¸è¦ä½ä¼°æµ‹è¯•é€Ÿåº¦</strong> â€¦</p><h2 id="1247" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">é€šè¿‡æ§åˆ¶æ—¶é’Ÿæ¥åŠ é€Ÿæ»šåŠ¨</h2><p id="c86c" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">è§†é¢‘å¼ºè°ƒäº†å¤§éƒ¨åˆ†æµ‹è¯•æ—¶é—´éƒ½èŠ±åœ¨äº†ç­‰å¾…æƒ¯æ€§æ»šåŠ¨å®Œæˆä¸Šã€‚è¿™æ²¡æœ‰é”™ï¼Œä½†æ˜¯ä¸€äº›æµ‹è¯•è·‘æ­¥è€…å…è®¸ä½ æ§åˆ¶æ—¶é—´ï¼Œèµ›æ™®æ‹‰æ–¯å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚å½“ä½ éœ€è¦æµ‹è¯•<code class="fe od oe of nu b">setTimeout</code>æˆ–<code class="fe od oe of nu b">setInterval</code>ç›¸å…³çš„ä¸œè¥¿æˆ–åƒæƒ¯æ€§æ»šåŠ¨è¿™æ ·çš„åŠ¨ç”»æ—¶ï¼ŒæŠŠæ—¶é—´å‘å‰æ¨æ˜¯åŸºæœ¬çš„ã€‚</p><p id="393e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kx" href="https://docs.cypress.io/api/commands/clock.html" rel="noopener ugc nofollow" target="_blank">å®˜æ–¹æ–‡æ¡£</a>æœ‰å¾ˆå¤šä¾‹å­ï¼Œä½†åŸºæœ¬ç”¨æ³•è¶³ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚æˆ‘ä»¬éœ€è¦è°ƒç”¨<code class="fe od oe of nu b">cy.clock()</code>ï¼Œç„¶åç”¨<code class="fe od oe of nu b">cy.tick(&lt;milliseconds&gt;)</code>è®¡æ—¶ã€‚</p><p id="d564" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç¬¬ä¸€ä¸ªæµ‹è¯•å¯¹æ–°çš„æ—¶é’Ÿæ§ä»¶è¿›è¡Œäº†è¯„è®º</p><pre class="km kn ko kp gt nt nu nv nw aw nx bi"><span id="9555" class="lg lh iq nu b gy ny nz l oa ob">it('When the component is scrolled, then the rendered items are not the first ones', () =&gt; {<br/>  const story = 'With 10000 items'<br/>  cy.loadStory('VirtualList', story)</span><span id="3275" class="lg lh iq nu b gy oc nz l oa ob">  // take control of the browser clock<br/>  cy.clock()</span><span id="7c65" class="lg lh iq nu b gy oc nz l oa ob">  cy.window()<br/>    .its('storyData')<br/>    .should(storyData =&gt; {<br/>      expect(storyData.storyName).to.eq(story)<br/>      expect(storyData.items).to.be.to.have.length(10000)<br/>      expect(storyData.visibleItemsAmount).to.be.greaterThan(0)<br/>      expect(storyData.getItemText).to.be.a('function')<br/>    })<br/>    .then(({ visibleItemsAmount, getItemText, items }) =&gt; {<br/>      // this test does not need the `scrollVirtualList` utility anymore<br/>      cy.findByTestId('VirtualList')<br/>        .trigger('wheel', {<br/>          deltaX: 0,<br/>          deltaY: 1000,<br/>        })</span><span id="ec68" class="lg lh iq nu b gy oc nz l oa ob">        // ticking the clock by one second.<br/>        // It jumps to the inertial scroll end.<br/>        .tick(1000)</span><span id="63e9" class="lg lh iq nu b gy oc nz l oa ob">        .then(() =&gt; getFirstRenderedItemIndex(items, getItemText))<br/>        .should('be.greaterThan', 10)<br/>        .then(firstVisibleItemIndex =&gt; {<br/>          const visibleItems = items.slice(<br/>            firstVisibleItemIndex,<br/>            firstVisibleItemIndex + visibleItemsAmount - 1,<br/>          )<br/>          visibleItems.forEach(item =&gt;<br/>            cy.findByText(getItemText(item)).should('be.visible'),<br/>          )<br/>        })<br/>    })<br/>})</span></pre><p id="8cf5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™å°±æ˜¯ç»“æœ</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="aaf5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬åœ¨æƒ¯æ€§å·è½´çš„æœ«ç«¯è·³è·ƒï¼Œæ²¡æœ‰ç­‰å¾…å®ƒçš„å®Œæˆã€‚è¯·æ³¨æ„:æ•´ä¸ªæµ‹è¯•æŒç»­æ—¶é—´è¢«å±å¹•è®°å½•ç¯¡æ”¹ï¼Œæ²¡æœ‰è®°å½•çš„æµ‹è¯•è¿è¡ŒèŠ±è´¹çš„æ—¶é—´æ›´å°‘ã€‚</p><p id="e671" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è®°ä½ï¼Œå¦‚æœä½ ä½¿ç”¨<code class="fe od oe of nu b">cy.clock</code>ï¼Œä½¿ç”¨<code class="fe od oe of nu b">cy.tick</code>ä¸æ˜¯å¯é€‰çš„ï¼å¦‚æœæ‚¨ä¸æ‰‹åŠ¨å‹¾é€‰æ—¶é—´ï¼Œåˆ—è¡¨æ ¹æœ¬ä¸ä¼šæ»šåŠ¨ï¼Œå› ä¸ºæ—¶é’Ÿè¢«å†»ç»“äº†ï¼çœ‹çœ‹å¦‚æœä½ ä¸è®¡æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi og"><img src="../Images/a6ade89b1131f7c28688f1c586339299.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6tqXuqDhWgiWjL5bBYbDFg.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk translated">åˆ—è¡¨åœç•™åœ¨åˆå§‹æ»šåŠ¨çº§åˆ«ï¼Œå®ƒæ²¡æœ‰æ»šåŠ¨ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰æ‰“å‹¾æ—¶é’Ÿã€‚</figcaption></figure><p id="e820" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe od oe of nu b">.should('be.greaterThan', 10)</code>æ–­è¨€ä¸æ»¡è¶³ï¼Œå› ä¸ºåˆ—è¡¨æ ¹æœ¬ä¸æ»šåŠ¨ã€‚</p><p id="e30b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åº”ç”¨äºå‡ ä¹æ‰€æœ‰æµ‹è¯•çš„æ—¶é’Ÿæ§åˆ¶å°†å®ƒä»¬çš„æŒç»­æ—¶é—´å‡å°‘äº†9ç§’ã€‚ä¸‹ä¸€ä¸ªè§†é¢‘çš„æœ€ç»ˆç»“æœ</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="1633" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ€ç»ˆç»“æœ:<strong class="jp ir">ä»æœ€åˆçš„16ç§’åˆ°9ç§’</strong>ï¼Œå¤ªæ£’äº†ï¼æµ‹è¯•è¶Šå¿«ï¼Œä½ å°±è¶Šèƒ½åˆ©ç”¨å®ƒä»¬ï¼</p><h2 id="3c8a" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">â€œæ— é¢„è§ˆâ€é”™è¯¯</h2><p id="a346" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">å¦‚æœæ‚¨é‡åˆ°æ­¤é”™è¯¯</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi og"><img src="../Images/10b5859c7672444227f3f2c489ea76ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d3nfA1zj25it17ppXGRekA.png"/></div></div></figure><p id="703c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é‡æ–°æ¨å‡ºCypressåº”è¯¥å¤Ÿäº†ã€‚å¦åˆ™ï¼Œé‡æ–°å¯åŠ¨æ•…äº‹ä¹¦ã€‚è¿™åœ¨å‡ ä¸ªå°æ—¶å†…åªå‘ç”Ÿè¿‡ä¸¤æ¬¡ï¼Œæ‰€ä»¥æˆ‘è¿˜æ²¡æœ‰æ·±å…¥äº†è§£å®ƒã€‚</p><h1 id="7c37" class="nc lh iq bd li nd ne nf ll ng nh ni lo nj nk nl lr nm nn no lu np nq nr lx ns bi translated">ç»“è®º</h1><p id="eefb" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">æµ‹è¯•å°±æ˜¯äº†è§£æœ€ä½³å®è·µï¼Œäº†è§£æµ‹è¯•æ–¹æ³•ï¼Œäº†è§£å¯ç”¨çš„å·¥å…·ï¼Œå¹¶å†³å®šå¦‚ä½•æ··åˆå®ƒä»¬æ¥å»ºç«‹ä½ è‡ªå·±çš„ä¿¡å¿ƒã€‚ä½¿ç”¨åƒCypressè¿™æ ·çš„æµè§ˆå™¨è‡ªåŠ¨åŒ–å·¥å…·å¯ä»¥ä¿è¯æ‚¨çš„ç»„ä»¶åƒæ‚¨çš„æ¶ˆè´¹è€…æ‰€æœŸæœ›çš„é‚£æ ·å·¥ä½œã€‚</p><p id="ba62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœä½ çš„ä»£ç åº“ä¸­æœ‰æ•°åƒä¸ªæ•…äº‹ï¼Œç”±äºå·¥å…·æœ¬èº«çš„ç¼“æ…¢(ä¸<a class="ae kx" href="https://testing-library.com/docs/react-testing-library/intro" rel="noopener ugc nofollow" target="_blank"> Reactæµ‹è¯•åº“</a>ç›¸æ¯”)ï¼Œå®ƒå¯èƒ½ä¸æ˜¯æœ€ä½³é€‰æ‹©ï¼Œä½†æ˜¯å¯¹äºä¸­å°å‹ä»£ç åº“ï¼Œç”±äºæµ‹è¯•æ—¶é—´è¾ƒå°‘ï¼ŒCypresså¯ä»¥ä½œä¸ºä¸€ä¸ªä¸€ä½“åŒ–çš„æµ‹è¯•å·¥å…·ã€‚</p><p id="0c0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½ åˆ›é€ æ€§åœ°æµ‹è¯•è¿‡ä½ çš„ç»„ä»¶å—ï¼Ÿæœ‰åé¦ˆå—ï¼Ÿè¯·ç•™ä¸‹è¯„è®ºğŸ˜‰</p><p id="b641" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ›´ä¸€èˆ¬åœ°è¯´:ç”¨æµè§ˆå™¨è‡ªåŠ¨åŒ–å·¥å…·æµ‹è¯•ç»„ä»¶æ˜¯ä¸€ä¸ªçƒ­é—¨è¯é¢˜ï¼Œçœ‹çœ‹Storybookçš„è¿™ç¯‡æ¨æ–‡<a class="ae kx" href="https://twitter.com/storybookjs/status/1183344512787238912" rel="noopener ugc nofollow" target="_blank">å’ŒGlebçš„è¿™ç¯‡æ¨æ–‡</a>ã€‚</p><h2 id="b809" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">ç›¸å…³æ–‡ç« </h2><p id="95a3" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy mp ka kb kc mq ke kf kg mr ki kj kk ij bi translated">ä½ å¯èƒ½ä¼šå¯¹æˆ‘çš„å…¶ä»–æ–‡ç« æ„Ÿå…´è¶£:</p><ul class=""><li id="ed16" class="lz ma iq jp b jq jr ju jv jy ms kc mt kg mu kk mg mh mi mj bi translated">ä½ æƒ³æé«˜ä½ çš„å‰ç«¯ç”Ÿäº§åŠ›å—ï¼ŸCypressä¸ä»…ä»…æ˜¯ä¸€ä¸ªæµ‹è¯•å·¥å…·ï¼é˜…è¯»<a class="ae kx" href="https://medium.com/@NoriSte/front-end-productivity-boost-cypress-as-your-main-development-browser-f08721123498" rel="noopener">å‰ç«¯ç”Ÿäº§åŠ›æå‡:Cypressä½œä¸ºæ‚¨çš„ä¸»è¦å¼€å‘æµè§ˆå™¨</a></li><li id="f476" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">é¿å…ç”¨ä¸å¿…è¦çš„å’Œä¸å¯é¢„çŸ¥çš„ç­‰å¾…æ¥å‡ç¼“ä½ çš„æµ‹è¯•:<a class="ae kx" href="https://medium.com/@NoriSte/await-do-not-sleep-your-e2e-tests-df67e051b409" rel="noopener">ç­‰å¾…ï¼Œä¸è¦è®©ä½ çš„E2Eæµ‹è¯•ä¼‘çœ </a></li><li id="8379" class="lz ma iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">UIæµ‹è¯•åˆ†ç±»:<a class="ae kx" href="https://medium.com/@NoriSte/component-vs-ui-integration-vs-e2e-tests-f02b575339dc" rel="noopener">ç»„ä»¶vs (UI)é›†æˆvs E2Eæµ‹è¯•</a></li></ul></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><p id="8df3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½ å¥½ğŸ‘‹æˆ‘æ˜¯Stefano Magniï¼Œæˆ‘æ˜¯ä¸€åå……æ»¡æ¿€æƒ…çš„<strong class="jp ir"> JavaScriptå¼€å‘äººå‘˜</strong>ï¼Œä¸€å<strong class="jp ir"> Cypresså¤§ä½¿ã€</strong>å’Œä¸€å<strong class="jp ir">è®²å¸ˆ</strong>ã€‚æˆ‘æ˜¯WorkWave çš„é«˜çº§å‰ç«¯å·¥ç¨‹å¸ˆã€‚<br/>æˆ‘å–œæ¬¢åˆ›é€ é«˜è´¨é‡çš„äº§å“ï¼Œæµ‹è¯•å’Œè‡ªåŠ¨åŒ–ä¸€åˆ‡ï¼Œå­¦ä¹ å’Œåˆ†äº«æˆ‘çš„çŸ¥è¯†ï¼Œå¸®åŠ©ä»–äººï¼Œåœ¨ä¼šè®®ä¸Šå‘è¨€å’Œé¢å¯¹æ–°çš„æŒ‘æˆ˜ã€‚<br/>ä½ å¯ä»¥åœ¨<a class="ae kx" href="https://twitter.com/NoriSte?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> Twitter </a>ã€<a class="ae kx" href="https://github.com/NoriSte?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> GitHub </a>ã€<a class="ae kx" href="https://www.linkedin.com/in/noriste/?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>ä¸Šæ‰¾åˆ°æˆ‘ã€‚ä½ å¯ä»¥æ‰¾åˆ°æˆ‘æœ€è¿‘æ‰€æœ‰çš„æ–‡ç« /æ¼”è®²ç­‰ç­‰ã€‚è¿™é‡Œã€‚</p></div></div>    
</body>
</html>