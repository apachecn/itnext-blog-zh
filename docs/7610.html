<html>
<head>
<title>Butterfly â€” A full-featured navigation framework that supports Activityã€Fragmentã€DialogFragment and Compose UI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">butterflyâ€”â€”æ”¯æŒæ´»åŠ¨ã€ç‰‡æ®µã€å¯¹è¯ç‰‡æ®µå’Œç»„åˆUIçš„å…¨åŠŸèƒ½å¯¼èˆªæ¡†æ¶</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/butterfly-a-full-featured-navigation-framework-that-supports-activity-fragment-and-compose-664882bb125f?source=collection_archive---------3-----------------------#2022-11-22">https://itnext.io/butterfly-a-full-featured-navigation-framework-that-supports-activity-fragment-and-compose-664882bb125f?source=collection_archive---------3-----------------------#2022-11-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3ed98d8b7909d80c00261e1b9cbd15a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WxGk7Rnktr_rcmEzp0NxTw.jpeg"/></div></div></figure><p id="4c72" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">GitHub:</strong><a class="ae kw" href="https://github.com/ssseasonnn/Butterfly" rel="noopener ugc nofollow" target="_blank">T3ã€‘è´è¶T5ã€‘</a></p><p id="603c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç»è¿‡æ¼«é•¿çš„ç­‰å¾…ï¼ŒButterflyç»ˆäºå‘å¸ƒäº†æ–°ç‰ˆæœ¬ã€‚æ­¤æ¬¡æ›´æ–°ä¸ºå¤§å®¶å¸¦æ¥äº†ä¸€ä¸ªå…¨åŠŸèƒ½çš„å¯¼èˆªæ¡†æ¶ï¼Œä¸ä»…æ”¯æŒActivityã€Fragmentå’ŒDialogFragmentï¼Œè¿˜åœ¨Compose UIä¸­åŠ å…¥äº†è·¯ç”±æ”¯æŒã€‚è‡³æ­¤ï¼Œä¸€ä¸ªç»Ÿä¸€çš„è·¯ç”±æ¡†æ¶è¯ç”Ÿäº†ã€‚å®ƒä¸ä»…å°å·§çµæ´»ï¼Œè€Œä¸”åŠŸèƒ½å¼ºå¤§ã€‚Butterflyæä¾›äº†ç»Ÿä¸€çš„APIã€‚ä½ ä¸éœ€è¦å…³å¿ƒç›®çš„åœ°ï¼Œåœ¨å“ªé‡Œã€‚åªè¦æä¾›ä¸€ä¸ªæ–¹æ¡ˆï¼ŒButterflyå°±ä¼šå¯¼èˆªåˆ°æ­£ç¡®çš„åœ°æ–¹ã€‚</p><p id="517e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸ç”¨å¤šè¯´ï¼Œçœ‹çœ‹Butterflyæ”¯æŒçš„ç‰¹æ€§åˆ—è¡¨ã€‚</p><h1 id="93c2" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">ç‰¹å¾è¡¨</h1><p id="be16" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">âœ… <strong class="ka ir">æ”¯æŒå¯¼èˆªæ´»åŠ¨</strong></p><p id="ff3c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">âœ… <strong class="ka ir">æ”¯æŒå¯¼èˆªç‰‡æ®µ</strong></p><p id="cb10" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">âœ… <strong class="ka ir">æ”¯æŒå¯¼èˆªå¯¹è¯ç‰‡æ®µ</strong></p><p id="8c79" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> âœ…æ”¯æŒå¯¼èˆªæ’°å†™UI </strong></p><p id="2267" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> âœ…æ”¯æŒå¯¼èˆªè¡ŒåŠ¨</strong></p><p id="72fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> âœ…æ”¯æŒå¯¼èˆªå‚æ•°ä¼ é€’å’Œè§£æ</strong></p><p id="53f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> âœ…æ”¯æŒè·å–å¯¼èˆªè¿”å›ç»“æœ</strong></p><p id="add6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> âœ…æ”¯æ´å¯¼èˆªæ‹¦æˆªå™¨</strong></p><p id="9fc1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> âœ…æ”¯æŒç‰‡æ®µå’Œæ„é€ UI backstack </strong></p><p id="b964" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> âœ…æ”¯æŒç‰‡æ®µå’Œç»„åˆUIç»„ç®¡ç†</strong></p><p id="5de3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> âœ…æ”¯æŒåˆ†ç‰‡å’Œç»„åˆUIå¯åŠ¨æ¨¡å¼ï¼Œå¦‚SingleTopå’ŒClearTop </strong></p><p id="3dde" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> âœ…æ”¯æŒç»„ä»¶åŒ–é€šä¿¡</strong></p><h1 id="d40a" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">å¯¼èˆªå’Œå‚æ•°ä¼ é€’</h1><p id="b0c4" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">çœ¼è§ä¸ºå®ï¼Œè€³å¬ä¸ºè™šã€‚å¦‚æ­¤å¼ºå¤§çš„åŠŸèƒ½ï¼Œå¾ˆå°‘æœ‰å®ƒå¦‚ä½•å·¥ä½œçš„ä¾‹å­ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹åŸºæœ¬çš„å¯¼èˆªåŠŸèƒ½:</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="6efe" class="mj ky iq mf b be mk ml l mm mn">@Agile("test/activity")<br/>class AgileTestActivity : AppCompatActivity()<br/><br/>@Agile("test/fragment")<br/>class TestFragment : Fragment()<br/><br/>@Agile("test/dialog")<br/>class TestDialogFragment : DialogFragment()<br/><br/><br/>//Navigation<br/>Butterfly.agile("test/xxx").carry()<br/><br/>//Or navigate and get the returned data<br/>Butterfly.agile("test/xxx")<br/>    .carry {<br/>        val result = it.getStringExtra("result")<br/>        binding.tvResult.text = result<br/>    }</span></pre><p id="c967" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¦‚ä¸Šå›¾ï¼Œå¯¼èˆªå°±æ˜¯è¿™ä¹ˆç®€å•ã€‚æ— è®ºç›®çš„åœ°æ˜¯ä»€ä¹ˆï¼Œåœ¨å“ªé‡Œï¼Œåªéœ€è¦ä¸€ä¸ªæ–¹æ¡ˆå°±å¯ä»¥å®Œæˆè·¯ç”±è·³è½¬ã€‚æ–¹æ¡ˆæ²¡æœ‰é™åˆ¶ã€‚å®ƒå¯ä»¥æ˜¯ä»»ä½•å­—ç¬¦ä¸²æˆ–æ ‡å‡†æ–¹æ¡ˆï¼Œå¦‚<strong class="ka ir"> butterfly://home/path </strong>ç­‰ã€‚</p><p id="82a4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">åœ¨å¯¼èˆªçš„è¿‡ç¨‹ä¸­ï¼Œå‚æ•°ä¼ é€’ä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„ä¸€éƒ¨åˆ†ã€‚è´è¶æä¾›äº†ä¸¤ç§æ–¹å¼ä¾›ä½ é€‰æ‹©ã€‚ä¸€ç§æ˜¯æ‹¼æ¥æ–¹æ¡ˆï¼Œæ¯”å¦‚<strong class="ka ir">æµ‹è¯•/æ´»åŠ¨ï¼ŸparamA=123 &amp; paramB=abc </strong>ï¼Œå³<strong class="ka ir"> paramA </strong>å’Œ<strong class="ka ir"> paramB </strong>å¯ä»¥ä¼ é€åˆ°ç›®çš„åœ°ã€‚å¦ä¸€ç§æ˜¯é€šè¿‡è°ƒç”¨<strong class="ka ir"> params </strong>æ–¹æ³•æ¥ä¼ é€’æ‰€éœ€æ•°æ®ï¼Œæ¯”å¦‚:</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="82b7" class="mj ky iq mf b be mk ml l mm mn">//Splicing scheme<br/>Butterfly.agile("test/scheme?a=1&amp;b=2").carry()<br/><br/>//call params<br/>Butterfly.agile("test/scheme?a=1&amp;b=2")<br/>    .params("intValue" to 1)<br/>    .params("booleanValue" to true)<br/>    .params("stringValue" to "test value")<br/>    .carry()</span></pre><p id="d41c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¦‚ä¸Šå›¾ï¼Œå¯ä»¥åŒæ—¶è¿›è¡Œæ–¹æ¡ˆæ‹¼æ¥å’Œparamsæ–¹æ³•è°ƒç”¨ã€‚ä¼ é€’çš„æ‰€æœ‰å‚æ•°éƒ½å¯ä»¥åœ¨å¯¼èˆªç›®çš„åœ°è·å¾—ï¼Œparamsæ–¹æ³•å¯ä»¥ä¼ é€’Bundleæ”¯æŒçš„ä»»ä½•ç±»å‹çš„å‚æ•°ã€‚</p><p id="6083" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">åœ¨ç›®çš„åœ°æ¥å—å‚æ•°:</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="5023" class="mj ky iq mf b be mk ml l mm mn">//On the navigation destination page, you can obtain the passed parameter value through the key field of the parameter<br/>@Agile("test/scheme")<br/>class AgileTestActivity : AppCompatActivity() {<br/>    val a by lazy { intent?.getStringExtra("a") ?: "" }<br/>    val b by lazy { intent?.getStringExtra("b") ?: "" }<br/>    val intValue by lazy { intent?.getIntExtra("intValue", 0) ?: 0 }<br/>}<br/><br/>//In addition to manual parameter analysis, Bracer can also be equipped to realize fully automatic parameter analysis<br/>@Agile("test/scheme")<br/>class AgileTestActivity : AppCompatActivity() {<br/>    val a by params&lt;String&gt;()<br/>    val b by params&lt;String&gt;()<br/>    val intValue by params&lt;Int&gt;()<br/>}</span></pre><p id="6746" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å…³äºæŠ¤è…•çš„ä½¿ç”¨ç»†èŠ‚ï¼Œè¯·å‚è§Github: <a class="ae kw" href="https://github.com/ssseasonnn/Bracer" rel="noopener ugc nofollow" target="_blank">æŠ¤è…•</a></p><h1 id="9f93" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">æ’°å†™å¯¼èˆª</h1><p id="972e" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">Composeä½œä¸ºAndroidæ–°çš„UIæ¡†æ¶å¼‚å†›çªèµ·ã€‚è¶Šæ¥è¶Šå¤šçš„é¡¹ç›®æ­£åœ¨å¤§é‡ä½¿ç”¨Composeï¼Œå› æ­¤è¿«åˆ‡éœ€è¦æ”¯æŒComposeå¯¼èˆªã€‚</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="2f41" class="mj ky iq mf b be mk ml l mm mn">@Agile("test/compose")<br/>@Composable<br/>fun HomeScreen() {<br/>    Box {<br/>        ...<br/>    }<br/>}<br/><br/>//Navigate to the HomeScreen page<br/>Butterfly.agile("test/compose").carry()</span></pre><p id="dc0c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¦‚ä¸Šæ‰€ç¤ºï¼ŒComposeçš„å¯¼èˆªä¸Activityæˆ–Fragmentçš„å¯¼èˆªå®Œå…¨ä¸€è‡´ã€‚ç»Ÿä¸€çš„APIä½¿å®ƒæ›´å®¹æ˜“ä½¿ç”¨ã€‚</p><p id="9c7e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç»„åˆå¯¼èˆªä¸­çš„å‚æ•°ä¼ é€’å’Œè·å–ä¸æ´»åŠ¨æˆ–ç‰‡æ®µä¸­çš„å‚æ•°ä¼ é€’å’Œè·å–å‡ ä¹ç›¸åŒã€‚ä¼ è¾“å‚æ•°è¿˜æ”¯æŒæ‹¼æ¥æ–¹æ¡ˆå’Œè°ƒç”¨å‚æ•°ã€‚è¦è·å¾—å‚æ•°ï¼Œåªéœ€è¦å‘Composeç»„ä»¶æ·»åŠ ä¸€ä¸ªbundleå‚æ•°ï¼Œç„¶åå°±å¯ä»¥é€šè¿‡Bundleå‚æ•°è·å¾—å¯¼èˆªä¸­ä¼ é€’çš„å‚æ•°ã€‚</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="be1c" class="mj ky iq mf b be mk ml l mm mn">@Agile("test/compose")<br/>@Composable<br/>fun HomeScreen(bundle: Bundle) {<br/>    val a by bundle.params&lt;Int&gt;()<br/>    val b by bundle.params&lt;Int&gt;()<br/>    val booleanValue by bundle.params&lt;Boolean&gt;()<br/><br/>    Box {<br/>        Text(text = a)<br/>    }<br/>}<br/><br/>//Splicing scheme<br/>Butterfly.agile("test/compose?a=1&amp;b=2").carry()<br/><br/>//or call params<br/>Butterfly.agile("test/compose?a=1&amp;b=2")<br/>    .params("intValue" to 1)<br/>    .params("booleanValue" to true)<br/>    .params("stringValue" to "test value")<br/>    .carry()</span></pre><h1 id="9cff" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">è·¯çº¿æ‹¦æˆªå™¨</h1><p id="cf58" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">æ‹¦æˆªå™¨æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„åŠŸèƒ½ï¼Œå¯ä»¥æä¾›å¼ºå¤§çš„è·¯ç”±æ§åˆ¶åŠŸèƒ½ï¼Œå¦‚ç™»å½•æ£€æµ‹ã€ABæµ‹è¯•ç­‰ã€‚Butterflyæä¾›äº†ä¸¤ç§ç±»å‹çš„æ‹¦æˆªå™¨:å…¨å±€æ‹¦æˆªå™¨å’Œä¸€æ¬¡æ€§æ‹¦æˆªå™¨ï¼Œå¯ä»¥é’ˆå¯¹ä¸åŒçš„ä½¿ç”¨åœºæ™¯çµæ´»é€‰æ‹©ã€‚</p><p id="5947" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">é¦–å…ˆï¼Œå®šä¹‰æ‹¦æˆªå™¨å‡½æ•°:</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="ff36" class="mj ky iq mf b be mk ml l mm mn">//Custom interceptor<br/>class TestInterceptor : ButterflyInterceptor {<br/>    override fun shouldIntercept(agileRequest: AgileRequest): Boolean {<br/>        //Detect whether interception is required<br/>        return true<br/>    }<br/><br/>    override suspend fun intercept(agileRequest: AgileRequest) {<br/>        //Processing interception logic<br/>        println("intercepting")<br/>        delay(5000)<br/>        println("intercept finish")<br/>    }<br/>}</span></pre><p id="10b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">é…ç½®å…¨å±€æ‹¦æˆªå™¨:</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="5cba" class="mj ky iq mf b be mk ml l mm mn">//Add a global interceptor<br/>ButterflyCore.addInterceptor(TestInterceptor())<br/><br/>//Skip all global interceptors<br/>Butterfly.agile("test/scheme").skipGlobalInterceptor().carry()</span></pre><p id="74d8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">é…ç½®ä¸€æ¬¡æ€§æ‹¦æˆªå™¨:</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="c6d6" class="mj ky iq mf b be mk ml l mm mn">//Only the current navigation uses this interceptor<br/>Butterfly.agile("test/scheme")<br/>    .addInterceptor(TestInterceptor())<br/>    .carry()</span></pre><p id="521a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ‹¦æˆªå™¨æä¾›äº†<strong class="ka ir"> suspend </strong>æ‹¦æˆªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è¶³å¤Ÿèªæ˜ï¼Œä¸€çœ‹å°±çŸ¥é“å®ƒçš„é•¿å¤„ã€‚ğŸ‘»</p><h1 id="ba4f" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">SingleTopå’ŒClearTopå¯åŠ¨æ¨¡å¼å’Œbackstack</h1><p id="37b8" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">ä¼—æ‰€å‘¨çŸ¥ï¼ŒActivityæ”¯æŒå¤šç§å¯åŠ¨æ¨¡å¼ï¼Œå…¶ä¸­SingleTopå’ŒClearTopå°¤ä¸ºå¸¸è§ã€‚Butterflyå°†è¿™ä¸¤ç§å¯åŠ¨æ¨¡å¼è¿›è¡Œäº†åˆ†ç‰‡å’Œç»„åˆï¼Œå¹¶æä¾›äº†ç»Ÿä¸€çš„APIã€‚ä½ åªéœ€è¦è°ƒç”¨<strong class="ka ir"> singleTop </strong>æˆ–è€…<strong class="ka ir"> clearTop </strong>å°±å¯ä»¥äº†ã€‚</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="991a" class="mj ky iq mf b be mk ml l mm mn">//for Activity<br/>@Agile("test/activity")<br/>class AgileTestActivity : AppCompatActivity()<br/><br/>Butterfly.agile("test/activity")<br/>    .clearTop()              <br/>    // or .singleTop() <br/>    .carry()<br/><br/>//for Fragment<br/>@Agile("test/fragment")<br/>class TestFragment : Fragment()<br/><br/>Butterfly.agile("test/fragment")<br/>    .clearTop()                 <br/>    // or .singleTop()   <br/>    .carry()<br/><br/>//for Compose<br/>@Agile("test/compose")<br/>@Composable<br/>fun HomeScreen() {}<br/><br/>Butterfly.agile("test/compose")<br/>    .clearTop()                 <br/>     // or .singleTop()  <br/>    .carry()</span></pre><p id="ff75" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æœ‰äº†å¯åŠ¨æ¨¡å¼ï¼Œåå¤‡æ ˆè‡ªç„¶æ˜¯å¿…é¡»çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒButterflyä½¿ç”¨å›é€€å †æ ˆæ¥ç®¡ç†æ´»åŠ¨ã€ç‰‡æ®µã€å¯¹è¯ç‰‡æ®µå’Œåˆæˆã€‚æ¯æ¬¡å¯¼èˆªåˆ°ä¸€ä¸ªç›®æ ‡æ—¶ï¼Œè¯¥ç›®æ ‡å°†è¢«æ·»åŠ åˆ°å›é€€å †æ ˆä¸­ã€‚é€šè¿‡ä½¿ç”¨<strong class="ka ir">ç¼©å›</strong>æ–¹æ³•ï¼ŒButterflyå¯ä»¥å›åˆ°ä¸Šä¸€é¡µã€‚</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="27b7" class="mj ky iq mf b be mk ml l mm mn">//Close the top page and go back to the previous page<br/>Butterfly.retreat()<br/><br/>//Close the top page of the stack, go back to the previous page and return data<br/>Butterfly.retreat("result" to "123")</span></pre><p id="6f64" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç”±äºComposeçš„æ€§è´¨ï¼Œå®ƒä¸æ”¯æŒ<strong class="ka ir"> Backå’Œè¿”å›æ•°æ®</strong>ï¼ŒComposeå¯ä»¥é€šè¿‡é‡æ–°å¯¼èˆªæ¥ä¼ é€’æ–°æ•°æ®ï¼Œä»è€Œç›´æ¥åˆ·æ–°é¡µé¢</p><h1 id="9ef9" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">ç‰‡æ®µå’Œç»„åˆçš„åˆ†ç»„ç®¡ç†</h1><p id="7150" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">é™¤äº†ä»¥æ ˆçš„å½¢å¼ç®¡ç†ç‰‡æ®µå’Œå¤åˆï¼ŒButterflyè¿˜æ”¯æŒä»¥ç»„çš„å½¢å¼ç®¡ç†å®ƒä»¬ã€‚æ¯”å¦‚APPé¦–é¡µå¤šä¸ªæ ‡ç­¾é¡µå¯¹åº”å¤šä¸ªç¢ç‰‡å’Œå¤åˆå±æ—¶ï¼Œå¯ä»¥ç”¨ç¾¤ç»„ç®¡ç†æ¥å¤„ç†è¿™ç§åœºæ™¯ã€‚</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="607f" class="mj ky iq mf b be mk ml l mm mn">// group fragments<br/>Butterfly.agile("test/fragment1")<br/>    .group("groupName")          <br/>    .carry()<br/><br/>Butterfly.agile("test/fragment2")<br/>    .group("groupName")          <br/>    .carry()<br/><br/>Butterfly.agile("test/fragment3")<br/>    .group("groupName")          <br/>    .carry()<br/><br/><br/>// group composes<br/>Butterfly.agile("test/compose_screen1")<br/>    .group("groupName")          <br/>    .carry()<br/><br/>Butterfly.agile("test/compose_screen2")<br/>    .group("groupName")          <br/>    .carry()<br/><br/>Butterfly.agile("test/compose_screen3")<br/>    .group("groupName")          <br/>    .carry()</span></pre><p id="0d12" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">é€šè¿‡ä½¿ç”¨ç›¸åŒçš„ç»„åï¼Œå¯ä»¥åœ¨ç›¸åŒçš„ç»„ä¸­ç®¡ç†è¿™äº›ç‰‡æ®µæˆ–ç»„æˆå±å¹•ã€‚åœ¨åŒä¸€ç»„ä¸­é‡å¤å¯¼èˆªä¸ä¼šåˆ›å»ºå®ä¾‹ã€‚</p><h1 id="65e8" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">ç»„ä»¶åŒ–é€šä¿¡</h1><p id="5e50" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">ä½œä¸ºåŸºäºç»„ä»¶çš„è·¯ç”±æ¡†æ¶ï¼Œç»„ä»¶ä¹‹é—´çš„é€šä¿¡ä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„åŠŸèƒ½ã€‚Butterflyä¸ä»…æ”¯æŒå¸¸è§„çš„æ¥å£æ¥æ”¶ï¼Œè¿˜æ”¯æŒç»„ä»¶ä¹‹é—´ä¸ç›¸äº’ä¾èµ–çš„ç›´æ¥é€šä¿¡ã€‚</p><p id="1866" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä½¿ç”¨æ¥å£sinkçš„å½¢å¼ï¼Œé¦–å…ˆæœ‰ä¸€ä¸ªå…¬å…±ä¾èµ–ç»„ä»¶ï¼Œé€šå¸¸æ˜¯Baseæˆ–Commonï¼Œéœ€è¦é€šä¿¡çš„ä¸¤ä¸ªç»„ä»¶ï¼Œæ¯”å¦‚Homeå’ŒCartï¼Œéƒ½ä¾èµ–äºBaseæˆ–Commonï¼Œå½¢æˆå¦‚ä¸‹ä¾èµ–å›¾:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/874e49fb70e0d41d9d9089403ba6ff15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pC8RF8vTOrZlhktw6UWVUw@2x.png"/></div></div></figure><p id="fed3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¦‚æœHomeéœ€è¦è°ƒç”¨Cartä¸­çš„addToCartæ–¹æ³•ï¼Œé¦–å…ˆåœ¨Baseä¸­å®šä¹‰é€šä¿¡æ¥å£:</p><p id="611a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ¨¡å—åŸºåº§:</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="8cd1" class="mj ky iq mf b be mk ml l mm mn">@Evade<br/>interface CartApi {<br/>    fun addToCart(product: String)<br/>}</span></pre><p id="32a9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç„¶ååœ¨Cartä¸­åˆ›å»ºCartApiçš„å®ç°:</p><p id="1ccf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ¨¡å—æ¨è½¦:</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="7636" class="mj ky iq mf b be mk ml l mm mn">@EvadeImpl<br/>class CartApiImpl : CartApi {<br/>    override fun addToCart(product: String) {<br/>        // do something<br/>    }<br/>}</span></pre><p id="35de" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç„¶åå¯ä»¥åœ¨Homeä¸­è°ƒç”¨CartApiæä¾›çš„æ–¹æ³•:</p><p id="a15c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ¨¡å—ä¸»é¡µ:</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="55e2" class="mj ky iq mf b be mk ml l mm mn">val cartApi = Butterfly.evade&lt;CartApi&gt;()<br/>cartApi.addToCart("test")</span></pre><p id="c24a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ¥å£æ¥æ”¶å™¨æ˜¯ä¸€ç§å¾ˆå¥½çš„äº¤æµæ–¹å¼ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›é—®é¢˜ã€‚å¦‚æœä½ è¦é€šä¿¡çš„ç»„ä»¶è¶Šæ¥è¶Šå¤šï¼Œé‚£ä¹ˆå°±ä¼šæœ‰è¶Šæ¥è¶Šå¤šçš„æ¥å£ä¸‹æ²‰ï¼Œæœ€ç»ˆå¯¼è‡´Baseæˆ–è€…Commonçš„çˆ†ç‚¸ã€‚å› æ­¤ï¼Œé™¤äº†ä½¿ç”¨æ¥å£æ¥æ”¶å™¨å½¢å¼ï¼ŒButterflyè¿˜æä¾›äº†ç»„ä»¶ä¹‹é—´ç›´æ¥é€šä¿¡çš„èƒ½åŠ›ï¼Œè€Œç»„ä»¶ä¹‹é—´å®Œå…¨æ²¡æœ‰ä»»ä½•ä¾èµ–å…³ç³»ã€‚</p><p id="7d28" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å’Œå‰é¢çš„ç»“æ„ç±»ä¼¼ï¼ŒHomeå’ŒCartä¹Ÿéœ€è¦é€šä¿¡ã€‚Homeéœ€è¦è°ƒç”¨Cartä¸­çš„addToCartæ–¹æ³•ï¼Œä½†è¿™æ¬¡ä¸éœ€è¦å°†æ¥å£ä¸‹æ²‰åˆ°Baseæˆ–Commonï¼Œåªéœ€è¦åœ¨Homeä¸­å®šä¹‰é€šä¿¡æ¥å£å³å¯:</p><p id="fff3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ¨¡å—ä¸»é¡µ:</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="b055" class="mj ky iq mf b be mk ml l mm mn">@Evade<br/>interface CartApi {<br/>    fun addToCart(product: String)<br/>}</span></pre><p id="c96e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç„¶ååœ¨Cartä¸­åˆ›å»ºCartApiçš„å®ç°ã€‚ç”±äºHomeå’ŒCartä¸ç›´æ¥ä¾èµ–ï¼ŒCartçš„å®ç°ç±»ä¸éœ€è¦å®ç°Homeä¸­çš„æ¥å£ï¼Œåªéœ€è¦ä½¿ç”¨ä¸Homeä¸­çš„æ¥å£ç›¸åŒçš„æ–¹æ³•åå’Œæ–¹æ³•å‚æ•°å³å¯:</p><p id="b970" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ¨¡å—æ¨è½¦:</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="1591" class="mj ky iq mf b be mk ml l mm mn">// No need to implement CartApi<br/>@EvadeImpl<br/>class CartApiImpl {<br/>    fun addToCart(product: String) {<br/>        // do something<br/>    }<br/>}</span></pre><p id="e13e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç„¶åä½ å¯ä»¥åœ¨å®¶é‡Œè°ƒç”¨å¡å¡”çš®çš„æ–¹æ³•:</p><p id="bc9f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ¨¡å—ä¸»é¡µ:</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="6bf0" class="mj ky iq mf b be mk ml l mm mn">val cartApi = Butterfly.evade&lt;CartApi&gt;()<br/>cartApi.addToCart("test")</span></pre><h1 id="d81d" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">è·¯ç”±è¡¨æ³¨å†Œå’ŒGradleæ’ä»¶</h1><p id="790a" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">Butterflyå°†ä¸ºæ¯ä¸ªå¸¦æ³¨é‡Šçš„æ¨¡å—ç”Ÿæˆä¸€ä¸ªè·¯ç”±è¡¨ã€‚å‘½åè§„åˆ™æ˜¯:Butterfly[æ¨¡å—å]æ¨¡å—</p><p id="8d5b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ‰‹åŠ¨æ³¨å†Œ:</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="ec62" class="mj ky iq mf b be mk ml l mm mn">class DemoApplication : Application() {<br/>    override fun onCreate() {<br/>        super.onCreate()<br/>        //regist<br/>        ButterflyCore.addModule(ButterflyHomeModule())<br/>        ButterflyCore.addModule(ButterflyFooModule())<br/>        ButterflyCore.addModule(ButterflyBarModule())<br/>    }<br/>}</span></pre><p id="865d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ’ä»¶è‡ªåŠ¨æ³¨å†Œ:</p><p id="ae30" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">1.æ·»åŠ æ’ä»¶ä¾èµ–å…³ç³»</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="0247" class="mj ky iq mf b be mk ml l mm mn">//use plugins DSL:<br/>plugins {<br/>    id "io.github.ssseasonnn.butterfly" version "1.0.1"<br/>}<br/><br/>//or use legacy plugin application:<br/>buildscript {<br/>    repositories {<br/>        maven {<br/>            url "https://plugins.gradle.org/m2/"<br/>        }<br/>    }<br/>    dependencies {<br/>        classpath "io.github.ssseasonnn:plugin:1.0.1"<br/>    }<br/>}<br/><br/>//add plugin<br/>apply plugin: "io.github.ssseasonnn.butterfly"</span></pre><p id="c79d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.å®ç°æ‚¨è‡ªå·±çš„åº”ç”¨ç¨‹åºç±»</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="c77c" class="mj ky iq mf b be mk ml l mm mn">class DemoApplication : Application() {<br/>    override fun onCreate() {<br/>        super.onCreate()<br/>    }<br/>}</span></pre><p id="58c9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">é€šè¿‡æ’ä»¶ï¼ŒButterflyä¼šè‡ªåŠ¨å‘ç°æ‰€æœ‰çš„è·¯ç”±æ¨¡å—ï¼Œå¹¶è‡ªåŠ¨æ³¨å…¥ä»£ç å°†è·¯ç”±è¡¨æ·»åŠ åˆ°åº”ç”¨ç¨‹åºä¸­ï¼Œä»è€Œè§£æ”¾åŒæ‰‹</p><h1 id="62df" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">ç»“æŸ</h1><p id="7599" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">æ›´å¤šå…³äºButterflyçš„ç»†èŠ‚ï¼Œè¯·åˆ°GitHub: <a class="ae kw" href="https://github.com/ssseasonnn/Butterfly" rel="noopener ugc nofollow" target="_blank"> Butterfly </a></p><p id="de21" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ¬¢è¿æ„Ÿå…´è¶£çš„æœ‹å‹æä¾›åé¦ˆå’Œå»ºè®®ï¼Œè°¢è°¢ã€‚</p></div></div>    
</body>
</html>