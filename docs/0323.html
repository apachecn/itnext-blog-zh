<html>
<head>
<title>Serialize Deserialize Video in fabric JS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åœ¨fabric JSä¸­åºåˆ—åŒ–ååºåˆ—åŒ–è§†é¢‘</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/video-element-serialization-and-deserialization-of-canvas-fc5dbf47666d?source=collection_archive---------3-----------------------#2018-02-19">https://itnext.io/video-element-serialization-and-deserialization-of-canvas-fc5dbf47666d?source=collection_archive---------3-----------------------#2018-02-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/c37756918ac6873d63a74aa383b6e10e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*Pgh5_xtHkyIhoypRslJ6YQ.gif"/></div></figure><p id="d450" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘æ˜¯<a class="ae ks" href="http://fabricjs.com/" rel="noopener ugc nofollow" target="_blank"> fabric.js </a>çš„å¿ å®ç²‰ä¸ï¼Œæˆ‘å‘ç°å®ƒæ˜¯å¯ç”¨äºHTML5 canvasçš„æœ€å¼ºå¤§çš„jsã€‚</p><p id="4159" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘å¾ˆéš¾å°†è§†é¢‘æ¸²æŸ“åˆ°ç”»å¸ƒä¸Šï¼Œç„¶åå°†å…¶ä¿å­˜ä¸ºJSONå¯¹è±¡ï¼Œå¹¶ä½¿ç”¨<strong class="jw ir"> loadFromJson </strong>å†æ¬¡æ¸²æŸ“åˆ°ç”»å¸ƒä¸Š</p><p id="c4ec" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">ç”±äºæ²¡æœ‰å®˜æ–¹æ–¹æ³•æ¥åºåˆ—åŒ–å’Œååºåˆ—åŒ–è§†é¢‘å…ƒç´ <a class="ae ks" href="https://github.com/kangax/fabric.js/issues/3697" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir">é—®é¢˜#3697 </strong> </a></p><p id="01b9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><a class="ae ks" href="http://fabricjs.com/video-element" rel="noopener ugc nofollow" target="_blank">ä½ ç°åœ¨å¯ä»¥ä½¿ç”¨fabric jsæ¸²æŸ“è§†é¢‘å…ƒç´ </a>ï¼Œæœªæ¥çš„ç‰ˆæœ¬å¯èƒ½ä¼šæœ‰è¿™ä¸ªåŠŸèƒ½ï¼Œä½†ä¸ç¡®å®šã€‚</p><div class="kt ku kv kw gt ab cb"><figure class="kx jr ky kz la lb lc paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><img src="../Images/41b893bdf554e7d1d0576a690e7dcb71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*nPn75MWfBWxuasWDO5QqmQ.png"/></div></figure><figure class="kx jr lh kz la lb lc paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><img src="../Images/ff7ea51d7acb7b5122e8a4a290f938a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*Vlt-uhDZe17fa2mVk_fXZA.png"/></div></figure></div><h1 id="c4aa" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">æˆ‘æ˜¯è¿™æ ·åšçš„</h1><h2 id="7b72" class="mg lj iq bd lk mh mi dn lo mj mk dp ls kf ml mm lw kj mn mo ma kn mp mq me mr bi translated">#ç¬¬ä¸€æ­¥</h2><p id="6dcf" class="pw-post-body-paragraph ju jv iq jw b jx ms jz ka kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr ij bi translated">å°†ä¸€ä¸ªè§†é¢‘å…ƒç´ æ¸²æŸ“åˆ°ç”»å¸ƒä¸Šï¼Œä¸‹é¢è¿™æ®µä»£ç å°†æŠŠä¸€ä¸ªè§†é¢‘å…ƒç´ æ¸²æŸ“åˆ°ç”»å¸ƒä¸Šã€‚</p><pre class="kt ku kv kw gt mx my mz na aw nb bi"><span id="e4c8" class="mg lj iq my b gy nc nd l ne nf"><strong class="my ir">function </strong>getVideoElement(url) {<br/>    <strong class="my ir">var </strong>videoE = document.createElement('video');<br/>    videoE.width = 530;<br/>    videoE.height = 298;<br/>    videoE.muted = <strong class="my ir">true</strong>;<br/>    videoE.crossOrigin = "anonymous";<br/>    <strong class="my ir">var </strong>source = document.createElement('source');<br/>    source.src = url;<br/>    source.type = 'video/mp4';<br/>    videoE.appendChild(source);<br/>    <strong class="my ir">return </strong>videoE;<br/>}</span><span id="0d6a" class="mg lj iq my b gy ng nd l ne nf"><strong class="my ir">var</strong> canvas = new fabric.Canvas('c');</span><span id="da87" class="mg lj iq my b gy ng nd l ne nf"><strong class="my ir">var </strong>url_mp4 = 'http://www.quirksmode.org/html5/videos/big_buck_bunny.mp4';<br/><br/><strong class="my ir">var </strong>videoE = getVideoElement(url_mp4);<br/><strong class="my ir">var </strong>fab_video = <strong class="my ir">new </strong>fabric.Image(videoE, {left: 0,   top: 0});</span><span id="36f8" class="mg lj iq my b gy ng nd l ne nf">canvas.add(fab_video);<br/>fab_video.getElement().play();</span><span id="e568" class="mg lj iq my b gy ng nd l ne nf">fabric.util.requestAnimFrame(<strong class="my ir">function </strong>render() {<br/>   canvas.renderAll();<br/>   fabric.util.requestAnimFrame(render);<br/>});</span></pre><p id="8d65" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">ç°åœ¨ï¼Œå¦‚æœæ‚¨å°†ç”»å¸ƒå¯¼å‡ºä¸ºJSON</p><pre class="kt ku kv kw gt mx my mz na aw nb bi"><span id="d18b" class="mg lj iq my b gy nc nd l ne nf">canvas.toJSON();</span></pre><p id="6959" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">ä½ ä¼šçœ‹åˆ°JSONå¯¹è±¡ä¸­æœ‰å¾ˆå¤šå±æ€§ï¼Œä½†æ˜¯ä¸»è¦å…³æ³¨çš„å±æ€§æ˜¯<code class="fe nh ni nj my b">src</code>å’Œ<code class="fe nh ni nj my b">type</code></p><blockquote class="nk nl nm"><p id="4c72" class="ju jv nn jw b jx jy jz ka kb kc kd ke no kg kh ki np kk kl km nq ko kp kq kr ij bi translated"><em class="iq"> {"objects": [{"src ":"ï¼Œ" top": 0ï¼Œ" left": 0ï¼Œ" type": "image "ï¼Œâ€¦}ï¼Œ{}]ï¼Œ" version": "2.0.0-rc.4" } </em></p></blockquote><p id="1727" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">æ³¨:</strong> <code class="fe nh ni nj my b">src</code>ä¸º<strong class="jw ir">ç©ºç™½</strong>ï¼Œ<code class="fe nh ni nj my b">type</code>ä¸º<strong class="jw ir">å›¾åƒï¼Œ</strong>è¡¨ç¤ºç»‡ç‰©å°†è§†é¢‘ä¿å­˜ä¸ºå›¾åƒå¯¹è±¡ï¼Œä½†æ— æ³•åˆ†é…è§†é¢‘æ¥æº</p><h2 id="ef54" class="mg lj iq bd lk mh mi dn lo mj mk dp ls kf ml mm lw kj mn mo ma kn mp mq me mr bi translated">#ç¬¬äºŒæ­¥</h2><p id="2d74" class="pw-post-body-paragraph ju jv iq jw b jx ms jz ka kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr ij bi translated">ä¸ºäº†ä¿å­˜è§†é¢‘å…ƒç´ çš„<code class="fe nh ni nj my b">src</code>ï¼Œä½ éœ€è¦ç»™fabricå¯¹è±¡æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰å±æ€§ï¼Œä¸ºæ­¤ä½ éœ€è¦è¦†ç›–<strong class="jw ir"> fabric </strong> <strong class="jw ir">å¯¹è±¡</strong>ã€‚</p><pre class="kt ku kv kw gt mx my mz na aw nb bi"><span id="88b2" class="mg lj iq my b gy nc nd l ne nf">fabric.Object.prototype.toObject = (<strong class="my ir">function </strong>(toObject) {<br/>    <strong class="my ir">return function </strong>(propertiesToInclude) {<br/>        propertiesToInclude = (propertiesToInclude || []).concat(<br/>            ['video_src']<br/>        );<br/>        <strong class="my ir">return </strong>toObject.apply(<strong class="my ir">this</strong>, [propertiesToInclude]);<br/>    };<br/>})(fabric.Object.prototype.toObject);</span></pre><p id="c38e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">ä¸Šé¢çš„ä»£ç åœ¨å¯¼å‡ºçš„æ—¶å€™ä¼šç»™JSONå¯¹è±¡æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰å±æ€§<code class="fe nh ni nj my b">video_src</code>ï¼Œä½ å¯ä»¥å¯¹å®ƒè¿›è¡Œå…¨å±€åˆå§‹åŒ–ã€‚</p><blockquote class="nk nl nm"><p id="a3e6" class="ju jv nn jw b jx jy jz ka kb kc kd ke no kg kh ki np kk kl km nq ko kp kq kr ij bi translated"><strong class="jw ir">æ³¨æ„:</strong>åœ¨å°†è§†é¢‘å…ƒç´ æ·»åŠ åˆ°ç”»å¸ƒä¹‹å‰è®¾ç½®<code class="fe nh ni nj my b">video_src</code>å±æ€§</p></blockquote><pre class="kt ku kv kw gt mx my mz na aw nb bi"><span id="bd56" class="mg lj iq my b gy nc nd l ne nf"><strong class="my ir">var </strong>fab_video = <strong class="my ir">new </strong>fabric.Image(videoE, {left: 0,   top: 0});</span><span id="7107" class="mg lj iq my b gy ng nd l ne nf">fab_video.set('video_src', url_mp4);</span><span id="9039" class="mg lj iq my b gy ng nd l ne nf">canvas.add(fab_video);</span></pre><p id="6ab9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æ‚¨å°†çœ‹åˆ°å¯¼å‡ºçš„å¯¹è±¡ä¸º:</p><blockquote class="nk nl nm"><p id="0bab" class="ju jv nn jw b jx jy jz ka kb kc kd ke no kg kh ki np kk kl km nq ko kp kq kr ij bi translated"><em class="iq"> {"objects": [{"src ":"ï¼Œ" video _ src ":"</em>http://www.quirksmode.org/html5/videos/big_buck_bunny.mp4<em class="iq">ï¼Œ" top": 0ï¼Œ" left": 0ï¼Œ" type": "image "ï¼Œâ€¦}ï¼Œ{}]ï¼Œ" version": "2.0.0-rc.4" } </em></p></blockquote><h2 id="bdfe" class="mg lj iq bd lk mh mi dn lo mj mk dp ls kf ml mm lw kj mn mo ma kn mp mq me mr bi translated"><strong class="ak">#ç¬¬ä¸‰æ­¥</strong></h2><p id="ee45" class="pw-post-body-paragraph ju jv iq jw b jx ms jz ka kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr ij bi translated">æ‚¨å·²æˆåŠŸå°†è§†é¢‘srcä¿å­˜åˆ°JSONå¯¹è±¡ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦ä½¿ç”¨<strong class="jw ir"> loadFromJSON </strong>å†æ¬¡æ¸²æŸ“å®ƒ</p><blockquote class="nk nl nm"><p id="69e6" class="ju jv nn jw b jx jy jz ka kb kc kd ke no kg kh ki np kk kl km nq ko kp kq kr ij bi translated"><strong class="jw ir"> loadFromJSON </strong>æ–¹æ³•ï¼Œç”¨äºå°†JSONå¯¹è±¡è½¬æ¢ä¸ºå®é™…çš„fabricå¯¹è±¡ï¼Œå¹¶å°†å®ƒä»¬åŠ è½½åˆ°ç”»å¸ƒä¸Šã€‚</p></blockquote><p id="4cb7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">ç°åœ¨çš„é—®é¢˜æ˜¯ï¼Œå®ƒå°†å¦‚ä½•ç†è§£è‡ªå®šä¹‰å±æ€§<code class="fe nh ni nj my b">video_src</code>ï¼Œç­”æ¡ˆæ˜¯ï¼Œå®ƒä¸ä¼šï¼Œæˆ‘ä»¬éœ€è¦å†æ¬¡åˆ›å»ºä¸€ä¸ªè§†é¢‘å…ƒç´ å¹¶æ‰‹åŠ¨æ¸²æŸ“å®ƒã€‚</p><p id="282c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨loadFromJSON çš„å›è°ƒæ–¹æ³•ä¸Šå¾ªç¯éå†å¯¹è±¡ï¼Œæ‰¾å‡ºè§†é¢‘å¯¹è±¡å¹¶æ‰‹åŠ¨å¤„ç†å®ƒï¼Œå…¶ä½™çš„å¯¹è±¡ï¼Œå³<em class="nn">æ–‡æœ¬ã€å›¾åƒ</em>å°†è¢«æ­£ç¡®æ¸²æŸ“ã€‚</p><pre class="kt ku kv kw gt mx my mz na aw nb bi"><span id="0ae7" class="mg lj iq my b gy nc nd l ne nf"><strong class="my ir">var</strong> data = <em class="nn">{â€œobjectsâ€: [{â€œsrcâ€: â€œâ€, â€œvideo_srcâ€: â€œ</em>http://www.quirksmode.org/html5/videos/big_buck_bunny.mp4<em class="nn">â€, â€œtopâ€: 0, â€œleftâ€: 0, â€œtypeâ€: â€œimageâ€, â€¦}, {}], â€œversionâ€: â€œ2.0.0-rc.4â€ }</em></span><span id="254e" class="mg lj iq my b gy ng nd l ne nf"><strong class="my ir">var </strong>canvas = canvas.loadFromJSON(JSON.stringify(data), canvasLoaded , <strong class="my ir">function</strong>(o, object) {<br/>    fabric.log(o, object);<br/>});</span><span id="cd72" class="mg lj iq my b gy ng nd l ne nf"><strong class="my ir">function </strong>canvasLoaded(){      <br/>   canvas.renderAll.bind(canvas);<br/>   <strong class="my ir">var </strong>objs = data['objects'];      <br/>   <strong class="my ir">for</strong>(<strong class="my ir">var </strong>i=0; i&lt; objs.length; i++){<br/>      <strong class="my ir">if</strong>(objs[i].hasOwnProperty('video_src')){<br/>         <strong class="my ir">var </strong>videoE = getVideoElement(objs[i]['video_src']); <br/>         <strong class="my ir">var </strong>fab_video = <strong class="my ir">new </strong>fabric.Image(videoE, {left: objs[i]['left'], top: objs[i]['top']} );                   <br/>         canvas.add(fab_video);<br/>         fab_video.getElement().play();                 <br/>         fabric.util.requestAnimFrame(<strong class="my ir">function </strong>render() {                      <br/>            canvas.renderAll();                     <br/>            fabric.util.requestAnimFrame(render);                <br/>         });<br/>      }<br/>   }<br/>}</span></pre><p id="8237" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨fabricæ¥åºåˆ—åŒ–å’Œååºåˆ—åŒ–è§†é¢‘å…ƒç´ çš„è§£å†³æ–¹æ³•ã€‚</p><p id="33b1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="nn">(é€šè¿‡ç»™åˆ«äºº</em>å¸®åŠ©åˆ«äººåœ¨Mediumä¸Šæ‰¾åˆ°æˆ‘çš„æ–‡ç« )ğŸ‘ğŸ½<em class="nn">ä¸‹å›¾ã€‚)</em></p></div></div>    
</body>
</html>