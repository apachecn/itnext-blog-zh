<html>
<head>
<title>Kubernetes Ingress-Nginx Troubleshooting made Easy with kubectl plugins</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">kubernetes Ingressâ€”â€”ku bectlæ’ä»¶ç®€åŒ–äº†Nginxæ•…éšœæ’é™¤</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/kubernetes-ingress-nginx-troubleshooting-made-easy-with-kubectl-plugins-dbc8fdff35fd?source=collection_archive---------0-----------------------#2019-06-23">https://itnext.io/kubernetes-ingress-nginx-troubleshooting-made-easy-with-kubectl-plugins-dbc8fdff35fd?source=collection_archive---------0-----------------------#2019-06-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8e2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">éšç€éƒ¨ç½²è§„æ¨¡è¶Šæ¥è¶Šå¤§ï¼Œç½‘ç»œé—®é¢˜è¶Šæ¥è¶Šéš¾è§£å†³ã€‚</p><p id="5b3e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ¬æŒ‡å—å°†æä¾›ä½¿ç”¨<em class="kl"> ingress-nginx </em> kubectlæ’ä»¶é€šè¿‡ingressæ§åˆ¶å™¨è°ƒè¯•åº”ç”¨ç¨‹åºè®¿é—®çš„åŸºæœ¬ä¿¡æ¯ã€‚</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/7a408ccca7850335301073745988db90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6dos1e9cp8hqBGzV"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">ç”±<a class="ae lc" href="https://unsplash.com/@borisworkshop?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">é²é‡Œæ–¯Â·æ–¯è«å…‹ç½—ç»´å¥‡</a>åœ¨<a class="ae lc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><p id="c691" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä»Kubernetes 1.12å¼€å§‹ï¼Œå¯ä»¥ä¸ºkubectlç¼–å†™å®šåˆ¶æ’ä»¶ã€‚ingressç¤¾åŒºï¼Œå…·ä½“æ¥è¯´æ˜¯<a class="ae lc" href="https://github.com/alexkursell" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> alexkursell </strong> </a>åœ¨åˆ›å»ºä¸€ä¸ªæ’ä»¶æ¥å¸®åŠ©æˆ‘ä»¬è½»æ¾è°ƒè¯•Ingressé—®é¢˜æ–¹é¢åšäº†å¤§é‡å·¥ä½œã€‚</p><p id="ef17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<em class="kl"> minikube </em>ï¼Œä½†æ˜¯æ‰€æœ‰çš„æ•…éšœæ’é™¤ç¤ºä¾‹éƒ½å¯ä»¥åœ¨ä»»ä½•å…·æœ‰<em class="kl"> ingress-nginx </em>éƒ¨ç½²(0.23.0+)çš„Kubernetesé›†ç¾¤(1.12+)ä¸Šæ‰§è¡Œã€‚</p><h2 id="bb98" class="ld le iq bd lf lg lh dn li lj lk dp ll jy lm ln lo kc lp lq lr kg ls lt lu lv bi translated">è¦æ±‚</h2><p id="123d" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">ä¸ºäº†å¼€å§‹ä½¿ç”¨æœ¬æŒ‡å—ï¼Œå¿…é¡»å®‰è£…ä»¥ä¸‹è½¯ä»¶:</p><ul class=""><li id="3d61" class="mb mc iq jp b jq jr ju jv jy md kc me kg mf kk mg mh mi mj bi translated"><a class="ae lc" href="https://www.virtualbox.org/wiki/Downloads" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> VirtualBox </strong> </a></li><li id="0b43" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated"><a class="ae lc" href="https://kubernetes.io/docs/tasks/tools/install-minikube/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Minikube </strong> </a></li><li id="9a7c" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated"><a class="ae lc" href="https://kubernetes.io/docs/tasks/tools/install-kubectl/#install-kubectl" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Kubectl </strong> </a></li><li id="79e4" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated"><strong class="jp ir">å¿…é¡»åœ¨BIOSä¸­å¯ç”¨VT-x/AMD-vè™šæ‹ŸåŒ–</strong></li><li id="ac0d" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated"><strong class="jp ir">é¦–æ¬¡è¿è¡Œæ—¶çš„äº’è”ç½‘è¿æ¥</strong></li></ul><p id="317d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ³¨:å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨<em class="kl"> ingress-nginx </em>æ§åˆ¶å™¨ï¼Œæˆ‘æ¨èæŸ¥çœ‹æˆ‘çš„æ•™ç¨‹<a class="ae lc" href="https://medium.com/@awkwardferny/getting-started-with-kubernetes-ingress-nginx-on-minikube-d75e58f52b6c" rel="noopener"><strong class="jp ir">Minikube</strong></a>ä¸Šçš„Kubernetes Ingress-Nginxå…¥é—¨ã€‚</p><h2 id="2714" class="ld le iq bd lf lg lh dn li lj lk dp ll jy lm ln lo kc lp lq lr kg ls lt lu lv bi translated">è£…ç½®</h2><p id="f185" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated"><em class="kl"> ingress-nginx </em>æ’ä»¶å¯ä»¥é€šè¿‡<strong class="jp ir"> <em class="kl"> krew </em> </strong>å®‰è£…ï¼Œè¿™æ˜¯ä¸€ä¸ªkubectlæ’ä»¶ä¾èµ–ç®¡ç†å™¨ã€‚ä¸ºäº†å®‰è£…<em class="kl">æ‰³æ‰‹</em>ï¼Œåªéœ€éµå¾ª<a class="ae lc" href="https://github.com/kubernetes-sigs/krew" rel="noopener ugc nofollow" target="_blank">https://github.com/kubernetes-sigs/krew</a>ä¸­æä¾›çš„å®‰è£…æŒ‡å—ã€‚</p><p id="44a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸€æ—¦æ‚¨å®‰è£…äº†<em class="kl"> krew </em>ï¼Œæ‚¨å°±å¯ä»¥é€šè¿‡æ‰§è¡Œä»¥ä¸‹æ“ä½œæ¥è·å–ä¿¡æ¯å¹¶å®‰è£…<strong class="jp ir"><em class="kl">ingress-nginx</em></strong>æ’ä»¶:</p><pre class="kn ko kp kq gt mp mq mr ms aw mt bi"><span id="54bf" class="ld le iq mq b gy mu mv l mw mx"><strong class="mq ir">$ kubectl krew info ingress-nginx</strong></span><span id="8e56" class="ld le iq mq b gy my mv l mw mx">NAME: ingress-nginx<br/>URI: <a class="ae lc" href="https://github.com/kubernetes/ingress-nginx/releases/download/nginx-0.24.0/kubectl-ingress_nginx-darwin-amd64.tar.gz" rel="noopener ugc nofollow" target="_blank">https://github.com/kubernetes/ingress-nginx/releases/download/nginx-0.24.0/kubectl-ingress_nginx-darwin-amd64.tar.gz</a><br/>SHA256: 34e999ddc4e1926bbd7f4bdbb5fc40d6c3a5b2ffd711131e4f62e2d24cb2a179<br/>DESCRIPTION:<br/>The official kubectl plugin for ingress-nginx.</span><span id="d4b1" class="ld le iq mq b gy my mv l mw mx">VERSION: 0.24.0</span><span id="1e19" class="ld le iq mq b gy my mv l mw mx"><strong class="mq ir">$ kubectl krew install ingress-nginx</strong></span><span id="ee33" class="ld le iq mq b gy my mv l mw mx">Updated the local copy of plugin index.<br/>Installing plugin: ingress-nginx<br/>Installed plugin: ingress-nginx</span></pre><p id="0511" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ›´å¤šå…³äº<em class="kl"> krew </em>å’Œkubectlæ’ä»¶çš„ä¸€èˆ¬ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹<a class="ae lc" href="https://youtu.be/83ITOTsXsHU" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">ä¸ºæ‰€æœ‰äººç¼–å†™kubectlæ’ä»¶:å¼€å‘ã€æ‰“åŒ…å’Œåˆ†å‘</strong> </a> <strong class="jp ir"> </strong>æ¥è‡ªKubeCon Europe 2019ã€‚</p><h2 id="7dc5" class="ld le iq bd lf lg lh dn li lj lk dp ll jy lm ln lo kc lp lq lr kg ls lt lu lv bi translated">ä½¿ç”¨</h2><p id="4c40" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">é¦–å…ˆï¼Œæ‚¨å¿…é¡»åˆ›å»ºä¸€ä¸ª<em class="kl"> minikube </em>é›†ç¾¤å¹¶å¯ç”¨å…¥å£æ§åˆ¶å™¨ã€‚æˆ‘ä»¬è¿˜å¯ä»¥éªŒè¯æ˜¯å¦ç”Ÿæˆäº†<em class="kl"> ingress-nginx </em> podsã€‚</p><pre class="kn ko kp kq gt mp mq mr ms aw mt bi"><span id="b4d8" class="ld le iq mq b gy mu mv l mw mx"><strong class="mq ir">$ minikube start</strong></span><span id="f1b3" class="ld le iq mq b gy my mv l mw mx">ğŸ˜„  minikube v1.0.1 on darwin (amd64)<br/>ğŸ¤¹  Downloading Kubernetes v1.14.1 images in the background ...<br/>ğŸ”¥  Creating virtualbox VM (CPUs=2, Memory=2048MB, Disk=20000MB) ...<br/>ğŸ“¶  "minikube" IP address is 192.168.99.100<br/>ğŸ³  Configuring Docker as the container runtime ...<br/>ğŸ³  Version of container runtime is 18.06.3-ce<br/>âŒ›  Waiting for image downloads to complete ...<br/>âœ¨  Preparing Kubernetes environment ...<br/>ğŸšœ  Pulling images required by Kubernetes v1.14.1 ...<br/>ğŸš€  Launching Kubernetes v1.14.1 using kubeadm ...<br/>âŒ›  Waiting for pods: apiserver proxy etcd scheduler controller dns<br/>ğŸ”‘  Configuring cluster permissions ...<br/>ğŸ¤”  Verifying component health .....<br/>ğŸ’—  kubectl is now configured to use "minikube"<br/>ğŸ„  Done! Thank you for using minikube!</span><span id="f919" class="ld le iq mq b gy my mv l mw mx"><strong class="mq ir">$ minikube addons enable ingress</strong></span><span id="e1e2" class="ld le iq mq b gy my mv l mw mx">âœ…  ingress was successfully enabled</span><span id="fe0b" class="ld le iq mq b gy my mv l mw mx"><strong class="mq ir">$ kubectl get pods -n kube-system | grep ingress</strong></span><span id="b65b" class="ld le iq mq b gy my mv l mw mx">nginx-ingress-controller-586cdc477c-74vlb   1/1     Running   0          97s</span></pre><p id="839a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡ç›´æ¥ä»kubectlè¿è¡Œ<em class="kl"> ingress-nginx </em>å‘½ä»¤æ¥æ’é™¤æ•…éšœã€‚</p><pre class="kn ko kp kq gt mp mq mr ms aw mt bi"><span id="4ef2" class="ld le iq mq b gy mu mv l mw mx"><strong class="mq ir">$ kubectl ingress-nginx --help</strong></span><span id="a638" class="ld le iq mq b gy my mv l mw mx">....<br/>Available Commands:<br/>backends  Inspect the dynamic backend information of an ingress-nginx instance<br/>certs     Output the certificate data stored in an ingress-nginx pod<br/>conf      Inspect the generated nginx.conf<br/>exec      Execute a command inside an ingress-nginx pod<br/>general   Inspect the other dynamic ingress-nginx information<br/>help      Help about any command<br/>info      Show information about the ingress-nginx service<br/>ingresses Provide a short summary of all of the ingress definitions<br/>lint      Inspect kubernetes resources for possible issues<br/>logs      Get the kubernetes logs for an ingress-nginx pod<br/>ssh       ssh into a running ingress-nginx pod<br/>...</span></pre><h2 id="fcb6" class="ld le iq bd lf lg lh dn li lj lk dp ll jy lm ln lo kc lp lq lr kg ls lt lu lv bi translated">æ·»åŠ ç”¨äºæµ‹è¯•çš„å…¥å£èµ„æº</h2><p id="e7a1" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">è®©æˆ‘ä»¬å¿«é€Ÿåˆ›å»ºä¸€ä¸ªåœ¨æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨çš„åº”ç”¨ç¨‹åºã€æœåŠ¡å’Œå…¥å£ã€‚</p><p id="7689" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">éƒ¨ç½²åº”ç”¨</strong></p><p id="137d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è®©æˆ‘ä»¬ä½¿ç”¨éƒ¨ç½²æ¥éƒ¨ç½²æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå•å…ƒ(å®¹å™¨)ã€‚å…³äºéƒ¨ç½²çš„æ›´å¤šä¿¡æ¯å¯ä»¥åœ¨<a class="ae lc" href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>æ‰¾åˆ°ã€‚</p><pre class="kn ko kp kq gt mp mq mr ms aw mt bi"><span id="fb81" class="ld le iq mq b gy mu mv l mw mx"><strong class="mq ir">$ echo "<br/>apiVersion: extensions/v1beta1<br/>kind: Deployment<br/>metadata:<br/>  name: meow<br/>spec:<br/>  replicas: 2<br/>  selector:<br/>    matchLabels:<br/>      app: meow<br/>  template:<br/>    metadata:<br/>      labels:<br/>        app: meow<br/>    spec:<br/>      containers:<br/>      - name: meow<br/>        image: gcr.io/kubernetes-e2e-test-images/echoserver:2.1<br/>        ports:<br/>        - containerPort: 8080<br/>" | kubectl apply -f -</strong></span><span id="f90a" class="ld le iq mq b gy my mv l mw mx">deployment.extensions/meow created</span></pre><p id="af7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">é€šè¿‡æœåŠ¡å…¬å¼€pod</strong></p><p id="4ce3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™é‡Œï¼Œæˆ‘ä»¬åœ¨é›†ç¾¤çš„å†…éƒ¨IPä¸Šå…¬å¼€åº”ç”¨ç¨‹åºã€‚æ›´å¤šå…³äºæœåŠ¡çš„ä¿¡æ¯ï¼Œè¯·çœ‹è¿™é‡Œã€‚</p><pre class="kn ko kp kq gt mp mq mr ms aw mt bi"><span id="099e" class="ld le iq mq b gy mu mv l mw mx"><strong class="mq ir">$ echo "<br/>apiVersion: v1<br/>kind: Service<br/>metadata:<br/>  name: meow-svc<br/>spec:<br/>  ports:<br/>  - port: 80<br/>    targetPort: 8080<br/>    protocol: TCP<br/>    name: http<br/>  selector:<br/>    app: meow<br/>" | kubectl apply -f -</strong></span><span id="a77e" class="ld le iq mq b gy my mv l mw mx">service/meow-svc created</span></pre><p id="a35b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">åˆ›å»ºå…¥å£èµ„æº</strong></p><p id="39bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™å…è®¸æˆ‘ä»¬é€šè¿‡<em class="kl"> /meow </em>è·¯å¾„è®¿é—®æœåŠ¡<em class="kl"> meow-svc </em>ã€‚ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯minikubeï¼Œ<em class="kl">cats.com</em>æ˜¯æˆ‘ä»¬çš„è™šæ‹Ÿä¸»æœºï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»é€šè¿‡<em class="kl">ä¸»æœº</em>å¤´æ¥è®¿é—®åº”ç”¨ç¨‹åºã€‚</p><pre class="kn ko kp kq gt mp mq mr ms aw mt bi"><span id="0ec1" class="ld le iq mq b gy mu mv l mw mx"><strong class="mq ir">$ echo "<br/>apiVersion: extensions/v1beta1<br/>kind: Ingress<br/>metadata:<br/>  name: meow-ingress<br/>  namespace: default<br/>spec:<br/>  rules:<br/>  - host: cats.com<br/>    http:<br/>      paths:<br/>      - backend:<br/>          serviceName: meow-svc<br/>          servicePort: 80<br/>        path: /meow<br/>" | kubectl apply -f -</strong></span><span id="f540" class="ld le iq mq b gy my mv l mw mx">ingress.extensions/meow-ingress created</span><span id="7c6d" class="ld le iq mq b gy my mv l mw mx"><strong class="mq ir">$ curl $(minikube ip)/meow -H "host: cats.com"</strong></span><span id="1bdb" class="ld le iq mq b gy my mv l mw mx">....<br/>Request Information:<br/>client_address=172.17.0.7<br/>method=GET<br/>real path=/meow<br/>query=<br/>request_version=1.1<br/>request_scheme=http<br/>request_uri=http://cats.com:8080/meow<br/>....</span></pre></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><h1 id="1669" class="ng le iq bd lf nh ni nj li nk nl nm ll nn no np lo nq nr ns lr nt nu nv lu nw bi translated">æ’é™¤æ•…éšœ</h1><p id="d858" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹ä¸€äº›è°ƒè¯•å·¥ä½œğŸ›ã€‚æˆ‘ä»¬å¯ä»¥é‡‡å–ä¸€äº›æ­¥éª¤æ¥è§£å†³å¸¸è§çš„å…¥ä¾µé—®é¢˜ã€‚</p><h2 id="91c4" class="ld le iq bd lf lg lh dn li lj lk dp ll jy lm ln lo kc lp lq lr kg ls lt lu lv bi translated">éªŒè¯éƒ¨ç½²ã€è¿›å…¥å’Œåç«¯</h2><p id="3270" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">é€šè¿‡éªŒè¯éƒ¨ç½²ã€è¿›å…¥å’Œåç«¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å®é™…ä¸Šæ˜¯å¦è®¾ç½®æ­£ç¡®ã€‚</p><pre class="kn ko kp kq gt mp mq mr ms aw mt bi"><span id="9539" class="ld le iq mq b gy mu mv l mw mx"><strong class="mq ir">$ kubectl ingress-nginx ingresses -n default</strong></span><span id="5564" class="ld le iq mq b gy my mv l mw mx">INGRESS_NAME HOST+PATH ADDRESSES TLS SERVICE SERVICE_PORT ENDPOINTS<br/>meow-ingress  cats.com/meow  10.0.2.15  NO  meow-svc  80  2</span><span id="de77" class="ld le iq mq b gy my mv l mw mx"><strong class="mq ir">$ kubectl ingress-nginx backends -n kube-system --list</strong></span><span id="9d58" class="ld le iq mq b gy my mv l mw mx">default-meow-svc-80<br/>upstream-default-backend</span><span id="cf1a" class="ld le iq mq b gy my mv l mw mx"><strong class="mq ir">$ kubectl ingress-nginx backends -n kube-system --backend upstream-default-meow-svc-80</strong></span><span id="46dc" class="ld le iq mq b gy my mv l mw mx">{<br/>  "endpoints": [<br/>    {<br/>      "address": "172.17.0.8",<br/>      "port": "8080"<br/>    },<br/>    {<br/>      "address": "172.17.0.9",<br/>      "port": "8080"<br/>    }<br/>  ],<br/>  "name": "default-meow-svc-80",<br/>  "noServer": false,<br/>  "port": 80,<br/>  ....</span><span id="5d60" class="ld le iq mq b gy my mv l mw mx"><strong class="mq ir">$ kubectl ingress-nginx lint -n default</strong></span><span id="f1fc" class="ld le iq mq b gy my mv l mw mx">Checking ingresses...<br/>Checking deployments...</span></pre><p id="8e3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é¦–å…ˆï¼Œé€šè¿‡æ£€æŸ¥å…¥å£èµ„æºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ˜¯å¦æ­£ç¡®åœ°é…ç½®äº†å…¥å£ã€‚æˆ‘ä»¬è¿˜å¯ä»¥éªŒè¯ç‰¹å®šçš„åç«¯é…ç½®æ˜¯å¦æ­£ç¡®ã€‚</p><p id="2426" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ€åï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œlintï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä»»ä½•æ½œåœ¨çš„é…ç½®é—®é¢˜ã€‚</p><p id="7d23" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">æ³¨æ„:</strong>å¯¹äºåç«¯å‘½ä»¤ï¼Œå¦‚æœæ‚¨çš„ingress-nginxéƒ¨ç½²æœªå‘½åä¸º<em class="kl"> nginx-ingress-controllerï¼Œæ‚¨å°†éœ€è¦ä¼ é€’åç§°ç©ºé—´ä»¥åŠ<strong class="jp ir"> - <em class="kl">éƒ¨ç½²</em> </strong>æ ‡å¿—ã€‚</em></p><h2 id="ef30" class="ld le iq bd lf lg lh dn li lj lk dp ll jy lm ln lo kc lp lq lr kg ls lt lu lv bi translated">æ£€æŸ¥æ—¥å¿—</h2><p id="7575" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">å¦‚æœå­˜åœ¨ç‰¹å®šé—®é¢˜ï¼Œå¹¶ä¸”æˆ‘ä»¬çŸ¥é“æœåŠ¡å’Œå…¥å£èµ„æºé…ç½®æ­£ç¡®ï¼Œæˆ‘ä»¬åº”è¯¥ç»§ç»­æŸ¥çœ‹æ—¥å¿—ã€‚æ—¥å¿—å°†ç»™å‡ºå¤„ç†å…¥å£èµ„æºé—®é¢˜çš„ç»†èŠ‚ã€‚</p><pre class="kn ko kp kq gt mp mq mr ms aw mt bi"><span id="5d62" class="ld le iq mq b gy mu mv l mw mx"><strong class="mq ir">$ curl $(minikube ip)/meow -H "host: cats.com"</strong></span><span id="ea5f" class="ld le iq mq b gy my mv l mw mx">....<br/>Request Information:<br/>client_address=172.17.0.7<br/>method=GET<br/>real path=/meow<br/>query=<br/>request_version=1.1<br/>request_scheme=http<br/>request_uri=http://cats.com:8080/meow<br/>....</span><span id="2165" class="ld le iq mq b gy my mv l mw mx"><strong class="mq ir">$ kubectl ingress-nginx logs -n kube-system</strong></span><span id="6d5d" class="ld le iq mq b gy my mv l mw mx">....<br/>I0623 04:49:34.058860       6 controller.go:172] Configuration changes detected, backend reload required.</span><span id="0812" class="ld le iq mq b gy my mv l mw mx">I0623 04:49:34.061302       6 event.go:221] Event(v1.ObjectReference{Kind:"Ingress", Namespace:"default", Name:"meow-ingress", UID:"4bb59ae1-9572-11e9-b459-080027ab110d", APIVersion:"extensions/v1beta1", ResourceVersion:"1333", FieldPath:""}): type: 'Normal' reason: 'CREATE' Ingress default/meow-ingress</span><span id="08fb" class="ld le iq mq b gy my mv l mw mx">I0623 04:49:34.226892       6 controller.go:190] Backend successfully reloaded.</span><span id="f8b0" class="ld le iq mq b gy my mv l mw mx">I0623 04:50:01.122763       6 status.go:388] updating Ingress default/meow-ingress status from [] to [{10.0.2.15 }]</span><span id="0f65" class="ld le iq mq b gy my mv l mw mx">192.168.99.1 - [192.168.99.1] - - [23/Jun/2019:05:13:17 +0000] "GET /meow HTTP/1.1" 200 638 "-" "curl/7.54.0" 76 0.001 [default-meow-svc-80] 172.17.0.8:8080 638 0.001 200 176c54287bf24c650c132e6ff3b7aed8</span></pre><p id="32b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™åŸºæœ¬ä¸Šä¸æ£€æŸ¥<em class="kl">å…¥å£-nginx </em>åŠèˆ±è¾“å‡ºçš„æ—¥å¿—åŠŸèƒ½ç›¸åŒã€‚</p><p id="3155" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å‘é€ä¸€ä¸ªcurlï¼Œç„¶åæ£€æŸ¥æ—¥å¿—ï¼Œçœ‹çœ‹æ˜¯å¦ä¸€åˆ‡æ­£å¸¸ã€‚æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œæœ‰å…³äºåç«¯æˆåŠŸåŠ è½½çš„ä¿¡æ¯ï¼Œä»¥åŠcurlé€šè¿‡çš„ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›æ—¥å¿—æ¥ç¡®ä¿æˆ‘ä»¬çš„å…¥å£è¢«æ­£ç¡®åŠ è½½ï¼Œä»¥åŠæŸ¥çœ‹æµé‡æ˜¯å¦é€šè¿‡ã€‚</p><h2 id="3a77" class="ld le iq bd lf lg lh dn li lj lk dp ll jy lm ln lo kc lp lq lr kg ls lt lu lv bi translated">æ£€æŸ¥NGINXé…ç½®</h2><p id="5725" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">æˆ‘ä»¬å¯ä»¥æ£€æŸ¥nginxé…ç½®ï¼Œçœ‹çœ‹æ˜¯å¦æ‰€æœ‰çš„æŒ‡ä»¤å’Œè·¯å¾„éƒ½é…ç½®æ­£ç¡®ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<a class="ae lc" href="http://nginx.org/en/docs/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> nginxæ–‡æ¡£</strong> </a>æ¥çœ‹çœ‹æŒ‡ä»¤å’Œå˜é‡æ˜¯åšä»€ä¹ˆçš„ã€‚</p><pre class="kn ko kp kq gt mp mq mr ms aw mt bi"><span id="794b" class="ld le iq mq b gy mu mv l mw mx"><strong class="mq ir">$ kubectl ingress-nginx conf -n kube-system</strong></span><span id="ba2c" class="ld le iq mq b gy my mv l mw mx"># Configuration checksum: 4909015860030157750<br/># setup custom paths that do not require root access<br/>pid /tmp/nginx.pid;<br/>load_module /etc/nginx/modules/ngx_http_modsecurity_module.so;<br/>daemon off;<br/>worker_processes 2;<br/>worker_rlimit_nofile 523264;<br/>worker_shutdown_timeout 10s ;<br/>....</span><span id="3caa" class="ld le iq mq b gy my mv l mw mx"><strong class="mq ir">$ kubectl ingress-nginx conf -n kube-system --host cats.com</strong></span><span id="8d00" class="ld le iq mq b gy my mv l mw mx">server {<br/>  server_name cats.com ;<br/>  listen 80;<br/>  set $proxy_upstream_name "-";<br/>  location /meow {<br/>    set $namespace      "default";<br/>    set $ingress_name   "meow-ingress";<br/>    set $service_name   "meow-svc";<br/>    set $service_port   "80";<br/>    set $location_path  "/meow";<br/>  rewrite_by_lua_block {<br/>    balancer.rewrite()<br/>  }<br/>  header_filter_by_lua_block {}<br/>  body_filter_by_lua_block {}<br/>  log_by_lua_block {<br/>    balancer.log()<br/>    monitor.call()<br/>  }<br/>  port_in_redirect off;<br/>  set $proxy_upstream_name    "default-meow-svc-80";<br/>  set $proxy_host             $proxy_upstream_name;<br/>  client_max_body_size                    1m;<br/>  ....</span></pre><h2 id="3450" class="ld le iq bd lf lg lh dn li lj lk dp ll jy lm ln lo kc lp lq lr kg ls lt lu lv bi translated">ä½¿ç”¨å…¥å£æ§åˆ¶å™¨ç›’è¿è¡Œå‘½ä»¤</h2><p id="edd9" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">å¦‚æœæˆ‘ä»¬å¸Œæœ›è§£å†³ä»»ä½•å…·ä½“é—®é¢˜ï¼Œæˆ‘ä»¬æ€»æ˜¯å¯ä»¥åœ¨podä¸­è¿è¡Œå‘½ä»¤ã€‚</p><pre class="kn ko kp kq gt mp mq mr ms aw mt bi"><span id="82c6" class="ld le iq mq b gy mu mv l mw mx"><strong class="mq ir">$ kubectl ingress-nginx exec -n kube-system -- curl http://127.0.0.1/meow -H "host: cats.com"</strong></span><span id="d34b" class="ld le iq mq b gy my mv l mw mx">....<br/>Server values:<br/>server_version=nginx: 1.12.2 - lua: 10010<br/>Request Information:<br/>client_address=172.17.0.7<br/>method=GET<br/>real path=/meow<br/>query=<br/>request_version=1.1<br/>request_scheme=http<br/>request_uri=http://cats.com:8080/meow<br/>....</span></pre><p id="8a2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™ä¸<em class="kl">æ‰§è¡Œ</em>åˆ°<em class="kl">å…¥å£-nginx </em>åŠèˆ±çš„åŠŸèƒ½åŸºæœ¬ç›¸åŒã€‚ä¸Šé¢ä½ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æ­£åœ¨æµ‹è¯•æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ˜¯å¦å¯ä»¥ä»æˆ‘ä»¬çš„å…¥å£podè®¿é—®ã€‚</p></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><p id="07a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ„Ÿè°¢é˜…è¯»ï¼Œå¸Œæœ›ä½ å–œæ¬¢ï¼ğŸ˜¸</p><p id="8982" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¦äº†è§£æ›´å¤šå…³äº<em class="kl"> ingress-nginx </em> kubectlæ’ä»¶çš„ä¿¡æ¯ï¼Œä½ å¯ä»¥æŸ¥çœ‹å®ƒçš„<a class="ae lc" href="https://kubernetes.github.io/ingress-nginx/kubectl-plugin/" rel="noopener ugc nofollow" target="_blank">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><p id="337d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¦äº†è§£æ›´å¤šå…³äºè§£å†³å…¥å£é—®é¢˜çš„ä¿¡æ¯ï¼Œä½ å¯ä»¥æŸ¥çœ‹ä¸¹å°¼å°”Â·é©¬ä¸æ–¯çš„ã€ç—›è‹¦(è¾ƒå°‘)NGINXå…¥å£ã€‘ä¸€æ–‡ã€‚è¿™æ˜¯ä¸€ç¯‡å†™å¾—éå¸¸å¥½çš„æ–‡ç« ã€‚</p></div></div>    
</body>
</html>