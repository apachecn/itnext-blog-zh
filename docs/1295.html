<html>
<head>
<title>Refactoring in Swift: Typealias-ing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swiftä¸­çš„é‡æ„:ç±»å‹åˆ«ååŒ–</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/refactoring-swift-using-typealias-93b3c03bb5a9?source=collection_archive---------2-----------------------#2018-09-02">https://itnext.io/refactoring-swift-using-typealias-93b3c03bb5a9?source=collection_archive---------2-----------------------#2018-09-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a894" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">é™¤äº†å°†JSONå®šä¹‰ä¸º[String: Any]ä¹‹å¤–ï¼ŒTypealiasesè¿˜å¯ä»¥æœ‰æ›´å¤šç”¨é€”</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/3e7b00ef308212d1e2efb87206b3dfde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0g9v_DDfTL7nNqlk"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><code class="fe kv kw kx ky b">typealias Swift = Apodidae. </code>ç¿ é¸Ÿæ— è¡€ç¼˜å…³ç³»ã€‚</figcaption></figure><h2 id="c48f" class="kz la iq bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">ç»å…¸ç”¨é€”</h2><p id="01b4" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md li me mf mg lm mh mi mj lq mk ml mm mn ij bi translated">æ‚¨å¯èƒ½ä»¥å‰è§è¿‡æˆ–ä½¿ç”¨è¿‡è¿™äº›ç±»å‹åˆ«åä¹‹ä¸€:</p><pre class="kg kh ki kj gt mo ky mp mq aw mr bi"><span id="2a3f" class="kz la iq ky b gy ms mt l mu mv"><em class="mw">// To give commonly used structures a name</em><br/>typealias JSON = [String: Any]</span><span id="2d12" class="kz la iq ky b gy mx mt l mu mv"><em class="mw">// To combine two or more protocols into a protocol composition</em><br/>typealias UserAPI = GetUserInterface &amp; UpdateUserInterface</span><span id="62a9" class="kz la iq ky b gy mx mt l mu mv"><em class="mw">// To make a closure type more readable</em><br/>typealias Callback = <!-- -->(() -&gt; ())</span></pre><p id="eff8" class="pw-post-body-paragraph lv lw iq lx b ly my jr ma mb mz ju md li na mf mg lm nb mi mj lq nc ml mm mn ij bi translated">æœ¬æ–‡ä¸è®¨è®ºè¿™äº›æƒ…å†µâ€”â€”æœ‰ä¸€ç§æ›´ç®€å•çš„æ–¹æ³•å¯ä»¥æ”¹è¿›ä»£ç ï¼</p><h2 id="a613" class="kz la iq bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">å•ä½æ¸…æ™°åº¦</h2><p id="dae5" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md li me mf mg lm mh mi mj lq mk ml mm mn ij bi translated">å‰å‡ å¤©ï¼Œæˆ‘ç¼–å†™äº†ä¸€ä¸ªåŒ…å«ä¸€äº›å•†ä¸šé€»è¾‘çš„å‡½æ•°æ¥è®¡ç®—ä¸€é¡¿é¥­ä¸­çš„å¡è·¯é‡Œæ•°ã€‚ç»“æœæ˜¯è¿™æ ·çš„:</p><pre class="kg kh ki kj gt mo ky mp mq aw mr bi"><span id="95d4" class="kz la iq ky b gy ms mt l mu mv">func calculate(carbs: Float, protein: Float, fat: Float) -&gt; Float</span></pre><p id="33d4" class="pw-post-body-paragraph lv lw iq lx b ly my jr ma mb mz ju md li na mf mg lm nb mi mj lq nc ml mm mn ij bi translated">ç°åœ¨ï¼Œ<em class="mw">æˆ‘</em>çŸ¥é“è¿™ä¸ªå‡½æ•°å–ä»€ä¹ˆå•ä½ï¼Œè¿”å›ä»€ä¹ˆå•ä½ï¼Œä½†æ˜¯å…¶ä»–äººä¼šçŸ¥é“å—ï¼Ÿ</p><p id="d36f" class="pw-post-body-paragraph lv lw iq lx b ly my jr ma mb mz ju md li na mf mg lm nb mi mj lq nc ml mm mn ij bi translated">è€ƒè™‘ä¸€ä¸‹<code class="fe kv kw kx ky b">TimeInterval</code>ã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ª<code class="fe kv kw kx ky b">Double</code>ï¼Œä½†æ˜¯æ¯å½“æˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ª<code class="fe kv kw kx ky b">TimeInterval</code>æ—¶ï¼Œæˆ‘ä»¬ç«‹å³çŸ¥é“è¯¥å€¼æ˜¯ä»¥ç§’ä¸ºå•ä½çš„é¢„æœŸå€¼ã€‚</p><pre class="kg kh ki kj gt mo ky mp mq aw mr bi"><span id="bb2d" class="kz la iq ky b gy ms mt l mu mv"><em class="mw">// UIView.h</em><br/>func animate(withDuration duration: TimeInterval, animations: @escaping () -&gt; Swift.Void)</span></pre><p id="dffc" class="pw-post-body-paragraph lv lw iq lx b ly my jr ma mb mz ju md li na mf mg lm nb mi mj lq nc ml mm mn ij bi translated">æˆ‘çš„<code class="fe kv kw kx ky b">calculate</code>åŠŸèƒ½ç”šè‡³å¯ä»¥åœ¨æ·»åŠ æ–‡æ¡£æ³¨é‡Šä¹‹å‰å¾—åˆ°æ”¹è¿›:</p><pre class="kg kh ki kj gt mo ky mp mq aw mr bi"><span id="66cd" class="kz la iq ky b gy ms mt l mu mv"><em class="mw">/// A weight representation in Grams<br/></em>typealias Grams = Float</span><span id="0773" class="kz la iq ky b gy mx mt l mu mv"><em class="mw">/// Kilo-calories</em><br/>typealias kCal = Float</span><span id="e70a" class="kz la iq ky b gy mx mt l mu mv">func calculate(carbs: Grams, protein: Grams, fat: Grams) -&gt; kCal</span></pre><p id="a461" class="pw-post-body-paragraph lv lw iq lx b ly my jr ma mb mz ju md li na mf mg lm nb mi mj lq nc ml mm mn ij bi translated">çœ‹èµ·æ¥é‚£äº›è®ºç‚¹æ ¹æœ¬ä¸æ˜¯ç”¨å›½é™…å•ä½åˆ¶çš„ï¼</p><h2 id="06af" class="kz la iq bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">ä¼ ç»ŸAPI</h2><p id="50b1" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md li me mf mg lm mh mi mj lq mk ml mm mn ij bi translated">ç±»å‹åˆ«åè¿˜æœ‰è®¸å¤šå…¶ä»–ç±»ä¼¼çš„ç”¨é€”ã€‚åœ¨æˆ‘ä»¬å½“å‰çš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬åœ¨ä¸ä»¥æ•´æ•°å½¢å¼è¿”å›å¸ƒå°”å€¼çš„APIé›†æˆæ—¶ä½¿ç”¨äº†å®ƒä»¬(æ˜¯çš„ï¼ŒğŸ™„).è¿™æ˜¯æˆ‘ä»¬ä»å…¶ä¸­ä¸€ä¸ªç«¯ç‚¹è·å¾—çš„ç»“æœçš„æ¨¡å‹:</p><pre class="kg kh ki kj gt mo ky mp mq aw mr bi"><span id="73a8" class="kz la iq ky b gy ms mt l mu mv">struct BadgeInfo: Decodable {<br/>            <br/>    let lunch_flg: Int <em class="mw">// 0 or 1</em><br/>    let dinner_flg: Int <em class="mw">// 0 or 1</em><br/>    let snack_flg: Int <em class="mw">// 0 or 1</em><br/>}</span></pre><p id="4eda" class="pw-post-body-paragraph lv lw iq lx b ly my jr ma mb mz ju md li na mf mg lm nb mi mj lq nc ml mm mn ij bi translated">è¿™å¹¶ä¸ç†æƒ³ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç¡®ä¿éœ€è¦ä¸è¿™äº›æ¨¡å‹äº¤äº’çš„å…¶ä»–å¼€å‘äººå‘˜æ„è¯†åˆ°è¿™ä¸‰ä¸ªå±æ€§åªèƒ½æ˜¯<code class="fe kv kw kx ky b">0</code>æˆ–<code class="fe kv kw kx ky b">1</code>ï¼Œè€Œä¸éœ€è¦ä»–ä»¬æ£€æŸ¥æ¨¡å‹æ–‡ä»¶çš„æ³¨é‡Š:</p><pre class="kg kh ki kj gt mo ky mp mq aw mr bi"><span id="29dd" class="kz la iq ky b gy ms mt l mu mv"><em class="mw">/// An integer that can only be zero or one (support for </em>ğŸ™„<em class="mw"> API)</em><br/>typealias BoolInt = Int</span><span id="acfa" class="kz la iq ky b gy mx mt l mu mv">struct BadgeInfo: Decodable {<br/>            <br/>    let lunch_flg: BoolInt<br/>    let dinner_flg: BoolInt<br/>    let snack_flg: BoolInt<br/>}</span></pre><p id="ad9c" class="pw-post-body-paragraph lv lw iq lx b ly my jr ma mb mz ju md li na mf mg lm nb mi mj lq nc ml mm mn ij bi translated">ä½ ç°åœ¨å°±å¯ä»¥å¯¹ä½ çš„é¡¹ç›®è¿™æ ·åšâ€”â€”å®ƒåªæ”¹å˜äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œä¸”(åœ¨æˆ‘çœ‹æ¥)å®ƒä½¿ä½ çš„ä»£ç æ›´å…·å¯è¯»æ€§ã€‚</p><h2 id="0038" class="kz la iq bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">ä¼šå‘˜äººæ•°</h2><p id="590b" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md li me mf mg lm mh mi mj lq mk ml mm mn ij bi translated">æˆ‘æœ€å–œæ¬¢çš„typealiasçš„å¦ä¸€ä¸ªç”¨é€”æ˜¯è·Ÿè¸ªæ ‡è¯†ç¬¦:</p><pre class="kg kh ki kj gt mo ky mp mq aw mr bi"><span id="d6a1" class="kz la iq ky b gy ms mt l mu mv">typealias MemberIdentifier = String<br/>typealias PassengerIdentifier = String</span></pre><p id="1582" class="pw-post-body-paragraph lv lw iq lx b ly my jr ma mb mz ju md li na mf mg lm nb mi mj lq nc ml mm mn ij bi translated">å¦‚æœæ‚¨å¯ä»¥åœ¨éœ€è¦æˆå‘˜ç¼–å·æ—¶ä½¿ç”¨è¿™äº›æ ‡è¯†ç¬¦ï¼Œé‚£ä¹ˆä»»ä½•é˜…è¯»æ‚¨çš„ä»£ç çš„äººéƒ½ä¼šç«‹å³æ¸…æ¥šå“ªä¸ªå‚æ•°éœ€è¦å“ªä¸ªæ ‡è¯†ç¬¦ã€‚</p><pre class="kg kh ki kj gt mo ky mp mq aw mr bi"><span id="4931" class="kz la iq ky b gy ms mt l mu mv"><em class="mw">// Before - are we linking with the membership id or passenger id?</em><br/>func link(user: String, to flight: Flight)</span><span id="4e9e" class="kz la iq ky b gy mx mt l mu mv"><em class="mw">// After - aha! (of course, the argument name could be tidied too..)</em><br/>func link(user: PassengerIdentifier, to flight: Flight)</span></pre><p id="52e6" class="pw-post-body-paragraph lv lw iq lx b ly my jr ma mb mz ju md li na mf mg lm nb mi mj lq nc ml mm mn ij bi translated">æˆ‘ä»¬åœ¨è¿™ä¸ªåœºæ™¯ä¸­å‘ç°çš„å¦ä¸€ä¸ªå—æ¬¢è¿çš„å‰¯ä½œç”¨æ˜¯:æˆ‘ä»¬çš„é™æ€æ¨¡æ‹ŸAPIè¿”å›æ•´æ•°å½¢å¼çš„æˆå‘˜æ•°ï¼Œä½†æ˜¯å½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡è¢«å…è®¸è®¿é—®çœŸæ­£çš„æ¨¡æ‹Ÿæ—¶ï¼Œæˆ‘ä»¬å‘ç°æˆå‘˜æ•°å®é™…ä¸Šæ˜¯å­—ç¬¦ä¸²ã€‚å°†<code class="fe kv kw kx ky b">MemberIdentifier</code>çš„å®šä¹‰ä»<code class="fe kv kw kx ky b">Int</code>æ›´æ”¹ä¸º<code class="fe kv kw kx ky b">String</code>ï¼Œç„¶åæ¸…é™¤ä¸€äº›ç¼–è¯‘é”™è¯¯ï¼Œè¿™æ¯”å¯¹æ¯ä¸ªå¼•ç”¨éƒ½è¿›è¡Œæ›´æ”¹è¦å¿«å¾—å¤šï¼</p><h2 id="e0c4" class="kz la iq bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">è¿˜æœ‰æ›´å¤š</h2><p id="0e85" class="pw-post-body-paragraph lv lw iq lx b ly lz jr ma mb mc ju md li me mf mg lm mh mi mj lq mk ml mm mn ij bi translated">ç±»å‹åˆ«åæ˜¯ä¸€ç§ä¸æ–­å‡ºç°çš„è¯­è¨€ç‰¹æ€§ã€‚ä½œä¸ºè¿™ç¯‡æ–‡ç« çš„ç»“å°¾ï¼Œä¸‹é¢æ˜¯ä¸€äº›å…³äºä¸‹æ¬¡ç¼–å†™å‡½æ•°æ—¶å¦‚ä½•ä½¿ç”¨ç±»å‹åŒ–çš„çµæ„Ÿ:</p><pre class="kg kh ki kj gt mo ky mp mq aw mr bi"><span id="5199" class="kz la iq ky b gy ms mt l mu mv"><em class="mw">// It's clear that the angle is in Radians and not Degrees</em><br/>func pointOnCircumference(given angle: Radians) -&gt; CGPoint</span><span id="0c07" class="kz la iq ky b gy mx mt l mu mv"><em class="mw">// This can be used for a number that must be from 0.0 to 1.0</em><br/>typealias Percentage = Float</span><span id="67bd" class="kz la iq ky b gy mx mt l mu mv"><em class="mw">// Sometimes UIKit APIs still use NSAttributedStringKeys as strings<br/>// But don't make your attribute dictionaries [String: Any]!</em><br/>let someLegacyAttributes: [NSAttributedStringKey.RawValue: Any]</span><span id="4779" class="kz la iq ky b gy mx mt l mu mv"><em class="mw">// For when you are passing around a dictionary of <br/>// ["English": "en", "Japanese": "ja"...]</em><br/>typealias Language = String<br/>typealias LanguageCode = String<br/>let languageMap: [Language: LanguageCode] = ...</span></pre></div></div>    
</body>
</html>