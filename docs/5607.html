<html>
<head>
<title>Graphing Xcode project dependencies â€” Introducing XCGrapher</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç»˜åˆ¶Xcodeé¡¹ç›®ä¾èµ–å…³ç³»XCGrapherç®€ä»‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/graphing-xcode-project-dependencies-introducing-xcgrapher-cb99aa0a325e?source=collection_archive---------1-----------------------#2021-04-15">https://itnext.io/graphing-xcode-project-dependencies-introducing-xcgrapher-cb99aa0a325e?source=collection_archive---------1-----------------------#2021-04-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="48d9" class="pw-subtitle-paragraph jr ip iq bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">æœ€è¿‘ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨å°†æˆ‘ä»¬çš„(è®¸å¤š)å†…éƒ¨åº“ä»CocoaPodsè¿ç§»åˆ°SwiftåŒ…ã€‚ä¸ºäº†å…¨é¢äº†è§£æˆ‘ä»¬çš„è¿›å±•ï¼Œæˆ‘æ„å»ºäº†ä¸€ä¸ªæ–°å·¥å…·ï¼Œéšåå­¦åˆ°äº†ä¸€äº›å¯¹æˆ‘æ¥è¯´æ–°çš„ä¸œè¥¿:åœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½Swiftåº“ï¼</h2></div><p id="0ca9" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">è¿™æ˜¯ä¸€ç¯‡æœ‰ç‚¹é•¿çš„æ–‡ç« ï¼Œæ‰€ä»¥ä¸ºäº†åŠèµ·ä½ çš„èƒƒå£ï¼Œè¿™é‡Œåˆ—å‡ºäº†æˆ‘ä»¬å°†è¦è®¨è®ºçš„éƒ¨åˆ†å†…å®¹(æœ‰æ—¶éå¸¸è¯¦ç»†) :</p><ul class=""><li id="9055" class="lf lg iq kl b km kn kp kq ks lh kw li la lj le lk ll lm ln bi translated">ğŸ’¡æˆ‘ä¸ºä»€ä¹ˆåˆ›å»º<code class="fe jn jo jp jq b">xcgrapher</code>ä»¥åŠå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„</li><li id="db6a" class="lf lg iq kl b km lo kp lp ks lq kw lr la ls le lk ll lm ln bi translated">ğŸ‘¨â€ğŸ’»å¦‚ä½•å†™ä¸€ä¸ª<code class="fe jn jo jp jq b">xcgrapher</code>æ’ä»¶</li><li id="074d" class="lf lg iq kl b km lo kp lp ks lq kw lr la ls le lk ll lm ln bi translated">ğŸ‘¨â€ğŸ”§å¦‚ä½•é˜»æ­¢Swiftç¼–è¯‘å™¨ç¯¡æ”¹å‡½æ•°å</li><li id="0b56" class="lf lg iq kl b km lo kp lp ks lq kw lr la ls le lk ll lm ln bi translated">ğŸ§™â€â™‚ï¸å¦‚ä½•åœ¨è¿è¡Œæ—¶åŠ è½½å’Œæ‰§è¡Œå¤–éƒ¨åŠ¨æ€åº“ä¸­çš„ä»£ç </li><li id="3ca1" class="lf lg iq kl b km lo kp lp ks lq kw lr la ls le lk ll lm ln bi translated">ğŸºå¦‚ä½•é€šè¿‡è‡ªåˆ¶è½¯ä»¶åˆ†å‘SwiftåŒ…</li><li id="8e55" class="lf lg iq kl b km lo kp lp ks lq kw lr la ls le lk ll lm ln bi translated">ğŸ•µï¸â€â™‚ï¸å¦‚ä½•çœ‹åˆ°å’Œæ”¹å˜åŠ¨æ€åº“è·¯å¾„åµŒå…¥åœ¨äºŒè¿›åˆ¶</li></ul><p id="0bd1" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">æœç´¢ä¸Šé¢çš„è¡¨æƒ…ç¬¦å·è·³è½¬åˆ°ä¸€ä¸ªç« èŠ‚ï¼</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi lt"><img src="../Images/bf2962ffe02786dbb7fc739b52647e24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LXyUr3o_7ynpy2qL"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated">ä¸‹é¢æ˜¯xcgrapherå¯ä»¥ä¸ºæ‚¨æä¾›çš„å¼€ç®±å³ç”¨åŠŸèƒ½</figcaption></figure><h1 id="ec59" class="mj mk iq bd ml mm mn mo mp mq mr ms mt ka mu kb mv kd mw ke mx kg my kh mz na bi translated">ğŸ’¡æ¨¡å—è¿ç§»æ··ä¹±</h1><p id="c753" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated">å°†10å¤šä¸ªå®šåˆ¶CocoaPodsè¿ç§»åˆ°SwiftåŒ…æ˜¯ä¸€é¡¹æ£˜æ‰‹çš„ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯å½“å®ƒä»¬ç›¸äº’ä¾èµ–å¹¶ä¸”éƒ½ç”±ä¸‰ä¸ªiOS/tvOSåº”ç”¨ç¨‹åºé¡¹ç›®ä½¿ç”¨æ—¶ã€‚å†³å®šè¿ç§»çš„é¡ºåºå’Œç¡®å®šå“ªäº›ä¾èµ–é¡¹ä¼šå¾ˆå¿«å—åˆ°å½±å“å˜å¾—å¾ˆå›°éš¾ï¼Œæ‰€ä»¥ç”¨ä¸€ä¸ªå›¾è¡¨æ¥æ˜¾ç¤ºè°ä¾èµ–è°å¬èµ·æ¥æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¸»æ„ã€‚</p><p id="183e" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">ä¼¼ä¹æœ‰å„ç§å„æ ·çš„ä¾èµ–ç»˜å›¾å·¥å…·å·²ç»å¯ç”¨ï¼Œä½†æ²¡æœ‰ä¸€ä¸ªæ»¡è¶³æˆ‘çš„æ‰€æœ‰è¦æ±‚ã€‚å‡ºäºæˆ‘çš„ç›®çš„ï¼Œç»˜å›¾å·¥å…·å¿…é¡»:</p><ul class=""><li id="f0fb" class="lf lg iq kl b km kn kp kq ks lh kw li la lj le lk ll lm ln bi translated">åœ¨æ¨¡å—çº§è€Œä¸æ˜¯ç±»çº§ç»˜åˆ¶å›¾å½¢</li><li id="5214" class="lf lg iq kl b km lo kp lp ks lq kw lr la ls le lk ll lm ln bi translated">æ”¯æŒç§äºº/å†…éƒ¨å›¾ä¹¦é¦†</li><li id="a9c1" class="lf lg iq kl b km lo kp lp ks lq kw lr la ls le lk ll lm ln bi translated">åœ¨å•ä¸ªå›¾è¡¨ä¸­æ˜¾ç¤ºSwiftåŒ…å’ŒCocoaPods</li></ul></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="f5f0" class="mj mk iq bd ml mm nn mo mp mq no ms mt ka np kb mv kd nq ke mx kg nr kh mz na bi translated">æŸ¥æ‰¾å¯¼å…¥çš„æ¨¡å—</h1><p id="56c8" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated">æœ€åˆï¼Œæˆ‘ç”¨<code class="fe jn jo jp jq b">objdump</code>(ç¨åä¼šæœ‰æ›´å¤šä»‹ç»)ä½œä¸ºå±•ç¤ºäºŒè¿›åˆ¶æ–‡ä»¶ä¾èµ–äºä»€ä¹ˆåº“çš„ä¸€ç§æ–¹å¼ï¼Œç„¶è€Œå¾ˆå¿«å°±å‘ç°å¹¶ä¸æ˜¯æ‰€æœ‰çš„æƒ…å†µéƒ½å¯ä»¥ç”¨è¿™ç§æ–¹å¼è§£å†³ã€‚ç”±äºæ¯ä¸ªæ¨¡å—å¯¼å…¥éƒ½ç”±ä¸€è¡Œä»£ç è¡¨ç¤ºï¼Œå¦‚<code class="fe jn jo jp jq b">import MyModule</code> â€¦çœ‹èµ·æ¥è¡ŒåŠ¨çš„è¿‡ç¨‹å°±æ˜¯ç®€å•åœ°è®©å·¥å…·è¯»å–è¿™äº›å¯¼å…¥ã€‚</p><h2 id="037a" class="ns mk iq bd ml nt nu dn mp nv nw dp mt ks nx ny mv kw nz oa mx la ob oc mz od bi translated">è¯»å–Xcodeç›®æ ‡çš„ç¼–è¯‘æºåˆ—è¡¨</h2><p id="8289" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated">å¦‚æœä½ å’Œä»»ä½•è§„æ¨¡çš„å›¢é˜Ÿä¸€èµ·åšè¿‡Xcodeé¡¹ç›®ï¼Œé‚£ä¹ˆåœ¨è§£å†³åˆå¹¶å†²çªçš„æ—¶å€™ï¼Œä½ æ— ç–‘å¿…é¡»å¤„ç†è¯»å–<code class="fe jn jo jp jq b">project.pbxproj</code>æ–‡ä»¶çš„å¤´ç—›é—®é¢˜ã€‚æˆ‘ä¸æƒ³èŠ±æ—¶é—´å»ç ´è¯‘å®ƒçš„æ ¼å¼ï¼Œåªæ˜¯ä¸ºäº†å¾—åˆ°ä¸€ä¸ªç¼–è¯‘æºä»£ç çš„åˆ—è¡¨ï¼Œæ‰€ä»¥å¹¸è¿çš„æ˜¯<a class="ae oe" href="https://github.com/CocoaPods/Xcodeproj" rel="noopener ugc nofollow" target="_blank"> Cocoapodså›¢é˜Ÿæœ‰ä¸€ä¸ªå·¥å…·</a>æ¥ä¸å®ƒäº¤äº’ã€‚</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="7e2e" class="ns mk iq jq b gy oj ok l ol om">require 'xcodeproj'</span><span id="d011" class="ns mk iq jq b gy on ok l ol om">Xcodeproj::Project.open("SomeApp.xcodeproj")<br/>    .targets<br/>    .filter do |target|<br/>        target.name == "SomeApp"<br/>    end<br/>    .first<br/>    .source_build_phase.files.to_a<br/>    .each do |file| <br/>        puts file.file_ref.real_path.to_s <br/>    end</span></pre><p id="fe8e" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">è¿™ä¸ªè„šæœ¬â€¦æ˜¯ç”¨Rubyå†™çš„ã€‚è¿™å¾ˆçƒ¦äººï¼Œå› ä¸ºRubyæ„å‘³ç€Gemsï¼ŒGemsæ„å‘³ç€Bundlerï¼ŒBundleræ„å‘³ç€è¿‡äºé¢‘ç¹åœ°å¯¹Rbenvè®¾ç½®è¿›è¡Œæ•…éšœæ’é™¤ã€‚ä½†æ˜¯â€¦â€¦å¤§å¤šæ•°iOSå·¥ç¨‹å¸ˆå·²ç»ä¸ºCocoaPodsåšäº†æ‰€æœ‰è¿™äº›å·¥ä½œï¼Œè¿™æ¯”è§£æpbxprojè¦å¥½ï¼Œæ‰€ä»¥æˆ‘æŠŠå®ƒå‹ç¼©æˆä¸€ä¸ªå¯shellåŒ–çš„ä¸€è¡Œç¨‹åºï¼Œå¹¶ä¸”<a class="ae oe" href="https://github.com/maxchuquimia/xcgrapher/blob/d5b410f1f42bb95ce51453da539834d3678d85a4/Sources/XCGrapherLib/ShellTasks/Xcodeproj.swift#L20" rel="noopener ugc nofollow" target="_blank">é‚£ä¸ª</a>å°±æ˜¯ç›®å‰åœ¨<code class="fe jn jo jp jq b">xcgrapher</code>ä¸­ä½¿ç”¨çš„:</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="d095" class="ns mk iq jq b gy oj ok l ol om"><strong class="jq ir">$</strong> ruby -r xcodeproj -e 'Xcodeproj::Project.open("XXX").targets.filter do |t| t.name == "YYY" end.first.source_build_phase.files.to_a.each do |f| puts f.file_ref.real_path.to_s end'</span></pre><p id="19fa" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">ç°åœ¨ç»§ç»­ã€‚</p><h2 id="a27f" class="ns mk iq bd ml nt nu dn mp nv nw dp mt ks nx ny mv kw nz oa mx la ob oc mz od bi translated">æŸ¥æ‰¾å¯¼å…¥</h2><p id="833b" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated">è¿™ç›¸å¯¹ç®€å•:éå†ç¼–è¯‘æºåˆ—è¡¨ï¼Œæ‰¾åˆ°æ‰€æœ‰å¸¦æœ‰<code class="fe jn jo jp jq b">import Something</code>çš„è¡Œï¼Œå¹¶å°†æ‰€æœ‰çš„<code class="fe jn jo jp jq b">Something</code>ç¼–è¯‘åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ã€‚å¯¼å…¥æœ‰å¤šç§æ–¹å¼ï¼ŒåŒ…æ‹¬:</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="e162" class="ns mk iq jq b gy oj ok l ol om">import Module<br/>@testable import Module<br/>import class Module.Class<br/>@_exported import Module</span></pre><p id="72df" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">æˆ‘å°½å¯èƒ½å¤šåœ°è§£é‡Šäº†è¿™äº›ï¼Œç„¶åæ˜¯ä¸€äº›ã€‚æŸ¥çœ‹<a class="ae oe" href="https://github.com/maxchuquimia/xcgrapher/blob/master/Sources/XCGrapherLib/ImportFinder.swift" rel="noopener ugc nofollow" target="_blank"> ImportFinder </a>è·å–å®Œæ•´åˆ—è¡¨ã€‚</p><h2 id="2d58" class="ns mk iq bd ml nt nu dn mp nv nw dp mt ks nx ny mv kw nz oa mx la ob oc mz od bi translated">åœ¨SwiftåŒ…è£¹ä¸­æŸ¥æ‰¾è¿›å£</h2><p id="c743" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated">åŒæ ·çš„<code class="fe jn jo jp jq b">ImportFinder</code>ä»£ç éœ€è¦åœ¨æ¯ä¸ªSwiftè½¯ä»¶åŒ…ä¸Šè¿è¡Œã€‚æ®æˆ‘æ‰€çŸ¥ï¼Œæ²¡æœ‰ç®€å•çš„æ–¹æ³•åˆ—å‡ºXcodeé¡¹ç›®æ‰€ä¾èµ–çš„æ‰€æœ‰SwiftåŒ…ï¼Œå› ä¸ºæˆ‘ä¹Ÿä¸å¸Œæœ›æˆ‘çš„å·¥å…·åœ¨è¯»å–æ¯ä¸ªåŒ…çš„æºä»£ç ä¹‹å‰å¿…é¡»å…‹éš†æ¯ä¸ªåŒ…çš„æ­£ç¡®æäº¤ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©äº†ç®€å•çš„<a class="ae oe" href="https://github.com/maxchuquimia/xcgrapher/blob/d5b410f1f42bb95ce51453da539834d3678d85a4/Sources/XCGrapherLib/ShellTasks/Xcodebuild.swift#L39" rel="noopener ugc nofollow" target="_blank">è¿è¡Œxcodebuild </a>å¹¶è§£æå…¶è¾“å‡ºä»¥æ‰¾åˆ°æœ¬åœ°åŒ…å…‹éš†ã€‚</p><p id="95ee" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">ä¸€æ—¦çŸ¥é“äº†æ¯ä¸ªåŒ…çš„å…‹éš†ç›®å½•ï¼Œè·å¾—æ¯ä¸ªç›®æ ‡çš„æºæ–‡ä»¶åˆ—è¡¨å°±å¾ˆå®¹æ˜“äº†ï¼</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="3556" class="ns mk iq jq b gy oj ok l ol om"><strong class="jq ir">$</strong> swift package -â€”package-path /path/to/clone describe -â€”type json</span></pre><p id="a93a" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">ç„¶åå‰é¢æåˆ°çš„<code class="fe jn jo jp jq b">ImportFinder</code>å¯ä»¥ç”¨æ¥è¯»å–æ¯ä¸ªåŒ…è£…äº§å“ä¸­çš„æ‰€æœ‰è¿›å£å•†å“ã€‚</p><h2 id="ee00" class="ns mk iq bd ml nt nu dn mp nv nw dp mt ks nx ny mv kw nz oa mx la ob oc mz od bi translated">åœ¨æ¤°å­ä¸­å¯»æ‰¾è¿›å£</h2><p id="641b" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated">è¿™å¯¹æˆ‘æ¥è¯´ä¸æ˜¯ä¸€ä¸ªä¼˜å…ˆè€ƒè™‘çš„é—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬æ­£åœ¨è¿œç¦»cocoa podsâ€”â€”äº‹å®ä¸Šï¼Œ<code class="fe jn jo jp jq b">xcgrapher</code>ç›®å‰ä¸»è¦é¢å‘åªä½¿ç”¨SwiftåŒ…çš„é¡¹ç›®ã€‚ç¼–è¯‘å·²çŸ¥CocoaPodsåˆ—è¡¨çš„æœ€ç®€å•æ–¹æ³•æ˜¯è§£æ<code class="fe jn jo jp jq b">Podfile.lock</code>:å¦‚æœæ‚¨å¯¹æ­¤æ„Ÿå…´è¶£ï¼Œé‚£ä¹ˆè¯·åœ¨è¿™é‡ŒæŸ¥çœ‹å®ç°<a class="ae oe" href="https://github.com/maxchuquimia/xcgrapher/blob/master/Sources/XCGrapherLib/DependencyManagers/CocoapodsManager.swift" rel="noopener ugc nofollow" target="_blank"/>ã€‚</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="3c98" class="mj mk iq bd ml mm nn mo mp mq no ms mt ka np kb mv kd nq ke mx kg nr kh mz na bi translated">ç”¨GraphVizç»˜å›¾</h1><p id="d89a" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated">ä¸€æ—¦ç¼–è¯‘äº†æ‰€æœ‰å¯¼å…¥æ¨¡å—çš„åˆ—è¡¨ï¼Œé‚£ä¹ˆ<code class="fe jn jo jp jq b">xcgrapher</code>å°†éå†å®ƒä»¬ï¼Œå¹¶å°†å®ƒä»¬ä¸å…¶ä»–æ¨¡å—è¿›è¡ŒåŒ¹é…ã€‚å®é™…çš„ç»˜å›¾æ˜¯é€šè¿‡ä½¿ç”¨æœ‰å‘å›¾çš„<a class="ae oe" href="https://graphviz.org/" rel="noopener ugc nofollow" target="_blank"> GraphViz </a>å®Œæˆçš„ã€‚æœ‰å‘å›¾æ˜¯ä¸€ç§ç”¨äºæŒ‡å®šå›¾ä¸Šâ€œèŠ‚ç‚¹â€ä¹‹é—´â€œè¾¹â€çš„æ ¼å¼(ç®­å¤´åœ¨<strong class="kl ir">di</strong>rected-<strong class="kl ir">graph</strong>ä¸­):</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="5f47" class="ns mk iq jq b gy oj ok l ol om">digraph XCGrapher {<br/><br/>  graph [ nodesep = 0.5, ranksep = 4, overlap = false, splines = true ]<br/>  node [ shape = box ]<br/><br/>  "Algorithms" -&gt; "RealModule"<br/>  "Charts" -&gt; "Algorithms"<br/>  "RealModule" -&gt; "_NumericsShims"<br/>  "RealmSwift" -&gt; "Realm"<br/>  "SomeApp" -&gt; "Charts"<br/>  "SomeApp" -&gt; "Lottie"<br/>  "SomeApp" -&gt; "RealmSwift"<br/><br/>}</span></pre><p id="67a5" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">å¦‚æœä½ æƒ³äº²è‡ªå°è¯•ï¼Œåªéœ€ç”¨<code class="fe jn jo jp jq b">brew install graphviz</code>ç„¶åç”¨<code class="fe jn jo jp jq b">dot -T png -o output.png digraph.txt</code>ä»åŒ…å«ä¸Šè¿°å†…å®¹çš„æ–‡æœ¬æ–‡ä»¶ä¸­ç”Ÿæˆä¸€ä¸ªPNGå›¾åƒã€‚å½“åœ¨æœ¬åœ°è¿è¡Œ<code class="fe jn jo jp jq b">xcgrapher</code>æ—¶ï¼Œä½ çš„æœ‰å‘å›¾å­˜å‚¨åœ¨<code class="fe jn jo jp jq b">/tmp/xcgrapher.dot</code>ã€‚</p><p id="6261" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">è¿™æ˜¯æœ€ç®€å•çš„ä¾‹å­ã€‚GraphVizçš„åŠŸèƒ½éå¸¸éå¸¸å¤šã€‚ä¸€å®šè¦å»çœ‹çœ‹ï¼</p><div class="oo op gp gr oq or"><a href="https://graphviz.org/" rel="noopener  ugc nofollow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd ir gy z fp ow fr fs ox fu fw ip bi translated">Graphvizå›¾å½¢å¯è§†åŒ–è½¯ä»¶</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">è¯·åŠ å…¥Graphvizè®ºå›æé—®ï¼Œè®¨è®ºGraphvizã€‚Graphvizæ˜¯å¼€æºçš„å›¾å½¢å¯è§†åŒ–å·¥å…·â€¦</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">graphviz.org</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf md or"/></div></div></a></div></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="7675" class="mj mk iq bd ml mm nn mo mp mq no ms mt ka np kb mv kd nq ke mx kg nr kh mz na bi translated">ğŸ‘¨â€ğŸ’»ä½¿ç”¨XCGrapheræ’ä»¶åˆ›å»ºè‡ªå®šä¹‰å›¾è¡¨</h1><p id="5602" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated">æˆ‘ä»¬æ‰åˆšåˆšå¼€å§‹ã€‚</p><p id="a0d2" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">å¦‚æœä½ æƒ³ç”»åˆ«çš„ä¸œè¥¿å‘¢ï¼Ÿä¾‹å¦‚ï¼Œæˆ‘ä»¬çš„é¡¹ç›®ä½¿ç”¨è‡ªå®šä¹‰å±æ€§åŒ…è£…å™¨<code class="fe jn jo jp jq b">@Injected</code>ä½œä¸ºå°†ä¾èµ–é¡¹æ³¨å…¥ç±»å®ä¾‹çš„æ–¹å¼ã€‚å“ªäº›ç±»éœ€è¦å“ªäº›æ³¨å…¥çš„å›¾è¡¨åœ¨å°†æ¥ä¹Ÿä¼šæœ‰ç”¨â€¦</p><p id="d1b5" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">æ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ª<code class="fe jn jo jp jq b">xcgrapher</code>æ’ä»¶æ¥å®Œæˆè¿™äº›å®šåˆ¶ä»»åŠ¡ï¼Œè€Œä¸æ˜¯ç¼–å†™ä¸Šé¢æè¿°çš„æ‰€æœ‰æ¨¡æ¿ã€‚</p><h2 id="4d1e" class="ns mk iq bd ml nt nu dn mp nv nw dp mt ks nx ny mv kw nz oa mx la ob oc mz od bi translated">æ’ä»¶ç»“æ„</h2><p id="9d47" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated"><code class="fe jn jo jp jq b">xcgrapher</code>æ’ä»¶åªæ˜¯ç¼–è¯‘æˆåŠ¨æ€åº“çš„SwiftåŒ…ï¼Œä¾èµ–äº<code class="fe jn jo jp jq b">XCGrapherPluginSupport</code>:</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="da3a" class="ns mk iq jq b gy oj ok l ol om">let package = Package(<br/>    name: "MyPlugin",<br/>    products: [<br/>        .library(<br/>            name: "MyPlugin",<br/>            type: .dynamic, <br/>            targets: ["MyPlugin"]<br/>        ),<br/>    ],<br/>    dependencies: [<br/>        .package(<br/>            url: "https://github.com/maxchuquimia/XCGrapherPluginSupport.git", <br/>            from: "0.0.6"<br/>        ),<br/>    ],<br/>    targets: [<br/>        .target(<br/>            name: "MyPlugin", <br/>            dependencies: [<br/>                .product(<br/>                    name: "XCGrapherPluginSupport",<br/>                    package: "xcgrapher"<br/>                )<br/>            ]<br/>        ),<br/>    ]<br/>)</span></pre><p id="6bf1" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">åœ¨åŒ…ä¸­ä½ å¯ä»¥<code class="fe jn jo jp jq b">import XCGrapherPluginSupport</code>å’Œå­ç±»<code class="fe jn jo jp jq b">XCGrapherPlugin</code>ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥è¦†ç›–å‡½æ•°æ¥å¸®åŠ©æ„å»ºæ‚¨çš„å›¾å½¢:</p><p id="5590" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><code class="fe jn jo jp jq b"><strong class="kl ir">override func process(file: XCGrapherFile) throws -&gt; [Any] { ... }</strong><br/></code>è¯¥å‡½æ•°ä¸ºé¡¹ç›®ä¸­çš„æ¯ä¸ªæºæ–‡ä»¶è°ƒç”¨ä¸€æ¬¡ï¼Œä¸ºSwiftåŒ…ä¾èµ–å…³ç³»ä¸­çš„æ¯ä¸ªæºæ–‡ä»¶è°ƒç”¨ä¸€æ¬¡(å¦‚æœ<code class="fe jn jo jp jq b">--spm</code>ä¼ é€’ç»™<code class="fe jn jo jp jq b">xcgrapher</code>)ã€‚æ¨¡å‹<code class="fe jn jo jp jq b">XCGrapherFile</code>åŒ…å«å…³äºæºæ–‡ä»¶çš„ä¾¿åˆ©ä¿¡æ¯ï¼Œç„¶åä½ å¯ä»¥ç”¨ä½ è‡ªå·±çš„æ–¹å¼è§£æå®ƒ(è§<a class="ae oe" href="https://github.com/maxchuquimia/XCGrapherPluginSupport/tree/master/Sources/XCGrapherPluginSupport/XCGrapherFile.swift" rel="noopener ugc nofollow" target="_blank">XCGrapherFile</a><em class="pg">)</em>ã€‚</p><p id="8b24" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><code class="fe jn jo jp jq b"><strong class="kl ir">override func process(library: XCGrapherImport) throws -&gt; [Any] { ... }</strong><br/></code>è¿™ä¸ªå‡½æ•°åœ¨ä½ çš„é¡¹ç›®ä¸­çš„æ¯ä¸€ä¸ª<code class="fe jn jo jp jq b">import SomeLibrary</code>è¡Œè¢«è°ƒç”¨ä¸€æ¬¡(å–å†³äºä¼ é€’ç»™<code class="fe jn jo jp jq b">xcgrapher</code>çš„æ ‡å¿—)ã€‚<code class="fe jn jo jp jq b">SomeLibrary</code>ä»¥<code class="fe jn jo jp jq b">XCGrapherImport</code>æ¨¡å¼ä¸ºä»£è¡¨ã€‚å¯ç”¨å‚æ•°è§<a class="ae oe" href="https://github.com/maxchuquimia/XCGrapherPluginSupport/tree/master/Sources/XCGrapherPluginSupport/XCGrapherImport.swift" rel="noopener ugc nofollow" target="_blank"> XCGrapherImport </a>ã€‚</p><p id="fd10" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><code class="fe jn jo jp jq b"><strong class="kl ir">override func makeArrows(from results: [Any]) throws -&gt; [XCGrapherArrow]<br/></strong></code>ä¸Šé¢åˆ—å‡ºçš„å¤„ç†å‡½æ•°è¿”å›çš„æ•°ç»„å°†è¢«è¿æ¥å¹¶ä¼ é€’ç»™ä½ ï¼Œä»¥ä¾¿åœ¨<code class="fe jn jo jp jq b">makeArrows(from:)</code>å‡½æ•°ä¸­è¿›è¡Œæœ€ç»ˆåˆå¹¶ã€‚åœ¨è¿™é‡Œï¼Œä½ åº”è¯¥æŒ‰ç…§ä½ è®¤ä¸ºåˆé€‚çš„æ–¹å¼éå†<code class="fe jn jo jp jq b">results</code>ï¼Œä»¥ä¾¿è¿”å›ä¸€ä¸ª<code class="fe jn jo jp jq b">XCGrapherArrow</code>æ¨¡å‹çš„åˆ—è¡¨ï¼Œè¿™äº›æ¨¡å‹å°†è¢«ä¼ é€’ç»™GraphVizå¹¶è¢«ç»˜åˆ¶åˆ°<code class="fe jn jo jp jq b">xcgrapher</code>çš„<code class="fe jn jo jp jq b">--output</code> PNGæ–‡ä»¶ä¸­ã€‚</p><p id="edbb" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><em class="pg">æˆ‘åœ¨è¿™é‡Œé€‰æ‹©ä½¿ç”¨</em> <code class="fe jn jo jp jq b"><em class="pg">Any</em></code> <em class="pg">æ˜¯ä¸ºäº†ç»™ä½ è¿™ä¸ªæ’ä»¶æ„å»ºè€…å°½å¯èƒ½å¤šçš„çµæ´»æ€§ã€‚å¼ºåˆ¶æ’ä»¶æˆä¸º</em> <code class="fe jn jo jp jq b"><em class="pg">XCGrapherPlugin</em></code> <em class="pg">çš„å­ç±»ï¼Œè€Œä¸æ˜¯ä»»ä½•ç¬¦åˆåè®®çš„å¯¹è±¡ï¼Œè¿™æ˜¯å¦ä¸€ä¸ªæˆ˜ç•¥å†³ç­–ï¼Œä½¿æ’ä»¶æ„å»ºè€…çš„ç”Ÿæ´»æ›´å®¹æ˜“ï¼Œå› ä¸ºæœ‰äº›æ£˜æ‰‹çš„äº‹æƒ…éœ€è¦ä»¥ååšâ€”â€”ç»§ç»­é˜…è¯»ï¼</em></p><p id="aae1" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">å› æ­¤ï¼Œå¦‚æœæ‚¨æƒ³è¦ç»˜åˆ¶æ¯ä¸ªæ–‡ä»¶(åŒ…æ‹¬SwiftåŒ…)ä¸­çš„æ‰€æœ‰<code class="fe jn jo jp jq b">@Injected</code>è¡Œï¼Œæ‚¨éœ€è¦åšçš„å°±æ˜¯è§£æ<code class="fe jn jo jp jq b">process(file:)</code>ä¸­çš„<code class="fe jn jo jp jq b">file</code>ï¼Œè¿”å›æ‚¨è‡ªå·±çš„è¡¨ç¤º<code class="fe jn jo jp jq b">@Injected</code>å…³ç³»çš„å¯¹è±¡ï¼Œç„¶ååœ¨<code class="fe jn jo jp jq b">makeArrows(from:)</code>å‡½æ•°ä¸­å°†è¯¥å¯¹è±¡è½¬æ¢ä¸º<code class="fe jn jo jp jq b">XCGrapherArrow</code>ï¼</p><h2 id="ab3b" class="ns mk iq bd ml nt nu dn mp nv nw dp mt ks nx ny mv kw nz oa mx la ob oc mz od bi translated">ğŸ‘¨â€ğŸ”§é¿å…æ··ä¹±çš„å‡½æ•°å</h2><p id="921f" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated">ä½ æœ‰æ²¡æœ‰åœ¨Xcodeçš„è°ƒè¯•å™¨ä¸­ç¼–è¾‘è¿‡ä¸€äº›ä¸œè¥¿ï¼Œå¹¶æ³¨æ„åˆ°ä¸€ä¸ªç±»çš„åå­—çœ‹èµ·æ¥â€¦ <em class="pg">æ··ä¹±ä¸å ª</em>ï¼Ÿä¾‹å¦‚ï¼Œè€ƒè™‘ä»¥ä¸‹Swiftæ–‡ä»¶:</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="5f04" class="ns mk iq jq b gy oj ok l ol om"><em class="pg">// doSomething.swift</em></span><span id="ae7a" class="ns mk iq jq b gy on ok l ol om">public func <!-- -->thisFunctionDoesSomething<!-- -->() {<br/>    print("doing something...")<br/>}</span></pre><p id="0946" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">å¦‚æœæ‚¨è¦å°†è¿™ä¸ª<code class="fe jn jo jp jq b">doSomething.swift</code>ç¼–è¯‘æˆä¸€ä¸ªåŠ¨æ€åº“:</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="4790" class="ns mk iq jq b gy oj ok l ol om"><strong class="jq ir">$</strong> swiftc -emit-library -module-name libDoSomething doSomething.swift</span></pre><p id="4b54" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">ç„¶åä½¿ç”¨<code class="fe jn jo jp jq b">nm</code>æ‰“å°å‡ºç»“æœdylibä¸­çš„æ‰€æœ‰ç¬¦å·ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„å‡½æ•°åç§°<code class="fe jn jo jp jq b">thisFunctionDoesSomething()</code>ä¸å†æ˜¯æˆ‘ä»¬æ‰€æœŸæœ›çš„:</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="a6e3" class="ns mk iq jq b gy oj ok l ol om"><strong class="jq ir">$</strong> nm -an liblibDoSomething.dylib <br/>                 U _$sSS21_builtinStringLiteral17utf8CodeUnitCount7isASCIISSBp_BwBi1_tcfC<br/>                 U _$sSSN<br/>                 U _$ss27_allocateUninitializedArrayySayxG_BptBwlF<br/>                 U _$ss5print_9separator10terminatoryypd_S2StF<br/>                 U _$sypN<br/>                 U _swift_bridgeObjectRelease<br/>                 U dyld_stub_binder<br/>0000000000003e50 T <strong class="jq ir">_$s14libDoSomething016thisFunctionDoesC0yyF</strong><br/>0000000000003f00 t _$ss5print_9separator10terminatoryypd_S2StFfA0_<br/>0000000000003f20 t _$ss5print_9separator10terminatoryypd_S2StFfA1_<br/>0000000000003fa8 s ___swift_reflection_version<br/>0000000000008020 d __dyld_private</span></pre><blockquote class="ph pi pj"><p id="1803" class="kj kk pg kl b km kn jv ko kp kq jy kr pk kt ku kv pl kx ky kz pm lb lc ld le ij bi translated">Swiftç¼–è¯‘å™¨å°†è¢«ç ´åçš„åç§°å‘é€åˆ°äºŒè¿›åˆ¶æ˜ åƒä¸­ï¼Œä»¥å¯¹è¿è¡Œæ—¶å®ä¾‹åŒ–å’Œåå°„çš„ç±»å‹å¼•ç”¨è¿›è¡Œç¼–ç ã€‚åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œè¿™äº›æ··ä¹±çš„åç§°å¯èƒ½ä¼šåµŒå…¥æŒ‡å‘è¿è¡Œæ—¶æ•°æ®ç»“æ„çš„æŒ‡é’ˆï¼Œä»¥ä¾¿æ›´æœ‰æ•ˆåœ°è¡¨ç¤ºæœ¬åœ°å®šä¹‰çš„ç±»å‹ã€‚<br/>â€”<a class="ae oe" href="https://github.com/apple/swift/blob/main/docs/ABI/Mangling.rst" rel="noopener ugc nofollow" target="_blank">https://github . com/apple/swift/blob/main/docs/ABI/mangling . rst</a></p></blockquote><p id="a59a" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">ç®€è€Œè¨€ä¹‹ï¼Œåç§°ç®¡ç†å…è®¸ç¼–è¯‘å™¨ä»¥ç¡®å®šçš„æ–¹å¼ä¸ºå‡½æ•°ç”Ÿæˆæ–°åç§°â€”â€”è¿™å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒå…è®¸æˆ‘ä»¬å¼€å‘äººå‘˜ç¼–å†™(ä¾‹å¦‚)ä¸¤ä¸ªåŒåçš„å‡½æ•°(æ¯æ¬¡æˆ‘ä»¬åœ¨å­ç±»ä¸­è¦†ç›–å‡½æ•°æ—¶éƒ½ä¼šè¿™æ ·åš)ã€‚</p><p id="4143" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">ä¸ºäº†é¿å…åœ¨Swiftä¸­æ··æ·†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="fe jn jo jp jq b">@_cdecl</code>å±æ€§æ¥æŒ‡å®šç¼–è¯‘å™¨åº”è¯¥ä¸ºè¢«æ³¨é‡Šçš„å‡½æ•°å­˜å‚¨çš„ç¡®åˆ‡ç¬¦å·å:</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="1c39" class="ns mk iq jq b gy oj ok l ol om"><em class="pg">// doSomething.swift</em></span><span id="e187" class="ns mk iq jq b gy on ok l ol om"><strong class="jq ir">@_cdecl("thisFunctionDoesSomething")</strong><br/>public func thisFunctionDoesSomething() {<br/>    print("doing something...")<br/>}</span></pre><p id="b095" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">ç°åœ¨ï¼Œå½“æˆ‘ä»¬ç¼–è¯‘å¹¶åˆ—å‡ºdylibäºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„ç¬¦å·æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°æˆ‘ä»¬çš„å‡½æ•°åï¼</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="443c" class="ns mk iq jq b gy oj ok l ol om"><strong class="jq ir">$</strong> swiftc -emit-library -module-name libDoSomething doSomething.swift<br/><strong class="jq ir">$</strong> nm -an liblibDoSomething.dylib <br/>                 U _$sSS21_builtinStringLiteral17utf8CodeUnitCount7isASCIISSBp_BwBi1_tcfC<br/>                 U _$sSSN<br/>                 U _$ss27_allocateUninitializedArrayySayxG_BptBwlF<br/>                 U _$ss5print_9separator10terminatoryypd_S2StF<br/>                 U _$sypN<br/>                 U _swift_bridgeObjectRelease<br/>                 U dyld_stub_binder<br/>0000000000003e40 T _<strong class="jq ir">thisFunctionDoesSomething</strong><br/>0000000000003e50 T _$s14libDoSomething016thisFunctionDoesC0yyF<br/>0000000000003f00 t _$ss5print_9separator10terminatoryypd_S2StFfA0_<br/>0000000000003f20 t _$ss5print_9separator10terminatoryypd_S2StFfA1_<br/>0000000000003fa8 s ___swift_reflection_version<br/>0000000000008020 d __dyld_private</span></pre><p id="e205" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">åœ¨è¿è¡Œæ—¶åŠ è½½åº“æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç¼–è¯‘ç¬¦å·ä¹‹å‰çŸ¥é“å®ƒä»¬çš„åç§°ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è°ƒç”¨å®ƒä»¬â€”â€”æ‰€ä»¥åœ¨åˆ›å»ºè‡ªå®šä¹‰<code class="fe jn jo jp jq b">XCGrapherPlugin</code>å­ç±»çš„æ’ä»¶dylibä¸­æ³¨é‡Šä¸€ä¸ªå‡½æ•°æ˜¯å¿…é¡»çš„:</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="1a87" class="ns mk iq jq b gy oj ok l ol om">@_cdecl("makeXCGrapherPlugin")                       <br/>public func makeXCGrapherPlugin() -&gt; UnsafeMutableRawPointer {<br/>    Unmanaged.passRetained(MyPlugin()).toOpaque()                       }</span></pre><p id="de8b" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨<code class="fe jn jo jp jq b">UnsafeMutableRawPointer</code>,å› ä¸ºæˆ‘ä»¬æ­£åœ¨åšDodgy Thingsï¼Œè€ŒSwiftç¼–è¯‘å™¨ä¸å¸Œæœ›å¯¹å¤§é‡å¯èƒ½å‡ºé”™çš„äº‹æƒ…è´Ÿè´£ã€‚</p><blockquote class="ph pi pj"><p id="02e3" class="kj kk pg kl b km kn jv ko kp kq jy kr pk kt ku kv pl kx ky kz pm lb lc ld le ij bi translated"><strong class="kl ir">é‚£æ˜¯æ–¯å¨å¤«ç‰¹é«˜ä¸¾åŒæ‰‹åé€€â€¦â€¦â€œå˜¿ï¼Œä½ è‡ªå·±çœ‹ç€åŠå§ï¼Œä¼™è®¡â€</strong><br/>â€”â€”æˆ‘çš„åŒäº‹åœ¨æˆ‘å‘ä»–å±•ç¤ºäº†å®ç°ä¹‹å</p></blockquote><p id="44f2" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">(å®é™…ä¸Š<code class="fe jn jo jp jq b">@_cdecl</code>å°†å‡½æ•°æ ‡è®°ä¸ºCå£°æ˜ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨Cå…¼å®¹çš„è¿”å›å€¼ã€‚æœ‰ä¸€äº›å…³äºè®©å®ƒå¾—åˆ°å®˜æ–¹æ”¯æŒçš„è®¨è®ºï¼Œå¸Œæœ›å®ƒèƒ½å¾ˆå¿«å®ç°ï¼)</p><h2 id="6031" class="ns mk iq bd ml nt nu dn mp nv nw dp mt ks nx ny mv kw nz oa mx la ob oc mz od bi translated">ç¼–è¯‘åŠ¨æ€åº“</h2><p id="e438" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated">åƒæ„å»ºä»»ä½•SwiftåŒ…ä¸€æ ·æ„å»ºåº“:</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="179b" class="ns mk iq jq b gy oj ok l ol om"><strong class="jq ir">$</strong> swift build -c release --disable-sandbox</span></pre><p id="39df" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">ç„¶åè¯¥åº“è¢«ä¿å­˜åˆ°<code class="fe jn jo jp jq b">./.build/release/libMyPlugin.dylib</code></p><h2 id="e101" class="ns mk iq bd ml nt nu dn mp nv nw dp mt ks nx ny mv kw nz oa mx la ob oc mz od bi translated">ğŸ§™â€â™‚ï¸åœ¨è¿è¡Œæ—¶åŠ è½½åŠ¨æ€åº“</h2><p id="1257" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»å°†dylibå­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œå›åˆ°ä¸»ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒçš„è·¯å¾„ä¼ é€’ç»™<code class="fe jn jo jp jq b">dlopen()</code>ï¼Œå¹¶æ£€ç´¢æŒ‡å‘å‰é¢æ ‡æœ‰<code class="fe jn jo jp jq b">@_cdecl("makeXCGrapherPlugin")</code>çš„å‡½æ•°çš„ç¬¦å·:</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="988a" class="ns mk iq jq b gy oj ok l ol om">let path = "/path/to/libMyPlugin.dylib"<br/>let openResult = dlopen(path, RTLD_NOW|RTLD_LOCAL)<br/>guard openResult != nil else { ... }<br/>defer { dlclose(openResult) }</span><span id="8dd5" class="ns mk iq jq b gy on ok l ol om">let symbol = dlsym(openResult, "makeXCGrapherPlugin")</span></pre><p id="99e8" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">å¦‚æœä½ æƒ³äº†è§£<code class="fe jn jo jp jq b">RTLD_NOW</code>å’Œ<code class="fe jn jo jp jq b">RTLD_LOCAL</code>(æˆ‘çŸ¥é“ä½ ä¸æƒ³ï¼)ï¼Œé‚£ä¹ˆ<a class="ae oe" href="https://pubs.opengroup.org/onlinepubs/009696699/functions/dlopen.html" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>æœ‰ä¸€äº›ä¿¡æ¯ç»™ä½ ã€‚æˆ‘ä¼¼ä¹è®°å¾—è¯»åˆ°è¿‡ï¼Œå¯èƒ½å®é™…ä¸Šå¹¶ä¸éœ€è¦<code class="fe jn jo jp jq b">RTLD_LOCAL</code>ï¼Œå› ä¸ºå®ƒæ˜¯é»˜è®¤çš„ï¼Œé™¤éä½ æŒ‡å®š<code class="fe jn jo jp jq b">RTLD_GLOBAL</code> â€¦ä½†æ˜¯æˆ‘åœ¨ç½‘ä¸Šçœ‹åˆ°çš„ä¸€åŠSwiftä¾‹å­éƒ½ä½¿ç”¨å®ƒï¼Œæ‰€ä»¥æˆ‘ç°åœ¨æŠŠå®ƒç•™åœ¨è¿™é‡Œã€‚æ›´å¤šçš„æ˜¯å…³äºæˆ‘ä¸çŸ¥é“æˆ‘æ˜¯å¦åº”è¯¥åˆ é™¤çš„ä¸œè¥¿ã€‚</p><p id="b749" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">æ— è®ºå¦‚ä½•ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯¥ç¬¦å·è½¬æ¢ä¸ºä¸åŠ¨æ€åº“ä¸­çš„Dodgy Thingså‡½æ•°å…·æœ‰ç›¸åŒç­¾åçš„å‡½æ•°:</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="6b0b" class="ns mk iq jq b gy oj ok l ol om">typealias MakeFunc = @convention(c) () -&gt; UnsafeMutableRawPointer</span><span id="1201" class="ns mk iq jq b gy on ok l ol om">let makePlugin = unsafeBitCast(symbol, to: MakeFunc.self)</span></pre><p id="21d5" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">æœ€åè°ƒç”¨å‡½æ•°å¾—åˆ°åŠ¨æ€åº“ä¸­å®šä¹‰çš„<code class="fe jn jo jp jq b">XCGrapherPlugin</code>å­ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="ca03" class="ns mk iq jq b gy oj ok l ol om">let pluginPointer = makeXCGrapherPlugin()<br/>let plugin = Unmanaged&lt;XCGrapherPlugin&gt;.fromOpaque(pluginPointer)<br/>    .takeRetainedValue()</span></pre><blockquote class="ph pi pj"><p id="9f98" class="kj kk pg kl b km kn jv ko kp kq jy kr pk kt ku kv pl kx ky kz pm lb lc ld le ij bi translated"><strong class="kl ir">è€¶å“‡ã€‚è¿™æ¯”æˆ‘æƒ³è±¡çš„ç®€å•å¤šäº†<br/> </strong> â€”æˆ‘çš„åŒäº‹(åŒä¸€ä¸ªåŒäº‹)</p></blockquote><p id="8b47" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">è¦ä½¿ç”¨æ–°åˆ›å»ºçš„<code class="fe jn jo jp jq b">xcgrapher</code>æ’ä»¶ï¼Œè¯·å°†å…¶è·¯å¾„ä¼ é€’ç»™<code class="fe jn jo jp jq b">xcgrapher</code>å·¥å…·çš„<code class="fe jn jo jp jq b">--plugin</code>é€‰é¡¹ã€‚</p><h2 id="8ae2" class="ns mk iq bd ml nt nu dn mp nv nw dp mt ks nx ny mv kw nz oa mx la ob oc mz od bi translated">å®ä¾‹å’Œå‚è€ƒ</h2><p id="e185" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated"><code class="fe jn jo jp jq b">xcgrapher</code>çš„åŠ¨æ€åº“åŠ è½½ä»£ç å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹<a class="ae oe" href="https://github.com/maxchuquimia/xcgrapher/blob/master/Sources/XCGrapherLib/PluginSupport/PluginLoader.swift" rel="noopener ugc nofollow" target="_blank">ã€‚å›¾å½¢æ¨¡å—å¯¼å…¥çš„é»˜è®¤è¡Œä¸ºæ˜¯ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„æ’ä»¶å®ç°çš„ï¼Œå¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹</a><a class="ae oe" href="https://github.com/maxchuquimia/xcgrapher/tree/master/Sources/XCGrapherModuleImportPlugin" rel="noopener ugc nofollow" target="_blank"/>ã€‚</p><p id="76fe" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">æˆ‘ç¬¬ä¸€æ¬¡ä»<a class="ae oe" href="https://theswiftdev.com/building-and-loading-dynamic-libraries-at-runtime-in-swift/" rel="noopener ugc nofollow" target="_blank">è¿™ç¯‡</a>ç²¾å½©çš„æ–‡ç« ä¸­äº†è§£åˆ°ä»¥è¿™ç§æ–¹å¼åŠ è½½åº“â€”â€”ä»–ä»¬çš„æ–¹æ³•å’Œæˆ‘çš„æœ‰ç‚¹ä¸åŒï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³äº†è§£æ›´å¤šï¼Œè¯·é˜…è¯»ä¸€ä¸‹ï¼æœ€åï¼Œ<a class="ae oe" href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/DynamicLibraries/100-Articles/DynamicLibraryUsageGuidelines.html#//apple_ref/doc/uid/TP40001928-SW10" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>æ˜¯ä¸€äº›å…³äº<code class="fe jn jo jp jq b">dlopen()</code>å’Œæœ‹å‹çš„å®˜æ–¹æ–‡çŒ®ã€‚</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="3846" class="mj mk iq bd ml mm nn mo mp mq no ms mt ka np kb mv kd nq ke mx kg nr kh mz na bi translated">å‡ºç‰ˆ</h1><p id="83c5" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated">æ„å»ºå·¥å…·çš„æœ€åä¸€æ­¥æ˜¯ä½¿å…¶æ˜“äºå®‰è£…ã€‚åœ¨macOSä¸–ç•Œä¸­ï¼Œè¿™æ„å‘³ç€é€šè¿‡<code class="fe jn jo jp jq b">brew</code>æ¥å®‰è£…å®ƒã€‚</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi pn"><img src="../Images/375d89b35d86b725983995e73797381c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PMQbS1DEjlv3dEX5"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated"><a class="ae oe" href="https://www.jspowerhour.com/comics/263" rel="noopener ugc nofollow" target="_blank">https://www.jspowerhour.com/comics/263</a></figcaption></figure><p id="c3c4" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">å¦‚æœä½ æƒ³å®‰è£…<code class="fe jn jo jp jq b">xcgrapher</code>ï¼Œä½ éœ€è¦å…ˆæ·»åŠ æˆ‘çš„æ°´é¾™å¤´ã€‚</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="39e2" class="ns mk iq jq b gy oj ok l ol om"><strong class="jq ir">$</strong> brew tap maxchuquimia/scripts<br/><strong class="jq ir">$</strong> brew install xcgrapher<br/><em class="pg"># If you donâ€™t use CocoaPods youâ€™ll also need to </em><a class="ae oe" href="https://github.com/CocoaPods/Xcodeproj" rel="noopener ugc nofollow" target="_blank"><em class="pg">install Xcodeproj</em></a><em class="pg">.</em></span></pre><p id="63f5" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">æˆ‘é€‰æ‹©ä½¿ç”¨æˆ‘è‡ªå·±çš„æ°´é¾™å¤´ï¼Œè€Œä¸æ˜¯å°†å…¶æ·»åŠ åˆ°brewä¸»æ°´é¾™å¤´ï¼Œå› ä¸ºæˆ‘ä¸å¤ªå–œæ¬¢åƒå®¶é…¿å’ŒCocoaPodsé‚£æ ·ä¿æŒä¸€åˆ‡é›†ä¸­(å‡ºäºé€Ÿåº¦åŸå› )ã€‚æˆ‘ä¸ªäººå¸Œæœ›SwiftåŒ…è£¹æ°¸è¿œä¸è¦èµ°è¿™æ¡è·¯â€¦</p><h2 id="3c09" class="ns mk iq bd ml nt nu dn mp nv nw dp mt ks nx ny mv kw nz oa mx la ob oc mz od bi translated">ç¼–è¯‘ã€å®‰è£…å’ŒåµŒå…¥å¼åŠ¨æ€åº“è·¯å¾„</h2><p id="4133" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated">ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶çš„SwiftåŒ…å®é™…ä¸Šä¸ä»»ä½•brewå¯å®‰è£…å·¥å…·æ²¡æœ‰ä»€ä¹ˆä¸åŒ:åªéœ€æ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶å¹¶å°†å…¶ç§»åŠ¨åˆ°ç”±<code class="fe jn jo jp jq b">brew</code>æŒ‡å®šçš„ä½ç½®ã€‚æˆ‘ä½¿ç”¨äº†ä¸€ä¸ªMakefileæ¥å®Œæˆè¿™é¡¹å·¥ä½œ:</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="7808" class="ns mk iq jq b gy oj ok l ol om">prefix ?= /usr/local<br/>bindir = $(prefix)/bin<br/>libdir = $(prefix)/lib<br/>buildroot = $(shell swift build -c release --show-bin-path)<br/><br/>configure:<br/>	echo "let DEFAULT_PLUGIN_LOCATION=\"$(libdir)/libXCGrapherModuleImportPlugin.dylib\"" &gt; Sources/xcgrapher/Generated.swift<br/><br/>build: configure<br/>	swift build -c release --disable-sandbox<br/><br/>install: build<br/>	mkdir -p "$(bindir)"<br/>	mkdir -p "$(libdir)"<br/>	install "$(buildroot)/xcgrapher" "$(bindir)"<br/>	install "$(buildroot)/libXCGrapherPluginSupport.dylib" "$(libdir)"<br/>	install "$(buildroot)/libXCGrapherModuleImportPlugin.dylib" "$(libdir)"<br/>	install_name_tool -change "$(buildroot)/libXCGrapherPluginSupport.dylib" "$(libdir)/libXCGrapherPluginSupport.dylib" "$(bindir)/xcgrapher"<br/><br/>uninstall:<br/>	rm -rf "$(bindir)/xcgrapher"<br/>	rm -rf "$(libdir)/libXCGrapherPluginSupport.dylib"<br/>	rm -rf "$(libdir)/libXCGrapherModuleImportPlugin.dylib"<br/><br/>clean:<br/>	rm -rf .build<br/>	rm Sources/xcgrapher/Generated.swift<br/><br/>.PHONY: build install uninstall clean configure</span></pre><p id="5f2b" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">è¿™é‡Œå‘ç”Ÿäº†ä¸€äº›äº‹æƒ…ï¼é¦–å…ˆæ˜¯ä¸€äº›å®šä¹‰ï¼Œç„¶åæ˜¯å‡ ä¸ªæ­¥éª¤:</p><p id="710a" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kl ir">å‰ç¼€ï¼Ÿ= /usr/local <br/></strong></p><p id="2a86" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kl ir"> bindir </strong>å’Œ<strong class="kl ir"> libdir <br/>å’Œ</strong>è¿™ä¸¤ä¸ªå˜é‡å®šä¹‰äº†äºŒè¿›åˆ¶æ–‡ä»¶å’Œåº“åº”è¯¥å®‰è£…çš„ç›®å½•ã€‚</p><p id="2a2d" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kl ir"> buildroot <br/> </strong>è¿™ä¸ªå˜é‡è¢«è®¾ç½®ä¸º<code class="fe jn jo jp jq b">swift build -c release --show-bin-path</code>çš„è¾“å‡ºâ€”â€”è¿™æ˜¯<code class="fe jn jo jp jq b">swift build</code>åœ¨ç¼–è¯‘æ—¶å°†å·¥ä»¶å†™å…¥çš„ç›®å½•ã€‚</p><p id="8315" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kl ir">é…ç½®:</strong><br/><code class="fe jn jo jp jq b">configure</code>ç›®æ ‡å°†é¢„æµ‹çš„dylibå®‰è£…è·¯å¾„å†™å…¥<code class="fe jn jo jp jq b">xcgrapher</code>çš„åŒ…å†…çš„æ–‡ä»¶ä¸­ã€‚ç„¶ååœ¨ç¼–è¯‘æ—¶è·å¾—ï¼Œç”Ÿæˆçš„<code class="fe jn jo jp jq b">DEFAULT_PLUGIN_LOCATION</code>å˜é‡è¢«ç”¨ä½œ<code class="fe jn jo jp jq b">--plugin</code>å‚æ•°çš„é»˜è®¤å€¼ã€‚</p><p id="5ed9" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kl ir">æ„å»º:</strong><br/><code class="fe jn jo jp jq b">build</code>ç›®æ ‡é¦–å…ˆè¿è¡Œé…ç½®æ­¥éª¤ã€‚ç„¶åä½¿ç”¨<code class="fe jn jo jp jq b">mkdir -p</code>ç¡®ä¿äºŒè¿›åˆ¶å’Œåº“ç›®å½•å­˜åœ¨ã€‚ç¬¬ä¸€ä¸ª<code class="fe jn jo jp jq b">install</code>å‘½ä»¤å®‰å…¨åœ°å°†<code class="fe jn jo jp jq b">xcgrapher</code>äºŒè¿›åˆ¶æ–‡ä»¶å¤åˆ¶åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ç›®å½•ï¼Œç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ª<code class="fe jn jo jp jq b">install</code>å‘½ä»¤å°†<code class="fe jn jo jp jq b">libXCGrapherPluginSupport.dylib</code>å’Œ<code class="fe jn jo jp jq b">libXCGrapherModuleImportPlugin.dylib</code>å¤åˆ¶åˆ°åº“ç›®å½•ã€‚</p><p id="c4f6" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kl ir">ğŸ•µï¸â€â™‚ï¸install _ name _ tool<br/></strong><code class="fe jn jo jp jq b">install_name_tool</code>æ˜¯ä¸€ä¸ªæœ‰è¶£çš„å‘½ä»¤:å®ƒæ‰“å¼€ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶(ç¬¬ä¸‰ä¸ªå‚æ•°)å¹¶å°†åŒ¹é…ç¬¬ä¸€ä¸ªå‚æ•°çš„dylibè·¯å¾„æ›´æ”¹ä¸ºç¬¬äºŒä¸ªå‚æ•°çš„è·¯å¾„ã€‚ä½¿ç”¨<code class="fe jn jo jp jq b">install_name_tool</code>ä¼¼ä¹æ˜¯é©¬ç‰¹Â·æ±¤æ™®æ£®(ä¸€ä¸ªå¯é çš„çŸ¥è¯†æ¥æº)æ¨èçš„<a class="ae oe" href="https://nshipster.com/homebrew/" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œæ˜¯</a>ï¼Œä½†æ˜¯åœ¨ä»–çš„æ–‡ç« ä¸­ä»–å¹¶æ²¡æœ‰è¯¦ç»†è¯´æ˜åœ¨ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦å®ƒã€‚æ‰€ä»¥ï¼Œæˆ‘å½“ç„¶å†³å®šè°ƒæŸ¥ä¸€ä¸‹ã€‚</p><p id="f5d1" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">è®©æˆ‘ä»¬çœ‹çœ‹<code class="fe jn jo jp jq b">xcgrapher</code>ä¾èµ–çš„æ‰€æœ‰åŠ¨æ€åº“(æ³¨æ„<code class="fe jn jo jp jq b">/usr/local/bin/xcgrapher</code>æ˜¯<code class="fe jn jo jp jq b">xcgrapher</code>äºŒè¿›åˆ¶å®‰è£…çš„è·¯å¾„) :</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="a435" class="ns mk iq jq b gy oj ok l ol om"><strong class="jq ir">$</strong> objdump -p /usr/local/bin/xcgrapher<br/><br/>/usr/local/bin/xcgrapher:    file format Mach-O 64-bit x86-64<br/><br/>Mach header<br/>      magic cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags<br/>MH_MAGIC_64  X86_64        ALL  0x00     EXECUTE    30       4240   NOUNDEFS DYLDLINK TWOLEVEL PIE<br/>Load command 0<br/>&lt;redacted&gt;<br/>&lt;redacted&gt;<br/>&lt;redacted&gt;<br/>Load command 13<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 56<br/>         name /usr/lib/libobjc.A.dylib (offset 24)<br/>   time stamp 2 Thu Jan  1 10:00:02 1970<br/>      current version 228.0.0<br/>compatibility version 1.0.0<br/>Load command 14<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 56<br/>         name /usr/lib/libSystem.B.dylib (offset 24)<br/>   time stamp 2 Thu Jan  1 10:00:02 1970<br/>      current version 1292.60.1<br/>compatibility version 1.0.0<br/>Load command 15<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 64<br/>         name @rpath/libXCGrapherPluginSupport.dylib (offset 24)<br/>   time stamp 2 Thu Jan  1 10:00:02 1970<br/>      current version 0.0.0<br/>compatibility version 0.0.0<br/>Load command 16<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 96<br/>         name /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation (offset 24)<br/>   time stamp 2 Thu Jan  1 10:00:02 1970<br/>      current version 1770.255.0<br/>&lt;redacted&gt;<br/>&lt;redacted&gt;<br/>&lt;redacted&gt;</span></pre><p id="3eaa" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">å¥½çš„ï¼Œè®©æˆ‘ä»¬å†è¯•ä¸€æ¬¡ï¼Œè¿™æ¬¡è¿›è¡Œä¸€äº›è¿‡æ»¤(åªæ‰“å°åŒ¹é…<code class="fe jn jo jp jq b">LC_LOAD_DYLIB</code>åŠå…¶åä¸¤è¡Œçš„è¡Œ) :</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="5d9f" class="ns mk iq jq b gy oj ok l ol om"><strong class="jq ir">$</strong> objdump -p /usr/local/bin/xcgrapher | grep LC_LOAD_DYLIB -A 2<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 56<br/>         name /usr/lib/libobjc.A.dylib (offset 24)<br/>--<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 56<br/>         name /usr/lib/libSystem.B.dylib (offset 24)<br/>--<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 64<br/><strong class="jq ir">         name @rpath/libXCGrapherPluginSupport.dylib (offset 24)</strong><br/>--<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 96<br/>         name /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation (offset 24)<br/>--<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 64<br/>         name /usr/lib/swift/libswiftCore.dylib (offset 24)<br/>--<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 64<br/>         name /usr/lib/swift/libswiftDarwin.dylib (offset 24)<br/>--<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 64<br/>         name /usr/lib/swift/libswiftFoundation.dylib (offset 24)</span></pre><p id="3da9" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°<code class="fe jn jo jp jq b">xcgrapher</code>éœ€è¦çš„æ‰€æœ‰dylibsåŒ…æ‹¬æˆ‘ä»¬è‡ªå·±çš„<code class="fe jn jo jp jq b">libXCGrapherPluginSupport</code>(æ³¨æ„ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬åœ¨è¿è¡Œæ—¶åŠ è½½çš„æ’ä»¶æœ¬èº«:è¿™æ˜¯å®šä¹‰æˆ‘ä»¬ä¹‹å‰è°ˆåˆ°çš„è¶…ç±»<code class="fe jn jo jp jq b">XCGrapherPlugin</code>çš„åŒ…)ã€‚</p><p id="11eb" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><code class="fe jn jo jp jq b">libXCGrapherPluginSupport</code>æ²¡æœ‰åƒå…¶ä»–åº“ä¸€æ ·ç»™å‡ºå®Œæ•´çš„è·¯å¾„:è€Œæ˜¯ä»¥<code class="fe jn jo jp jq b">@rpath</code>å¼€å§‹ï¼è¿™æ˜¯ä¸€ä¸ª<a class="ae oe" href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/DynamicLibraries/100-Articles/RunpathDependentLibraries.html" rel="noopener ugc nofollow" target="_blank">ç‰¹æ®Šçš„å®</a>ï¼Œå®ƒå…è®¸æˆ‘ä»¬<em class="pg">é¿å…</em>ä¸å¾—ä¸åšçš„äº‹æƒ…ï¼Œæ¯”å¦‚ä½¿ç”¨<code class="fe jn jo jp jq b">install_name_tool</code>å¹¶ä½¿æˆ‘ä»¬å¼€å‘è€…èƒ½å¤Ÿåˆ†å‘å¸¦æœ‰dylibsçš„ç¨‹åºã€‚äº‹å®ä¸Šï¼ŒMakefileä¸­çš„<code class="fe jn jo jp jq b">install_name_tool</code>å‘½ä»¤ä¼¼ä¹å®Œå…¨æ²¡æœ‰ç”¨ï¼Œå› ä¸ºå®ƒè¯•å›¾åŒ¹é…<code class="fe jn jo jp jq b">.build/release/libXCGrapherPluginSupport.dylib</code>è€Œä¸æ˜¯<code class="fe jn jo jp jq b">@rpath/libXCGrapherPluginSupport.dylib</code>ã€‚</p><p id="70ed" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">æ”¹å˜åº”è¯¥åŠ è½½çš„dylibè·¯å¾„çš„çœŸæ­£æ–¹æ³•æ˜¯:</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="0c07" class="ns mk iq jq b gy oj ok l ol om"><strong class="jq ir">$ </strong>install_name_tool -change "@rpath/libXCGrapherPluginSupport.dylib" "/new/dylib/path/something.dylib" /usr/local/bin/xcgrapher</span></pre><p id="41c2" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">ç°åœ¨ï¼Œå½“æˆ‘ä»¬å†æ¬¡æœç´¢å·²åŠ è½½çš„åº“æ—¶:</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="b23a" class="ns mk iq jq b gy oj ok l ol om"><strong class="jq ir">$</strong> objdump -p /usr/local/bin/xcgrapher | grep LC_LOAD_DYLIB -A 2<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 56<br/>         name /usr/lib/libobjc.A.dylib (offset 24)<br/>--<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 56<br/>         name /usr/lib/libSystem.B.dylib (offset 24)<br/>--<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 56<br/><strong class="jq ir">         name /new/dylib/path/something.dylib (offset 24)</strong><br/>--<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 96<br/>         name /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation (offset 24)<br/>--<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 64<br/>         name /usr/lib/swift/libswiftCore.dylib (offset 24)<br/>--<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 64<br/>         name /usr/lib/swift/libswiftDarwin.dylib (offset 24)<br/>--<br/>          cmd LC_LOAD_DYLIB<br/>      cmdsize 64<br/>         name /usr/lib/swift/libswiftFoundation.dylib (offset 24)</span></pre><p id="fdac" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><code class="fe jn jo jp jq b">libXCGrapherPluginSupport.dylib</code>ä¸è§è¸ªå½±ã€‚å¦‚æœæˆ‘ä»¬ç°åœ¨å°è¯•è¿è¡Œ<code class="fe jn jo jp jq b">xcgrapher</code>ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªæˆ‘ä»¬ä¸­çš„ä¸€äº›äººå¯èƒ½å¾ˆç†Ÿæ‚‰çš„é”™è¯¯:</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="11c8" class="ns mk iq jq b gy oj ok l ol om"><strong class="jq ir">$</strong> xcgrapher <br/>dyld: Library not loaded: /new/dylib/path/something.dylib<br/>  Referenced from: /usr/local/bin/xcgrapher<br/>  Reason: image not found<br/>Abort trap: 6</span></pre><p id="e51e" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">æˆ‘åœ¨Makefileä¸­ç•™ä¸‹<code class="fe jn jo jp jq b">install_name_tool</code>çš„åŸå› ä¸»è¦æ˜¯æ‹…å¿ƒæˆ‘ç¼ºä¹è¿™æ–¹é¢çš„çŸ¥è¯†ã€‚ä¹Ÿè®¸é©¬ç‰¹çŸ¥é“ä¸€äº›æˆ‘ä¸çŸ¥é“çš„äº‹æƒ…ï¼Œä¹Ÿè®¸åœ¨ä»–çš„æœºå™¨ä¸Šè¿è¡Œ<code class="fe jn jo jp jq b">swift build</code>æ—¶ï¼Œå°±ä¸ç”¨<code class="fe jn jo jp jq b">@rpath</code>å®äº†ï¼Ÿæˆ‘è¿™é‡Œåªæœ‰ä¸¤å°ç”µè„‘å¯ä»¥æµ‹è¯•å®‰è£…ï¼Œä¹Ÿè®¸å¦‚æœæˆ‘åœ¨ç¬¬ä¸‰å°ç”µè„‘ä¸Šè¯•ä¸€è¯•ï¼Œå°±ä¼šéœ€è¦å®ƒäº†ï¼Ÿç°åœ¨ï¼Œæˆ‘è¦ç•™ç€å®ƒã€‚</p><p id="d6f2" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">æ— è®ºå¦‚ä½•ï¼Œå›åˆ°éå†Makefileã€‚</p><p id="fb46" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kl ir">å¸è½½:<br/></strong><code class="fe jn jo jp jq b">uninstall</code>ç›®æ ‡ä»æ‚¨çš„æœºå™¨ä¸Šåˆ é™¤äºŒè¿›åˆ¶æ–‡ä»¶å’Œåº“ã€‚</p><p id="335f" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kl ir">æ¸…é™¤:</strong><br/><code class="fe jn jo jp jq b">clean</code>ç›®æ ‡æ¸…é™¤ä»»ä½•ç”±<code class="fe jn jo jp jq b">build</code>æ­¥éª¤åˆ›å»ºçš„å·¥ä»¶ã€‚</p><p id="0bc9" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kl ir">ã€‚å‡çš„<br/> </strong>è¿™å®šä¹‰äº†ä¸€ä¸ªä¸æ˜¯æ–‡ä»¶çš„ç›®æ ‡åˆ—è¡¨(æ®æˆ‘æ‰€çŸ¥<code class="fe jn jo jp jq b">make</code>å®é™…ä¸Šæ˜¯å…³äºåˆ›å»ºæ–‡ä»¶çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç¡®ä¿å®ƒä¸ä¼šè¢«æˆ‘ä»¬æ‰€å†™çš„å†…å®¹æ‰€æ··æ·†â€”â€”æ›´å¤šå…³äºé‚£ä¸ª<a class="ae oe" href="https://www.gnu.org/software/make/manual/html_node/Phony-Targets.html" rel="noopener ugc nofollow" target="_blank">åœ¨è¿™é‡Œ</a>)ã€‚</p><h2 id="11ca" class="ns mk iq bd ml nt nu dn mp nv nw dp mt ks nx ny mv kw nz oa mx la ob oc mz od bi translated">ğŸºè‡ªåˆ¶é…æ–¹</h2><p id="2d7a" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated"><code class="fe jn jo jp jq b">brew</code>å‘½ä»¤è¯»å–ä¸€ä¸ªâ€œå…¬å¼â€,è¯¥å…¬å¼å®šä¹‰äº†å®‰è£…å‘½ä»¤éœ€è¦åšçš„äº‹æƒ…ã€‚<code class="fe jn jo jp jq b">xcgrapher</code>çš„å…¬å¼çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:</p><pre class="lu lv lw lx gt of jq og oh aw oi bi"><span id="4b8b" class="ns mk iq jq b gy oj ok l ol om">class Xcgrapher &lt; Formula<br/>  desc "Framework-level dependency graph generator for Xcode projects "<br/>  homepage "https://github.com/maxchuquimia/xcgrapher"<br/>  url "https://github.com/maxchuquimia/xcgrapher.git",<br/>      :tag =&gt; "0.0.8", :revision =&gt; "d5b410f1f42bb95ce51453da539834d3678d85a4"<br/>  head "https://github.com/maxchuquimia/xcgrapher.git"<br/><br/>  depends_on :xcode =&gt; ["12.4", :build]<br/>  depends_on "graphviz"<br/><br/>  def install<br/>    system "make", "install", "prefix=#{prefix}"<br/>  end<br/><br/>end</span></pre><p id="9fed" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">é¦–å…ˆï¼Œå®šä¹‰å…³äºæºä»£ç å’Œç‰ˆæœ¬çš„ä¿¡æ¯ã€‚ç„¶å<code class="fe jn jo jp jq b">depends_on</code>ç¡®ä¿Xcodeå­˜åœ¨ï¼Œå¹¶åœ¨å¿…è¦æ—¶å®‰è£…<code class="fe jn jo jp jq b">graphviz</code>(è®°ä½ï¼Œ<code class="fe jn jo jp jq b">xcgrapher</code>éœ€è¦GraphViz' <code class="fe jn jo jp jq b">dot</code>å‘½ä»¤)ã€‚ç„¶å<code class="fe jn jo jp jq b">install</code>å‡½æ•°åœ¨é¡¹ç›®å…‹éš†çš„ç›®å½•ä¸­è°ƒç”¨<code class="fe jn jo jp jq b">make install</code>ã€‚</p><p id="2266" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">æ­£å¦‚æœ¬æ–‡å‰é¢æåˆ°çš„ï¼Œ<code class="fe jn jo jp jq b">prefix=#{prefix}</code>æ˜¯Makefileä¸­çš„<code class="fe jn jo jp jq b">prefix</code>å˜é‡è¢«è¦†ç›–çš„åœ°æ–¹ã€‚é€šè¿‡ä½¿ç”¨å…¬å¼çš„å‰ç¼€è€Œä¸æ˜¯æˆ‘ä»¬åœ¨Makefileä¸­ç¼–å†™çš„å¸¸é‡<code class="fe jn jo jp jq b">/usr/local</code>,æˆ‘ä»¬å…è®¸Homebrewä¼˜é›…åœ°ç®¡ç†å®‰è£…ã€‚åœ¨æˆ‘çš„ä¾‹å­ä¸­<code class="fe jn jo jp jq b">prefix</code>å˜æˆäº†<code class="fe jn jo jp jq b">/usr/local/Cellar/xcgrapher/0.0.8</code>ã€‚ä¸è¿‡ä¸ç”¨æ‹…å¿ƒï¼Œbrewè±¡å¾æ€§åœ°å°†æ‰€æœ‰ä¸œè¥¿éƒ½é“¾æ¥åˆ°äº†<code class="fe jn jo jp jq b">/usr/local </code>(è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘å¯ä»¥åœ¨å‰é¢çš„ä¾‹å­ä¸­ä½¿ç”¨<code class="fe jn jo jp jq b">/usr/local/bin/xcgrapher</code>)ã€‚</p><p id="36dc" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><code class="fe jn jo jp jq b">xcgrapher</code>çš„å…¬å¼å‘è¡¨åœ¨<a class="ae oe" href="https://github.com/maxchuquimia/homebrew-scripts" rel="noopener ugc nofollow" target="_blank">æˆ‘çš„tap </a>ã€‚æœ€ç®€å•çš„å®šåˆ¶tapæ˜¯ä»¥ä½ çš„åå­—å‘½åçš„GitHub repoï¼Œåä¸º<code class="fe jn jo jp jq b">hombrew-scripts</code>ï¼Œå…¬å¼å­˜å‚¨åœ¨<code class="fe jn jo jp jq b">Formula</code>ç›®å½•ä¸­ã€‚å½“ç„¶ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ƒä¼šå˜å¾—æ›´åŠ å¤æ‚:åœ¨è¿™é‡Œ<a class="ae oe" href="https://github.com/Homebrew/brew/blob/master/docs/How-to-Create-and-Maintain-a-Tap.md" rel="noopener ugc nofollow" target="_blank">é˜…è¯»å…¨éƒ¨å†…å®¹</a>ã€‚</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="0947" class="mj mk iq bd ml mm nn mo mp mq no ms mt ka np kb mv kd nq ke mx kg nr kh mz na bi translated">dlclose(æœ¬æ–‡)</h1><p id="2017" class="pw-post-body-paragraph kj kk iq kl b km nb jv ko kp nc jy kr ks nd ku kv kw ne ky kz la nf lc ld le ij bi translated">æ„Ÿè°¢æ‚¨è¯»åˆ°è¿™é‡Œï¼æˆ‘å¸Œæœ›<code class="fe jn jo jp jq b">xcgrapher</code>åœ¨æŸäº›æ–¹é¢å¯¹ä½ æœ‰ç”¨ï¼Œå³ä½¿å®ƒåªæ˜¯ä¸€ä¸ªå®Œå…¨ä¸åŒçš„ä¸œè¥¿çš„èµ·ç‚¹ã€‚</p><div class="oo op gp gr oq or"><a href="https://github.com/maxchuquimia/xcgrapher" rel="noopener  ugc nofollow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd ir gy z fp ow fr fs ox fu fw ip bi translated">maxchuquimia/xcgrapher</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">é»˜è®¤æƒ…å†µä¸‹ï¼Œxcgrapheræ˜¯Xcodeé¡¹ç›®çš„æ¡†æ¶çº§ä¾èµ–å›¾ç”Ÿæˆå™¨ã€‚å®ƒé€šè¿‡è¯»å–æœ¬åœ°â€¦</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">github.com</p></div></div><div class="pa l"><div class="po l pc pd pe pa pf md or"/></div></div></a></div><p id="8180" class="pw-post-body-paragraph kj kk iq kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">æˆ‘ä¼šæŠŠ<code class="fe jn jo jp jq b">xcgrapher --help</code>ç•™ç»™ä½ â€”â€”ä½†æ˜¯ç°åœ¨ï¼Œæ™šå®‰:)</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi pp"><img src="../Images/32b21a2dc9c252ac114f018693f16305.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kCAYl251pFaNaKheSbAN3A.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated">åˆ¶å›¾å¿«ä¹ï¼</figcaption></figure></div></div>    
</body>
</html>