# è½¯ä»¶èšç„¦:Huskyï¼Œgit æŒ‚é’©å˜å¾—ç®€å•

> åŸæ–‡ï¼š<https://itnext.io/software-spotlight-husky-git-hooks-made-easy-dc326e6c9dbb?source=collection_archive---------5----------------------->

![](img/5791bcf2f4dcb4a2a2e6868ff27de2aa.png)

æˆ‘å‡ ä¹æ¯å¤©éƒ½å¶ç„¶å‘ç°ä¼Ÿå¤§çš„å¼€æºåº“æˆ–å·¥å…·â€”â€”å…¶ä¸­ä¸€äº›æ‹¥æœ‰æ•°ä»¥åƒè®¡çš„ GitHub ä¹‹æ˜Ÿï¼Œä½†æˆ‘ä»æœªå¬è¯´è¿‡å®ƒä»¬ã€‚æˆ‘æƒ³ä»…ä»…åœ¨ GitHub ä¸Šå°±æœ‰è¶…è¿‡ 1 äº¿ä¸ªä»“åº“çš„äº‹å®å¯ä»¥è§£é‡Šè¿™ä¸€ç‚¹ã€‚

ç„¶è€Œï¼Œæˆ‘æ€»æ˜¯å–œæ¬¢åœ¨æˆ‘çš„åšå®¢ä¸Šåšä¸€äº›ç³»åˆ—æ–‡ç« â€”â€”æˆ‘æƒ³å±•ç¤ºæˆ‘çš„ä¸€äº›å‘ç°æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹å¼â€”â€”ç‰¹åˆ«æ˜¯å› ä¸ºå…¶ä¸­ä¸€äº›å·²ç»æˆä¸ºæˆ‘è‡ªå·±å·¥ä½œæµç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦å…ƒç´ ã€‚

æ‰€ä»¥è¿™æ˜¯ç¬¬ä¸€ä¸ª(å¸Œæœ›æœ‰å¾ˆå¤šï¼)**è½¯ä»¶ spotlightï¼Œ**ç‰¹è‰²[**Husky**](https://github.com/typicode/husky)**by**[**typicode**](https://twitter.com/typicode?lang=de)ï¼Œä¸€ä¸ªå¼€æºåº“ï¼Œæ–¹ä¾¿åˆ›å»º git é’©å­çš„è¿‡ç¨‹ã€‚****

# ****å“ˆå£«å¥‡ï¼ŒGit æŒ‚é’©å˜å¾—ç®€å•****

****Husky æ˜¯ä¸€ä¸ªç®€å•çš„å·¥å…·ï¼Œå®ƒä½¿å¾—åœ¨ä½ çš„`package.json`ä¸­è½»æ¾åˆ›å»º [git é’©å­](https://git-scm.com/book/uz/v2/Customizing-Git-Git-Hooks)æˆä¸ºå¯èƒ½ã€‚****

*   ****[å‚¨å­˜åº“](https://github.com/typicode/husky)****
*   ****GitHub ä¸Šè¶…è¿‡[15000 é¢—æ˜Ÿ](https://github.com/typicode/husky/stargazers)****
*   ****GitHub ä¸Šè¶…è¿‡ 160ï¼Œ000 ä¸ªå­˜å‚¨åº“ä½¿ç”¨(ä¾‹å¦‚ï¼Œwebpackã€babelã€Next.jsã€create-react-app ç­‰)****
*   ****æ¯å‘¨è¶…è¿‡[150 ä¸‡æ¬¡ä¸‹è½½](https://www.npmjs.com/package/husky)****

# ****å®ƒçš„ä½œç”¨****

****Husky å…è®¸æ‚¨ç®€å•åœ°åœ¨æ‚¨çš„`package.json`ä¸­æ·»åŠ æŒ‚é’©ï¼Œè€Œä¸æ˜¯åœ¨æ‚¨çš„`.git`ç›®å½•ä¸­æ‰‹åŠ¨åˆ›å»º git æŒ‚é’©ï¼Œä¾‹å¦‚:****

```
**{
  ... your package.json
  "husky": {
    "hooks": {
      "pre-push": "npm test"
    }
  }
}**
```

****è¿™å°†åœ¨æ¯ä¸ª`git push`ä¹‹å‰æ‰§è¡Œ`npm test`ï¼Œå¦‚æœ`npm test`å¤±è´¥ï¼Œæ¨é€å°†ä¸è¢«æ‰§è¡Œã€‚****

****æœ‰æ—¶ä½ å¯èƒ½æƒ³è·³è¿‡é’©å­(ä¾‹å¦‚ï¼Œå½“åœ¨ WIP åˆ†æ”¯ä¸Šå·¥ä½œæ—¶)â€”â€”è¿™å¯ä»¥é€šè¿‡åœ¨ git å‘½ä»¤ä¸­æ·»åŠ `--no-verify`æ ‡å¿—æ¥è½»æ¾å®ç°ã€‚****

****å¸è½½ Husky æ—¶ï¼Œç”± Husky åˆ›å»ºçš„æŒ‚é’©å°†è¢«ç§»é™¤ã€‚****

# ****å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„****

****åœ¨å¼•æ“ç›–ä¸‹ï¼ŒHusky åªåœ¨å®‰è£…æ—¶åˆ›å»ºæ­£å¸¸çš„ git æŒ‚é’©[ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨åœ¨`.git/hooks/pre-pull`ä¸­æŸ¥çœ‹ï¼Œæ‚¨ä¼šå‘ç°ä¸€ä¸ªç”± Husky ç”Ÿæˆçš„æ–‡ä»¶:](https://github.com/typicode/husky/blob/master/package.json#L16)****

```
**#!/bin/sh
# husky# Hook created by Husky
#   Version: 3.0.1
#   At: 8/2/2019, 9:53:34 AM
#   See: [https://github.com/typicode/husky#readme](https://github.com/typicode/husky#readme)# From
#   Directory: /<your-project>/node_modules/husky
#   Homepage: [https://github.com/typicode/husky#readme](https://github.com/typicode/husky#readme)scriptPath="node_modules/husky/run.js"
hookName=`basename "$0"`
gitParams="$*"[...]**
```

****è¿™ä¸ªç”Ÿæˆçš„æ–‡ä»¶è´Ÿè´£ä¸ºæ‰§è¡Œçš„å‘½ä»¤(åœ¨è¿™é‡Œæ˜¯`git push`)æ‰§è¡Œé€‚å½“çš„é’©å­(åœ¨è¿™é‡Œæ˜¯:`pre-push`)ã€‚****

****å¦‚ä¸Šæ‰€è¿°ï¼Œå½“å“ˆå£«å¥‡[è¢«ç§»é™¤](https://github.com/typicode/husky/blob/master/package.json#L17)æ—¶ï¼Œè¿™äº›æ–‡ä»¶ä¹Ÿè¢«ç§»é™¤ã€‚****

# ****ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒ****

****æœ‰äººå¯èƒ½ä¼šè¯´ï¼Œä¸€ä¸ªé€‚å½“çš„ CI è®¾ç½®å¯èƒ½ä¼šåšä¸ Husky ç›¸åŒçš„äº‹æƒ…ï¼Œè¿™ä¸€ç‚¹æˆ‘éƒ¨åˆ†åŒæ„ã€‚ä½†æœ‰ä¸€ä»¶äº‹å¯¼è‡´æˆ‘ä»¬(è¿™æ„å‘³ç€æˆ‘å·¥ä½œçš„å…¬å¸)ä½¿ç”¨ Huskyï¼Œå³ä½¿æˆ‘ä»¬çš„ CI è®¾ç½®è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼Œæ—æŒºå’Œç›¸å…³çš„ä¸œè¥¿:æˆ‘ä»¬çš„ CI éœ€è¦ç›¸å½“é•¿çš„æ—¶é—´æ‰èƒ½å®Œæˆã€‚ä¸€æ¬¡æ„å»ºéœ€è¦ 30 åˆ° 60 åˆ†é’Ÿâ€”â€”æ‚¨ä¸å¸Œæœ›ç­‰é‚£ä¹ˆä¹…æ‰æ”¶åˆ°é€šçŸ¥ï¼Œå®ƒå®é™…ä¸Šå‘Šè¯‰æ‚¨:****

> ****ä½ çš„æ„å»ºå¤±è´¥äº†ï¼Œå› ä¸ºä½ å¿˜è®°äº†ä¸€ä¸ªç©ºæ ¼ã€‚è¯ºå¸ƒã€‚****

****æˆ‘ä»¬çš„`pre-push`é’©å­åªæ˜¯è¿è¡Œ`npm run lint`(é“¾æ¥æ‰€æœ‰`.ts`å’Œ`.scss`æ–‡ä»¶)æ¥é˜²æ­¢è¿™ç§æƒ…å†µã€‚å¯¹äº git æŒ‚é’©æ¥è¯´ï¼ŒèŠ±è´¹çš„æ—¶é—´æœ‰ç‚¹å¤ªå¤šäº†ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬é€‰æ‹©æ—æŒºçš„åŸå› ã€‚****

****ä¸€ä¸ªé¢å¤–çš„å¥½å¤„æ˜¯ï¼Œå®ƒä½¿å¾—åœ¨å›¢é˜Ÿå†…éƒ¨å…±äº« git æŒ‚é’©å˜å¾—éå¸¸å®¹æ˜“ï¼Œè€Œä¸éœ€è¦æ”¹å˜ä»»ä½• git é…ç½®ã€‚****

****å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·ç•™ä¸‹ğŸ‘ï¼Œå…³æ³¨æˆ‘ä¸Š [*æ¨ç‰¹*](https://twitter.com/nehalist) *å¹¶è®¢é˜…* [*æˆ‘çš„å¿«è®¯*](https://nehalist.io/newsletter/) *ã€‚æœ¬å¸–åŸè½½äº 2019 å¹´ 8 æœˆ 13 æ—¥* [*æˆ‘çš„åšå®¢*](https://nehalist.io) *ã€‚*****