<html>
<head>
<title>FFmpeg.wasm, a pure WebAssembly / Javascript port of FFmpeg</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">FFmpeg.wasmï¼ŒFFmpegçš„çº¯WebAssembly / Javascriptç«¯å£</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/ffmpeg-wasm-a-pure-webassembly-javascript-port-of-ffmpeg-f13de6402452?source=collection_archive---------0-----------------------#2020-11-04">https://itnext.io/ffmpeg-wasm-a-pure-webassembly-javascript-port-of-ffmpeg-f13de6402452?source=collection_archive---------0-----------------------#2020-11-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f69d28612d7cc814cb0ddb8f4a4dbd6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*40PV9XbaxN75GHtraxoO6A.png"/></div></div></figure><p id="7fbd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å®˜æ–¹ç½‘ç«™:<a class="ae kz" href="https://ffmpegwasm.github.io/" rel="noopener ugc nofollow" target="_blank">https://ffmpegwasm.github.io/</a></p><p id="58bc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å½“è°ˆåˆ°è§†é¢‘/éŸ³é¢‘å¤„ç†æ—¶ï¼Œffmpegæ˜¯ä¸€ä¸ªè‘—åçš„æ¡†æ¶/å·¥å…·ï¼Œç°åœ¨æœ‰äº†ffmpeg.wasmï¼Œä½ å¯ä»¥åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨FFmpegï¼Œè€Œæ— éœ€å®‰è£…æˆ–å°†æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚è™½ç„¶ffmpeg.wasmæ²¡æœ‰ffmpegå¿«ï¼Œä½†å¯¹äºæŸäº›ç”¨ä¾‹æ¥è¯´ï¼Œå®ƒå¯èƒ½ä¼šæ´¾ä¸Šç”¨åœºã€‚</p><p id="5a8f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘æƒ³åˆ†äº«å¦‚ä½•å®‰è£…å’Œä½¿ç”¨ffmpeg.wasmï¼Œä»¥åŠæ”¯æŒä½ ä½¿ç”¨çš„æŠ€æœ¯ç»†èŠ‚ã€‚</p><h1 id="05e0" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">å®‰è£…ffmpeg.wasm</h1><p id="ea8a" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">è¦å®‰è£…å’Œä½¿ç”¨ffmpeg.wasmï¼Œåªéœ€è¦ä½¿ç”¨npm/yarn:</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="0614" class="mm lb it mi b gy mn mo l mp mq">$ npm install @ffmepg/ffmpeg<br/># or<br/>$ yarn add @ffmpeg/ffmpeg</span></pre><p id="35cd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">è¦åœ¨èŠ‚ç‚¹ç¯å¢ƒä¸‹ä½¿ç”¨ffmpeg.wasmï¼Œè¿˜éœ€è¦å®‰è£…<code class="fe mr ms mt mi b">@ffmpeg/core</code>ã€‚</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="fda7" class="mm lb it mi b gy mn mo l mp mq">$ npm install @ffmepg/core<br/># or<br/>$ yarn add @ffmpeg/core</span></pre><p id="a685" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">æˆ–è€…ä½ å¯ä»¥ä½¿ç”¨CDN</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="b8fc" class="mm lb it mi b gy mn mo l mp mq">&lt;script src='https://unpkg.com/@ffmpeg/ffmpeg@0.9.3/dist/ffmpeg.min.js'&gt;&lt;/script&gt;</span></pre><h1 id="c374" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">ä½¿ç”¨ffmpeg.wasm</h1><p id="4f1b" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">è¦ä½¿ç”¨ffmpeg.wasmï¼Œåªéœ€è¦å‡ è¡Œä»£ç :</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mu mv l"/></div></figure><blockquote class="mw mx my"><p id="0167" class="kb kc mz kd b ke kf kg kh ki kj kk kl na kn ko kp nb kr ks kt nc kv kw kx ky im bi translated">åœ¨nodeä¸­æ‰§è¡Œè„šæœ¬æ—¶ï¼Œä¸è¦å¿˜è®°æ·»åŠ <code class="fe mr ms mt mi b">--experimental-wasm-threads</code>å’Œ<code class="fe mr ms mt mi b">--experimental-wasm-bulk-memory</code>ã€‚</p></blockquote><p id="d597" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">ä½ ä¹Ÿå¯ä»¥åœ¨å®˜æ–¹ç½‘ç«™å°è¯•ç°åœºæ¼”ç¤º:<a class="ae kz" href="https://ffmpegwasm.github.io/#demo" rel="noopener ugc nofollow" target="_blank">https://ffmpegwasm.github.io/#demo</a></p><figure class="md me mf mg gt ju gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/96b1a80bdb59308b0eae5472d518d1c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*gV8HwSk-3ombFWxZfjJO1g.gif"/></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">å°†AVIè½¬ç ä¸ºx264 MP4çš„æ¼”ç¤º</figcaption></figure><h1 id="cb6d" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">å¹•å</h1><p id="f164" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">ä¸ºäº†å……åˆ†åˆ©ç”¨/ç†è§£ffmpeg.wasmçš„å¼ºå¤§åŠŸèƒ½(å¯¹äºå¤§å¤šæ•°WebAssemblyåº“ä¹Ÿæ˜¯å¦‚æ­¤)ï¼Œæ‚¨å¯èƒ½æƒ³çŸ¥é“ä¸€äº›æŠ€æœ¯ç»†èŠ‚:</p><h2 id="7830" class="mm lb it bd lc ni nj dn lg nk nl dp lk km nm nn lo kq no np ls ku nq nr lw ns bi translated">ffmpeg.load()å†…éƒ¨</h2><p id="e01a" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated"><code class="fe mr ms mt mi b">ffmpeg.load()</code>æ˜¯åœ¨è°ƒç”¨å…¶ä»–APIä¹‹å‰éœ€è¦è°ƒç”¨çš„APIã€‚è¿™ä¸ªAPIå†…éƒ¨çš„æƒ…å†µæ˜¯:</p><ol class=""><li id="323a" class="nt nu it kd b ke kf ki kj km nv kq nw ku nx ky ny nz oa ob bi translated">ä»è¿œç¨‹æœåŠ¡å™¨ä¸‹è½½ffmpeg-core.js(å¤§çº¦25MB)</li><li id="bd57" class="nt nu it kd b ke oc ki od km oe kq of ku og ky ny nz oa ob bi translated">å®ä¾‹åŒ–ffmpeg.wasm wasmä»£ç </li></ol><p id="7fff" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">æ ¹æ®æ‚¨çš„ç½‘ç»œé€Ÿåº¦å’Œä¸»æœºç¡¬ä»¶ï¼Œæ­¤æ“ä½œå¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ‰èƒ½å®Œæˆã€‚</p><h2 id="efd0" class="mm lb it bd lc ni nj dn lg nk nl dp lk km nm nn lo kq no np ls ku nq nr lw ns bi translated">æ–‡ä»¶ç³»ç»Ÿ</h2><p id="cf41" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">å½“ä½ æŸ¥çœ‹ffmpeg.wasmçš„APIæ—¶ï¼Œä½ å¯èƒ½ä¼šå‘ç°ä¸€ä¸ªå«åš<code class="fe mr ms mt mi b">ffmpeg.FS()</code>çš„APIæ¥å¤„ç†æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€‚(åœ¨ffmpeg.wasmä¸­æˆ‘ä»¬ä½¿ç”¨MEMFS / Memoryæ–‡ä»¶ç³»ç»Ÿ)ä½ å¯ä»¥æŠŠè¿™ä¸ªFSæƒ³è±¡æˆä¸€ä¸ªç¡¬ç›˜ï¼Œä½ å¯ä»¥æŠŠè¾“å…¥æ–‡ä»¶æ”¾åœ¨é‚£é‡Œï¼Œä»ffmpeg.wasmå‘½ä»¤ä¸­æ‹‰å‡ºè¾“å‡ºæ–‡ä»¶ã€‚è¿™æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›ä¿æŒFFmpegæºä»£ç çš„æœ€å°å˜åŒ–ï¼Œå¹¶ä¿ç•™å…¶ä¸åŸå§‹å‘½ä»¤è¡Œç•Œé¢çš„æœ€å¤§ç›¸ä¼¼æ€§ã€‚æ‚¨å¯èƒ½ä¼šä½¿ç”¨çš„ä¸€äº›å‘½ä»¤æ“ä½œ:</p><ul class=""><li id="bf54" class="nt nu it kd b ke kf ki kj km nv kq nw ku nx ky oh nz oa ob bi translated"><code class="fe mr ms mt mi b">ffmpeg.FS('writeFile', 'filename', data)</code>:å°†æ–‡ä»¶å†™å…¥MEMFSï¼Œä½œä¸ºffmpeg.wasmçš„è¾“å…¥</li><li id="322a" class="nt nu it kd b ke oc ki od km oe kq of ku og ky oh nz oa ob bi translated"><code class="fe mr ms mt mi b">ffmpeg.FS('readFile', 'filename')</code>:ä»MEMFSä¸­è¯»å–æ–‡ä»¶ä½œä¸ºffmpeg.wasmçš„è¾“å‡º</li><li id="e13f" class="nt nu it kd b ke oc ki od km oe kq of ku og ky oh nz oa ob bi translated"><code class="fe mr ms mt mi b">ffmpeg.FS('unlink', 'filename')</code>:åˆ é™¤MEMFSä¸­çš„æ–‡ä»¶</li><li id="8f4b" class="nt nu it kd b ke oc ki od km oe kq of ku og ky oh nz oa ob bi translated"><code class="fe mr ms mt mi b">ffmpeg.FS('readdir', '/')</code>:åˆ—å‡ºç‰¹å®šè·¯å¾„ä¸‹çš„æ–‡ä»¶</li></ul><p id="3ebb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å®Œæ•´çš„apiåˆ—è¡¨ï¼Œå¯ä»¥æŸ¥çœ‹:<a class="ae kz" href="https://emscripten.org/docs/api_reference/Filesystem-API.html" rel="noopener ugc nofollow" target="_blank">https://EMS cripten . org/docs/API _ reference/file system-API . html</a></p><h2 id="7da5" class="mm lb it bd lc ni nj dn lg nk nl dp lk km nm nn lo kq no np ls ku nq nr lw ns bi translated">SharedArrayBuffer</h2><p id="072c" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">SharedArrayBufferæ˜¯JavaScriptä¸­ä¸€ä¸ªéå¸¸æ–°çš„æ•°æ®ç±»å‹ï¼Œç›®å‰å¤§å¤šæ•°æµè§ˆå™¨ç”±äºå®‰å…¨é—®é¢˜ä»ç„¶ç¼ºä¹å®Œå…¨çš„æ”¯æŒã€‚ä½†æ˜¯åœ¨ffmpeg.wasmä¸­ï¼Œè¦ä½¿pthread /å¤šçº¿ç¨‹æ”¯æŒåŠ é€Ÿï¼Œå®ƒæ˜¯ä¸€ä¸ªå¿…é¡»ä½¿ç”¨çš„æ•°æ®ç±»å‹ã€‚</p><ul class=""><li id="05e8" class="nt nu it kd b ke kf ki kj km nv kq nw ku nx ky oh nz oa ob bi translated">SharedArrayBufferç®€ä»‹:<a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/JavaScript/Reference/Global _ Objects/SharedArrayBuffer</a></li><li id="aca1" class="nt nu it kd b ke oc ki od km oe kq of ku og ky oh nz oa ob bi translated">å¯ä»¥ç”¨SharedArrayBufferå—ï¼Ÿ:<a class="ae kz" href="https://caniuse.com/sharedarraybuffer" rel="noopener ugc nofollow" target="_blank">https://caniuse.com/sharedarraybuffer</a></li></ul><h2 id="f7d1" class="mm lb it bd lc ni nj dn lg nk nl dp lk km nm nn lo kq no np ls ku nq nr lw ns bi translated">ç½‘ç»œå·¥ä½œè€…</h2><p id="7e99" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">å½“ä½ è¿è¡Œ<code class="fe mr ms mt mi b">ffmpeg.run()</code>æ—¶ï¼Œä½ å¯èƒ½ä¼šå‘ç°å¤§é‡çš„ç½‘ç»œå·¥ä½œè€…äº§ç”Ÿäº†ã€‚è¿™æ˜¯ä¸€ä¸ªæ­£å¸¸çš„æƒ…å†µï¼Œå› ä¸ºwebå·¥ä½œäººå‘˜åœ¨FFmpegä¸­æ¨¡æ‹Ÿçº¿ç¨‹ï¼Œè¿™å¾ˆå¥½ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¸Œæœ›ffmpeg.wasmé˜»å¡æˆ‘ä»¬çš„ä¸»çº¿ç¨‹ã€‚</p><h2 id="7145" class="mm lb it bd lc ni nj dn lg nk nl dp lk km nm nn lo kq no np ls ku nq nr lw ns bi translated">åˆ©ç”¨CPUèƒ½åŠ›</h2><p id="3124" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">å› ä¸ºå¤§å¤šæ•°åº“éƒ½ä½¿ç”¨ffmpeg(ä¾‹å¦‚x264)ï¼Œä»–ä»¬ä½¿ç”¨ç±»ä¼¼x86çš„æ±‡ç¼–è¯­è¨€æ¥åŠ å¿«è¿›ç¨‹ã€‚ä½†é—æ†¾çš„æ˜¯ï¼ŒWebAssemblyä¸èƒ½ç›´æ¥ä½¿ç”¨è¿™äº›x86æ±‡ç¼–ä»£ç ï¼Œå› ä¸ºå®ƒä¸å…¼å®¹æˆ–è€…ä¸æ”¯æŒæŸäº›æŒ‡ä»¤ã€‚å› æ­¤ï¼Œå°†x86ç¨‹åºé›†ç§»æ¤åˆ°SIMDç¨‹åºé›†ä»¥ä½¿å…¶å·¥ä½œéœ€è¦æ—¶é—´ã€‚</p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><p id="4b94" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">å®ƒè¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ï¼Œå› ä¸ºffmpeg.wasmä»ç„¶å¤„äºæ—©æœŸé˜¶æ®µ(ç°åœ¨åªæœ‰v0.9)ï¼Œè™½ç„¶ä¸åŸå§‹ç‰ˆæœ¬ç›¸æ¯”å®ƒä»ç„¶éå¸¸æ…¢ï¼Œä½†éšç€WebAssemblyçš„å¢é•¿å’Œå‘å±•ï¼Œæˆ‘ç›¸ä¿¡å®ƒä¼šå˜å¾—è¶Šæ¥è¶Šæœ‰ç”¨ã€‚ğŸ˜ƒ</p><p id="db6d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">æ¬¢è¿éšæ—¶å°è¯•å’Œè¯„è®ºï¼Œé—®é¢˜æˆ–/å’Œå…¬å…³ï¼</p><p id="99a7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">github:<a class="ae kz" href="https://github.com/ffmpegwasm/ffmpeg.wasm" rel="noopener ugc nofollow" target="_blank">https://github.com/ffmpegwasm/ffmpeg.wasm</a></p></div></div>    
</body>
</html>