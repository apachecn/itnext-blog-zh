<html>
<head>
<title>Write your first Web Scraper in Dart</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨Dartç¼–å†™æ‚¨çš„ç¬¬ä¸€ä¸ªWeb Scraper</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/write-your-first-web-scraper-in-dart-243c7bb4d05?source=collection_archive---------2-----------------------#2018-12-17">https://itnext.io/write-your-first-web-scraper-in-dart-243c7bb4d05?source=collection_archive---------2-----------------------#2018-12-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5e0b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">äº†è§£å¦‚ä½•ä½¿ç”¨ç°æœ‰å·¥å…·ä»ç½‘ç«™ä¸­æå–æ•°æ®</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d68555a95fcbf19c43b02fcf5ba1b219.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XiQ8rv-Jgu7livDZlkZ5Sw.png"/></div></div></figure><p id="ecaf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ªweb scraperæ¥æŸ¥è¯¢Hacker Newsä¸»é¡µä¸Šçš„æœ€æ–°æ–‡ç« åˆ—è¡¨åŠå…¶URLã€‚æˆ‘ä»¬å°†ç”Ÿæˆä¸€ä¸ªJSONå­—ç¬¦ä¸²ï¼Œå…¶ä¸­åŒ…å«åŸºäºæŠ“å–æ•°æ®çš„ç»“æœã€‚æˆ‘ä»¬è¿˜å°†é€šè¿‡ä¸€äº›å•å…ƒæµ‹è¯•æ¥ä»‹ç»è¿™ä¸€ç‚¹ï¼</p><p id="c946" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è¿™å°†æ˜¯å¾ˆå¥½çš„åç»­è¡ŒåŠ¨ï¼Œå°¤å…¶æ˜¯ä½ ä¸€ç›´æƒ³æ·±å…¥ç ”ç©¶Dartè¯­è¨€å’Œå·¥å…·ã€‚</p><p id="ef62" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">â†’ <a class="ae ln" href="https://creativebracket.com/write-your-first-web-scraper/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">ç»§ç»­é˜…è¯»æˆ‘çš„åšå®¢</strong> </a></p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="e390" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">ä»€ä¹ˆæ˜¯Web Scraperï¼Ÿ</h1><p id="4d69" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">ç½‘é¡µæŠ“å–å™¨æŒ‡çš„æ˜¯æ‰§è¡Œä»ç½‘ç«™æå–æ•°æ®çš„ä»»åŠ¡çš„è„šæœ¬ã€‚è¿™é€šå¸¸æ˜¯é€šè¿‡å¯¹ç½‘é¡µæ‰§è¡ŒGETè¯·æ±‚ï¼Œç„¶åè§£æHTMLå“åº”ä»¥æ£€ç´¢æ‰€éœ€å†…å®¹æ¥å®ç°çš„ã€‚</p><h1 id="2b21" class="lv lw iq bd lx ly ms ma mb mc mt me mf jw mu jx mh jz mv ka mj kc mw kd ml mm bi translated">1.ç”Ÿæˆæ§åˆ¶å°é¡¹ç›®</h1><p id="1756" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">ä¸ºæ‚¨çš„é¡¹ç›®åˆ›å»ºç›®å½•</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="a852" class="nc lw iq my b gy nd ne l nf ng">$ <strong class="my ir">mkdir hacker_news_scraper &amp;&amp; cd hacker_news_scraper</strong></span></pre><p id="69b2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ä½¿ç”¨stagehandåŒ…ç”Ÿæˆæ§åˆ¶å°åº”ç”¨ç¨‹åº:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="6fa9" class="nc lw iq my b gy nd ne l nf ng">$ <strong class="my ir">pub global activate stagehand</strong> # If it's not installed<br/>$ <strong class="my ir">stagehand console-full</strong></span></pre><p id="75b5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">åœ¨<code class="fe nh ni nj my b">pubspec.yaml</code>æ–‡ä»¶ä¸­æ·»åŠ <strong class="kt ir"> http </strong>å’Œ<strong class="kt ir"> html </strong>ä¾èµ–å…³ç³»:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="8837" class="nc lw iq my b gy nd ne l nf ng"><strong class="my ir">dependencies</strong>:<br/>  <strong class="my ir">html</strong>: ^0.13.3+3<br/>  <strong class="my ir">http</strong>: ^0.12.0</span></pre><p id="f18b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">httpåŒ…ä¸ºè¯·æ±‚æä¾›äº†ä¸€ä¸ªåŸºäºæœªæ¥çš„APIã€‚<strong class="kt ir"> html </strong>åŒ…åŒ…å«ä½¿ç”¨å—DOMå¯å‘çš„APIè§£æHTML5å­—ç¬¦ä¸²çš„åŠ©æ‰‹ã€‚<em class="nk">æ˜¯æ¥è‡ªPythonçš„</em><strong class="kt ir"><em class="nk">html 5 lib</em></strong><em class="nk">çš„ä¸€ä¸ªç«¯å£ã€‚</em></p><p id="57f9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¹¶å®‰è£…æ·»åŠ çš„ä¾èµ–é¡¹:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="5e01" class="nc lw iq my b gy nd ne l nf ng">$ <strong class="my ir">pub get</strong></span></pre><p id="5af2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æ­£ç¡®éµå¾ªè¿™äº›è¯´æ˜åº”è¯¥ä¼šç»™æ‚¨æä¾›ä¸‹é¢çš„æ–‡ä»¶/æ–‡ä»¶å¤¹ç»“æ„:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/b7c6b797b53ae55a75cb2f70d1dd9d01.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*s7IeGtIR69oRyckrF8z2iA.png"/></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">æ§åˆ¶å°åº”ç”¨ç¨‹åºçš„é¡¹ç›®ç»“æ„</figcaption></figure><h1 id="2bdf" class="lv lw iq bd lx ly ms ma mb mc mt me mf jw mu jx mh jz mv ka mj kc mw kd ml mm bi translated">2.å®ç°è„šæœ¬</h1><p id="cec0" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">æ¸…ç©º<code class="fe nh ni nj my b">lib/hacker_news_scraper.dart</code>çš„å†…å®¹ï¼Œå› ä¸ºæˆ‘ä»¬å°†ä»scratchâ˜ï¸ï¸å‡ºå‘</p><p id="c583" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¯¼å…¥æˆ‘ä»¬å®‰è£…çš„ä¾èµ–é¡¹:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="6bd9" class="nc lw iq my b gy nd ne l nf ng"><strong class="my ir">import 'dart:convert';</strong> // Contains the JSON encoder<br/><br/><strong class="my ir">import 'package:http/http.dart';</strong> // Contains a client for making API calls<br/><strong class="my ir">import 'package:html/parser.dart';</strong> // Contains HTML parsers to generate a Document object<br/><strong class="my ir">import 'package:html/dom.dart';</strong> // Contains DOM related classes for extracting data from elements</span></pre><p id="6686" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">åœ¨å¯¼å…¥ååˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥åŒ…å«æˆ‘ä»¬çš„é€»è¾‘:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="39e9" class="nc lw iq my b gy nd ne l nf ng"><strong class="my ir">initiate</strong>() <strong class="my ir">async</strong> {}</span></pre><p id="daaa" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">http åŒ…åŒ…å«ä¸€ä¸ªç”¨äºè¿›è¡Œhttpè°ƒç”¨çš„<code class="fe nh ni nj my b">Client</code>ç±»ã€‚åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå¹¶å¯¹é»‘å®¢æ–°é—»ä¸»é¡µæ‰§è¡Œä¸€ä¸ª<code class="fe nh ni nj my b">GET</code>è¯·æ±‚:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="89ee" class="nc lw iq my b gy nd ne l nf ng">Future initiate() <strong class="my ir">async</strong> {<br/>  var <strong class="my ir">client</strong> = <strong class="my ir">Client()</strong>;<br/>  Response response = <strong class="my ir">await client.get</strong>(<br/>    'https://news.ycombinator.com'<br/>  );<br/><br/>  print(response.body);<br/>}</span></pre><p id="acd4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ä¸ºäº†æµ‹è¯•è¿™ä¸€ç‚¹ï¼Œè½¬åˆ°<code class="fe nh ni nj my b">bin/main.dart</code>å¹¶è°ƒç”¨<code class="fe nh ni nj my b">initiate</code>æ–¹æ³•:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="7fe0" class="nc lw iq my b gy nd ne l nf ng">import 'package:hacker_news_scraper/hacker_news_scraper.dart' <strong class="my ir">as</strong> <strong class="my ir">hacker_news_scraper</strong>;<br/><br/>void main(List&lt;String&gt; arguments) async {<br/>  print(await <strong class="my ir">hacker_news_scraper.initiate</strong>());<br/>}</span></pre><p id="5160" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è¿è¡Œè¯¥æ–‡ä»¶:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="7ca1" class="nc lw iq my b gy nd ne l nf ng">$ <strong class="my ir">dart bin/main.dart</strong></span></pre><p id="4848" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ä»¥ä¸‹æ˜¯å›åº”çš„æ‘˜è¦:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="cb91" class="nc lw iq my b gy nd ne l nf ng">&lt;html op="news"&gt;&lt;head&gt;&lt;meta name="referrer" content="origin"&gt;&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt; <br/>...<br/>...<br/>&lt;table border="0" cellpadding="0" cellspacing="0" class="itemlist"&gt;<br/>              &lt;tr class='athing' id='18678314'&gt;<br/>      &lt;td align="right" valign="top" class="title"&gt;&lt;span class="rank"&gt;1.&lt;/span&gt;&lt;/td&gt;      &lt;td valign="top" class="votelinks"&gt;&lt;center&gt;&lt;a id='up_18678314' href='vote?id=18678314&amp;amp;how=up&amp;amp;goto=news'&gt;&lt;div class='votearrow' title='upvote'&gt;&lt;/div&gt;&lt;/a&gt;&lt;/center&gt;&lt;/td&gt;&lt;td class="title"&gt;&lt;a href="http://vmls-book.stanford.edu/" class="storylink"&gt;Introduction to Applied Linear Algebra: Vectors, Matrices, and Least Squares&lt;/a&gt;&lt;span class="sitebit comhead"&gt; (&lt;a href="from?site=stanford.edu"&gt;&lt;span class="sitestr"&gt;stanford.edu&lt;/span&gt;&lt;/a&gt;)&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan="2"&gt;&lt;/td&gt;&lt;td class="subtext"&gt;<br/>        &lt;span class="score" id="score_18678314"&gt;381 points&lt;/span&gt; by &lt;a href="user?id=yarapavan" class="hnuser"&gt;yarapavan&lt;/a&gt; &lt;span class="age"&gt;&lt;a href="item?id=18678314"&gt;8 hours ago&lt;/a&gt;&lt;/span&gt; &lt;span id="unv_18678314"&gt;&lt;/span&gt; | &lt;a href="hide?id=18678314&amp;amp;goto=news"&gt;hide&lt;/a&gt; | &lt;a href="item?id=18678314"&gt;37&amp;nbsp;comments&lt;/a&gt;              &lt;/td&gt;&lt;/tr&gt;<br/>...<br/>...</span></pre><p id="29e0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ä¸ºäº†çŸ¥é“è¦æŸ¥æ‰¾ä»€ä¹ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å¦‚ä½•é€‰æ‹©é¡µé¢ä¸Šçš„é“¾æ¥:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/f49c75d689a03f6a4874b4b8cab44919.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GYldVxILTHTeeszwoFb0jQ.png"/></div></div></figure><p id="6527" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ä¼¼ä¹æ¯ä¸ªé“¾æ¥éƒ½åœ¨ä¸€ä¸ªè¡¨æ ¼å•å…ƒæ ¼ä¸­ï¼Œå¹¶ä¸”å…·æœ‰ç±»â€œstorylinkâ€ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªCSSé€‰æ‹©å™¨æ¥éå†è¿™äº›:<code class="fe nh ni nj my b">td.title &gt; a.storylink</code></p><p id="2477" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">åœ¨<code class="fe nh ni nj my b">lib/hacker_news_scraper.dart</code>ä¸­ï¼Œæˆ‘ä»¬ä¸åœ¨initiateå‡½æ•°ä¸­æ‰“å°å“åº”ä½“ï¼Œè€Œæ˜¯ä½¿ç”¨<strong class="kt ir"> html </strong>åŒ…ä¸­çš„åŠ©æ‰‹æ¥è§£æå“åº”ä½“å¹¶é€‰æ‹©å…ƒç´ ã€‚</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="dbf7" class="nc lw iq my b gy nd ne l nf ng">Future initiate() async {<br/>  var client = Client();<br/>  Response response = await client.get(<br/>    'https://news.ycombinator.com'<br/>  );<br/><br/>  // Use html parser and query selector<br/>  var <strong class="my ir">document</strong> = <strong class="my ir">parse</strong>(response.body);<br/>  List&lt;<strong class="my ir">Element</strong>&gt; links = document<strong class="my ir">.querySelectorAll</strong>('td.title &gt; a.storylink');<br/>}</span></pre><p id="c761" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æ­¤æ—¶ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ª<code class="fe nh ni nj my b">Element</code>åˆ—è¡¨ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ª<code class="fe nh ni nj my b">a.storylink</code>é¡¹ç›®ã€‚<code class="fe nh ni nj my b">Element</code>ç±»å‹<a class="ae ln" href="https://pub.dartlang.org/documentation/html/latest/dom/Element-class.html" rel="noopener ugc nofollow" target="_blank">æä¾›äº†ä¸€ä¸ªç±»ä¼¼äºDOMçš„API </a>ã€‚</p><p id="8b2c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">é€šè¿‡ä¸€ä¸ª<code class="fe nh ni nj my b">for in</code>å¾ªç¯ï¼Œæˆ‘ä»¬å¯ä»¥éå†é›†åˆ:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="a00d" class="nc lw iq my b gy nd ne l nf ng">List&lt;Map&lt;String, dynamic&gt;&gt; <strong class="my ir">linkMap</strong> = [];<br/><br/>for (var <strong class="my ir">link</strong> in links) {<br/>  linkMap.add({<br/>    '<strong class="my ir">title</strong>': <strong class="my ir">link.text</strong>,<br/>    '<strong class="my ir">href</strong>': <strong class="my ir">link.attributes[</strong>'href'<strong class="my ir">]</strong>,<br/>  });<br/>}</span></pre><p id="06c2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¹¶è¿”å›JSONç¼–ç çš„è¾“å‡º:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="d883" class="nc lw iq my b gy nd ne l nf ng">import 'dart:convert'; // Import this library at the top of the file<br/><br/>Future initiate() <strong class="my ir">async</strong> {<br/>  ...<br/>  ...<br/>  return <strong class="my ir">json.encode(</strong>linkMap<strong class="my ir">)</strong>;<br/>}</span></pre><p id="181d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ä»¥ä¸‹æ˜¯ç›®å‰ä¸ºæ­¢çš„å®Œæ•´è„šæœ¬:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="6f96" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è¿è¡Œè¯¥å‘½ä»¤åº”è¯¥ä¼šè¿”å›å¦‚ä¸‹æ‰€ç¤ºçš„JSONè¾“å‡º:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="52e3" class="nc lw iq my b gy nd ne l nf ng">[<br/>  {<br/>    "title":"Introduction to Applied Linear Algebra: Vectors, Matrices, and Least Squares",<br/>    "href":"http://vmls-book.stanford.edu/"<br/>  },<br/>  {<br/>    "title":"Write Your Own Virtual Machine",<br/>    "href":"https://justinmeiners.github.io/lc3-vm/"<br/>  },<br/>  ...<br/>  ...<br/>]</span></pre><h1 id="1759" class="lv lw iq bd lx ly ms ma mb mc mt me mf jw mu jx mh jz mv ka mj kc mw kd ml mm bi translated">3.ç¼–å†™å•å…ƒæµ‹è¯•</h1><p id="e363" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">æˆ‘ä»¬çš„æµ‹è¯•å°†åœ¨<code class="fe nh ni nj my b">test/hacker_news_scraper_test.dart</code>è¿›è¡Œã€‚å°†å…¶å†…å®¹æ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="c590" class="nc lw iq my b gy nd ne l nf ng">import 'dart:convert';<br/><br/>import 'package:test/test.dart';<br/>import 'package:http/http.dart';<br/>import 'package:http/testing.dart';<br/>import 'package:hacker_news_scraper/hacker_news_scraper.dart' as hacker_news_scraper;<br/><br/>void main() {<br/>  // Our tests will go here<br/>}</span></pre><p id="8e91" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è¿™æ˜¯æˆ‘ä»¬ç¬¬ä¸€æ¬¡æµ‹è¯•çš„æ ·å­:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="2d4e" class="nc lw iq my b gy nd ne l nf ng">void main() {<br/>  <strong class="my ir">test</strong>('calling initiate() returns a list of storylinks', <strong class="my ir">() async {</strong><br/>    var response = await hacker_news_scraper.initiate();<br/>    <strong class="my ir">expect</strong>(response, equals('/* JSON string to match against */'));<br/>  <strong class="my ir">}</strong>);<br/>}</span></pre><p id="7759" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æˆ‘ä»¬éœ€è¦ä¸ºæˆ‘ä»¬çš„æµ‹è¯•ç¨å¾®é‡æ„æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆã€‚è¿™æ˜¯å› ä¸ºç¼–å†™æµ‹è¯•å°†æ˜¯å¤æ€ªçš„ï¼Œå› ä¸º<strong class="kt ir">æˆ‘ä»¬å°†å®é™…è°ƒç”¨</strong>é»‘å®¢æ–°é—»ç½‘ç«™ã€‚</p><p id="9cf7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¦‚æœé»‘å®¢æ–°é—»ä¸å¯ç”¨ï¼Œæˆ–è€…æˆ‘ä»¬æ²¡æœ‰äº’è”ç½‘è¿æ¥ï¼Œæˆ–è€…æ•…äº‹åˆ—è¡¨å‘ç”Ÿå˜åŒ–(å®ƒä»¬ä¼šå‘ç”Ÿå˜åŒ–)ï¼Œæˆ‘ä»¬çš„æµ‹è¯•å°±ä¼šå¤±è´¥ã€‚</p><p id="6cbe" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è®©æˆ‘ä»¬é‡æ„æˆ‘ä»¬çš„<code class="fe nh ni nj my b">initiate()</code>æ–¹æ³•calllï¼ŒæœŸå¾…ä¸€ä¸ª<code class="fe nh ni nj my b">client</code>å‚æ•°ï¼Œå¹¶åˆ é™¤<code class="fe nh ni nj my b">var client = Client();</code>å£°æ˜:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="8f18" class="nc lw iq my b gy nd ne l nf ng">// lib/hacker_news_scraper.dart<br/>initiate(<strong class="my ir">BaseClient client</strong>) {<br/>  // var client = Client(); // &lt;- <strong class="my ir">Remove this line</strong><br/>  ...<br/>}</span></pre><p id="8a75" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> http </strong>åŒ…ä¸ºå…¶httpå®¢æˆ·ç«¯æ‰©å±•äº†ä¸€ä¸ª<code class="fe nh ni nj my b">BaseClient</code>ç±»å‹ã€‚è¿™ä¹Ÿå¾ˆæœ‰ç”¨ï¼Œå› ä¸ºåŒä¸€ä¸ªåŒ…æä¾›äº†å¦ä¸€ä¸ªå­ç±»<code class="fe nh ni nj my b">MockClient</code>ï¼Œç”¨äºæ¨¡æ‹ŸHTTPè°ƒç”¨ï¼Œè¿™å¯¹æˆ‘ä»¬çš„å•å…ƒæµ‹è¯•å¾ˆæœ‰ç”¨ï¼</p><p id="34d9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è¿”å›<code class="fe nh ni nj my b">bin/main.dart</code>å¹¶ç¡®ä¿<code class="fe nh ni nj my b">Client</code>è¢«ä¼ å…¥:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="b9c8" class="nc lw iq my b gy nd ne l nf ng"><strong class="my ir">import 'package:http/http.dart';</strong> // Import the package first!<br/>import 'package:hacker_news_scraper/hacker_news_scraper.dart' as hacker_news_scraper;<br/><br/>void main(List&lt;String&gt; arguments) async {<br/>  print(await hacker_news_scraper.initiate(<strong class="my ir">Client()</strong>));<br/>}</span></pre><p id="93c7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å¥½ï¼Œå›åˆ°æˆ‘ä»¬çš„å•å…ƒæµ‹è¯•ã€‚</p><p id="ea97" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è¿™æ˜¯ç¬¬ä¸€ä¸ªä½¿ç”¨æˆ‘ä»¬çš„<code class="fe nh ni nj my b">MockClient</code>çš„æµ‹è¯•:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="41ee" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe nh ni nj my b">MockClient</code>å®ä¾‹å°†é—­åŒ…ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚è¿™ä¸ªé—­åŒ…æä¾›äº†ä¸€ä¸ªè¯·æ±‚å¯¹è±¡ï¼Œå¦‚æœéœ€è¦ï¼Œæˆ‘ä»¬å¯ä»¥æ“çºµå®ƒã€‚æœŸæœ›ä»è¿™ä¸ªé—­åŒ…è¿”å›ä¸€ä¸ª<code class="fe nh ni nj my b">Future</code>å¯¹è±¡ï¼Œè¿™å°±æ˜¯è¿™é‡Œæ‰€å‘ç”Ÿçš„ã€‚å½“åœ¨æˆ‘ä»¬çš„<code class="fe nh ni nj my b">await client.get(...)</code>æ–¹æ³•ä¸­è¿›è¡Œè°ƒç”¨æ—¶ï¼Œæˆ‘ä»¬è¿”å›ä¸€ä¸ªHTMLå­—ç¬¦ä¸²ã€‚</p><p id="d088" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe nh ni nj my b">MockClient</code>å®ä¾‹è¿˜æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¸€ä¸ªè¡¨ç¤ºå“åº”çŠ¶æ€ä»£ç çš„æ•´æ•°ã€‚æœ¬ä¾‹ä¸­æ˜¯ä¸€ä¸ª<code class="fe nh ni nj my b">200 OK</code>ã€‚</p><p id="11d9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æˆ‘ä»¬ç»§ç»­è¿›è¡Œæˆ‘ä»¬çš„<code class="fe nh ni nj my b">initiate()</code>è°ƒç”¨ï¼Œä¼ å…¥è¢«æ¨¡ä»¿çš„å®¢æˆ·ç«¯ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬çš„æµ‹è¯•ç°åœ¨æ˜¯å¯é¢„æµ‹çš„ï¼Œå¹¶ä¸”å¯ä»¥è‡ªä¿¡åœ°å¯¹å“åº”æ‰§è¡Œæ–­è¨€ã€‚</p><p id="0fd1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe nh ni nj my b">expect</code>å’Œ<code class="fe nh ni nj my b">equals</code>é¡¶çº§å‡½æ•°æ˜¯Dartå›¢é˜Ÿçš„<strong class="kt ir">æµ‹è¯•</strong>åŒ…çš„ä¸€éƒ¨åˆ†ã€‚æˆ‘ä»¬ä¹‹å‰å®‰è£…äº†å®ƒï¼Œå®ƒåˆ—åœ¨æˆ‘ä»¬çš„<code class="fe nh ni nj my b">pubspec.yaml</code>æ–‡ä»¶ä¸­çš„<code class="fe nh ni nj my b">dev_dependencies:</code>ä¸‹ã€‚</p><p id="d0d3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æˆ‘ä»¬ä½¿ç”¨<code class="fe nh ni nj my b">json.encode()</code>æ–¹æ³•ä½œä¸ºæˆ‘ä»¬æœŸæœ›ä»æ“ä½œä¸­å¾—åˆ°çš„ç¼–ç JSONå­—ç¬¦ä¸²ã€‚</p><p id="248f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰§è¡Œä»¥ä¸‹æ“ä½œæ¥è¿è¡Œè¯¥æµ‹è¯•:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="a99d" class="nc lw iq my b gy nd ne l nf ng">$ <strong class="my ir">pub run test</strong></span></pre><p id="71d6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">ä¸‹é¢æ˜¯é’ˆå¯¹å¤±è´¥åœºæ™¯çš„ç¬¬äºŒä¸ªæµ‹è¯•:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="dcb9" class="nc lw iq my b gy nd ne l nf ng">void main() {<br/>  ...<br/>  ...</span><span id="5ead" class="nc lw iq my b gy nt ne l nf ng">  <strong class="my ir">test</strong>('calling initiate(client) should silently fail', () async {<br/>    // Arrange<br/>    <strong class="my ir">client</strong> = MockClient((req) =&gt; Future(() =&gt; <strong class="my ir">Response('Failed', 400)</strong>));<br/><br/>    // Act<br/>    var response = <strong class="my ir">await hacker_news_scraper.initiate(client)</strong>;<br/><br/>    // Assert<br/>    expect(<strong class="my ir">response</strong>, <strong class="my ir">equals</strong>('<strong class="my ir">Failed</strong>'));<br/>  });<br/>}</span></pre><p id="4fe0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å†æ¬¡æ‰§è¡Œ<code class="fe nh ni nj my b">pub run test</code>ã€‚è¿™å°†å¤±è´¥ã€‚</p><p id="4173" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">è®©æˆ‘ä»¬åº¦è¿‡è¿™ä¸€å…³ã€‚åœ¨æˆ‘ä»¬çš„<code class="fe nh ni nj my b">initiate()</code>æ–¹æ³•ä¸­ï¼Œè®©æˆ‘ä»¬åœ¨GETè°ƒç”¨ä¸‹é¢æ·»åŠ è¿™ä¸ªæ¡ä»¶:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="ea55" class="nc lw iq my b gy nd ne l nf ng">if (response.statusCode != 200) return response.body;</span></pre><p id="42b3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å†æ¬¡è¿è¡Œæµ‹è¯•ã€‚éƒ½åº”è¯¥è¿‡å»ï¼</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/62083ea5ccdbcb4d5ad0fa4fb8127b62.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*K7RUPzSnHvrnd0ewY8YFFQ.png"/></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">é€šè¿‡æµ‹è¯•ã€‚ç”±Dartæ‰©å±•ä¸ºVSä»£ç ç”Ÿæˆçš„è¾“å‡º</figcaption></figure><h1 id="e1e5" class="lv lw iq bd lx ly ms ma mb mc mt me mf jw mu jx mh jz mv ka mj kc mw kd ml mm bi translated">ç»“è®º</h1><p id="9c47" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">æ€»è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬ä½¿ç”¨Dartå›¢é˜Ÿæä¾›çš„<strong class="kt ir"> http </strong>å’Œ<strong class="kt ir"> html </strong>åŒ…æ„å»ºäº†ä¸€ä¸ªæŠ“å–å·¥å…·ï¼Œä»é»‘å®¢æ–°é—»ç½‘ç«™è·å–æœ€æ–°çš„æè¦ã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡ç¼–å†™ä¸€äº›å•å…ƒæµ‹è¯•æ¥ä¿æŠ¤è‡ªå·±ã€‚</p><p id="b2af" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">å®é™…ä¸Šï¼Œä½¿ç”¨é»‘å®¢æ–°é—»APIå¯èƒ½ä¼šæ›´å¥½ğŸ˜„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºæ²¡æœ‰å®˜æ–¹APIæ¥éå†å†…å®¹çš„ç½‘ç«™ï¼Œæ‚¨ä»ç„¶éœ€è¦è¿™ç§æ–¹æ³•ã€‚</p><p id="aa41" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æˆ‘å¸Œæœ›è¿™æ˜¯æœ‰è§åœ°çš„ï¼Œå°¤å…¶æ˜¯åœ¨ç”¨Dartç¼–å†™æµ‹è¯•çš„é¢†åŸŸã€‚</p><p id="fa90" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">â†’ <a class="ae ln" href="https://github.com/graphicbeacon/hacker_news_scraper" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">è·å–æºä»£ç </strong> </a></p><p id="f810" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æˆ‘è¿˜ç»è¥ä¸€ä¸ªYouTubeé¢‘é“ï¼Œæ•™ç”¨æˆ·ç”¨Dartå¼€å‘å…¨æ ˆåº”ç”¨ç¨‹åºã€‚<a class="ae ln" href="http://bit.ly/fullstackdart" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">æˆä¸ºè®¢é˜…è€…</strong> </a>æ¥æ”¶æ–°è§†é¢‘å‘å¸ƒæ—¶çš„æ›´æ–°ã€‚</p><p id="b868" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">æœ€åï¼Œæˆ‘å‡ ä¹å®Œæˆäº†Egghead.ioä¸Šçš„å…è´¹é£é•–è¯¾ç¨‹ã€‚è¿™å°†åœ¨æ–°å¹´å‘å¸ƒğŸ‰ï¼Œæ‰€ä»¥è¯·å¯†åˆ‡æ³¨æ„ğŸ‘ï¸</p><p id="5fe5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">å–œæ¬¢ï¼Œåˆ†äº«</strong> <a class="ae ln" href="https://twitter.com/creativ_bracket" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">è·Ÿæˆ‘æ¥</strong> </a>ğŸ˜æœ‰å…³Dartçš„æ›´å¤šå†…å®¹ã€‚è°¢è°¢ï¼</p><h1 id="2152" class="lv lw iq bd lx ly ms ma mb mc mt me mf jw mu jx mh jz mv ka mj kc mw kd ml mm bi translated">è¿›ä¸€æ­¥é˜…è¯»</h1><ol class=""><li id="c91f" class="nv nw iq kt b ku mn kx mo la nx le ny li nz lm oa ob oc od bi translated"><a class="ae ln" href="https://pub.dartlang.org/packages/http" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> http </strong>:ä¸€ä¸ªå¯ç»„åˆçš„ã€åŸºäºæœªæ¥çš„åº“ï¼Œç”¨äºå‘å‡ºhttpè¯·æ±‚</a></li><li id="d0c2" class="nv nw iq kt b ku oe kx of la og le oh li oi lm oa ob oc od bi translated"><a class="ae ln" href="https://pub.dartlang.org/packages/html" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir">html</strong>:Dartä¸­çš„HTML5è§£æå™¨</a></li><li id="d9c4" class="nv nw iq kt b ku oe kx of la og le oh li oi lm oa ob oc od bi translated"><a class="ae ln" href="https://egghead.io/instructors/jermaine-oppong" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">å…è´¹é£é•–æˆªå±åœ¨Egghead.io </strong> </a></li></ol></div></div>    
</body>
</html>