<html>
<head>
<title>Python and AutoKeras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pythonå’ŒAutoKeras</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/python-and-autokeras-cbf9f1dbaa04?source=collection_archive---------4-----------------------#2020-11-29">https://itnext.io/python-and-autokeras-cbf9f1dbaa04?source=collection_archive---------4-----------------------#2020-11-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/a096813b7b9dcdb1edd97cd8c1f658db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ga702VA7E6VZoL35nFAzrQ.jpeg"/></div></div></figure><div class=""/><p id="d5f7" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">AutoMLæ˜¯æœºå™¨å­¦ä¹ è¡Œä¸šä¸­ä¸€ä¸ªæœ‰è¶£çš„é¢†åŸŸï¼Œæœ‰æœ›åŠ å¿«æ¨¡å‹ç”Ÿæˆå‘¨æœŸã€‚æœ€è¿‘æˆ‘ä¸€ç›´åœ¨ä¸Tensroflowå’ŒKerasåˆä½œä¸€ä¸ªæ·±åº¦å­¦ä¹ é¡¹ç›®ã€‚å‡ºäºçº¯ç²¹çš„å¥½å¥‡å’Œæ€»æ˜¯å­¦ä¹ çš„ç›®çš„ï¼Œæˆ‘å†³å®šå°è¯•è‡ªåŠ¨åŒ–æ·±åº¦å­¦ä¹ ï¼Œæ›´å…·ä½“åœ°è¯´æ˜¯AutoKerasã€‚</p><p id="93ea" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è¿™ç¯‡æ–‡ç« èƒŒåçš„åŠ¨æœºæ˜¯å› ä¸ºå…³äºè¿™ä¸ªä¸»é¢˜çš„èµ„æºå¾ˆå°‘ã€‚å¼€å§‹æ—¶ï¼Œæˆ‘åªæœç´¢äº†ä¸€äº›ä¿¡æ¯ï¼Œåœ¨è¿™äº›ä¿¡æ¯ä¸­æˆ‘å‘ç°äº†éå¸¸å°‘çš„æ¼”ç»ƒï¼Œè€Œä¸”æ²¡æœ‰ä¸€ä¸ªæ˜¯æœ€æ–°çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ¬æ–‡çš„èŒƒå›´æ˜¯AutoKerasçš„ä¸€ä¸ªåŸºæœ¬ç”¨ä¾‹ä»¥åŠä¸€ä¸ªæ–‡ä»¶ç»“æ„å¸ƒå±€..ofc GitHub repoåŒ…æ‹¬:d .ä¸€äº›å…³äºTensorflowå’ŒKerasçš„å…ˆéªŒçŸ¥è¯†æ˜¯æœ‰å¸®åŠ©çš„ã€‚</p><h1 id="0c93" class="kw kx jb bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">å®‰è£…</h1><p id="d77e" class="pw-post-body-paragraph jy jz jb ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><em class="lz">å…¬å¹³è­¦å‘Š:</em>æˆ‘å·²ç»å°è¯•ä½¿ç”¨æ‰€æœ‰è½¯ä»¶åŒ…çš„æœ€æ–°ç‰ˆæœ¬ï¼Œç„¶è€Œï¼Œåœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œæˆ‘é‡åˆ°äº†ä¸Tensorflow==2.3.1å’ŒAutoKeras==1.0.10 - &gt;é™çº§åˆ°AutoKeras==1.0.8çš„å…¼å®¹æ€§é—®é¢˜ã€‚</p><h1 id="d962" class="kw kx jb bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">è£…ç½®</h1><p id="5234" class="pw-post-body-paragraph jy jz jb ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯åœ¨æ‚¨æ‰“ç®—è¿›è¡Œé¡¹ç›®çš„ç›®å½•ä¸­è®¾ç½®ä¸€ä¸ªpythonè™šæ‹Ÿç¯å¢ƒã€‚Pythonä¸ºè™šæ‹Ÿç¯å¢ƒæä¾›äº†ä¸€ä¸ªéå¸¸ç®€å•çš„å‘½ä»¤ã€‚pythonç‰ˆæœ¬å°†ä¸è·¯å¾„ç›®å½•ä¸­å®‰è£…çš„ç‰ˆæœ¬ç›¸åŒ:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="835e" class="mj kx jb mf b gy mk ml l mm mn">python -m venv DL_Env<br/>DL_Env\Scripts\activate.bat # Windows activate<br/>source DL_Env/bin/activate # Linux activate</span></pre><p id="61dc" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ¿€æ´»è™šæ‹Ÿç¯å¢ƒåï¼Œä¸‹ä¸€æ­¥æ˜¯å®‰è£…æ‰€éœ€çš„è½¯ä»¶åŒ…ã€‚æˆ‘ä»¬åªéœ€è¦Tensorflow==2.3.1å’ŒAutoKeras==1.0.8ï¼Œè¿™äº›ä¹Ÿå¯ä»¥åœ¨requirements.txtæ–‡ä»¶ä¸­çš„GitHub Repoä¸­æ‰¾åˆ°ã€‚</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="87c2" class="mj kx jb mf b gy mk ml l mm mn">pip install Tensorflow==2.3.1<br/>pip install AutoKeras=1.0.8<br/>pip install git+https://github.com/keras-team/keras-tuner.git@1.0.2rc4</span></pre><h1 id="7cb8" class="kw kx jb bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">æ–‡ä»¶ç»“æ„</h1><p id="2392" class="pw-post-body-paragraph jy jz jb ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">å®‰è£…å®Œæ‰€æœ‰åˆé€‚çš„åŒ…åï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥å¦ä¸€ä¸ªéå¸¸é‡è¦çš„æ­¥éª¤ï¼Œé‚£å°±æ˜¯æ–‡ä»¶ç»“æ„ã€‚è‡ªåŠ¨æœºå™¨å­¦ä¹ å°†æ ¹æ®è„šæœ¬ä¸­çš„ç”¨æˆ·å®šä¹‰ç”Ÿæˆå¤§é‡æ¨¡å‹å’Œæ¨¡å‹çš„å¤§é‡ä¿¡æ¯ã€‚æœ‰ä¸€ä¸ªå¥½çš„æ–‡ä»¶ç»“æ„å¸ƒå±€æ˜¯å¾ˆé‡è¦çš„ï¼Œå®ƒæ—¢ç›´è§‚åˆå®¹æ˜“ç†è§£ã€‚å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæˆ‘æ²¡æœ‰æ‰¾åˆ°ä»»ä½•å…³äºä»€ä¹ˆæ˜¯æœ€å¥½çš„ç»“æ„çš„ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘å°†åˆ†äº«ä¸€ä¸ªè‡ªå·±åˆ¶ä½œçš„ç»“æ„ï¼Œå®ƒå°†å®Œæˆå·¥ä½œï¼Œå¹¶ä»ä¸ªäººç»éªŒä¸­è¯æ˜æ˜¯æœ‰æ•ˆçš„ã€‚</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="3ad4" class="mj kx jb mf b gy mk ml l mm mn">+-- Project_Folder<br/>|   +-- DL_Env<br/>|   +-- Datasets<br/>|   +-- Logs<br/>|   +-- Models<br/>|   +-- Projects<br/>|   +-- Datasets<br/>|   +-- Tensorboard<br/>|   +-- main.py</span></pre><h1 id="37f2" class="kw kx jb bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">AutoKeras</h1><p id="6ac1" class="pw-post-body-paragraph jy jz jb ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">æ•´ä¸ªè¿‡ç¨‹å°†åŒ…å«åœ¨ä¸€ä¸ªè„šæœ¬-&gt; main.pyä¸­ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åº”è¯¥å¯¼å…¥å’ŒåŠ è½½æ•°æ®é›†ã€‚æˆ‘ä»¬è¦è§£å†³çš„é—®é¢˜æ˜¯ä¸€ä¸ªç»“æ„åŒ–æ•°æ®åˆ†ç±»å™¨ï¼Œè¿™ä¸ªä»»åŠ¡çš„æ•°æ®é›†å°†æ˜¯ä¸€ä¸ªå·¨å¤§çš„æ•°æ®é›†ã€‚titanicæ•°æ®é›†æ˜¯æ•…æ„é€‰æ‹©çš„ï¼Œå› ä¸ºå®ƒæ˜¯æ•°æ®ç§‘å­¦ç¤¾åŒºä¸­ä¼—æ‰€å‘¨çŸ¥çš„ï¼Œå› æ­¤å°†æä¾›AutoKeraså¦‚ä½•å¤„ç†å®ƒçš„ä¸€ç§å‚è€ƒç‚¹ã€‚</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="6782" class="mj kx jb mf b gy mk ml l mm mn">import tensorflow as tf<br/>import autokeras as ak<br/>import kerastuner<br/>â€‹<br/>TRAIN_DATA_URL = "https://storage.googleapis.com/tf-datasets/titanic/train.csv"<br/>TEST_DATA_URL = "https://storage.googleapis.com/tf-datasets/titanic/eval.csv"<br/>â€‹<br/>train_file_path = tf.keras.utils.get_file("train.csv", TRAIN_DATA_URL)<br/>test_file_path = tf.keras.utils.get_file("eval.csv", TEST_DATA_URL)<br/>â€‹<br/>tensorboard_callback_train = tf.keras.callbacks.TensorBoard(log_dir='Tensorboard//logs_autokeras_f1_score_10%')<br/>tensorboard_callback_test = tf.keras.callbacks.TensorBoard(log_dir='Tensorboard//logs_autokeras_f1_score_10%')<br/>â€‹<br/>Early_Stopping = tf.keras.callbacks.EarlyStopping(monitor='val_loss', patience=101)</span></pre><p id="20bd" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸‹ä¸€æ­¥æ˜¯è°ƒç”¨æˆ‘ä»¬å¸Œæœ›AutoKerasä½¿ç”¨çš„åˆ†ç±»å™¨ç±»å‹ã€‚ç”±äºæˆ‘ä»¬æ­£åœ¨å¤„ç†ç»“æ„åŒ–æ•°æ®ï¼Œå¹¶ä¸”å­˜åœ¨åˆ†ç±»é—®é¢˜ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»ä½¿ç”¨AutoKerasæä¾›çš„ç»“æ„åŒ–æ•°æ®åˆ†ç±»å™¨å¯¹è±¡ã€‚</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="ccdb" class="mj kx jb mf b gy mk ml l mm mn"># Initialize the structured data classifier.<br/>clf = ak.StructuredDataClassifier(<br/>    project_name = "Projects/First_Run",<br/>    objective=kerastuner.Objective('accuracy', direction='max'),<br/>    metrics=["accuracy"],<br/>    overwrite=True,<br/>    max_trials=1001)</span></pre><p id="2399" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å› æ­¤ï¼Œè®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹æ¯ä¸ªå‚æ•°ã€‚é¡¹ç›®åç§°å‚æ•°å°†åœ¨æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„å­ç›®å½•â€œé¡¹ç›®â€ä¸­ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹ã€‚è¯¥æ–‡ä»¶å¤¹å°†åŒ…å«è¯¥è¿‡ç¨‹åˆ›å»ºçš„æ‰€æœ‰è¯•éªŒï¼Œæ¢å¥è¯è¯´å°±æ˜¯æ¨¡å‹ã€‚è¦†ç›–çœŸæ„å‘³ç€æ¸…é™¤æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰è¯•éªŒï¼Œå¹¶ä¿å­˜æ–°çš„è¿è¡Œã€‚åœ¨ç›®æ ‡å‚æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰AutoKerasåº”è¯¥ä¼˜å…ˆè€ƒè™‘å“ªä¸ªåº¦é‡ï¼Œä»¥åŠAutoKerasåœ¨ç¥ç»æ¶æ„æœç´¢æœŸé—´åº”è¯¥æœ€å¤§åŒ–è¿˜æ˜¯æœ€å°åŒ–è¯¥åº¦é‡ã€‚æ‚¨å¯ä»¥æ·»åŠ è‡ªå®šä¹‰æŒ‡æ ‡ï¼Œå¦‚F1ã€F0.5ã€AUCç­‰ã€‚ç›¸åŒçš„æŒ‡æ ‡å¯ä»¥æ”¾å…¥â€œæŒ‡æ ‡â€å‚æ•°ï¼Œè¯¥å‚æ•°å°†åœ¨åŸ¹è®­å’Œè¯„ä¼°æœŸé—´æŠ¥å‘Šã€‚æœ€åï¼Œmax_trialså‚æ•°å‘Šè¯‰AutoKerasè¦ç”Ÿæˆå¤šå°‘ä¸åŒè¶…å‚æ•°ç»„åˆçš„æ¨¡å‹æˆ–è¯•éªŒã€‚</p><p id="cda9" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ—¢ç„¶æˆ‘ä»¬å·²ç»å®šä¹‰äº†åˆ†ç±»å™¨åŠå…¶å‚æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹è¿™ä¸ªè¿‡ç¨‹äº†:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="93a0" class="mj kx jb mf b gy mk ml l mm mn">clf.fit(<br/>    train_file_path # or  train_x and train_y<br/>    epochs=151,<br/>    verbose=2,<br/>    callbacks=[tensorboard_callback_train, Early_Stopping],<br/>    batch_size=1001<br/>    )</span></pre><p id="7b4e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸ºäº†å¼€å§‹è‡ªåŠ¨åŒ–çš„æ·±åº¦å­¦ä¹ è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç®€å•åœ°è°ƒç”¨fitæ–¹æ³•å¹¶è¾“å…¥è®­ç»ƒæ•°æ®ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜ä¼šä¼ å…¥ä¸€äº›å‚æ•°ï¼Œå¦‚æ¯æ¬¡è¯•éªŒå°†è®­ç»ƒçš„æ¬¡æ•°ã€è¾“å‡ºçº§åˆ«ã€æˆ‘ä»¬çš„å›è°ƒ(åœ¨æœ¬ä¾‹ä¸­ï¼Œå›è°ƒä¼šäº§ç”Ÿå…·æœ‰æå‰åœæ­¢åŠŸèƒ½çš„tensorboardä¿¡æ¯),ä»¥åŠæœ€ç»ˆçš„æ‰¹é‡å¤§å°ã€‚</p><p id="58a1" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è®­ç»ƒç»“æŸåï¼Œæˆ‘ä»¬å¯ä»¥å¯¼å‡ºè¡¨ç°æœ€ä½³çš„æ¨¡å‹ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å¯¼å‡ºã€ä¿å­˜å¹¶è¯„ä¼°å…¶æ€§èƒ½:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="e19f" class="mj kx jb mf b gy mk ml l mm mn">clf_best_model = clf.export_model()<br/>clf_best_model.save("Models/First_Run", save_format="tf")<br/>print(accuracy=clf.evaluate(test_file_path, "survived"))</span></pre><p id="123f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¦‚æœæ‰“å¼€å¦ä¸€ä¸ªè„šæœ¬ï¼Œæ‚¨å¯ä»¥åŠ è½½æ¨¡å‹å¹¶ä½¿ç”¨å®ƒè¿›è¡Œé¢„æµ‹ï¼Œè€Œæ— éœ€å¯¼å…¥AutoKeras:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="e333" class="mj kx jb mf b gy mk ml l mm mn">from tensorflow.keras.models import load_model<br/>â€‹<br/>Custom_Objects = ak.CUSTOM_OBJECTS<br/>â€‹<br/># If you have custom metrics add each metric accordingly<br/># Custom_Objects["f1_score"] = f1_score<br/>â€‹<br/>loaded_model = load_model("Models/First_Run", custom_objects=Custom_Objects)<br/>â€‹<br/>print(loaded_model.evaluate(test_file_path, "survived"))</span></pre><h1 id="e2bb" class="kw kx jb bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">ç»“è®º</h1><p id="aa0b" class="pw-post-body-paragraph jy jz jb ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">è¿™å°±ç»“æŸäº†ä¸€ä¸ªé€šè¿‡AutoKerasè§£å†³çš„ç®€å•AutoMLé—®é¢˜ã€‚ç¡®ä¿ä»¥ä¸‹åˆ—æ–¹å¼è¿è¡Œè„šæœ¬ï¼Œä»¥ä¾¿ä¿å­˜æ—¥å¿—æ–‡ä»¶:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="213e" class="mj kx jb mf b gy mk ml l mm mn">python main.py &gt; Logs/First_Run.txt</span></pre><p id="1a5e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è°¢è°¢ä½ èµ°åˆ°è¿™ä¸€æ­¥ğŸ˜„</p><p id="9903" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">GitHub:<a class="ae mo" href="https://github.com/ervin007/Autokeras_And_Python" rel="noopener ugc nofollow" target="_blank">https://github.com/ervin007/Autokeras_And_Python</a></p></div></div>    
</body>
</html>