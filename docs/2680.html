<html>
<head>
<title>Creating a reading progress bar in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åœ¨Reactä¸­åˆ›å»ºé˜…è¯»è¿›åº¦æ¡</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/creating-a-reading-progress-bar-in-react-95729b533af8?source=collection_archive---------7-----------------------#2019-07-09">https://itnext.io/creating-a-reading-progress-bar-in-react-95729b533af8?source=collection_archive---------7-----------------------#2019-07-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5de68261575d2ab4948765100ed84180.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FwXpqkIhuz3kIBm0byA3NA.png"/></div></div></figure><p id="cb2d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">é˜…è¯»è¿›åº¦æ¡ï¼Œå°±åƒä½ å¯ä»¥åœ¨æˆ‘çš„åšå®¢ä¸Šçš„å•ç¯‡æ–‡ç« é¡¶éƒ¨æ‰¾åˆ°çš„é‚£ç§ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å°è¡¥å……ï¼Œå¯ä»¥æä¾›è¯»è€…åœ¨å½“å‰æ–‡ç« ä¸Šè¿›å±•çš„è¯¦ç»†ä¿¡æ¯ã€‚æ»šåŠ¨æ¡åœ¨è¿™æ–¹é¢å¹¶æ²¡æœ‰çœŸæ­£çš„æ„ä¹‰ï¼›å®ƒåŒ…æ‹¬ä½ çš„æ•´ä¸ªé¡µé¢ï¼Œè¿™æ„å‘³ç€ä½ çš„é¡µçœ‰ï¼Œè¯„è®ºï¼Œé¡µè„šç­‰ã€‚æ˜¯è¿¹è±¡çš„ä¸€éƒ¨åˆ†ã€‚</p><p id="540d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">åˆ›å»ºä¸€ä¸ªé˜…è¯»è¿›åº¦æ¡ï¼Œå‘Šè¯‰ä½ Reactä¸­å½“å‰æ–‡ç« å†…å®¹çš„å®é™…è¿›åº¦æ˜¯éå¸¸å®¹æ˜“çš„â€”â€”ç‰¹åˆ«æ˜¯ä½¿ç”¨é’©å­ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬çš„ç»„ä»¶æ›´å°ã€‚</p><h1 id="325d" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">ReadingProgressç»„ä»¶</h1><p id="a92e" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">æˆ‘ä»¬çš„<code class="fe lz ma mb mc b">ReadingProgress</code>ç»„ä»¶å°†åšä»¥ä¸‹äº‹æƒ…:</p><ul class=""><li id="f9a0" class="md me iq ka b kb kc kf kg kj mf kn mg kr mh kv mi mj mk ml bi translated">åˆ©ç”¨é’©å­ï¼Œå®ƒå°†è´Ÿè´£é˜…è¯»å’Œè®¾ç½®æˆ‘ä»¬çš„é˜…è¯»è¿›åº¦</li><li id="c8ed" class="md me iq ka b kb mm kf mn kj mo kn mp kr mq kv mi mj mk ml bi translated">åˆ©ç”¨é’©å­æ¥å¤„ç†æ»šåŠ¨äº‹ä»¶ï¼Œå¹¶æ­£ç¡®åœ°æ›´æ–°æˆ‘ä»¬çš„è¿›åº¦æ¡</li><li id="122c" class="md me iq ka b kb mm kf mn kj mo kn mp kr mq kv mi mj mk ml bi translated">ä»¥é€‚å½“çš„å®½åº¦è¿”å›é˜…è¯»è¿›åº¦æ¡</li></ul><p id="fed3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å› æ­¤ï¼Œè®©æˆ‘ä»¬ç›´æ¥è¿›å…¥å®ç°:</p><pre class="mr ms mt mu gt mv mc mw mx aw my bi"><span id="7b90" class="mz kx iq mc b gy na nb l nc nd">const ReadingProgress = ({ target }) =&gt; {<br/>  const [readingProgress, setReadingProgress] = useState(0);<br/>    <br/>  return &lt;div className={`reading-progress-bar`} style={{width: `${readingProgress}%` }} /&gt;<br/>};</span></pre><p id="08e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è¿™æ˜¯æˆ‘ä»¬ç»„ä»¶çš„åŸºç¡€ã€‚<code class="fe lz ma mb mc b">readingProgress</code>å°†ä½œä¸ºè¿›åº¦æ¡çš„å®½åº¦(ç™¾åˆ†æ¯”)ã€‚æˆ‘ä»¬ç»„ä»¶çš„å”¯ä¸€æ”¯æŸ±æ˜¯<code class="fe lz ma mb mc b">target</code>ï¼Œå®ƒå°†å¼•ç”¨æˆ‘ä»¬postçš„DOMå®¹å™¨â€”â€”ç¨åä¼šè¯¦ç»†ä»‹ç»ã€‚</p><p id="de91" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">é¦–å…ˆè®©æˆ‘ä»¬å®ç°æˆ‘ä»¬çš„ç›‘å¬å™¨ï¼Œå®ƒå°†æ›´æ–°æ»šåŠ¨äº‹ä»¶çš„è¿›åº¦æ¡:</p><pre class="mr ms mt mu gt mv mc mw mx aw my bi"><span id="8587" class="mz kx iq mc b gy na nb l nc nd">const scrollListener = () =&gt; {<br/>    if (!target.current) {<br/>      return;<br/>    }</span><span id="f594" class="mz kx iq mc b gy ne nb l nc nd">const element         = target.current;<br/>    const totalHeight     = element.clientHeight - element.offsetTop;<br/>    const windowScrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;</span><span id="fd11" class="mz kx iq mc b gy ne nb l nc nd">if (windowScrollTop === 0) {<br/>      return setReadingProgress(0);<br/>    }</span><span id="2b54" class="mz kx iq mc b gy ne nb l nc nd">if (windowScrollTop &gt; totalHeight) {<br/>      return setReadingProgress(100);<br/>    }<br/>    <br/>    console.log(windowScrollTop);</span><span id="2d58" class="mz kx iq mc b gy ne nb l nc nd">setReadingProgress((windowScrollTop / totalHeight) * 100);<br/>  };</span></pre><p id="c50e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe lz ma mb mc b">windowScrollTop</code>å°è¯•ä¸€ç³»åˆ—ä¸åŒçš„å€¼ï¼Œä¸ºæŸäº›æµè§ˆå™¨(å¦‚Safari)ä¿®å¤<code class="fe lz ma mb mc b">undefined</code>å€¼ã€‚</p><p id="1225" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è¿™ç§å®ç°æœ‰ä¸€ä¸ªé—®é¢˜:åªæœ‰å½“æˆ‘ä»¬æ»šåŠ¨<em class="nf">è¶…è¿‡</em>æˆ‘ä»¬çš„ç›®æ ‡æ—¶ï¼Œæ‰èƒ½è¾¾åˆ°100%çš„é˜…è¯»è¿›åº¦ã€‚è¿™ä¸å¤ªå¯èƒ½æ˜¯çœŸçš„(é™¤éä½ åœ¨è¯»å®Œä¸€è¡Œåæ»šåŠ¨ä¸€è¡Œï¼Œè¿™ä¼šè®©ä½ å¾ˆå¥‡æ€ª)â€”â€”æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç¨å¾®è°ƒæ•´ä¸€ä¸‹å¦‚ä½•è®¡ç®—æˆ‘ä»¬çš„é˜…è¯»è¿›åº¦:</p><pre class="mr ms mt mu gt mv mc mw mx aw my bi"><span id="20c1" class="mz kx iq mc b gy na nb l nc nd">const totalHeight = element.clientHeight - element.offsetTop - window.innerHeight;</span></pre><p id="b9dc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è¿™åº”è¯¥ä¼šäº§ç”Ÿä¸€ä¸ªæ›´å‡†ç¡®çš„ç»“æœï¼Œå½“æ¡å½¢å›¾æ˜¾ç¤ºç»“æŸæ—¶ã€‚</p><p id="c080" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æŠŠæˆ‘ä»¬çš„ç›‘å¬å™¨æ”¾åˆ°ä¸€ä¸ª<code class="fe lz ma mb mc b">useEffect</code>é’©å­ä¸­ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬çš„æ•´ä¸ªç»„ä»¶çœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="mr ms mt mu gt mv mc mw mx aw my bi"><span id="5c91" class="mz kx iq mc b gy na nb l nc nd">const ReadingProgress = ({ target }) =&gt; {<br/>  const [readingProgress, setReadingProgress] = useState(0);<br/>  const scrollListener = () =&gt; {<br/>    if (!target.current) {<br/>      return;<br/>    }</span><span id="4cdb" class="mz kx iq mc b gy ne nb l nc nd">const element         = target.current;<br/>    const totalHeight     = element.clientHeight - element.offsetTop - (window.innerHeight);<br/>    const windowScrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;</span><span id="9f3c" class="mz kx iq mc b gy ne nb l nc nd">if (windowScrollTop === 0) {<br/>      return setReadingProgress(0);<br/>    }</span><span id="47aa" class="mz kx iq mc b gy ne nb l nc nd">if (windowScrollTop &gt; totalHeight) {<br/>      return setReadingProgress(100);<br/>    }</span><span id="6fe6" class="mz kx iq mc b gy ne nb l nc nd">setReadingProgress((windowScrollTop / totalHeight) * 100);<br/>  };<br/>  <br/>  useEffect(() =&gt; {<br/>    window.addEventListener("scroll", scrollListener);<br/>    return () =&gt; window.removeEventListener("scroll", scrollListener);<br/>  });</span><span id="8402" class="mz kx iq mc b gy ne nb l nc nd">return &lt;div className={`reading-progress-bar`} style={{width: `${readingProgress}%`}} /&gt;;<br/>};</span></pre><p id="2393" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä»æˆ‘ä»¬çš„<code class="fe lz ma mb mc b">useEffect</code>é’©å­è¿”å›çš„å‡½æ•°åŸºæœ¬ä¸Šå°±æ˜¯ç»„ä»¶è¢«å¸è½½æ—¶å‘ç”Ÿçš„äº‹æƒ…(å‚è§æ–‡æ¡£ä¸­çš„<a class="ae ng" href="https://reactjs.org/docs/hooks-effect.html#effects-with-cleanup" rel="noopener ugc nofollow" target="_blank">æ•ˆæœå’Œæ¸…ç†</a>)ã€‚</p><p id="3bb9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æœ€åä½†åŒæ ·é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æŸä¸ªåœ°æ–¹ä½¿ç”¨æˆ‘ä»¬çš„ç»„ä»¶ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç›®æ ‡å®¹å™¨ä¸Šåˆ›å»ºä¸€ä¸ªrefï¼Œå¹¶ç®€å•åœ°å°†å®ƒä¼ é€’ç»™æˆ‘ä»¬çš„<code class="fe lz ma mb mc b">ReadingProgress</code>ç»„ä»¶:</p><pre class="mr ms mt mu gt mv mc mw mx aw my bi"><span id="8b80" class="mz kx iq mc b gy na nb l nc nd">function App() {<br/>  const target = React.createRef();<br/>  return (<br/>    &lt;&gt;<br/>      &lt;ReadingProgress target={target} /&gt;<br/>      &lt;div className={`post`} ref={target}&gt;post content&lt;/div&gt;<br/>    &lt;/&gt;<br/>  );<br/>}</span></pre><p id="d825" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æœ‰å…³<code class="fe lz ma mb mc b">createRef</code>çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§<a class="ae ng" href="https://reactjs.org/docs/refs-and-the-dom.html" rel="noopener ugc nofollow" target="_blank">æ–‡æ¡£</a></p><p id="6e53" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç°åœ¨ä½ çš„é˜…è¯»è¿›åº¦æ¡åº”è¯¥å·¥ä½œå¾—å¾ˆå¥½äº†â€”â€”é™¤äº†ä½ çœ‹ä¸åˆ°å®ƒï¼Œå› ä¸ºå®ƒæ²¡æœ‰é«˜åº¦ã€‚é€šè¿‡æ·»åŠ ä¸€äº›CSSæ¥è§£å†³è¿™ä¸ªé—®é¢˜:</p><pre class="mr ms mt mu gt mv mc mw mx aw my bi"><span id="1b73" class="mz kx iq mc b gy na nb l nc nd">.reading-progress-bar {<br/>  position: sticky;<br/>  height: 5px;<br/>  top: 0;<br/>  background-color: #ff0000;<br/>}</span></pre><p id="eee7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">æå®šï¼</strong>ç°åœ¨ï¼Œä½ çš„è¯»è€…ä¸å†ä¼šè¿·å¤±åœ¨ä½ çš„å¸–å­çš„æ— å°½é•¿åº¦ä¸­ï¼Œå¹¶ä¸”æ€»æ˜¯çŸ¥é“å®ƒä»€ä¹ˆæ—¶å€™ä¼šç»“æŸã€‚</p><p id="2e2d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è¦æŸ¥çœ‹ä¸€ä¸ªå®Œæ•´çš„å·¥ä½œç¤ºä¾‹ï¼Œä½ å¯ä»¥çœ‹çœ‹è¿™ä¸ªä»£ç ç¬”:ã€https://codepen.io/nehalist/pen/agRNYZ<a class="ae ng" href="https://codepen.io/nehalist/pen/agRNYZ" rel="noopener ugc nofollow" target="_blank"/></p><h1 id="bf36" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">ç¬¬ä¸‰æ–¹è½¯ä»¶åŒ…</h1><p id="0d7d" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">æœ‰ä¸€äº›ç¬¬ä¸‰æ–¹è½¯ä»¶åŒ…å¯ä»¥å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚æ®æˆ‘æ‰€çŸ¥ï¼Œå®ƒä»¬ä¸­çš„å¤§éƒ¨åˆ†éƒ½å·²ç»è¿‡æ—¶å’Œ/æˆ–ä¸å†ç»´æŠ¤â€”â€”ä½†æ­¤æ—¶æ›´é‡è¦çš„æ˜¯:å¯¹äºä¸€ä¸ªåªæœ‰å¤§çº¦30è¡Œä»£ç çš„éå¸¸ç®€å•çš„ç»„ä»¶ï¼Œæ‚¨çœŸçš„éœ€è¦ç¬¬ä¸‰æ–¹ä¾èµ–å—ï¼Ÿå—¯ï¼Œè€å®è¯´ï¼Œ<em class="nf">æˆ‘ä¸è¿™ä¹ˆè®¤ä¸º</em>ã€‚</p><h1 id="79f0" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">ç»“è®º</h1><p id="acd4" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œåœ¨Reactä¸­å®ç°ä¸€ä¸ªé˜…è¯»è¿›åº¦æ¡éå¸¸å®¹æ˜“ã€‚å¤šäºäº†é’©å­ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªç»„ä»¶å®ç°ä¸ºä¸€ä¸ªéå¸¸å°çš„åŠŸèƒ½ç»„ä»¶ï¼Œå‡ ä¹æ²¡æœ‰å¼€é”€ã€‚</p><p id="c708" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¦‚æœä½ åœ¨å®ç°æ–¹é¢æœ‰ä»»ä½•æ”¹è¿›ï¼Œæˆ–è€…è®¤ä¸ºå¯ä»¥åšå¾—æ›´å¥½ï¼Œè¯·åœ¨è¯„è®ºä¸­å‘Šè¯‰æˆ‘ï¼</p></div><div class="ab cl nh ni hu nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ij ik il im in"><p id="3480" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·ç•™ä¸‹ğŸ‘ï¼Œå…³æ³¨æˆ‘ä¸Š <a class="ae ng" href="https://twitter.com/nehalist" rel="noopener ugc nofollow" target="_blank"> <em class="nf">æ¨ç‰¹</em> </a> <em class="nf">å¹¶è®¢é˜…</em> <a class="ae ng" href="https://nehalist.io/newsletter/" rel="noopener ugc nofollow" target="_blank"> <em class="nf">æˆ‘çš„å¿«è®¯</em> </a> <em class="nf">ã€‚åŸè½½äº2019å¹´7æœˆ9æ—¥</em><a class="ae ng" href="https://nehalist.io/creating-a-reading-progress-bar-in-react" rel="noopener ugc nofollow" target="_blank"><em class="nf">https://nehalist . io</em></a><em class="nf">ã€‚</em></p></div></div>    
</body>
</html>