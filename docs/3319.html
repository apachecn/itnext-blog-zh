<html>
<head>
<title>Learn how to connect your microservices using Dapr and NATS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">äº†è§£å¦‚ä½•ä½¿ç”¨Daprå’ŒNATSè¿æ¥æ‚¨çš„å¾®æœåŠ¡</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/learn-how-to-connect-your-microservices-using-dapr-and-nats-aafea432a6e8?source=collection_archive---------3-----------------------#2019-11-21">https://itnext.io/learn-how-to-connect-your-microservices-using-dapr-and-nats-aafea432a6e8?source=collection_archive---------3-----------------------#2019-11-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="cd18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://github.com/dapr/dapr/blob/master/docs/release_notes/v0.2.0.md" rel="noopener ugc nofollow" target="_blank"> Daprç‰ˆæœ¬0.2.0 </a>é™„å¸¦äº†ä¸€å †æ·»åŠ åˆ°è¿è¡Œæ—¶çš„<a class="ae kl" href="https://github.com/dapr/dapr/blob/master/docs/release_notes/v0.2.0.md#dapr-runtime" rel="noopener ugc nofollow" target="_blank">æ–°ç»„ä»¶ã€‚å…¶ä¸­ä¸€ä¸ªç»„ä»¶åŒ…æ‹¬å…·æœ‰</a><a class="ae kl" href="https://nats.io/" rel="noopener ugc nofollow" target="_blank"> NATS </a>çš„pubsubåŠŸèƒ½ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäº<a class="ae kl" href="https://golang.org/" rel="noopener ugc nofollow" target="_blank"> Goçš„</a>å¼€æºæ¶ˆæ¯ç³»ç»Ÿï¼Œç”¨äºäº‘åŸç”Ÿåº”ç”¨ã€ç‰©è”ç½‘æ¶ˆæ¯å’Œå¾®æœåŠ¡æ¶æ„ã€‚è¿™ä¸ªåšå®¢å°†æä¾›å¦‚ä½•ä½¿ç”¨å®ƒçš„ä¸€æ­¥ä¸€æ­¥çš„æ¼”ç»ƒã€‚</p><blockquote class="km kn ko"><p id="57b9" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">ä»£ç ä¸€å¦‚æ—¢å¾€çš„åœ¨GitHub </em>  <em class="iq">ä¸Š</em> <a class="ae kl" href="https://github.com/abhirockzz/dapr-nats-pubsub" rel="noopener ugc nofollow" target="_blank"> <em class="iq">å¯ç”¨</em></a></p></blockquote><p id="6e31" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å°†åœ¨<code class="fe kt ku kv kw b">Kubernetes</code> ( <code class="fe kt ku kv kw b">minikube</code>)éƒ¨ç½²<code class="fe kt ku kv kw b">Dapr</code>ï¼Œå¹¶åœ¨<code class="fe kt ku kv kw b">demo.nats.io:4222</code>ä½¿ç”¨NATSæœåŠ¡å™¨è¿›è¡Œæ¼”ç¤ºã€‚</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/4abc6e4ba6f6fb5d99dd9c65970cf2c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/0*NU4Vh1lf-ydRGJdg.jpg"/></div></figure><h1 id="4dc3" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">ä½ å¥½Daprï¼</h1><p id="dde0" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated"><a class="ae kl" href="http://dapr.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Dapr </strong> </a>ä»£è¡¨<em class="kp">åˆ†å¸ƒå¼åº”ç”¨è¿è¡Œæ—¶</em>ã€‚å®ƒæ˜¯ä¸€ä¸ªå¼€æºã€å¯ç§»æ¤çš„è¿è¡Œæ—¶ï¼Œé€šè¿‡å°†æ„å»ºè¿™ç±»åº”ç”¨ç¨‹åºçš„æœ€ä½³å®è·µç¼–å…¥ç‹¬ç«‹çš„ç»„ä»¶ï¼Œæ¥å¸®åŠ©å¼€å‘äººå‘˜æ„å»ºæœ‰å¼¹æ€§çš„ã€å¾®æœåŠ¡æ— çŠ¶æ€å’Œæœ‰çŠ¶æ€çš„åº”ç”¨ç¨‹åºã€‚</p><p id="8243" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœä½ æ˜¯Daprçš„æ–°æ‰‹ï¼Œæˆ‘å»ºè®®ä½ ä»<a class="ae kl" href="https://github.com/dapr/docs/blob/master/overview.md" rel="noopener ugc nofollow" target="_blank">æ¦‚è¿°</a>å’Œ<a class="ae kl" href="https://github.com/dapr/docs/tree/master/concepts" rel="noopener ugc nofollow" target="_blank">æ¦‚å¿µ</a>å¼€å§‹ã€‚å°è¯•ä½¿ç”¨<a class="ae kl" href="https://github.com/dapr/docs/tree/master/getting-started" rel="noopener ugc nofollow" target="_blank">å…¥é—¨æŒ‡å—</a>ï¼Œç„¶åç»§ç»­ä½¿ç”¨<a class="ae kl" href="https://github.com/dapr/samples/blob/master/README.md" rel="noopener ugc nofollow" target="_blank">æ ·å“</a>å’Œ<a class="ae kl" href="https://github.com/dapr/docs/tree/master/howto" rel="noopener ugc nofollow" target="_blank">æ“ä½œæŒ‡å—</a>ã€‚éšç€è¿›ä¸€æ­¥æ·±å…¥ï¼Œæ‚¨å¯ä»¥æ·±å…¥äº†è§£<a class="ae kl" href="https://github.com/dapr/docs/tree/master/reference/api" rel="noopener ugc nofollow" target="_blank"> Daprè¿è¡Œæ—¶APIå‚è€ƒ</a>å’Œ<a class="ae kl" href="https://github.com/dapr/components-contrib" rel="noopener ugc nofollow" target="_blank">å•ä¸ªç»„ä»¶</a></p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="658d" class="lf lg iq bd lh li mp lk ll lm mq lo lp lq mr ls lt lu ms lw lx ly mt ma mb mc bi translated">è®¾ç½®</h1><p id="a736" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">å®‰è£…<a class="ae kl" href="https://github.com/dapr/cli" rel="noopener ugc nofollow" target="_blank"> Dapr CLI </a>(éœ€è¦å®‰è£…<code class="fe kt ku kv kw b">Docker</code>)ã€‚éµå¾ªæ–‡æ¡£-<a class="ae kl" href="https://github.com/dapr/docs/blob/master/getting-started/environment-setup.md" rel="noopener ugc nofollow" target="_blank">https://github . com/dapr/docs/blob/master/getting-started/environment-setup . MD</a></p><p id="0ccc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœä½ åœ¨è‹¹æœç”µè„‘ä¸Šï¼Œåªéœ€:</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="b480" class="my lg iq kw b gy mz na l nb nc">curl -fsSL https://raw.githubusercontent.com/dapr/cli/master/install/install.sh | /bin/bash</span></pre><p id="0972" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å°†<code class="fe kt ku kv kw b">Dapr</code>å®‰è£…åˆ°<code class="fe kt ku kv kw b">Kubernetes</code>(ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<code class="fe kt ku kv kw b">minikube</code>)ã€‚å¦‚æœéœ€è¦ï¼Œè¯·å‚è§å®‰è£…minikube çš„æ–‡æ¡£ã€‚</p><p id="e84a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸€æ—¦<code class="fe kt ku kv kw b">minikube</code>è®¾ç½®å¥½ï¼Œç¡®ä¿ä½ å¯åŠ¨å®ƒ</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="e48e" class="my lg iq kw b gy mz na l nb nc">minikube start</span></pre><p id="b00b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨æ‚¨åªéœ€è¦ä¸€ä¸ªå‘½ä»¤å°±å¯ä»¥åœ¨Kuberneresä¸Šå®‰è£…Dapräº†ï¼</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="d9e5" class="my lg iq kw b gy mz na l nb nc">dapr init --kubernetes</span></pre><p id="211c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚¨åº”è¯¥ä¼šçœ‹åˆ°è¿™æ¡æ¶ˆæ¯</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="deaa" class="my lg iq kw b gy mz na l nb nc">Success! Dapr has been installed. To verify, run 'kubectl get pods -w' in your terminal</span></pre><blockquote class="km kn ko"><p id="4bbc" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">å¦‚æœä½ æƒ³ä½¿ç”¨</em> <code class="fe kt ku kv kw b"><em class="iq">Helm</em></code> <em class="iq">å®‰è£…</em> <code class="fe kt ku kv kw b"><em class="iq">Dapr</em></code> <em class="iq">ï¼Œè¯·æŸ¥çœ‹</em><a class="ae kl" href="https://github.com/dapr/docs/blob/master/getting-started/environment-setup.md#using-helm-advanced" rel="noopener ugc nofollow" target="_blank"><em class="iq">https://github . com/dapr/docs/blob/master/getting-started/environment-setup . MD # using-helm-advanced</em></a></p></blockquote><p id="b15a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºäº†ç¡®è®¤ï¼Œå½“DapråŠèˆ±å¤„äº<code class="fe kt ku kv kw b">Running</code>çŠ¶æ€æ—¶ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¹¶ç»§ç»­ã€‚ç›¸å…³çš„podåŒ…æ‹¬Dapræ“ä½œå‘˜ã€Daprè¾¹è½¦æ³¨å°„å™¨å’ŒDaprä½ç½®</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="9d44" class="my lg iq kw b gy mz na l nb nc">kubectl get pods -w</span></pre><p id="a5da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½ å·²ç»å‡†å¤‡å¥½äº†ï¼</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="9262" class="lf lg iq bd lh li mp lk ll lm mq lo lp lq mr ls lt lu ms lw lx ly mt ma mb mc bi translated">å°è¯•ä¸NATSå…¬å…±è®¢é˜…Dapr</h1><p id="4ad1" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">ä»å…‹éš†repoå¼€å§‹ï¼Œå¹¶åˆ‡æ¢åˆ°æ­£ç¡®çš„ç›®å½•</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="04df" class="my lg iq kw b gy mz na l nb nc">git clone https://github.com/abhirockzz/dapr-nats-pubsub<br/>cd dapr-nats-pubsub</span></pre><h2 id="b02f" class="my lg iq bd lh nd ne dn ll nf ng dp lp jy nh ni lt kc nj nk lx kg nl nm mb nn bi translated">éƒ¨ç½²NATSå‘å¸ƒè®¢é˜…ç»„ä»¶</h2><p id="1be5" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">ä¸€ä¸ª<code class="fe kt ku kv kw b">Component</code>æ˜¯ä¸€ä¸ªDapr CRD(è‡ªå®šä¹‰èµ„æºå®šä¹‰)ã€‚è¿™æ˜¯é…ç½®â€”â€”æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨<code class="fe kt ku kv kw b">demo.nats.io:4222</code>ä½¿ç”¨çš„æ˜¯ç”±<code class="fe kt ku kv kw b">natsURL</code>æŒ‡å®šçš„æ¼”ç¤ºNATSæœåŠ¡å™¨</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="fec3" class="my lg iq kw b gy mz na l nb nc">apiVersion: dapr.io/v1alpha1<br/>kind: Component <br/>metadata:<br/>  name: messagebus-nats<br/>spec:<br/>  type: pubsub.nats<br/>  metadata:<br/>  - name: natsURL<br/>    value: nats://demo.nats.io:4222</span></pre><p id="1ca7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¦åˆ›å»º:</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="b662" class="my lg iq kw b gy mz na l nb nc">kubectl apply -f deploy/nats-pubsub.yaml<br/>//component.dapr.io/messagebus-nats created</span></pre><p id="b677" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç¡®è®¤:</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="4976" class="my lg iq kw b gy mz na l nb nc">kubectl get component.dapr.io    </span><span id="f627" class="my lg iq kw b gy no na l nb nc">NAME              AGE<br/>messagebus-nats   12s</span></pre><h1 id="581c" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">éƒ¨ç½²è®¢æˆ·åº”ç”¨ç¨‹åº</h1><p id="b6cd" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">è¿™æ˜¯ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºï¼Œè®¢é˜…äº†ä¸€ä¸ªåä¸º<code class="fe kt ku kv kw b">testsubject</code>çš„ä¸»é¢˜ã€‚</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="4d0f" class="my lg iq kw b gy mz na l nb nc">http.HandleFunc(<strong class="kw ir">"/dapr/subscribe"</strong>, func(w http.ResponseWriter, r *http.Request) {<br/>	response := `["` + natsSubject + `"]`<br/>	fmt.Println("subscribed to NATS subject", natsSubject)<br/>	w.Write([]byte(response))<br/>})</span></pre><p id="cd24" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åº”ç”¨ç¨‹åºæœ¬èº«è¢«å®šä¹‰ä¸ºKubernetes <code class="fe kt ku kv kw b">Deployment</code>èµ„æºã€‚å®ƒä½¿ç”¨æ³¨é‡Šæ¥ç¡®ä¿Daprè¾¹è½¦æ˜¯â€œæ³¨å…¥â€çš„</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="8041" class="my lg iq kw b gy mz na l nb nc">dapr.io/enabled: "true"<br/>dapr.io/id: "natsapp"<br/>dapr.io/port: "8080"<br/>dapr.io/log-level: "debug"</span></pre><p id="6463" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¦åˆ›å»ºåº”ç”¨ç¨‹åº:</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="9732" class="my lg iq kw b gy mz na l nb nc">kubectl apply -f deploy/app.yaml</span></pre><blockquote class="km kn ko"><p id="eb05" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">éƒ¨ç½²ä½¿ç”¨é¢„æ„å»ºçš„Dockeræ˜ åƒ(</em> <code class="fe kt ku kv kw b"><em class="iq">abhirockzz/dapr-nats-pubsub</em></code> <em class="iq">)ï¼Œä½†æ˜¯æ‚¨å¯ä»¥ä½¿ç”¨</em> <code class="fe kt ku kv kw b"><em class="iq">nats-app</em></code> <em class="iq">æ–‡ä»¶å¤¹</em>ä¸­æä¾›çš„ <code class="fe kt ku kv kw b"><em class="iq">Dockerfile</em></code> <em class="iq">æ„å»ºè‡ªå·±çš„æ˜ åƒ</em></p></blockquote><p id="a10f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ£€æŸ¥æ–°çš„<code class="fe kt ku kv kw b">Pod</code>å¹¶ç­‰å¾…å…¶<code class="fe kt ku kv kw b">transition</code>åˆ°<code class="fe kt ku kv kw b">Running</code>çŠ¶æ€</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="380d" class="my lg iq kw b gy mz na l nb nc">kubectl get pods -l=app=natsapp -w</span></pre><p id="6e47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ­¤æ—¶ï¼Œæ‚¨å¯ä»¥æ£€æŸ¥åº”ç”¨ç¨‹åºä»¥åŠDapr sidecarå®¹å™¨çš„æ—¥å¿—</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="7e0d" class="my lg iq kw b gy mz na l nb nc">//for the app<br/>kubectl logs &lt;POD_NAME&gt; -c natsapp</span><span id="a000" class="my lg iq kw b gy no na l nb nc">//logs for the Dapr sidecar<br/>kubectl logs &lt;POD_NAME&gt; -c daprd</span></pre><p id="884f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¯¹äºè¯¥åº”ç”¨ç¨‹åºï¼Œæ‚¨åº”è¯¥åªçœ‹åˆ°ä»¥ä¸‹æ—¥å¿—ï¼Œè¿™äº›æ—¥å¿—è¡¨æ˜è¯¥åº”ç”¨ç¨‹åºå·²ç»è®¢é˜…äº†NATSä¸»é¢˜ï¼Œå¹¶ä¸”æ­£åœ¨ä¾¦å¬è¿›ä¸€æ­¥çš„æ¶ˆæ¯</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="f91e" class="my lg iq kw b gy mz na l nb nc">starting HTTP server....<br/>subscribed to NATS subject testsubject</span></pre><p id="cfc7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¯¹äºDapr sidecarï¼Œæ‚¨åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹â€”è¯·æ³¨æ„ï¼ŒNATS pubsubç»„ä»¶è®¾ç½®æ­£ç¡®ï¼ŒDaprèƒ½å¤Ÿè¿æ¥åˆ°NATSå¹¶è®¢é˜…ç»„ä»¶ä¸­æŒ‡å®šçš„NATSæœåŠ¡å™¨ã€‚</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="590c" class="my lg iq kw b gy mz na l nb nc">time="2019-11-19T10:00:18Z" level=info msg="starting Dapr Runtime -- version 0.2.0 -- commit c75b111"<br/>time="2019-11-19T10:00:18Z" level=info msg="log level set to: debug"<br/>time="2019-11-19T10:00:18Z" level=info msg="kubernetes mode configured"<br/>time="2019-11-19T10:00:18Z" level=info msg="dapr id: natsapp"<br/><strong class="kw ir">time="2019-11-19T10:00:19Z" level=info msg="loaded component messagebus-nats (pubsub.nats)"<br/></strong>time="2019-11-19T10:00:19Z" level=info msg="application protocol: http. waiting on port 8080"<br/>time="2019-11-19T10:00:19Z" level=info msg="application discovered on port 8080"<br/><strong class="kw ir">time="2019-11-19T10:00:20Z" level=debug msg="connected to nats at nats://demo.nats.io:4222"<br/>time="2019-11-19T10:00:20Z" level=debug msg="nats: subscribed to subject testsubject with queue group natsapp"<br/></strong>time="2019-11-19T10:00:20Z" level=warning msg="failed to init actors: actors: state store must be present to initialize the actor runtime"<br/>time="2019-11-19T10:00:20Z" level=info msg="http server is running on port 3500"<br/>time="2019-11-19T10:00:20Z" level=info msg="gRPC server is running on port 50001"<br/>time="2019-11-19T10:00:20Z" level=info msg="dapr initialized. Status: Running. Init Elapsed 1211.203177ms"</span></pre><p id="b1a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¼€å§‹è·Ÿè¸ªåº”ç”¨ç¨‹åºæ—¥å¿—ï¼Œå› ä¸ºæ‚¨å°†éœ€è¦æ£€æŸ¥ç«¯åˆ°ç«¯çš„åŠŸèƒ½</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="6cd8" class="my lg iq kw b gy mz na l nb nc">kubectl logs -f &lt;POD_NAME&gt; -c natsapp</span></pre><h2 id="4c86" class="my lg iq bd lh nd ne dn ll nf ng dp lp jy nh ni lt kc nj nk lx kg nl nm mb nn bi translated">éƒ¨ç½²å®¢æˆ·ç«¯åº”ç”¨ç¨‹åº</h2><p id="f907" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºæ˜¯ä¸€ä¸ªReactå‰ç«¯åº”ç”¨ç¨‹åºï¼Œå®ƒæ˜¯ä»<a class="ae kl" href="https://github.com/dapr/samples" rel="noopener ugc nofollow" target="_blank"> Dapr samples repo </a>ä¸­æŒ‘é€‰å‡ºæ¥çš„ï¼Œå¹¶ä¸”ä¸ºäº†è¿™ä¸ªåœºæ™¯çš„ç›®çš„å·²ç»åšäº†éå¸¸å°çš„ä¿®æ”¹</p><p id="7595" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åˆ‡æ¢åˆ°æ–°çš„ç»ˆç«¯éƒ¨ç½²å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºã€‚è¿™ä¹Ÿæ˜¯ä¸€ä¸ªKubernetes <code class="fe kt ku kv kw b">Deployment</code>ã€‚å®ƒè¿˜åŒ…æ‹¬ä¸€ä¸ª<code class="fe kt ku kv kw b">LoadBalancer</code>,è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è®¿é—®è¿™ä¸ªåº”ç”¨ç¨‹åº</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="1b7d" class="my lg iq kw b gy mz na l nb nc">kubectl apply -f deploy/react-app.yaml</span></pre><p id="835e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç­‰å¾…åº”ç”¨ç¨‹åºè¢«éƒ¨ç½²</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="1c20" class="my lg iq kw b gy mz na l nb nc">kubectl get pods -l=app=react-form -w</span></pre><p id="b824" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸€æ—¦éƒ¨ç½²å®Œæ¯•ï¼Œæ‚¨å°±å¯ä»¥æ£€æŸ¥ç«¯åˆ°ç«¯çš„äº‹ä»¶æµäº†ã€‚</p><h2 id="ec44" class="my lg iq bd lh nd ne dn ll nf ng dp lp jy nh ni lt kc nj nk lx kg nl nm mb nn bi translated">ä½¿ç”¨å‰ç«¯åº”ç”¨ç¨‹åºåˆ¶ä½œ/å‘å¸ƒæ¶ˆæ¯</h2><p id="8a0c" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯<code class="fe kt ku kv kw b">minikube</code>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€Reactåº”ç”¨ç¨‹åº:</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="664c" class="my lg iq kw b gy mz na l nb nc">minikube service react-form</span></pre><p id="a530" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä»¥ä¸‹å±å¹•:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi np"><img src="../Images/c09d4377c19b08c74479ddcb231a7914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WWAzt2bUyognOzEs.png"/></div></div></figure><p id="c566" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kt ku kv kw b">testsubject</code>æ˜¯æˆ‘ä»¬è¦å‘å…¶å‘é€æ¶ˆæ¯çš„NATSä¸»é¢˜(å¿½ç•¥ä¸‹æ‹‰åˆ—è¡¨ä¸­çš„å…¶ä»–ä¸»é¢˜)ã€‚åªéœ€è¾“å…¥ä¿¡æ¯å¹¶æŒ‰ä¸‹<code class="fe kt ku kv kw b">Submit</code>æŒ‰é’®ã€‚è¿™å°†ä½¿ç”¨NATSå‘å¸ƒè®¢é˜…ç»„ä»¶çš„å‘å¸ƒè€…éƒ¨åˆ†ï¼Œå¹¶å‘ä½äº<code class="fe kt ku kv kw b">demo.nats.io:4222</code>çš„NATSæœåŠ¡å™¨å‘é€ä¸€æ¡æ¶ˆæ¯</p><p id="b8ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ£€æŸ¥è·Ÿè¸ªè®¢æˆ·åº”ç”¨ç¨‹åºæ—¥å¿—çš„å¦ä¸€ä¸ªç»ˆç«¯â€”â€”æ‚¨åº”è¯¥çœ‹åˆ°æ—¥å¿—ä»¥åŠæ‚¨å‘é€çš„æ¶ˆæ¯ï¼Œä¾‹å¦‚</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="7462" class="my lg iq kw b gy mz na l nb nc">Recieved Message from NATS - {"id":"48825607-1f10-4789-8d99-84b927c1900e","source":"react-form","type":"com.dapr.event.sent","specversion":"0.3","datacontenttype":"application/json","data":{"messageType":"testsubject","message":"looking dapr"}}</span></pre><p id="ba29" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ¶ˆæ¯å°è£…åœ¨<code class="fe kt ku kv kw b">Cloud Events</code>æœ‰æ•ˆè½½è·ä¸­ã€‚ä½ å¯ä»¥å¤šå‘å‡ æ¡ä¿¡æ¯ï¼Œå¤æŸ¥ä¸€ä¸‹ç»“æœã€‚</p><h2 id="5e2f" class="my lg iq bd lh nd ne dn ll nf ng dp lp jy nh ni lt kc nj nk lx kg nl nm mb nn bi translated">æ°´å¹³ç¼©æ”¾â€¦</h2><p id="00ad" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªè®¢æˆ·åº”ç”¨ç¨‹åºå®ä¾‹ã€‚Daprä¸­çš„NATS pubsubç»„ä»¶ä½œä¸ºé˜Ÿåˆ—è®¢é˜…è€…å·¥ä½œï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥ç”Ÿæˆæ›´å¤šçš„å®ä¾‹ï¼Œæ¥è‡ªNATSæœåŠ¡å™¨çš„äº‹ä»¶å°†åœ¨å®ƒä»¬ä¹‹é—´åˆ†å‘ã€‚è¿™å¯¼è‡´äº†å¯æ°´å¹³æ‰©å±•çš„ç³»ç»Ÿ</p><p id="8cc6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¦æ‰©å¤§æˆ‘ä»¬çš„éƒ¨ç½²:</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="5093" class="my lg iq kw b gy mz na l nb nc">kubectl scale deployment/natsapp --replicas=2</span></pre><p id="b63b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç­‰å¾…æ–°åº”ç”¨ç¨‹åº<code class="fe kt ku kv kw b">Pod</code>å¯åŠ¨</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="61ad" class="my lg iq kw b gy mz na l nb nc">kubectl get pods -l=app=natsapp -w</span></pre><p id="7db1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸€æ—¦å‡†å¤‡å¥½äº†ï¼Œå°±å¼€å§‹è·Ÿè¸ªæ—¥å¿—ï¼Œå°±åƒç¬¬ä¸€ä¸ªå®ä¾‹ä¸€æ ·</p><pre class="ky kz la lb gt mu kw mv mw aw mx bi"><span id="8bcb" class="my lg iq kw b gy mz na l nb nc">kubectl logs -f &lt;NAME_OF_NEW_POD&gt; -c natsapp</span></pre><p id="5729" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½¿ç”¨å‰ç«¯åº”ç”¨ç¨‹åºå‘é€æ¶ˆæ¯ï¼Œå¹¶ç¡®è®¤å®ƒä»¬å°†åœ¨ä¸¤ä¸ªå®ä¾‹ä¹‹é—´åˆ†å‘ã€‚æ‚¨å¯ä»¥è¿›ä¸€æ­¥æ‰©å±•åº”ç”¨ç¨‹åºï¼Œå¹¶ç¡®è®¤è¡Œä¸ºä¿æŒä¸å˜ã€‚</p><h2 id="b8da" class="my lg iq bd lh nd ne dn ll nf ng dp lp jy nh ni lt kc nj nk lx kg nl nm mb nn bi translated">æ¢ä¸ªåº”ç”¨æ€ä¹ˆæ ·ï¼Ÿ</h2><p id="c9bc" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªå®Œå…¨ä¸åŒçš„åº”ç”¨ç¨‹åºï¼Œå®ƒä¹Ÿæƒ³å¤„ç†æ¥è‡ªç›¸åŒä¸»é¢˜çš„æ¶ˆæ¯ï¼Œä½†å¤„ç†å®ƒä»¬çš„æ–¹å¼ä¸ç°æœ‰çš„åº”ç”¨ç¨‹åºä¸åŒã€‚å¥½å§ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„Dapré©±åŠ¨çš„åº”ç”¨ç¨‹åºï¼Œæ–¹æ³•å’Œç°æœ‰çš„ä¸€æ ·ï¼ŒåŒ…æ‹¬ä½ çš„å¤„ç†é€»è¾‘ï¼Œå¹¶æŠŠå®ƒéƒ¨ç½²åˆ°Kubernetesã€‚å®ƒä¹Ÿå°†æ”¶åˆ°ä¸æ—©æœŸåº”ç”¨ç¨‹åºç›¸åŒçš„ä¸€ç»„æ¶ˆæ¯ã€‚</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="5909" class="lf lg iq bd lh li mp lk ll lm mq lo lp lq mr ls lt lu ms lw lx ly mt ma mb mc bi translated">æ‘˜è¦</h1><p id="3330" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">åœ¨è¿™ç¯‡åšæ–‡ä¸­ï¼Œä½ çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨NATSä½œä¸ºä¸€ä¸ªå…¬å…±è®¢é˜…å±‚åœ¨ä½ çš„Dapråº”ç”¨ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚æ‚¨çš„åº”ç”¨ç¨‹åºç”šè‡³ä¸çŸ¥é“NATSâ€”â€”å®ƒæ‰€åšçš„åªæ˜¯ä½¿ç”¨Dapr HTTP APIä¸Daprè¿è¡Œæ—¶(åªæ˜¯ä¸€ä¸ªsidecar)è¿›è¡Œäº¤äº’ï¼</p><blockquote class="km kn ko"><p id="8451" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">ä½¿ç”¨gRPCæˆ–ç‰¹å®šè¯­è¨€çš„SDKä¹Ÿæ˜¯å¯è¡Œçš„</em></p></blockquote><p id="640d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œ<code class="fe kt ku kv kw b">Dapr</code>å¤„äºalphaçŠ¶æ€(<code class="fe kt ku kv kw b">v0.2.0</code>)ï¼Œå¹¶ä¹äºæ¥å—ç¤¾åŒºè´¡çŒ®ğŸ˜ƒæ¸¸è§ˆhttps://github.com/dapr/dapr<a class="ae kl" href="https://github.com/dapr/dapr" rel="noopener ugc nofollow" target="_blank"/>å°½æƒ…äº«å—å§ï¼</p><p id="7986" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©ï¼Œè¯·å–œæ¬¢å¹¶å…³æ³¨ğŸ™Œå¾ˆé«˜å…´é€šè¿‡<a class="ae kl" href="https://twitter.com/abhi_tweeter" rel="noopener ugc nofollow" target="_blank"> Twitter </a>è·å¾—åé¦ˆæˆ–å‘è¡¨è¯„è®ºã€‚</p></div></div>    
</body>
</html>