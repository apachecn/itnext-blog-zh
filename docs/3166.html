<html>
<head>
<title>Multiple HTTP Requests in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angularä¸­çš„å¤šä¸ªHTTPè¯·æ±‚</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/multiple-http-requests-in-angular-43df566016eb?source=collection_archive---------4-----------------------#2019-10-15">https://itnext.io/multiple-http-requests-in-angular-43df566016eb?source=collection_archive---------4-----------------------#2019-10-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/21498b6a74bdc62910f3bc654f7c3a46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZzMHBAMq5C-5PY0m.png"/></div></div></figure><p id="5f8b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">RxJSæœ‰æ—¶ä¼šä»¤äººå›°æƒ‘ï¼Œä¸€å¼€å§‹å¯èƒ½ä¸æ¸…æ¥šå¦‚ä½•åšæŸäº›äº‹æƒ…ã€‚å…¶ä¸­ä¹‹ä¸€å¯èƒ½æ˜¯å¦‚ä½•ä»¥æ­£ç¡®çš„æ–¹å¼å¤„ç†å¤šä¸ªHTTPè¯·æ±‚â€”â€”ä½†å¾ˆé«˜å…´è¿™å¹¶ä¸å¤ªå¤æ‚ã€‚</p><p id="7d74" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ‰§è¡Œå¤šä¸ªè¯·æ±‚å¯èƒ½æœ‰ä¸¤ç§ä¸åŒçš„æƒ…å†µï¼›ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°(é¡ºåºåœ°)æˆ–åŒæ—¶åœ°(å¹¶è¡Œåœ°)ã€‚</p><h1 id="5d27" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">è¦æ±‚</h1><p id="83cf" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">è¿™ç§æ–¹æ³•ä¾èµ–äºAngulars`<a class="ae lz" href="https://angular.io/guide/http" rel="noopener ugc nofollow" target="_blank">http client</a>`â€”â€”å› æ­¤<code class="fe ma mb mc md b">this.http</code>å°†æ€»æ˜¯å¼•ç”¨<code class="fe ma mb mc md b">HttpClient</code>ã€‚</p><p id="5667" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ­¤å¤–ï¼Œä¸ºäº†æ›´å®¹æ˜“ç†è§£ï¼Œæœ¬æŒ‡å—å°†ä½¿ç”¨ä¸€ä¸ªç®€å•çš„PHPè„šæœ¬ä½œä¸ºAPI:</p><pre class="me mf mg mh gt mi md mj mk aw ml bi"><span id="ba61" class="mm kx iq md b gy mn mo l mp mq">&lt;?php<br/>header("Access-Control-Allow-Origin: *");<br/>header("Content-Type: application/json");</span><span id="dea9" class="mm kx iq md b gy mr mo l mp mq">$timeout = isset($_GET['timeout']) ? $_GET['timeout'] : 0;</span><span id="9ba3" class="mm kx iq md b gy mr mo l mp mq">sleep($timeout);</span><span id="66d4" class="mm kx iq md b gy mr mo l mp mq">echo json_encode([<br/>    'timeout' =&gt; $timeout<br/>]);</span></pre><p id="d15a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è¿™ä¸ªè„šæœ¬å…è®¸ç”¨ä¸€ä¸ª<code class="fe ma mb mc md b">timeout</code>å‚æ•°è°ƒç”¨å®ƒï¼Œå°†ç­‰å¾…ç»™å®šçš„æ—¶é—´æ¥å“åº”ï¼Œå¹¶ç”¨å®ƒå·²ç»ç­‰å¾…çš„æ—¶é—´æ¥å“åº”ã€‚</p><h1 id="c774" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">ç»§ç»­åœ°</h1><p id="0cad" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">ä»å±æŸ¥è¯¢æ˜¯é¡ºåºæ‰§è¡ŒHTTPè¯·æ±‚çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼›ä¾‹å¦‚ï¼Œæ‚¨æƒ³è¦æŸ¥è¯¢åœ¨ä¸åŒç«¯ç‚¹æŸ¥è¯¢çš„è¯¥ç”¨æˆ·çš„ä¸€äº›ç”¨æˆ·è¯¦ç»†ä¿¡æ¯<em class="ms">å’Œ</em>é¡¹ç›®ã€‚</p><p id="3248" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸ºäº†å®Œæˆè¿™é¡¹å·¥ä½œï¼Œæˆ‘ä»¬å°†åˆ©ç”¨ç®¡é“ä¸­çš„å‡½æ•°ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­:</p><pre class="me mf mg mh gt mi md mj mk aw ml bi"><span id="a039" class="mm kx iq md b gy mn mo l mp mq">import {concatMap, tap} from 'rxjs/operators';</span><span id="d85e" class="mm kx iq md b gy mr mo l mp mq">this.http.get('<a class="ae lz" href="http://test.localhost/api.php?timeout=1'" rel="noopener ugc nofollow" target="_blank">http://test.localhost/api.php?timeout=1'</a>)<br/>      .pipe(<br/>        tap(res =&gt; console.log('First result', res)),<br/>        concatMap((res: { timeout: number }) =&gt; this.http.get(`<a class="ae lz" href="http://test.localhost/api.php?timeout=${+res.timeout" rel="noopener ugc nofollow" target="_blank">http://test.localhost/api.php?timeout=${+res.timeout</a> + 1}`)),<br/>        tap(res =&gt; console.log('Second result', res)),<br/>        concatMap((res: { timeout: number }) =&gt; this.http.get(`<a class="ae lz" href="http://test.localhost/api.php?timeout=${+res.timeout" rel="noopener ugc nofollow" target="_blank">http://test.localhost/api.php?timeout=${+res.timeout</a> + 3}`)),<br/>        tap(res =&gt; console.log('Third result', res)),<br/>      )<br/>      .subscribe(res =&gt; console.log('Latest result', res));</span></pre><p id="6388" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ§åˆ¶å°è¾“å‡º:</p><pre class="me mf mg mh gt mi md mj mk aw ml bi"><span id="59f5" class="mm kx iq md b gy mn mo l mp mq">First result {timeout: "1"}<br/>Second result {timeout: "2"}<br/>Third result {timeout: "5"}<br/>Latest result {timeout: "5"}</span></pre><p id="38c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">1ç§’åè®°å½•ç¬¬ä¸€ä¸ªè¾“å‡ºï¼Œ2ç§’åè®°å½•ç¬¬äºŒä¸ªï¼Œ5ç§’åè®°å½•ç¬¬ä¸‰ä¸ª(ä¹Ÿæ˜¯æœ€æ–°çš„ä¸€ä¸ª)ã€‚æ­£å¦‚æ‚¨åœ¨ç®¡é“ä¸­çœ‹åˆ°çš„ï¼Œç¬¬ä¸€ä¸ªè¯·æ±‚ä¹‹åçš„æ¯ä¸ªè¯·æ±‚éƒ½ä¾èµ–äºå‰ä¸€ä¸ªè¯·æ±‚çš„å“åº”ã€‚</p><h1 id="ccc8" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">å¹³è¡Œçš„</h1><p id="62f6" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">è¯·æ±‚å¯èƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œæ‚¨éœ€è¦åœ¨åº”ç”¨ç¨‹åºç»§ç»­è¿è¡Œä¹‹å‰æ‰§è¡Œæ‰€æœ‰è¯·æ±‚ã€‚æƒ³è±¡ä¸€ä¸‹æŸ¥è¯¢ä½ çš„åº”ç”¨ç¨‹åºè®¾ç½®(ä¾‹å¦‚ï¼Œé»˜è®¤ä¸»é¢˜ã€è¯­è¨€ç­‰ç­‰)ã€å½“å‰ç”¨æˆ·å’Œå½“å‰è§†å›¾æ•°æ®(ä¾‹å¦‚ï¼Œä½ æ­£åœ¨æŸ¥çœ‹çš„å½“å‰å¸–å­)â€”â€”è¿™äº›äº‹æƒ…éƒ½ä¸ç›¸äº’ä¾èµ–ï¼Œä½†æ˜¯ä½ éœ€è¦æ‰€æœ‰è¿™äº›æ‰èƒ½è®©ä½ çš„åº”ç”¨ç¨‹åºæ˜¾ç¤ºå‡ºæ¥ã€‚</p><p id="2842" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸€æ¬¡ä¸€ä¸ªåœ°æŸ¥è¯¢è¿™äº›å†…å®¹æ˜¯æµªè´¹èµ„æºâ€”â€”æˆ‘ä»¬å¯ä»¥åªæŸ¥è¯¢æ‰€æœ‰çš„å†…å®¹ï¼Œç„¶åå¤„ç†ç»„åˆçš„ç»“æœã€‚</p><p id="bee7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸ºäº†ä½¿æˆ‘ä»¬çš„è¯·æ±‚å¹¶è¡Œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<code class="fe ma mb mc md b">forkJoin</code>ã€‚<code class="fe ma mb mc md b">forkJoin</code>ä¸­çš„è¯·æ±‚æ˜¯å¹¶è¡Œè¯·æ±‚çš„ï¼Œå½“æ‰€æœ‰è¯·æ±‚å®Œæˆæ—¶ï¼Œå¯è§‚å¯Ÿå¯¹è±¡è‡ªèº«å‘å‡º:</p><pre class="me mf mg mh gt mi md mj mk aw ml bi"><span id="f7aa" class="mm kx iq md b gy mn mo l mp mq">import {forkJoin} from "rxjs";<br/>import {tap} from "rxjs/operators";</span><span id="8d46" class="mm kx iq md b gy mr mo l mp mq">forkJoin([<br/>  this.http.get('api.php?timeout=1').pipe(tap(res =&gt; console.log(res)),<br/>  this.http.get('api.php?timeout=5').pipe(tap(res =&gt; console.log(res)),<br/>  this.http.get('api.php?timeout=3').pipe(tap(res =&gt; console.log(res)),<br/>]).subscribe(allResults =&gt; console.log(allResults));</span></pre><p id="06f0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æŸ¥çœ‹æ§åˆ¶å°ä¼šæ˜¾ç¤ºä»¥ä¸‹ç»“æœ:</p><pre class="me mf mg mh gt mi md mj mk aw ml bi"><span id="30c3" class="mm kx iq md b gy mn mo l mp mq">{timeout: "1"}<br/>{timeout: "3"}<br/>{timeout: "5"}<br/>(3) [{â€¦}, {â€¦}, {â€¦}]<br/>  0: {timeout: "1"}<br/>  1: {timeout: "5"}<br/>  2: {timeout: "3"}</span></pre><p id="876a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å‰ä¸‰è¡Œæ¥è‡ªæˆ‘ä»¬çš„<code class="fe ma mb mc md b">tap</code>ä¸­çš„<code class="fe ma mb mc md b">console.log</code>ã€‚æ‚¨å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œå³ä½¿3ç§’è¶…æ—¶è¯·æ±‚åˆ—åœ¨5ç§’è¯·æ±‚çš„ä¹‹åçš„<em class="ms">ï¼Œ3ç§’è¶…æ—¶è®°å½•åœ¨5ç§’è¶…æ—¶è¯·æ±‚çš„</em>ä¹‹å‰çš„<em class="ms">â€”â€”å› ä¸ºæˆ‘ä»¬çš„è¯·æ±‚æ˜¯å•ç‹¬å¹¶è¡Œæ‰§è¡Œçš„ã€‚</em></p><p id="4b28" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">åœ¨æˆ‘ä»¬æ‰€æœ‰çš„è§‚å¯Ÿå¯¹è±¡éƒ½å‘å‡ºä¸€ä¸ªå€¼ä¹‹å(æˆ–è€…ï¼Œæ¢å¥è¯è¯´ï¼Œåœ¨5ç§’é’Ÿçš„è¯·æ±‚ç»“æŸä¹‹å)ï¼Œ<code class="fe ma mb mc md b">forkJoin</code>å°†å‘å‡ºä¸€ä¸ªå€¼ï¼Œæœ€ç»ˆå¯¼è‡´æˆ‘ä»¬çš„<code class="fe ma mb mc md b">subscribe</code>è¢«è°ƒç”¨ã€‚</p><p id="d1da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">åœ¨ä¸Šé¢æåˆ°çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™æ ·åšæ¥åˆ©ç”¨è¿™ä¸€ç‚¹:</p><pre class="me mf mg mh gt mi md mj mk aw ml bi"><span id="edfc" class="mm kx iq md b gy mn mo l mp mq">const postId = this.route.snapshot.paramMap.get("postId");</span><span id="3923" class="mm kx iq md b gy mr mo l mp mq">forkJoin([<br/>  this.http.get(`/api/settings`).pipe(tap(settings =&gt; this.store.dispatch(new LoadSettings(settings)))),<br/>      this.http.get(`/api/user`).pipe(tap(user =&gt; this.store.dispatch(new SetCurrentUser(user)))),<br/>      this.http.get(`/api/post/${postId}`).pipe(tap(post =&gt; this.store.dispatch(new SetCurrentPost(post))))<br/>]).subscribe(() =&gt; this.showApplication = true);</span></pre><p id="06ce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">åœ¨åº”ç”¨ç¨‹åºè®¾ç½®ä¹‹åï¼Œå½“å‰ç”¨æˆ·å’Œæ–‡ç« è¢«åŠ è½½ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥è¢«æ˜¾ç¤ºã€‚</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="8298" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="ms">å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·ç•™ä¸‹ä½ çš„ğŸ‘ï¼Œå…³æ³¨æˆ‘ä¸Š</em> <a class="ae lz" href="https://twitter.com/nehalist" rel="noopener ugc nofollow" target="_blank"> <em class="ms">æ¨ç‰¹</em> </a> <em class="ms">å¹¶è®¢é˜…</em> <a class="ae lz" href="https://nehalist.io/newsletter/" rel="noopener ugc nofollow" target="_blank"> <em class="ms">æˆ‘çš„å¿«è®¯</em> </a> <em class="ms">ã€‚æœ¬å¸–åŸè½½äº</em><a class="ae lz" href="https://nehalist.io/multiple-http-requests-in-angular" rel="noopener ugc nofollow" target="_blank"><em class="ms">nehalist . io</em></a><em class="ms">ã€‚</em></p></div></div>    
</body>
</html>