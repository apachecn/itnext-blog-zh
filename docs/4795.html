<html>
<head>
<title>How to experiment locally on Kubernetes with minikube and your local Dockerfiles</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä½¿ç”¨minikubeå’Œæ‚¨çš„æœ¬åœ°dockeræ–‡ä»¶åœ¨Kubernetesä¸Šè¿›è¡Œæœ¬åœ°å®éªŒ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/how-to-experiment-locally-on-kubernetes-with-minikube-and-your-local-dockerfiles-48833fcd90c9?source=collection_archive---------2-----------------------#2020-09-21">https://itnext.io/how-to-experiment-locally-on-kubernetes-with-minikube-and-your-local-dockerfiles-48833fcd90c9?source=collection_archive---------2-----------------------#2020-09-21</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><figure class="gm go jp jq jr js gi gj paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="gi gj jo"><img src="../Images/0e28ec56f0743444de32593c7c2881a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NwwtQgLqrtBAX8Xj"/></div></div><figcaption class="jz ka gk gi gj kb kc bd b be z dk translated">å°¼å…°å¡”Â·ä¼Šå…°åŠ ç©†ç“¦åœ¨<a class="ae kd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><h1 id="febc" class="ke kf ir bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">ä»‹ç»</h1><p id="4832" class="pw-post-body-paragraph lc ld ir le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated">åœ¨è¿™ç¯‡å…¥é—¨çº§æ–‡ç« ä¸­ï¼Œæˆ‘ä»‹ç»äº†ä¸€ç§åœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨Minikube(æœ¬è´¨ä¸Šæ˜¯è®¡ç®—æœºä¸Šçš„Kubernetes)æ„å»ºã€å…¬å¼€å’Œæµ‹è¯•dockerizedåº”ç”¨ç¨‹åºçš„ç®€å•æ–¹æ³•ã€‚æœ‰æ—¶ï¼Œå¼€å‘äººå‘˜å¾ˆéš¾å¤„ç†å®éªŒå›¾åƒï¼Œå› ä¸ºå¯¹äºæ¯ä¸ªå›¾åƒæ›´æ”¹ï¼Œä»–ä»¬éƒ½å°†å…¶æ¨é€åˆ°æ³¨å†Œè¡¨ï¼Œç„¶ååœ¨æµ‹è¯•K8sé›†ç¾¤ä¸Šæ‹‰å‡ºã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬å°†åªä½¿ç”¨æœ¬åœ°ç¯å¢ƒâ€”å³ä½¿æ‚¨æ²¡æœ‰ç½‘ç»œè¿æ¥ï¼Œè¿™ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚</p><p id="9ab9" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">æˆ‘ä»¬å°†æ”¶é›†å¿…è¦çš„å·¥å…·ï¼Œå®‰è£…Minikubeå¹¶æ„å»ºå’Œæµ‹è¯•æˆ‘ä»¬è‡ªå·±çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºã€‚</p><h1 id="75af" class="ke kf ir bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">TLï¼›ç¾éš¾æ¢å¤ç‰ˆæœ¬</h1><p id="8de1" class="pw-post-body-paragraph lc ld ir le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated">1.æ‚¨å¯ä»¥åœ¨è‡ªå·±çš„ç¬”è®°æœ¬ç”µè„‘ä¸Šä½¿ç”¨Minikubeè½»æ¾è¿è¡Œç®€å•çš„Kubernetesç¯å¢ƒï¼Œè€Œæ— éœ€åˆ›å»ºè™šæ‹Ÿæœºã€‚ç”¨`<em class="mf"> dockeré©±åŠ¨</em>å°±è¡Œäº†ã€‚</p><p id="9be2" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">2.ä½ å¯ä»¥æ’å…¥Minikubeçš„Docker deamonï¼Œä½ åªéœ€è¦è¿è¡Œ' minikube docker-env 'å¹¶æŒ‰ç…§è¯´æ˜æ“ä½œã€‚</p><p id="ee54" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">3.æ‚¨å¯ä»¥ä½¿ç”¨æ­¤è¿æ¥æ¥æ„å»ºDockeræ˜ åƒï¼Œä»¥ä¾¿Minikube K8s clusterè‡ªåŠ¨çœ‹åˆ°å®ƒã€‚</p><p id="0d96" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">4.ç„¶åï¼Œæ‚¨å¯ä»¥åŸºäºæ„å»ºçš„æ˜ åƒåˆ›å»ºKuberneteséƒ¨ç½²ï¼Œå¹¶å°†å…¶ä½œä¸ºæœåŠ¡å…¬å¼€ï¼Œè€Œä¸å¿…å°†å…¶æ¨é€åˆ°æŸä¸ªå¤–éƒ¨æ³¨å†Œä¸­å¿ƒã€‚</p></div><div class="ab cl mg mh hv mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ik il im in io"><h1 id="14d9" class="ke kf ir bd kg kh mn kj kk kl mo kn ko kp mp kr ks kt mq kv kw kx mr kz la lb bi translated">æ”¶é›†å·¥å…·é›†</h1><p id="0b00" class="pw-post-body-paragraph lc ld ir le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated"><strong class="le is">è·å–Docker </strong></p><p id="0830" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">æ—¢ç„¶æ‚¨æ­£åœ¨é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘å‡è®¾æ‚¨çš„æœºå™¨ä¸Šå·²ç»å®‰è£…äº†Dockerã€‚å¦‚æœæ²¡æœ‰ï¼Œæœ€å¥½çš„åœ°æ–¹æ˜¯Dockeræ–‡æ¡£é¡µé¢ï¼Œå®ƒçš„å­é¡µé¢è‡´åŠ›äºæµè¡Œçš„å‘è¡Œç‰ˆï¼Œæ¯”å¦‚Ubuntu Linux ã€‚</p><p id="ff5a" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated"><strong class="le is">è·å–Kubectl </strong></p><p id="008e" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">ä¸ºäº†æ£€æŸ¥æ˜¯å¦å®‰è£…äº†â€œkubectlâ€å·¥å…·ï¼Œåªéœ€è¿è¡Œ:</p><pre class="ms mt mu mv gu mw mx my mz aw na bi"><span id="8519" class="nb kf ir mx b gz nc nd l ne nf">$ kubectl version --client</span></pre><p id="f4c4" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">ç»“æœåº”è¯¥çœ‹èµ·æ¥æœ‰ç‚¹åƒè¿™æ ·:</p><pre class="ms mt mu mv gu mw mx my mz aw na bi"><span id="104d" class="nb kf ir mx b gz nc nd l ne nf">Client Version: version.Info{Major:â€1", Minor:â€19", GitVersion:â€v1.19.2", GitCommit:â€f5743093fd1c663cb0cbc89748f730662345d44dâ€, GitTreeState:â€cleanâ€, BuildDate:â€2020â€“09â€“16T13:41:02Zâ€, GoVersion:â€go1.15", Compiler:â€gcâ€, Platform:â€linux/amd64"}</span></pre><p id="410f" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">å¦‚æœæ‚¨çš„ç³»ç»Ÿä¸Šæ²¡æœ‰`<em class="mf"> kubectl </em>å·¥å…·ï¼Œé‚£ä¹ˆè·å–æœ€æ–°`<em class="mf"> kubectl </em>å·¥å…·çš„æµè¡Œæ–¹æ³•æ˜¯ç›´æ¥ä»<em class="mf"> kubernetes.io </em>ç«™ç‚¹è·å–ã€‚æˆ‘å»ºè®®ä½ è¿™æ ·æ”¾å…¥ä½ çš„`<em class="mf"> /usr/local/bin/ </em>`æ–‡ä»¶å¤¹:</p><pre class="ms mt mu mv gu mw mx my mz aw na bi"><span id="8d9e" class="nb kf ir mx b gz nc nd l ne nf">$ curl -Lo kubectl â€œhttps://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/linux/amd64/kubectl" &amp;&amp; chmod +x kubectl</span><span id="48d1" class="nb kf ir mx b gz ng nd l ne nf">$ sudo mv kubectl /usr/local/bin/</span></pre><p id="c18e" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">å½“ç„¶ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯Windowsæˆ–MacOSï¼Œä½ éœ€è¦æ”¹å˜è¿™ä¸ªæ–¹æ³•ã€‚æ‚¨å¯ä»¥è®¿é—®<a class="ae kd" href="https://kubernetes.io/docs/tasks/tools/install-kubectl/" rel="noopener ugc nofollow" target="_blank"> Kubernetesæ–‡æ¡£</a>è·å–è¯´æ˜ã€‚</p><p id="f54f" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated"><strong class="le is">è·å–Minikube </strong></p><p id="87e8" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">ç”±äºâ€œ<em class="mf"> minikube </em>â€æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åº”ç”¨ç¨‹åºï¼Œä¸â€œ<em class="mf"> kubectl </em>â€çš„æ–¹å¼éå¸¸ç›¸ä¼¼ï¼Œå› æ­¤å®‰è£…ä¹Ÿéå¸¸ç›¸ä¼¼:</p><pre class="ms mt mu mv gu mw mx my mz aw na bi"><span id="b6eb" class="nb kf ir mx b gz nc nd l ne nf">$ curl -Lo minikube <a class="ae kd" href="https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64" rel="noopener ugc nofollow" target="_blank">https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64</a> &amp;&amp; chmod +x minikube</span><span id="05d2" class="nb kf ir mx b gz ng nd l ne nf">$ sudo mv minikube /usr/local/bin</span></pre><p id="01d5" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">è¯·è®°ä½ï¼Œç§»åŠ¨åˆ°â€œ<em class="mf"> /usr/local/bin </em>â€åªæ˜¯ä¸€ä¸ªå»ºè®®â€”â€”è¿™æ˜¯æˆ‘ä¹ æƒ¯éµå¾ªçš„æ–¹å¼ï¼Œä»¥ä¾¿åœ¨æˆ‘çš„é“è·¯ä¸Šæ‹¥æœ‰æ‰€æœ‰æœ‰ç”¨çš„å·¥å…·ï¼›ä½ å¯ä»¥éšæ„æ”¹å˜å®ƒã€‚åªè¦ç¡®ä¿`<em class="mf"> minikube </em>`å‘½ä»¤æ­£å¸¸å·¥ä½œå³å¯:</p><pre class="ms mt mu mv gu mw mx my mz aw na bi"><span id="009d" class="nb kf ir mx b gz nc nd l ne nf">$ minikube version</span><span id="3651" class="nb kf ir mx b gz ng nd l ne nf">minikube version: v1.13.0<br/>commit: 0c5e9de4ca6f9c55147ae7f90af97eff5befef5f-dirty</span></pre><h1 id="8d90" class="ke kf ir bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated"><strong class="ak">è½»æ¾è·‘è¿·ä½ åº“</strong></h1><p id="6287" class="pw-post-body-paragraph lc ld ir le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated">Minikubeæ”¯æŒè®¸å¤šå…³äºè¿è¡ŒKubernetesç»„ä»¶çš„ç¯å¢ƒçš„é€‰é¡¹ï¼Œæ¯”å¦‚KVMæˆ–VirtualBoxã€‚ç„¶è€Œï¼Œè¿™äº›éƒ½ä¸æ˜¯å¿…éœ€çš„ï¼Œå®‰è£…åä¼šä½¿æ‚¨çš„å¼€å‘ç¯å¢ƒå˜å¾—æ··ä¹±ã€‚</p><p id="8f77" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">Minikubeè¿˜æä¾›â€œnoneâ€å’Œâ€œpodmanâ€é©±åŠ¨ç¨‹åºï¼Œä½†è¿™äº›é©±åŠ¨ç¨‹åºéœ€è¦ç‰¹æƒè®¿é—®ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½ä¼šè¦†ç›–ä¸€äº›æ•æ„Ÿçš„ç³»ç»Ÿé…ç½®ã€‚</p><p id="34ec" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">æˆ‘å»ºè®®ä½ ç®€å•åœ°ä½¿ç”¨â€œdockerâ€é©±åŠ¨ç¨‹åºï¼Œå› ä¸ºå®ƒä¸éœ€è¦rootæƒé™ï¼Œå¯¹ä½ è¿è¡ŒMinikubeçš„ç³»ç»Ÿé…ç½®æ²¡æœ‰å¨èƒã€‚</p><p id="2852" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">Minikubeçš„ç¬¬ä¸€æ¬¡è¿è¡Œæ˜¯ä¸€ä¸ªç®€å•çš„å‘½ä»¤è¡Œï¼Œç¤ºä¾‹ç»“æœå¦‚ä¸‹:</p><pre class="ms mt mu mv gu mw mx my mz aw na bi"><span id="60d5" class="nb kf ir mx b gz nc nd l ne nf">$ minikube start â€” driver=docker</span></pre><blockquote class="nh ni nj"><p id="4fb6" class="lc ld mf le b lf ma lh li lj mb ll lm nk mc lp lq nl md lt lu nm me lx ly lz ik bi translated">ğŸ˜„åŸºäºç”¨æˆ·é…ç½®ä½¿ç”¨dockeré©±åŠ¨ç¨‹åºçš„Linuxmint 19.3 <br/> âœ¨ä¸Šçš„minikube v 1 . 13 . 0<br/>ğŸ‘å¯åŠ¨é›†ç¾¤è¿·ä½ åº“<br/>ä¸­çš„æ§åˆ¶å¹³é¢èŠ‚ç‚¹è¿·ä½ åº“ğŸšœæ‹‰å‡ºåŸºç¡€å›¾åƒâ€¦ <br/>ğŸ’¾æ­£åœ¨ä¸‹è½½Kubernetes v1.19.0é¢„åŠ è½½â€¦ <br/> &gt;é¢„åŠ è½½-images-k8s-V6-v 1 . 19 . 0-docker-overlay 2-amd64 . tar . lz4:486.28 MiB<br/>ğŸ”¥æ­£åœ¨åˆ›å»ºdockerå®¹å™¨(CPUs = 2ï¼Œå†…å­˜=2200MB) â€¦ <br/>ğŸ³åœ¨Docker 19.03.8ä¸Šå‡†å¤‡Kubernetes v 1 . 19 . 0â€¦<br/>ğŸ”éªŒè¯Kubernetesç»„ä»¶â€¦ <br/>ğŸŒŸå¯ç”¨çš„æ’ä»¶:é»˜è®¤å­˜å‚¨ç±»ï¼Œå­˜å‚¨ä¾›åº”å™¨<br/>ğŸ„æå®šäº†ã€‚kubectlç°åœ¨é»˜è®¤é…ç½®ä¸ºä½¿ç”¨â€œminikubeâ€</p></blockquote><p id="642a" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">å®Œæˆä¸Šè¿°æ“ä½œåï¼Œæ‚¨å¯ä»¥æ£€æŸ¥minikubeéƒ¨ç½²çŠ¶æ€:</p><pre class="ms mt mu mv gu mw mx my mz aw na bi"><span id="e0ae" class="nb kf ir mx b gz nc nd l ne nf">$ minikube status</span><span id="3e75" class="nb kf ir mx b gz ng nd l ne nf">minikube<br/>type: Control Plane<br/>host: Running<br/>kubelet: Running<br/>apiserver: Running<br/>kubeconfig: Configured</span></pre><p id="8512" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated"><strong class="le is">é‡ç”¨Dockerå®ˆæŠ¤è¿›ç¨‹</strong></p><p id="ef17" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">æ­£å¦‚<a class="ae kd" href="https://kubernetes.io/docs/setup/learning-environment/minikube/" rel="noopener ugc nofollow" target="_blank"> Minikubeæ–‡æ¡£</a>æ‰€è¿°ï¼Œâ€œ<em class="mf">å½“å¯¹Kubernetesä½¿ç”¨å•ä¸ªVMæ—¶ï¼Œé‡ç”¨Minikubeçš„å†…ç½®Dockerå®ˆæŠ¤è¿›ç¨‹æ˜¯æœ‰ç”¨çš„ã€‚é‡ç”¨å†…ç½®çš„å®ˆæŠ¤è¿›ç¨‹æ„å‘³ç€ä½ ä¸å¿…åœ¨ä½ çš„ä¸»æœºä¸Šå»ºç«‹ä¸€ä¸ªDockeræ³¨å†Œè¡¨ï¼Œç„¶åæŠŠé•œåƒæ¨é€åˆ°é‡Œé¢</em>ã€‚</p><p id="cf6c" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">æˆ‘å·²ç»å®Œæ•´åœ°å¼•ç”¨äº†ä¸Šé¢çš„å¥å­ï¼Œå› ä¸ºæ²¡æœ‰æ›´å¥½çš„è¯æ¥æè¿°è¿™ä¸ªæƒ³æ³•ã€‚ä½†æ˜¯è¿™ä¸ªæ³¨é‡Šå¾ˆå®¹æ˜“åœ¨å¿«é€Ÿå…¥é—¨é¡µé¢ä¸­è¢«å¿½ç•¥ï¼Œå› ä¸ºå®ƒå¯¹äºåœ¨æœ¬åœ°æœºå™¨ä¸Šè¿›è¡Œå¿«é€Ÿå®éªŒæ˜¯è‡³å…³é‡è¦çš„ï¼</p><p id="25a5" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">æˆ‘ä»¬å°†â€œæ’å…¥â€minikubeçš„Dockerç¯å¢ƒï¼Œå› æ­¤æˆ‘ä»¬å°†æ„å»ºçš„ä»»ä½•æ˜ åƒéƒ½å°†åœ¨æˆ‘ä»¬çš„Minikubeé›†ç¾¤ä¸­ç«‹å³å¯è§ï¼Œå°±åƒå®ƒè¢«æ¨é€åˆ°DockerHubæˆ–å…¶ä»–å­˜å‚¨åº“ä¸€æ ·ã€‚</p><p id="6e40" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">åœ¨ç»ˆç«¯ä¸­è¿è¡Œçš„å‘½ä»¤æ˜¯:</p><pre class="ms mt mu mv gu mw mx my mz aw na bi"><span id="a2a1" class="nb kf ir mx b gz nc nd l ne nf">$ eval $(minikube -p minikube docker-env)</span></pre><p id="837e" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">è¯·è®°ä½ï¼Œè¿™å°†ä¸ºè¿™ä¸ªç‰¹å®šçš„ç»ˆç«¯ä¼šè¯è®¾ç½®ç¯å¢ƒï¼ä»ç°åœ¨å¼€å§‹ï¼Œä½ ä½¿ç”¨' docker 'å‘½ä»¤åšçš„ä»»ä½•äº‹æƒ…ï¼Œéƒ½å°†ç”±Minikubeä¸­çš„Dockerè§£é‡Šã€‚å¦‚æœæ‚¨é”€æ¯è¿™ä¸ªç»ˆç«¯ä¼šè¯æˆ–å¯åŠ¨å¦ä¸€ä¸ªç»ˆç«¯ä¼šè¯ï¼Œæ‚¨éœ€è¦é‡å¤å¦‚ä¸Šæ‰€ç¤ºçš„â€œevalâ€å‘½ä»¤ã€‚</p><h1 id="0dd0" class="ke kf ir bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated"><strong class="ak">å‡†å¤‡å’Œæ„å»ºæ˜ åƒ</strong></h1><p id="25b2" class="pw-post-body-paragraph lc ld ir le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å°†è¿›è¡Œå¿«é€ŸDevOpsé…æ–¹ä¸­çš„â€œå¼€å‘â€éƒ¨åˆ†ã€‚æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶â€”â€”ä¸€ä¸ªæ˜¯åœ¨å®¹å™¨ä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºï¼Œå¦ä¸€ä¸ªåŒ…å«å¦‚ä½•æ„å»ºè¿è¡Œè¯¥åº”ç”¨ç¨‹åºçš„Dockerå®¹å™¨çš„è¯´æ˜ã€‚</p><p id="cdd8" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated"><strong class="le is">ç²—WWWåº”ç”¨</strong></p><p id="715e" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">å¯¹äºæˆ‘ä»¬çš„ç®€å•åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Arundel &amp; Dominguisçš„â€œå¸¦æœ‰Kubernetesçš„äº‘åŸç”ŸDevOpsâ€çš„æ€æƒ³åˆ›å»ºgo httpæœåŠ¡å™¨ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰æ¥è§¦è¿‡è¿™æœ¬ä¹¦ï¼Œæˆ‘å¼ºçƒˆæ¨èå®ƒï¼</p><p id="de60" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">è¿™ç§é€‰æ‹©æœ‰ä¸€ä¸ªç‰¹å®šçš„åŸå› golangåº”ç”¨ç¨‹åºå¯ä»¥ç¼–è¯‘å¹¶æ„å»ºåˆ°éå¸¸å°çš„ä¼˜åŒ–å®¹å™¨ä¸­ï¼Œå½“æ„å»ºåˆ°â€œscratchâ€å®¹å™¨ä¸­æ—¶ï¼Œè¿˜ä¼šç•™ä¸‹éå¸¸å°çš„<em class="mf"> _attack surface_ </em>ã€‚åŸºæœ¬ä¸Šï¼Œæˆ‘ä»¬å°†åœ¨Dockerå†…åˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œé‡Œé¢ä»€ä¹ˆä¹Ÿæ²¡æœ‰ã€‚</p><p id="31b9" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">åˆ›å»ºä¸€ä¸ªâ€œhello.goâ€æ–‡ä»¶ï¼Œå¹¶åœ¨æ‚¨é€‰æ‹©çš„ç¼–è¾‘å™¨ä¸­è¿›è¡Œç¼–è¾‘ï¼Œä»¥å®ç°ä»¥ä¸‹ç›®çš„:</p><pre class="ms mt mu mv gu mw mx my mz aw na bi"><span id="2b89" class="nb kf ir mx b gz nc nd l ne nf">package hello<br/>import (<br/>   "fmt"<br/>   "log"<br/>   "net/http"<br/>)<br/>func handler(w http.ResponseWriter, r *http.Request) {<br/>   fmt.Fprintln(w, "It works!")<br/>}<br/>func main() {<br/>   http.HandleFunc("/", handler)<br/>   log.Fatal(http.ListenAndServe(":8080", nil))<br/>}</span></pre><p id="036f" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated"><strong class="le is">ç”¨äºWWWåº”ç”¨çš„Dockerå›¾åƒ</strong></p><p id="d220" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">æ¥ä¸‹æ¥ï¼Œåœ¨åŒä¸€ä¸ªç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª`<em class="mf"> Dockerfile </em>`,å†…å®¹å¦‚ä¸‹:</p><pre class="ms mt mu mv gu mw mx my mz aw na bi"><span id="9569" class="nb kf ir mx b gz nc nd l ne nf">FROM golang:1.15-alpine AS base<br/>WORKDIR /src/<br/>COPY hello.go /src/<br/>ENV CGO_ENABLED=0 <br/>RUN go build -o /bin/hello<br/>FROM scratch<br/>COPY --from=base /bin/hello /bin/hello<br/>ENTRYPOINT ["/bin/hello"]</span></pre><p id="151c" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">ç°åœ¨ï¼Œå¦‚æœæ‚¨åœ¨è¿æ¥åˆ°Minikubeçš„Docker deamonçš„ç»ˆç«¯ä¸­æ„å»ºå®¹å™¨ï¼Œå®ƒå°†ç«‹å³åœ¨K8sé›†ç¾¤ä¸­å¯ç”¨ã€‚</p><p id="6ac7" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">è‹¥è¦ä½¿ç”¨è¿æ¥ï¼Œè¯·è¿è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚è®°å¾—ç•™åœ¨Dockerfileæ”¾çš„ç›®å½•ä¸‹ï¼å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†â€œ1.0â€æ ‡ç­¾ã€‚æ³¨æ„æœ«å°¾çš„é‚£ä¸ªç‚¹ã€‚</p><pre class="ms mt mu mv gu mw mx my mz aw na bi"><span id="4a7f" class="nb kf ir mx b gz nc nd l ne nf">$ docker build -t go-hello:1.0 .</span></pre><p id="4aef" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">é‡è¦æç¤º:<strong class="le is">* *å§‹ç»ˆ** </strong>æ ‡è®°å›¾åƒã€‚ä¸è¦å¯¹æœ¬åœ°å›¾åƒä½¿ç”¨`<em class="mf">æœ€æ–°çš„</em>æ ‡ç­¾ã€‚å¦åˆ™ï¼Œæ‚¨å¯èƒ½ä¼šåœ¨Minikubeçš„K8sä¸­é‡åˆ°â€œ<em class="mf"> ErrPullBackoff </em>â€é”™è¯¯ã€‚</p><h1 id="180d" class="ke kf ir bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated"><strong class="ak">å±•å¼€å’Œæš´éœ²</strong></h1><p id="521d" class="pw-post-body-paragraph lc ld ir le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated">åœ¨ç”Ÿäº§ä¸­ï¼Œæ‚¨åº”è¯¥å§‹ç»ˆéµå¾ªIaCå’ŒDevOpsåŸåˆ™ã€‚å°±Kubernetesè€Œè¨€ï¼Œæ‚¨è‡³å°‘åº”è¯¥æœ‰éƒ¨ç½²å’ŒæœåŠ¡YAMLæ–‡ä»¶ï¼Œç”šè‡³æ˜¯é‡æ–°éƒ¨ç½²åº”ç”¨ç¨‹åºçš„å¯¼èˆªå›¾ã€‚</p><p id="92ee" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">åœ¨æ‚¨çš„æœ¬åœ°ç¯å¢ƒä¸­ï¼Œå½“æ‚¨è¿›è¡Œè¯•éªŒæ—¶ï¼Œæ‚¨å¯ä»¥åªåˆ›å»ºéƒ¨ç½²ï¼Œå¹¶ä½¿ç”¨ä¸¤ä¸ªç®€å•çš„å‘½ä»¤å…¬å¼€å®ƒ:</p><pre class="ms mt mu mv gu mw mx my mz aw na bi"><span id="5d9b" class="nb kf ir mx b gz nc nd l ne nf">$ kubectl create deployment go-hello --image=go-hello:1.0</span><span id="fac6" class="nb kf ir mx b gz ng nd l ne nf">$ kubectl expose deployment go-hello --type=NodePort --port=8080</span></pre><p id="4107" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">è¯·è®°ä½å°†æ ‡ç­¾è®¾ç½®ä¸ºæ‚¨åœ¨ä¸Šä¸€å°èŠ‚ä¸­ä½¿ç”¨çš„æ ‡ç­¾ã€‚</p><p id="a637" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">éƒ¨ç½²åï¼Œå¦‚æœæœåŠ¡å·²æˆåŠŸåˆ›å»ºï¼Œæ‚¨å¯ä»¥åœ¨K8sé›†ç¾¤ä¸­éªŒè¯åº”ç”¨ç¨‹åºè¡Œä¸ºï¼Œå¹¶ä½¿ç”¨Minikubeçš„å†…ç½®åŠŸèƒ½åœ¨æµè§ˆå™¨çª—å£ä¸­éªŒè¯æœåŠ¡:</p><pre class="ms mt mu mv gu mw mx my mz aw na bi"><span id="b946" class="nb kf ir mx b gz nc nd l ne nf">$ kubectl get svc go-hello</span><span id="ffbc" class="nb kf ir mx b gz ng nd l ne nf">$ kubectl get deploy go-hello -o wide</span><span id="a662" class="nb kf ir mx b gz ng nd l ne nf">$ kubectl get pods -l=app=go-hello</span><span id="832e" class="nb kf ir mx b gz ng nd l ne nf">$ minikube service go-hello</span></pre><p id="b41e" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">æœ€åä¸€ä¸ªå‘½ä»¤å°†æ‰“å¼€æ‚¨çš„æœåŠ¡æµè§ˆå™¨ï¼Œå¹¶æ˜¾ç¤ºè¿æ¥å€¼ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚</p><pre class="ms mt mu mv gu mw mx my mz aw na bi"><span id="c6dc" class="nb kf ir mx b gz nc nd l ne nf">| default | go-hello | 8080 | <a class="ae kd" href="http://172.17.0.3:32061" rel="noopener ugc nofollow" target="_blank">http://172.17.0.3:32061</a> |</span><span id="a446" class="nb kf ir mx b gz ng nd l ne nf">ğŸ‰ Opening service default/go-hello in default browserâ€¦</span></pre><p id="fa25" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">å½“ç„¶ï¼Œä½ å¯ä»¥ä½¿ç”¨curlã€Postmanæˆ–å…¶ä»–å·¥å…·æ¥æµ‹è¯•ä½ çš„æœåŠ¡ã€‚</p><p id="7f15" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">æ¯å½“æ‚¨æ›´æ”¹åº”ç”¨ç¨‹åºå¹¶å¸Œæœ›åœ¨Kubernetesä¸­è¿›è¡Œæµ‹è¯•æ—¶ï¼Œæ‚¨å¯ä»¥:</p><ul class=""><li id="2fd0" class="nn no ir le b lf ma lj mb ln np lr nq lv nr lz ns nt nu nv bi translated">ä½¿ç”¨æ–°æ ‡ç­¾æ„å»ºå›¾åƒï¼Œä¾‹å¦‚â€œ2.0â€</li></ul><pre class="ms mt mu mv gu mw mx my mz aw na bi"><span id="393c" class="nb kf ir mx b gz nc nd l ne nf">$ docker build -t go-hello:2.0 .</span></pre><ul class=""><li id="fdfa" class="nn no ir le b lf ma lj mb ln np lr nq lv nr lz ns nt nu nv bi translated">ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç¼–è¾‘Minikubeä¸­çš„éƒ¨ç½²:</li></ul><pre class="ms mt mu mv gu mw mx my mz aw na bi"><span id="e00d" class="nb kf ir mx b gz nc nd l ne nf">$ kubectl set image deployment/go-hello go-hello=go-hello:2.0</span></pre><p id="344f" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">æ›´æ–°çš„å›¾åƒå°†å¯¼è‡´çª—æ ¼è¢«é‡æ–°åˆ›å»ºï¼Œå¹¶ä¸”æ›´æ”¹å°†ç«‹å³åœ¨æµè§ˆå™¨ä¸­å¯è§ã€‚</p><h1 id="a465" class="ke kf ir bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">å°±æ˜¯è¿™æ ·ï¼</h1><p id="d9dd" class="pw-post-body-paragraph lc ld ir le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ik bi translated">æ‚¨å·²ç»æˆåŠŸåœ°éƒ¨ç½²äº†ä¸€ä¸ªminikube Kubernetesé›†ç¾¤ï¼Œæ„å»ºäº†ä¸€ä¸ªä¼˜åŒ–çš„Dockeråº”ç”¨ç¨‹åºï¼Œåœ¨é›†ç¾¤ä¸Šè¿è¡Œâ€”â€”å¹¶ä¸”åœ¨æ‚¨çš„æœ¬åœ°ç¯å¢ƒä¸­å®Œæˆäº†æ‰€æœ‰è¿™äº›å·¥ä½œã€‚æ­å–œä½ ï¼</p><p id="a6f0" class="pw-post-body-paragraph lc ld ir le b lf ma lh li lj mb ll lm ln mc lp lq lr md lt lu lv me lx ly lz ik bi translated">è®©æˆ‘åœ¨è¯„è®ºä¸­çŸ¥é“æ˜¯å¦æœ‰ä¸€äº›éƒ¨åˆ†å¼•èµ·äº†ä¸€äº›é—®é¢˜ã€‚æœ‰è®¸å¤šé…ç½®å’Œæ“ä½œç³»ç»Ÿï¼Œæˆ‘å¸Œæœ›æˆ‘çš„æ•™ç¨‹æ¶µç›–äº†å¤§å¤šæ•°ï¼Œä½†æˆ‘è‚¯å®šä¸æ˜¯æ‰€æœ‰çš„:)</p></div></div>    
</body>
</html>