# è§£å†³ CORS æ”¿ç­–é”™è¯¯

> åŸæ–‡ï¼š<https://itnext.io/resolving-cors-policy-error-c4cd11b012b?source=collection_archive---------2----------------------->

## ä»€ä¹ˆæ˜¯åŒæºç­–ç•¥ï¼Ÿä»¥åŠå¦‚ä½•ç»•è¿‡ï¼Ÿ

![](img/d18e889f754124673b0b32c22ddf725e.png)

CORS é”™è¯¯-åŒæºç­–ç•¥

è®¤å¾—è¿™ä¸ªå—ï¼Ÿï¼Ÿï¼Ÿ

![](img/7e1ae596da17dfd525b8f17663878295.png)

æ˜¯å•Šï¼ï¼ï¼CORS é”™è¯¯ã€‚å®ƒä¸æ—¶æŠ¬èµ·æ„¤æ€’çš„å¤´ã€‚

# è¿™æ˜¯ä»€ä¹ˆï¼Ÿ

é¦–å…ˆè¦ç†è§£çš„æ˜¯ï¼Œè¿™ä¸æ˜¯ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„é”™è¯¯ï¼Œè€Œæ˜¯ä¸€ç§ä¿æŠ¤ç”¨æˆ·å…å—äº’è”ç½‘ä¸Šå¯èƒ½å‘ç”Ÿçš„æ½œåœ¨ä¸è‰¯äº‹ä»¶å½±å“çš„å®‰å…¨æªæ–½ã€‚è¿™ç§å®‰å…¨æªæ–½è¢«ç§°ä¸ºåŒæºç­–ç•¥ã€‚

æˆ‘è¯•å›¾å®šä¹‰å®ƒ:

> åŒæºç­–ç•¥é™åˆ¶ç½‘é¡µè¯·æ±‚å…·æœ‰ä¸åŒæ¥æºçš„å¦ä¸€ç½‘é¡µä¸Šçš„æ•°æ®ã€‚

æƒ³è±¡ä¸€ä¸ªæµè§ˆå™¨æ²¡æœ‰å®ç°åŒæºç­–ç•¥çš„æƒ…å†µã€‚

ä»»ä½•ç½‘é¡µéƒ½å¯ä»¥è¯·æ±‚æ¥è‡ªä»»ä½•æ¥æºçš„æ•°æ®ï¼Œè¿™æ„å‘³ç€ä»»ä½•æ¶æ„ç½‘ç«™éƒ½å¯ä»¥ä½¿ç”¨å­˜å‚¨çš„ cookie æˆ–ä¼šè¯æ•°æ®æ¥è®¿é—®æ‚¨å·²ç»æ‰“å¼€çš„ä»»ä½•ç¤¾äº¤åª’ä½“å¸æˆ·ã€é“¶è¡Œï¼Œç”šè‡³æ›´ç³Ÿã€‚

![](img/35cdd9d243f4eeda3c46324bc8aad399.png)

å¦‚æœæ²¡æœ‰åŒæºæ”¿ç­–ï¼Œä¸–ç•Œå¯èƒ½ä¼šå˜æˆè¿™æ ·:

> 1.ç”¨æˆ·ç™»å½•ç”µå­é‚®ä»¶å¸æˆ·ï¼Œåˆ›å»ºä¼šè¯ cookie å¹¶å­˜å‚¨åœ¨æµè§ˆå™¨ä¸Šã€‚
> 
> 2.ç”¨æˆ·ç™»å½•åˆ° sketchysite.comã€‚sketchysite.com ä½¿ç”¨ cookies å‘ç”µå­é‚®ä»¶å¸æˆ·å‘é€è¯·æ±‚ã€‚è¿”å›çš„æ•°æ®è¢«æ•è·å¹¶å‡ºå”®ã€‚
> 
> 3.ä¸‹æ¬¡ä½ ä½¿ç”¨ä¿¡ç”¨å¡æ—¶ï¼Œä½ ä¼šå‘ç°å®ƒå·²ç»é€æ”¯äº†

**åŒæºä¾‹å­**

![](img/b8938c43f098e05b4db572784c1c4595.png)

åŒæºçš„ä¾‹å­

**ä¸åŒèµ·æºçš„ä¾‹å­**

![](img/a76dd014b9a2e15088ed047da79c48d4.png)

**ä¸åŒäº§åœ°çš„ä¾‹å­**

# å¦‚ä½•ç»•è¿‡å®ƒ

å¾ˆè‡ªç„¶ï¼Œä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦å®‰å…¨åœ°ç»•è¿‡è¿™ä¸€æ”¿ç­–ï¼Œè€Œ CORS å°±æ˜¯è¿™æ ·åšçš„ä¸€ç§æ–¹å¼ã€‚

Mozilla å°† CORS å®šä¹‰ä¸º

> **è·¨æ¥æºèµ„æºå…±äº«** ( [CORS](https://developer.mozilla.org/en-US/docs/Glossary/CORS) )æ˜¯ä¸€ç§åŸºäº [HTTP](https://developer.mozilla.org/en-US/docs/Glossary/HTTP) æŠ¥å¤´çš„æœºåˆ¶ï¼Œå…è®¸æœåŠ¡å™¨æŒ‡ç¤ºé™¤å…¶è‡ªèº«ä»¥å¤–çš„ä»»ä½•[æ¥æº](https://developer.mozilla.org/en-US/docs/Glossary/Origin) s(åŸŸã€æ–¹æ¡ˆæˆ–ç«¯å£),æµè§ˆå™¨åº”è¯¥å…è®¸ä»è¿™äº›æ¥æºåŠ è½½èµ„æºã€‚

**é€‰é¡¹ 1** ğŸ™…â€â™‚ï¸

å—¯ï¼Œæˆ‘ä»¬å®é™…ä¸Šå¯ä»¥åœ¨å®¢æˆ·ç«¯åšä¸€ä¸ªæ”¹å˜ï¼Œé€šè¿‡ä¼ é€’æ¨¡å¼:HTTP è¯·æ±‚ä¸­çš„â€œno-corsâ€æ¥ç»•è¿‡ CORSã€‚å°½ç®¡è¿™ä¸æ˜¯æ¨èçš„è§£å†³æ–¹æ¡ˆã€‚

*æ³¨æ„,â€œæ—  corsâ€åªå…è®¸æœ‰é™çš„ä¸€ç»„æ–¹æ³•ï¼Œå¹¶é˜²æ­¢æ ‡å¤´æˆä¸ºé™¤äº†* [*ç®€å•æ ‡å¤´*](https://fetch.spec.whatwg.org/#simple-header) ä¹‹å¤–çš„ä»»ä½•æ ‡å¤´

```
fetch(url, {
 method: â€˜POSTâ€™,
 mode: â€˜corsâ€™, // no-cors, *cors, same-origin,
 headers: {â€˜Content-Typeâ€™: â€˜application/jsonâ€™}
})
```

**é€‰é¡¹ 2** ğŸ™…â€â™‚ï¸

å¦ä¸€ä¸ªæˆ‘ä¸æ¨èçš„è§£å†³æ–¹æ¡ˆæ˜¯åœ¨ä½ çš„æµè§ˆå™¨ä¸Šæ·»åŠ ä¸€ä¸ªæ’ä»¶æ¥ç»•è¿‡è·¨æºç­–ç•¥ã€‚è¿™äº›é€šå¸¸è¡¨ç°å¾—åƒä¸€ä¸ªä»£ç†ï¼Œä½†æ˜¯ä¼šè®©ä½ å®¹æ˜“å—åˆ°æ”»å‡»ã€‚

æµè¡Œçš„æ’ä»¶åŒ…æ‹¬:

[](https://chrome.google.com/webstore/detail/allow-cors-access-control/lhobafahddgcelffkeicbaginigeejlf?hl) [## å…è®¸ CORS:è®¿é—®æ§åˆ¶å…è®¸æ¥æº

### è½»æ¾åœ°å°†(Access-Control-Allow-Origin: *)è§„åˆ™æ·»åŠ åˆ°å“åº”å¤´ä¸­ã€‚

chrome.google.com](https://chrome.google.com/webstore/detail/allow-cors-access-control/lhobafahddgcelffkeicbaginigeejlf?hl) [](https://chrome.google.com/webstore/detail/cors-unblock/lfhmikememgdcahcdlaciloancbhjino?hl=en) [## CORS è§£é”

### å¯ç”¨æ—¶ï¼Œé€šè¿‡å°†â€œAccess-Control-Allow-Origin: *â€æ ‡å¤´é™„åŠ åˆ°æœ¬åœ°å’Œè¿œç¨‹ web è¯·æ±‚ï¼Œä¸å†å‡ºç° CORS é”™è¯¯

chrome.google.com](https://chrome.google.com/webstore/detail/cors-unblock/lfhmikememgdcahcdlaciloancbhjino?hl=en) 

**é€‰é¡¹ä¸‰**ğŸ’â€â™‚ï¸

è§£å†³æ–¹æ¡ˆåº”è¯¥åœ¨æœåŠ¡å™¨ç«¯ã€‚å¯¹äº Node å’Œ Express æˆ‘ä»¬å¯ä»¥ä¸‹è½½ cors åŒ…ã€https://www.npmjs.com/package/cors 

`$ npm install cors`

è¿™ä¸ªåŒ…å°†å…è®¸æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªå“åº”å¤´`access-control-allow-origins`å¹¶æŒ‡å®šå…è®¸å“ªäº›æºã€‚

```
// Default = CORS-enabled for all origins 
app.use(cors())// restrict to certain origin
app.use(cors({origin: â€œhttp://localhost:3001"})) 
```

Viola åœ¨ä¸å½±å“å®‰å…¨æ€§çš„æƒ…å†µä¸‹å®Œå…¨æ§åˆ¶å…¬è®¤çš„æ¥æº

æˆ‘å¸Œæœ›ä½ å·²ç»å‘ç°è¿™æ˜¯æœ‰ç”¨çš„ï¼Œæ„Ÿè°¢æ‚¨çš„é˜…è¯»ã€‚å¦‚æœä½ å–œæ¬¢è¿™ä¸ªï¼Œä½ å¯èƒ½ä¹Ÿä¼šå–œæ¬¢æˆ‘ä»¬åœ¨[åˆ›é€ çš„å…¶ä»–ä¸€äº›åšå®¢å¸–å­å’Œåˆ›æ„ï¼ï¼ä¹¦å‘†å­](https://www.notnotnerdy.com/)ã€‚æ¯ä¸ªæœˆéƒ½ä¼šæ¨å‡ºæ–°çš„è®¾è®¡ã€‚