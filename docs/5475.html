<html>
<head>
<title>GYRO-WEB: ACCESSING THE DEVICE ORIENTATION IN JAVASCRIPT</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GYRO-WEB:åœ¨JAVASCRIPTä¸­è®¿é—®è®¾å¤‡æ–¹å‘</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://itnext.io/gyro-web-accessing-the-device-orientation-in-javascript-387da43eeb84?source=collection_archive---------1-----------------------#2021-03-15">https://itnext.io/gyro-web-accessing-the-device-orientation-in-javascript-387da43eeb84?source=collection_archive---------1-----------------------#2021-03-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/24a35986f13232f29e939e3451f487e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gkiruUauYUO6mnGeoGEgMQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">å›¾ç‰‡æ¥æº:ã€https://newnow.co/me-myself-and-i/ T4ã€‘</figcaption></figure><blockquote class="kd ke kf"><p id="7ad0" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><em class="iq">æœ¬æ–‡æœ‰</em> <a class="ae kc" href="https://trekhleb.dev/blog/2021/gyro-web/" rel="noopener ugc nofollow" target="_blank"> <em class="iq">äº’åŠ¨ç‰ˆ</em> </a> <em class="iq">ã€‚æ‚¨å¯ä»¥æ‰“å¼€å®ƒï¼Œä»æ‚¨çš„ç§»åŠ¨è®¾å¤‡ä¸Šè°ƒæ•´è®¾å¤‡æ–¹å‘ã€‚</em></p></blockquote><h1 id="f5d7" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">åœ¨çº¯JavaScriptä¸­è®¿é—®è®¾å¤‡å®šå‘</h1><p id="e878" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">åœ¨Javascriptä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡ç›‘å¬<a class="ae kc" href="https://developer.mozilla.org/en-US/docs/Web/API/Detecting_device_orientation" rel="noopener ugc nofollow" target="_blank"> deviceorientation </a>äº‹ä»¶æ¥è®¿é—®æ‚¨çš„è®¾å¤‡æ–¹ä½æ•°æ®ã€‚å°±åƒä¸‹é¢è¿™æ ·ç®€å•:</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="bd9b" class="mu lg iq mq b gy mv mw l mx my">window.addEventListener('deviceorientation', handleOrientation);<br/><br/>function handleOrientation(event) {<br/>  const alpha = event.alpha;<br/>  const beta = event.beta;<br/>  const gamma = event.gamma;<br/>  // Do stuff...<br/>}</span></pre><p id="9433" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">ä¸‹é¢æ˜¯<code class="fe mz na nb mq b">alpha</code>ã€<code class="fe mz na nb mq b">beta</code>å’Œ<code class="fe mz na nb mq b">gama</code>è§’åº¦çš„å«ä¹‰:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7d49d7b8a25fe8a56ab7be4b907b794f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mb47G9t-t-WcH4v8.jpg"/></div></div></figure><p id="da8d" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated"><em class="ki">å›¾ç‰‡æ¥æº:</em><a class="ae kc" href="https://newnow.co/me-myself-and-i/" rel="noopener ugc nofollow" target="_blank"><em class="ki">newnow.co</em></a></p><p id="356b" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated"><strong class="kj ir">ä½†æ˜¯ï¼</strong>ä¸æ˜¯æ¯ä¸ªæµè§ˆå™¨éƒ½å…è®¸ä½ åœ¨æ²¡æœ‰ç”¨æˆ·è®¸å¯çš„æƒ…å†µä¸‹è®¿é—®æ–¹ä½æ•°æ®ã€‚ä¾‹å¦‚ï¼Œåœ¨iOS 13ä¸­ï¼Œè‹¹æœå¼•å…¥äº†<a class="ae kc" href="https://www.w3.org/TR/orientation-event/#dom-deviceorientationevent-requestpermission" rel="noopener ugc nofollow" target="_blank"> requestPermission </a>æ–¹æ³•ã€‚å®ƒå¿…é¡»åœ¨ç”¨æˆ·æ“ä½œ(ç‚¹å‡»ã€è½»æ•²æˆ–ç­‰æ•ˆæ“ä½œ)æ—¶è§¦å‘ã€‚</p><p id="1d3b" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">è®¿é—®è®¾å¤‡æ–¹å‘çš„ç¤ºä¾‹å˜å¾—æœ‰ç‚¹å¤æ‚:</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="4094" class="mu lg iq mq b gy mv mw l mx my">function onClick() {<br/>  if (typeof DeviceMotionEvent.requestPermission === 'function') {<br/>    // Handle iOS 13+ devices.<br/>    DeviceMotionEvent.requestPermission()<br/>      .then((state) =&gt; {<br/>        if (state === 'granted') {<br/>          window.addEventListener('devicemotion', handleOrientation);<br/>        } else {<br/>          console.error('Request to access the orientation was rejected');<br/>        }<br/>      })<br/>      .catch(console.error);<br/>  } else {<br/>    // Handle regular non iOS 13+ devices.<br/>    window.addEventListener('devicemotion', handleOrientation);<br/>  }<br/>}</span></pre><p id="135c" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">å¦‚æœä½ åœ¨æœ¬å¸–çš„<a class="ae kc" href="https://trekhleb.dev/blog/2021/gyro-web/" rel="noopener ugc nofollow" target="_blank">äº’åŠ¨ç‰ˆä¸­æ‰“å¼€è®¾å¤‡æ–¹å‘å¼€å…³ï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ°ä½ çš„è®¾å¤‡æŠ¥å‘Šçš„è§’åº¦ã€‚</a></p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/4702732631b82268fb7e485a72caefc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*8eCWwsbYwYCky2wc.gif"/></div></figure><h1 id="9fd3" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">è°ƒè¯•æµè§ˆå™¨ä¸­çš„æ–¹å‘è®¿é—®</h1><p id="5e7d" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯æ¡Œé¢è®¾å¤‡ï¼Œæ‚¨å¯ä»¥åœ¨å¼€å‘å·¥å…·çš„â€œä¼ æ„Ÿå™¨â€é€‰é¡¹å¡ä¸­æ¨¡ä»¿è®¾å¤‡æ—‹è½¬:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/6d3405ece701058abf694cb34470c3f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qYReUd_Rqai03mWL.jpg"/></div></div></figure><p id="2c0e" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">é…·ï¼ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®è®¾å¤‡æ–¹å‘ï¼Œç”šè‡³å¯ä»¥åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•å®ƒï¼</p><h1 id="43d8" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">ç”¨äºè®¿é—®è®¾å¤‡æ–¹å‘çš„ååº”æŒ‚é’©</h1><p id="16f5" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">æˆ‘æƒ³é‡‡å–çš„æœ€åä¸€æ­¥æ˜¯æ‹¿å‡º<a class="ae kc" href="https://reactjs.org/docs/hooks-intro.html" rel="noopener ugc nofollow" target="_blank"> Reacté’©å­</a>ï¼Œå®ƒå°†ä¸ºæˆ‘å°è£…æ–¹å‘æŠ“å–ï¼Œå¹¶ä½¿å®ƒæ›´å®¹æ˜“åœ¨Reactç»„ä»¶ä¸­ä½¿ç”¨(å°±åƒä¸Šé¢å‘æ‚¨æ˜¾ç¤ºè§’åº¦çš„é‚£ä¸ª)ã€‚</p><p id="e22f" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">ä¸‹é¢æ˜¯ä¸€ä¸ªç”¨TypeScriptç¼–å†™çš„<code class="fe mz na nb mq b">useDeviceOrientation.ts</code>é’©å­çš„ä¾‹å­:</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="914a" class="mu lg iq mq b gy mv mw l mx my">import { useCallback, useEffect, useState } from 'react';<br/><br/>type DeviceOrientation = {<br/>  alpha: number | null,<br/>  beta: number | null,<br/>  gamma: number | null,<br/>}<br/><br/>type UseDeviceOrientationData = {<br/>  orientation: DeviceOrientation | null,<br/>  error: Error | null,<br/>  requestAccess: () =&gt; Promise&lt;boolean&gt;,<br/>  revokeAccess: () =&gt; Promise&lt;void&gt;,<br/>};<br/><br/>export const useDeviceOrientation = (): UseDeviceOrientationData =&gt; {<br/>  const [error, setError] = useState&lt;Error | null&gt;(null);<br/>  const [orientation, setOrientation] = useState&lt;DeviceOrientation | null&gt;(null);<br/><br/>  const onDeviceOrientation = (event: DeviceOrientationEvent): void =&gt; {<br/>    setOrientation({<br/>      alpha: event.alpha,<br/>      beta: event.beta,<br/>      gamma: event.gamma,<br/>    });<br/>  };<br/><br/>  const revokeAccessAsync = async (): Promise&lt;void&gt; =&gt; {<br/>    window.removeEventListener('deviceorientation', onDeviceOrientation);<br/>    setOrientation(null);<br/>  };<br/><br/>  const requestAccessAsync = async (): Promise&lt;boolean&gt; =&gt; {<br/>    if (!DeviceOrientationEvent) {<br/>      setError(new Error('Device orientation event is not supported by your browser'));<br/>      return false;<br/>    }<br/><br/>    if (<br/>      DeviceOrientationEvent.requestPermission<br/>      &amp;&amp; typeof DeviceMotionEvent.requestPermission === 'function'<br/>    ) {<br/>      let permission: PermissionState;<br/>      try {<br/>        permission = await DeviceOrientationEvent.requestPermission();<br/>      } catch (err) {<br/>        setError(err);<br/>        return false;<br/>      }<br/>      if (permission !== 'granted') {<br/>        setError(new Error('Request to access the device orientation was rejected'));<br/>        return false;<br/>      }<br/>    }<br/><br/>    window.addEventListener('deviceorientation', onDeviceOrientation);<br/><br/>    return true;<br/>  };<br/><br/>  const requestAccess = useCallback(requestAccessAsync, []);<br/>  const revokeAccess = useCallback(revokeAccessAsync, []);<br/><br/>  useEffect(() =&gt; {<br/>    return (): void =&gt; {<br/>      revokeAccess();<br/>    };<br/>  }, [revokeAccess]);<br/><br/>  return {<br/>    orientation,<br/>    error,<br/>    requestAccess,<br/>    revokeAccess,<br/>  };<br/>};</span></pre><p id="3ba5" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">æŒ‚é’©çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹:</p><pre class="ml mm mn mo gt mp mq mr ms aw mt bi"><span id="68ba" class="mu lg iq mq b gy mv mw l mx my">import React from 'react';<br/>import Toggle  from './Toggle';<br/>import { useDeviceOrientation } from './useDeviceOrientation';<br/><br/>const OrientationInfo = (): React.ReactElement =&gt; {<br/>  const { orientation, requestAccess, revokeAccess, error } = useDeviceOrientation();<br/><br/>  const onToggle = (toggleState: boolean): void =&gt; {<br/>    const result = toggleState ? requestAccess() : revokeAccess();<br/>  };<br/><br/>  const orientationInfo = orientation &amp;&amp; (<br/>    &lt;ul&gt;<br/>      &lt;li&gt;É‘: &lt;code&gt;{orientation.alpha}&lt;/code&gt;&lt;/li&gt;<br/>      &lt;li&gt;Î²: &lt;code&gt;{orientation.beta}&lt;/code&gt;&lt;/li&gt;<br/>      &lt;li&gt;Î³: &lt;code&gt;{orientation.gamma}&lt;/code&gt;&lt;/li&gt;<br/>    &lt;/ul&gt;<br/>  );<br/><br/>  const errorElement = error ? (<br/>    &lt;div className="error"&gt;{error.message}&lt;/div&gt;<br/>  ) : null;<br/><br/>  return (<br/>    &lt;&gt;<br/>      &lt;Toggle onToggle={onToggle} /&gt;<br/>      {orientationInfo}<br/>      {errorElement}<br/>    &lt;/&gt;<br/>  );<br/>};<br/><br/>export default OrientationInfo;</span></pre><h1 id="320e" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">æ¼”ç¤º</h1><p id="f00f" class="pw-post-body-paragraph kg kh iq kj b kk md km kn ko me kq kr mf mg ku kv mh mi ky kz mj mk lc ld le ij bi translated">æœ€åï¼Œæœ‰äº†å¯¹è®¾å¤‡æ–¹å‘çš„è®¿é—®ï¼Œè®©æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸ª3Dç©ºé—´ï¼Œå¹¶æœ‰å¯èƒ½é€šè¿‡æ—‹è½¬æ‚¨çš„ç§»åŠ¨è®¾å¤‡ä»3Dè§†è§’è§‚çœ‹å¯¹è±¡ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªè™šæ‹Ÿçš„è´­ç‰©ç‰©å“ï¼Œä½ æƒ³ä»ä¸åŒçš„è§’åº¦å’Œä¾§é¢çœ‹åˆ°å®ƒï¼Œç„¶åå†æŠŠå®ƒæ”¾è¿›ä½ çš„ç¯®å­é‡Œã€‚</p><p id="39b9" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªç®€å•çš„3Dç«‹æ–¹ä½“ï¼Œå®ƒæ˜¯ç”±çº¯CSSé€šè¿‡ä½¿ç”¨<a class="ae kc" href="https://css-tricks.com/almanac/properties/p/perspective/" rel="noopener ugc nofollow" target="_blank">é€è§†</a>ã€<a class="ae kc" href="https://css-tricks.com/almanac/properties/p/perspective-origin/" rel="noopener ugc nofollow" target="_blank">é€è§†-åŸç‚¹</a>å’Œ<a class="ae kc" href="https://css-tricks.com/almanac/properties/t/transform/" rel="noopener ugc nofollow" target="_blank">å˜æ¢</a>å±æ€§åˆ¶ä½œçš„(ä½ å¯ä»¥åœ¨css-tricks.comä¸Šæ‰¾åˆ°æ ·å¼<a class="ae kc" href="https://css-tricks.com/how-css-perspective-works/" rel="noopener ugc nofollow" target="_blank">çš„å®Œæ•´ç¤ºä¾‹)ã€‚</a></p><p id="e576" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">æˆ‘ä»¬å¼€å§‹å§ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„é™€èºç«‹æ–¹ä½“ï¼Œæ ¹æ®ä½ çš„è®¾å¤‡æ–¹å‘ï¼Œä½ åº”è¯¥èƒ½å¤Ÿä»ä¸åŒçš„è§’åº¦çœ‹åˆ°å®ƒï¼</p><p id="afba" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">å¦‚æœä½ åœ¨ç¬”è®°æœ¬ç”µè„‘ä¸Šé˜…è¯»è¿™ç¯‡æ–‡ç« ï¼Œå¦‚æœä½ å¯åŠ¨è¿™ç¯‡æ–‡ç« çš„<a class="ae kc" href="https://trekhleb.dev/blog/2021/gyro-web/" rel="noopener ugc nofollow" target="_blank">äº’åŠ¨ç‰ˆæœ¬</a>ï¼Œä¸‹é¢æ˜¯æ¼”ç¤ºå¦‚ä½•åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šè¿è¡Œ:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/16809a1d8baab98e2047510b95f7b90e.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/0*fOsHrHgwWkFH0VQZ.gif"/></div></figure><p id="8a73" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">ä½ å¯ä»¥åœ¨<a class="ae kc" href="https://github.com/trekhleb/trekhleb.github.io/tree/master/src/posts/2021/gyro-web/components/" rel="noopener ugc nofollow" target="_blank">trek Hleb . github . io</a>repoä¸­æ‰¾åˆ°æœ¬æ–‡ä¸­çš„æ‰€æœ‰ä»£ç ç¤ºä¾‹(åŒ…æ‹¬é™€èºç«‹æ–¹ä½“æ ·å¼)ã€‚</p><p id="661f" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr mf kt ku kv mh kx ky kz mj lb lc ld le ij bi translated">æˆ‘å¸Œæœ›è¿™ä¸ªä¾‹å­å¯¹ä½ æœ‰ç”¨ï¼æˆ‘è¿˜å¸Œæœ›ä½ èƒ½æƒ³å‡ºä¸€ä¸ªæ¯”ä¸Šé¢çš„é™€èºç«‹æ–¹ä½“æ›´æœ‰è¶£ã€æ›´ç°å®çš„è®¾å¤‡å®šå‘ç”¨ä¾‹ğŸ˜„ç¼–ç å¿«ä¹ï¼</p></div></div>    
</body>
</html>