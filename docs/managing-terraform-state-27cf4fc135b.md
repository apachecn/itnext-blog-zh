# ç®¡ç†åœ°å½¢çŠ¶æ€

> åŸæ–‡ï¼š<https://itnext.io/managing-terraform-state-27cf4fc135b?source=collection_archive---------3----------------------->

## æœ€ä½³å®è·µå’Œç¤ºä¾‹

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶å¦‚ä½•ç®¡ç† Terraform çŠ¶æ€ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä»‹ç»ä»€ä¹ˆæ˜¯ Terraform çŠ¶æ€ä»¥åŠä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Œç„¶åçœ‹ä¸€äº›å­˜å‚¨ã€ç»„ç»‡å’Œéš”ç¦»çŠ¶æ€æ–‡ä»¶çš„æœ€ä½³å®è·µã€‚ç„¶åï¼Œæˆ‘ä»¬å°†ç»§ç»­ç ”ç©¶å¦‚ä½•åˆ©ç”¨æ•°æ®æºå¼•ç”¨è¿œç¨‹çŠ¶æ€ï¼Œæœ€åï¼Œå¦‚ä½•ä½¿ç”¨`terraform state`å‘½ä»¤æ¥æ“ä½œçŠ¶æ€æ–‡ä»¶çš„å†…å®¹ã€‚

![](img/068d9dae81b35ccf4406516a823593cf.png)

ç…§ç‰‡ç”±[é˜¿ç»´Â·ç†æŸ¥å…¹](https://unsplash.com/@avirichards?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)åœ¨ [Unsplash](https://unsplash.com/s/photos/remote?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ä¸Šæ‹æ‘„

## ä»€ä¹ˆæ˜¯åœ°å½¢çŠ¶æ€ï¼Ÿ

Terraform åœ¨ä¸€ä¸ªçŠ¶æ€æ–‡ä»¶ä¸­è®°å½•å®ƒæ‰€åˆ›å»ºçš„èµ„æºçš„ä¿¡æ¯ã€‚è¿™ä½¿å¾— Terraform èƒ½å¤ŸçŸ¥é“å“ªäº›èµ„æºåœ¨å…¶æ§åˆ¶ä¹‹ä¸‹ï¼Œä»¥åŠä½•æ—¶æ›´æ–°å’Œé”€æ¯å®ƒä»¬ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œterraform çŠ¶æ€æ–‡ä»¶åä¸º`terraform.tfstate`ï¼Œä¿å­˜åœ¨è¿è¡Œ Terraform çš„åŒä¸€ç›®å½•ä¸­ã€‚å®ƒæ˜¯åœ¨è¿è¡Œ`terraform apply.`ä¹‹ååˆ›å»ºçš„ã€‚è¿™ä¸ªæ–‡ä»¶çš„å®é™…å†…å®¹æ˜¯é…ç½®ä¸­å®šä¹‰çš„èµ„æºçš„ JSON æ ¼å¼æ˜ å°„ï¼Œä»¥åŠé‚£äº›å­˜åœ¨äºæ‚¨çš„åŸºç¡€è®¾æ–½ä¸­çš„èµ„æºã€‚å½“ Terraform è¿è¡Œæ—¶ï¼Œå®ƒå¯ä»¥ä½¿ç”¨è¿™ç§æ˜ å°„æ¥æ¯”è¾ƒåŸºç¡€è®¾æ–½å’Œä»£ç ï¼Œå¹¶æ ¹æ®éœ€è¦è¿›è¡Œè°ƒæ•´ã€‚

## å­˜å‚¨çŠ¶æ€æ–‡ä»¶

é»˜è®¤æƒ…å†µä¸‹ï¼ŒçŠ¶æ€æ–‡ä»¶å­˜å‚¨åœ¨è¿è¡Œ Terraform çš„æœ¬åœ°ç›®å½•ä¸­ã€‚å¦‚æœæ‚¨ä½¿ç”¨ Terraform è¿›è¡Œæµ‹è¯•æˆ–ç”¨äºä¸ªäººé¡¹ç›®ï¼Œè¿™æ˜¯å¾ˆå¥½çš„(åªè¦æ‚¨çš„çŠ¶æ€æ–‡ä»¶æ˜¯å®‰å…¨çš„å’Œå¤‡ä»½çš„ï¼)ï¼Œä½†æ˜¯ï¼Œå½“åœ¨ä¸€ä¸ªå›¢é˜Ÿä¸­å¤„ç† Terraform é¡¹ç›®æ—¶ï¼Œè¿™å°±æˆäº†ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºå¤šä¸ªäººéœ€è¦è®¿é—®çŠ¶æ€æ–‡ä»¶ã€‚æ­¤å¤–ï¼Œå½“ä½¿ç”¨è‡ªåŠ¨åŒ–å’Œ CI/CD ç®¡é“æ¥è¿è¡Œ Terraform æ—¶ï¼ŒçŠ¶æ€æ–‡ä»¶éœ€è¦æ˜¯å¯è®¿é—®çš„ï¼Œå¹¶ä¸”å°†è®¸å¯ç»™äºˆè¿è¡Œç®¡é“çš„æœåŠ¡ä¸»ä½“ï¼Œä»¥ä¾¿èƒ½å¤Ÿè®¿é—®ä¿å­˜çŠ¶æ€æ–‡ä»¶çš„å­˜å‚¨å¸æˆ·å®¹å™¨ã€‚è¿™ä½¿å¾—å…±äº«å­˜å‚¨æˆä¸ºä¿å­˜çŠ¶æ€æ–‡ä»¶çš„ç†æƒ³é€‰æ‹©ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æˆäºˆæƒé™ã€‚Azure å­˜å‚¨å¸æˆ·æˆ–äºšé©¬é€Š S3 æ¡¶æ˜¯ä¸€ä¸ªå®Œç¾çš„é€‰æ‹©ã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ [Spacelift ä¹‹ç±»çš„å·¥å…·ä¸ºä½ ç®¡ç†ä½ çš„çŠ¶æ€](https://docs.spacelift.io/vendors/terraform/state-management)ã€‚

ä½ åº”è¯¥è¿œç¨‹å­˜å‚¨ä½ çš„çŠ¶æ€æ–‡ä»¶ï¼Œè€Œä¸æ˜¯åœ¨ä½ çš„æœ¬åœ°æœºå™¨ä¸Šï¼ç„¶åå¯ä»¥ä½¿ç”¨`terraform`å—ä¸­çš„`backend`å—å¼•ç”¨è¿œç¨‹çŠ¶æ€æ–‡ä»¶çš„ä½ç½®(é€šå¸¸åœ¨`main.tf`æ–‡ä»¶ä¸­)ã€‚

ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†åœ¨ Azure ä¸­ä½¿ç”¨å­˜å‚¨å¸æˆ·çš„é…ç½®:

```
terraform { backend "azurerm" {
    resource_group_name  = "terraform-rg"
    storage_account_name = "terraformsa"
    container_name       = "terraformstate"
    key                  = "terraform.tfstate"
  }}
```

å°†çŠ¶æ€æ–‡ä»¶å­˜å‚¨åœ¨æºä»£ç æ§åˆ¶ä¸­å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚è¿™æ˜¯å› ä¸º Terraform çŠ¶æ€æ–‡ä»¶åŒ…å«æ‰€æœ‰çº¯æ–‡æœ¬æ•°æ®ï¼Œå…¶ä¸­å¯èƒ½åŒ…å«æœºå¯†ã€‚å°†ç§˜å¯†å­˜å‚¨åœ¨é™¤å®‰å…¨ä½ç½®ä¹‹å¤–çš„ä»»ä½•åœ°æ–¹éƒ½ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œå¹¶ä¸”ç»å¯¹ä¸åº”è¯¥æ”¾åœ¨æºä»£ç æ§åˆ¶ä¸­ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œä¾‹å¦‚åœ¨ Azure ä¸­ï¼Œå¯ä»¥å¼•ç”¨ Azure Key Vaultã€‚å…¶æ¬¡ï¼Œå¤§å¤šæ•°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¸å…è®¸é”å®šæ–‡ä»¶ï¼Œå½“å¤šäººè¯•å›¾åŒæ—¶è®¿é—®æ–‡ä»¶æ—¶ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´é—®é¢˜ã€‚æœ€åï¼Œåœ¨ç‰ˆæœ¬æ§åˆ¶ä¸­å­˜å‚¨çŠ¶æ€æ–‡ä»¶å¯èƒ½ä¼šå¼•å…¥äººä¸ºé”™è¯¯ï¼Œå› ä¸ºæ¯æ¬¡è¿è¡Œ Terraform æ—¶éƒ½éœ€è¦æå–æœ€æ–°çš„çŠ¶æ€æ–‡ä»¶ã€‚è¿™å¯èƒ½å¯¼è‡´ä½¿ç”¨æ—§çš„çŠ¶æ€æ–‡ä»¶ï¼Œå¹¶å¯¹åŸºç¡€ç»“æ„è¿›è¡Œæ„å¤–æ›´æ”¹ã€‚

ç›¸åï¼Œä½¿ç”¨è¿œç¨‹åç«¯è§£å†³äº†è¿™äº›æŒ‘æˆ˜ï¼Œæœ¬æœºæ”¯æŒé”å®šï¼Œå°†è‡ªåŠ¨åŠ è½½çŠ¶æ€æ–‡ä»¶ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨åŠ å¯†æ¥ä¿æŠ¤ç£ç›˜ä¸Šå’Œä¼ è¾“ä¸­çš„çŠ¶æ€æ–‡ä»¶ã€‚Azure Storage æˆ–äºšé©¬é€Š S3 ç­‰è¿œç¨‹åç«¯å­˜å‚¨æ—¨åœ¨å®ç°é«˜å¯ç”¨æ€§ã€‚å®ƒä»¬è¿˜æ”¯æŒç‰ˆæœ¬æ§åˆ¶ï¼Œå› æ­¤å¦‚æœæ–‡ä»¶æŸåï¼Œæ‚¨å¯ä»¥å›æ»šåˆ°ä»¥å‰çš„çŠ¶æ€æ–‡ä»¶ã€‚æœ€åï¼Œå®ƒä½¿ç”¨èµ·æ¥å¾ˆä¾¿å®œï¼Œé€šå¸¸çŠ¶æ€æ–‡ä»¶éå¸¸å°ï¼Œé€šå¸¸å¯ä»¥æ”¾å…¥ç©ºé—²å±‚ã€‚

## éš”ç¦»å’Œç»„ç»‡çŠ¶æ€æ–‡ä»¶

**å›½å®¶æ–‡ä»¶åº”è¯¥éš”ç¦»ï¼Œä»¥å‡å°‘â€œçˆ†ç‚¸åŠå¾„â€ã€‚**é€šå¸¸ï¼Œé¡¹ç›®è¢«æ„å»ºåœ¨å•ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œå¹¶ä¸”å¯¹æ‰€æœ‰èµ„æºä½¿ç”¨å•ä¸ªçŠ¶æ€æ–‡ä»¶ã€‚è¿™ä¼šç«‹å³å¸¦æ¥é£é™©ï¼Œå› ä¸ºé…ç½®ä¸­çš„é”™è¯¯å¯èƒ½ä¼šæ›´æ”¹çŠ¶æ€æ–‡ä»¶ï¼Œå¹¶å¯¹æ‰€æœ‰èµ„æºé€ æˆä¸å¿…è¦çš„åæœã€‚ä¸€ä¸ªæ›´å¥½çš„æ–¹æ³•æ˜¯ä¸ºåŸºç¡€è®¾æ–½çš„å„ä¸ªéƒ¨åˆ†ä½¿ç”¨å¤šä¸ªçŠ¶æ€æ–‡ä»¶ã€‚åœ¨é€»è¾‘ä¸Šå°†èµ„æºå½¼æ­¤åˆ†å¼€ï¼Œå¹¶åœ¨åç«¯ç»™å®ƒä»¬è‡ªå·±çš„çŠ¶æ€æ–‡ä»¶ï¼Œè¿™æ„å‘³ç€å¯¹ä¸€ä¸ªèµ„æºçš„æ›´æ”¹ä¸ä¼šå½±å“å¦ä¸€ä¸ªã€‚ä¸åŒç¯å¢ƒçš„ä¸åŒçŠ¶æ€æ–‡ä»¶ä¹Ÿæ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚

ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬çš„é¡¹ç›®ä¸­æœ‰ä¸€ä¸ª Azure SQL æ•°æ®åº“ã€Azure VNET å’Œ Azure Web Appã€‚åŸºç¡€è®¾æ–½åœ¨ 3 ä¸ªç¯å¢ƒä¸­æ˜¯ç›¸åŒçš„:å¼€å‘ã€UAT(ç”¨æˆ·éªŒæ”¶æµ‹è¯•)å’Œç”Ÿäº§ã€‚å¯¹äºæ¯ä¸ªç¯å¢ƒï¼Œè¿™ 3 ç§èµ„æºä¸­çš„æ¯ä¸€ç§éƒ½æœ‰è‡ªå·±çš„çŠ¶æ€æ–‡ä»¶ã€‚è¿™ä¸ºæ¯ä¸ªç¯å¢ƒæä¾›äº†å¼ºæœ‰åŠ›çš„éš”ç¦»ã€‚æ›´è¿›ä¸€æ­¥ï¼Œæ‚¨å¯èƒ½å¸Œæœ›åœ¨ä¸åŒçš„è®¢é˜…ä¸­ä¸ºæ¯ä¸ªç¯å¢ƒä½¿ç”¨å®Œå…¨ç‹¬ç«‹çš„å­˜å‚¨å¸æˆ·ã€‚å‡è®¾æˆ‘ä»¬å°†æ‰€æœ‰çŠ¶æ€æ–‡ä»¶ä¿å­˜åœ¨ä¸€ä¸ªå­˜å‚¨å¸æˆ·ä¸­ï¼Œè¿œç¨‹åç«¯çš„å®¹å™¨æ–‡ä»¶å¤¹ç»“æ„æœ€ç»ˆå¯èƒ½çœ‹èµ·æ¥åƒä¸‹é¢çš„ç¤ºä¾‹:

```
terraformstate--development
  --webapp.tfstate
  --sqldb.tfstate
  --vnet.tfstate--UAT
  --webapp.tfstate
  --sqldb.tfstate
  --vnet.tfstate--production
  --webapp.tfstate
  --sqldb.tfstate
  --vnet.tfstate
```

å¼€å‘ç¯å¢ƒä¸­ Azure Web App çš„åç«¯é…ç½®:

```
terraform { backend "azurerm" {
    resource_group_name  = "terraform-rg"
    storage_account_name = "terraformsa"
    container_name       = "terraformstate"
    key                  = "development\webapp.tfstate"
  }}
```

å¯¹å¼€å‘ä¸­çš„ Azure Web åº”ç”¨ç¨‹åºè¿›è¡Œæ›´æ”¹ä¸ä¼šå½±å“ç”Ÿäº§ä¸­çš„ Azure Web åº”ç”¨ç¨‹åºã€‚

ä½¿ç”¨ Terraform å·¥ä½œç©ºé—´ä¹Ÿå¯ä»¥å®ç°éš”ç¦»ã€‚è¿™äº›åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¸å¤ªæœ‰ç”¨ï¼Œä½†æœ‰åˆ©äºå¿«é€Ÿæµ‹è¯•éš”ç¦»ç¯å¢ƒã€‚[ä¸é¼“åŠ±ä½¿ç”¨å·¥ä½œç©ºé—´æ¥ç®¡ç†å®é™…ç¯å¢ƒ](https://www.terraform.io/language/state/workspaces#when-to-use-multiple-workspaces.)ã€‚Terraform é»˜è®¤æœ‰ä¸€ä¸ªå·¥ä½œç©ºé—´(ç§°ä¸º defaultï¼).çŠ¶æ€æ–‡ä»¶è¢«éš”ç¦»åˆ°æ¯ä¸ªå·¥ä½œåŒºã€‚

æ‚¨å¯ä»¥ä½¿ç”¨`terraform workspace new`å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ä½œç©ºé—´ã€‚

```
$ terraform workspace new developmentCreated and switched to workspace "development"! You're now on a new, empty workspace. Workspaces isolate their state, so if you run "terraform plan" Terraform will not see any existing state for this configuration.
```

ä½¿ç”¨å·¥ä½œç©ºé—´æ—¶æœ‰ç”¨çš„å‘½ä»¤å¿«é€Ÿå‚è€ƒ:

`terraform workspace list` â€”åˆ—å‡ºæ‚¨çš„å·¥ä½œåŒºã€‚

`terraform workspace new [workspace name]` â€”åˆ›å»ºæ–°çš„å·¥ä½œåŒºã€‚

`terraform workspace select [workspace name]`-åˆ‡æ¢åˆ°æŒ‡å®šçš„å·¥ä½œåŒºã€‚

## åœ°å½¢è¿œç¨‹çŠ¶æ€

`terraform_remote_state`æ˜¯ä¸€ä¸ªæ•°æ®æºï¼Œå¯ç”¨äºç›´æ¥ä»è¿œç¨‹çŠ¶æ€æ–‡ä»¶ä¸­è·å–è¯¦ç»†ä¿¡æ¯ã€‚å½“æ‚¨éœ€è¦å¼•ç”¨å­˜å‚¨åœ¨ä¸åŒçŠ¶æ€æ–‡ä»¶ä¸­çš„é…ç½®è¾“å‡ºæ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚å½“åœ¨æ‚¨çš„é…ç½®ä¸­å®šä¹‰äº†ä¸€ä¸ª`output`å—æ—¶ï¼Œå…¶å†…å®¹åŒ…å«åœ¨çŠ¶æ€æ–‡ä»¶ä¸­ã€‚è¿™äº›ç»†èŠ‚å¯ä»¥åœ¨é¡¹ç›®çš„å…¶ä»–åœ°æ–¹å¼•ç”¨ã€‚

ä¾‹å¦‚ï¼Œå†æ¬¡è€ƒè™‘æˆ‘ä»¬æœ‰ä¸€ä¸ª Azure SQL æ•°æ®åº“å’Œ Azure Web åº”ç”¨ç¨‹åºã€‚è¿™äº›çš„é…ç½®æ–‡ä»¶åº”è¯¥è®¾ç½®ä¸ºä½¿ç”¨ä¸åŒçš„çŠ¶æ€æ–‡ä»¶ã€‚å½“åˆ›å»º web åº”ç”¨ç¨‹åºéœ€è¦è¿æ¥çš„æ•°æ®åº“æ—¶ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ª`output`å—æ¥å…¬å¼€æ•°æ®åº“åˆ›å»ºåçš„ç»“æœ ID:

```
output "sqldb_id" {
  value       = azurerm_sql_database.example.id
  description = "Database ID"
}
```

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨`terraform_remote_state`é…ç½®æ•°æ®å—ï¼Œåœ¨ Web åº”ç”¨ç¨‹åºé…ç½®ä»£ç ä¸­å¼•ç”¨ç»“æœ SQL æ•°æ®åº“ ID:

```
data "terraform_remote_state" "dev_sqldb" {   
  backend = "azurerm"

  config = {     
    storage_account_name = "terraformsa"     
    container_name       = "terraformstate"     
    key                  = "development/sqldb.tfstate"   
  }
}
```

ç„¶ååœ¨é…ç½®ä¸­éœ€è¦çš„åœ°æ–¹å¼•ç”¨è¾“å‡ºçš„åç§°:

```
data.terraform_remote_state.dev_sqldb.outputs.sqldb_id
```

## æ“ä½œçŠ¶æ€æ–‡ä»¶

æœ‰æ—¶æœ‰å¿…è¦ç›´æ¥ä¸çŠ¶æ€æ–‡ä»¶äº¤äº’ï¼Œæˆ–è€…æ£€æŸ¥å…¶å†…å®¹ï¼Œå½“é¡¹ç›®è¢«é”™è¯¯å¯¼å…¥æˆ–ä¸å†å­˜åœ¨äºçœŸå®åŸºç¡€ç»“æ„ä¸­æ—¶åˆ é™¤é¡¹ç›®ï¼Œæˆ–è€…å¯¼å…¥å·²ç»å­˜åœ¨çš„é¡¹ç›®ä»¥å°†å…¶ç½®äº Terraform ç®¡ç†ä¹‹ä¸‹ã€‚

`terraform state`å‘½ä»¤å¯ç”¨äºæ‰§è¡Œé«˜çº§çŠ¶æ€ç®¡ç†ã€‚æ‰€æœ‰ä¿®æ”¹çŠ¶æ€çš„çŠ¶æ€ç®¡ç†å‘½ä»¤åœ¨è¿›è¡Œä¿®æ”¹ä¹‹å‰åˆ›å»ºçŠ¶æ€çš„æ—¶é—´æˆ³å¤‡ä»½ã€‚

æœ‰ç”¨çš„`terraform state`å‘½ä»¤:

`terraform state list` â€”åˆ—å‡ºçŠ¶æ€æ–‡ä»¶çš„å†…å®¹ã€‚

`terraform state rm` â€”ä»çŠ¶æ€æ–‡ä»¶ä¸­åˆ é™¤ä¸€ä¸ªé¡¹ç›®ã€‚

`terraform state show` â€”æ˜¾ç¤ºçŠ¶æ€æ–‡ä»¶ä¸­çš„èµ„æºã€‚

è¦å°†åŸºç¡€è®¾æ–½ä¸­ç”±å…¶ä»–æ–¹æ³•åˆ›å»ºçš„ç°æœ‰é¡¹ç›®å¯¼å…¥çŠ¶æ€æ–‡ä»¶ï¼Œä½¿å…¶å¤„äºåœ°å½¢æ§åˆ¶ä¹‹ä¸‹ï¼Œå¯ä½¿ç”¨`terraform import`å‘½ä»¤ã€‚Terraform æ–‡æ¡£é¡µé¢ä¸Šçš„æ¯ä¸ªèµ„æºéƒ½æœ‰ä¸€ä¸ªå¯¼å…¥éƒ¨åˆ†ï¼Œè¯¦ç»†è¯´æ˜äº†å¦‚ä½•å¯¹ç‰¹å®šèµ„æºä½¿ç”¨è¯¥å‘½ä»¤ã€‚æ¯”å¦‚åœ¨[azure RM _ sql _ database](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_database)docs é¡µé¢ä¸Šï¼Œå£°æ˜å¯ä»¥ä½¿ç”¨`resource id`å¯¼å…¥ SQL æ•°æ®åº“ï¼Œå¹¶ç»™å‡ºäº†ä¸€ä¸ªä¾‹å­ã€‚

```
terraform import azurerm_sql_database.database1 /subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/myresourcegroup/providers/Microsoft.Sql/servers/myserver/databases/database1
```

åœ¨ä½¿ç”¨è¯¥å‘½ä»¤ä¹‹å‰ï¼Œéœ€è¦å°†ç›¸åº”çš„`resource`å—`azurerm_sql_database.database1`å†™å…¥é…ç½®æ–‡ä»¶ï¼Œè®¾ç½®ä¸å®é™…åŸºç¡€è®¾æ–½ç›¸åŒ¹é…ã€‚å¯¼å…¥èµ„æºå¯èƒ½éå¸¸è€—æ—¶ï¼Œå› æ­¤ä»ä¸€å¼€å§‹å°±é¿å…æ‰‹åŠ¨åˆ›å»ºèµ„æºé€šå¸¸æ˜¯ä¸€ä¸ªæ˜æ™ºçš„æƒ³æ³•ï¼

## æ‘˜è¦

ç†è§£ Terraform çŠ¶æ€ç®¡ç†å’Œæœ€ä½³å®è·µæ˜¯ç²¾é€š Terraform çš„å…³é”®ã€‚ä½œä¸ºä¸€èˆ¬è§„åˆ™ï¼ŒçŠ¶æ€æ–‡ä»¶åº”è¿œç¨‹å­˜å‚¨ï¼Œå¹¶ä»¥è¿™æ ·çš„æ–¹å¼éš”ç¦»å’Œç»„ç»‡ï¼Œå³å¯¹äºèµ„æºå’Œç¯å¢ƒçš„é€»è¾‘ç»„å­˜åœ¨å•ç‹¬çš„çŠ¶æ€æ–‡ä»¶ï¼Œä»¥ä¾¿åœ¨å‘ç”Ÿä»»ä½•é”™è¯¯æ—¶å‡å°‘â€œçˆ†ç‚¸åŠå¾„â€ã€‚`terraform_remote_state`æ•°æ®æºå¯ç”¨äºä»çŠ¶æ€æ–‡ä»¶ä¸­å¼•ç”¨`outputs`ã€‚æœ€åï¼Œ`terraform state`å’Œ`terraform import`å‘½ä»¤å¯ä»¥ç”¨æ¥æ“ä½œçŠ¶æ€æ–‡ä»¶çš„å†…å®¹ã€‚

æœ‰å…³ Terraform çŠ¶æ€çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ Terraform æ–‡æ¡£:

[](https://www.terraform.io/language/state) [## HashiCorp çš„ State | Terraform

### æœç´¢ Terraform æ–‡æ¡£ Terraform å¿…é¡»å­˜å‚¨æœ‰å…³æ‰˜ç®¡åŸºç¡€æ¶æ„å’Œé…ç½®çš„çŠ¶æ€ã€‚è¿™ä¸ªâ€¦

www.terraform.io](https://www.terraform.io/language/state) 

æƒ³è¦æ›´å¤šçš„ Terraform å†…å®¹ï¼Ÿ[ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹æˆ‘åœ¨ Terraform ä¸Šçš„å…¶ä»–æ–‡ç« ](https://medium.com/@jackwesleyroper/terraform-related-articles-index-52fab8f11a0b)ï¼

å¹²æ¯ï¼ğŸ»

[](https://www.buymeacoffee.com/jackwesleyroper) [## Jack Roper æ­£åœ¨ Azureã€Azure DevOpsã€Terraformã€Kubernetes å’Œ Cloud tech ä¸Šå†™åšå®¢ï¼

### å¸Œæœ›æˆ‘çš„åšå®¢èƒ½å¸®åˆ°ä½ ï¼Œä½ ä¼šå–œæ¬¢å®ƒçš„å†…å®¹ï¼æˆ‘çœŸçš„å¾ˆå–œæ¬¢å†™æŠ€æœ¯å†…å®¹å’Œåˆ†äº«â€¦

www.buymeacoffee.com](https://www.buymeacoffee.com/jackwesleyroper) 

*æœ€åˆå‘è¡¨äº*[*space lift . io*](https://spacelift.io/)*ã€‚*